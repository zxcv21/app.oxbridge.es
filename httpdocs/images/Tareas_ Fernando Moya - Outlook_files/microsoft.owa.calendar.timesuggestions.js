try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.timesuggestions.js'] = (new Date()).getTime();
function CalendarTimeSuggestionsComponent(){}CalendarTimeSuggestionsComponent.$$cctor=function(){_a.r.a().a(CalendarTimeSuggestionsComponent)};CalendarTimeSuggestionsComponent.prototype={a:function(n,t,i){var r=this;n.b(ITimeSuggestionsViewModelFactory,function(){return new Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.d(n.a(_a.cj))}).a()},b:function(){return[]}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models");Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a.initializeBase(this);this.c=n};Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a.prototype={c:null,b:null,u:function(n){var t;var r=(t=new _gg.hK,t.Header=this.y(),t.Body=this.c,t);var i=new _gg.sx(this.x);n.bn(r,i,this.r,this.q)},cp:function(n){if(n.MeetingTimeCandidates){this.b=new Array(n.MeetingTimeCandidates.length);for(var t=0;t<n.MeetingTimeCandidates.length;t++)this.b[t]=n.MeetingTimeCandidates[t]}}};Type.registerNamespace("Microsoft.Owa.Calendar.TimeSuggestions.ViewModels");Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c=function(n){Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c.initializeBase(this);this.d=n};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c.prototype={d:null,c:function(){return _a.c.b(this.d.MeetingTimeslot.StartTime)},b:function(){return this.c().r(this.d.MeetingTimeslot.DurationInMinutes)},a:function(){if(this.d.Locations&&this.d.Locations.length>0){var n;return n=new _g.d,n.EmailAddress=this.d.Locations[0].EmailAddress,n.Name=this.d.Locations[0].DisplayName,n}return new _g.d},g:function(){return _js.d.c(_tss.CalTSStrings.D,this.c().a(7),this.c().a(18),this.b().a(18))},f:function(){return this.e()?this.e()===this.d.AttendeeAvailabilities.length?_tss.CalTSStrings.C:this.e()===1?_tss.CalTSStrings.A:String.format(_tss.CalTSStrings.B,this.e()):_tss.CalTSStrings.J},e:function(){var t=0;if(!this.d.AttendeeAvailabilities)return 0;for(var n=0;n<this.d.AttendeeAvailabilities.length;n++)this.d.AttendeeAvailabilities[n].Availability!=="Free"&&t++;return t}};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a=function(){Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a.initializeBase(this);this.f=new _js.f};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a.prototype={h:!1,j:!1,k:!1,f:null,g:null,b:function(){return this.h},a:function(n){this.h=n;this.ea("IsExpanded");return n},e:function(n){this.j=n;this.ea("IsLoading");this.p(!n&&!this.f.y.length);return n},p:function(n){this.k=n;this.ea("ShowNoResultsMessage");return n},c:function(){return this.f},d:function(){return this.g},n:function(n){if(this.g!==n){this.g=n;this.ea(Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a.a)}return n},m:function(n){this.f.g();if(n)for(var t=0;t<n.length;t++)this.f.a(new Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c(n[t]));this.e(!1)}};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.d=function(n){this.b=n};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.d.prototype={b:null,a:function(n){return new Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b(n,this.b)}};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b=function(n,t){this.o=Function.createDelegate(this,this.r);Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b.initializeBase(this);this.m=t;this.h=n;this.n=new _C(this.o,Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b.a);this.t(new Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a);this.f=new _js.f;this.f.a(30);this.f.a(60);this.f.a(120);this.f.a(180);this.f.a(240);this.f.a(480);this.i=30;this.l=!0;this.d(!0)};Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b.prototype={h:null,n:null,f:null,l:!1,k:!1,i:0,g:null,j:null,m:null,c:function(n){if(this.i!==n&&n>0){this.i=n;this.ea("Duration")}return n},e:function(n){this.l=n;return n},b:function(){return this.k},d:function(n){if(n!==this.k){this.k=n;this.ea("IsEnabled")}return n},a:function(){return this.g},t:function(n){this.g=n;return n},p:function(){var n=new Array(0);if(this.h.q()){var i=this;this.h.q().o(function(t){var i;n.push((i=new _gg.dZ,i.Email=t.bh.Mailbox.EmailAddress,i.IsRequired=!0,i))})}if(this.h.v()){var t=this;this.h.v().o(function(t){var i;n.push((i=new _gg.dZ,i.Email=t.bh.Mailbox.EmailAddress,i.IsRequired=!1,i))})}return n},q:function(){var n=this.h.r();var i=new Array(0);if(n&&n.bh.DisplayName&&n.a()&&n.a().a()!=="Resource"){var t;i.push((t=new _gg.fn,t.Name=n.bh.DisplayName,t.ResolveAvailability=!1,t))}if(!this.l){var r=this;this.h.G().o(function(n){var r=n;var t;i.push((t=new _gg.fn,t.Email=r.bh.Mailbox.EmailAddress,t.Name=r.bh.Mailbox.Name||r.bh.Mailbox.EmailAddress,t.ResolveAvailability=!0,t))})}return i},r:function(){var i,t,u,f,r,n;var s=(n=new _gg.eA,n.SearchConstraints=(t=new _gg.hO,t.MeetingDurationInMinutes=this.i,t.SearchWindows=[(i=new _gg.mh,i.StartTime=_a.c.get_utcNow().H(),i.DurationInMinutes=21600,i)],t),n.AttendeeConstraints=(u=new _gg.hL,u.AttendeeEntries=this.p(),u),n.Constraints=(f=new _gg.hM,f.MaxCandidates=5,f),n.LocationConstraints=(r=new _gg.hN,r.LocationEntries=this.q(),r),n);this.j=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a(s);var e=this;this.j.z(function(n){var t=n;t===e.j&&e.g.m(t.b)});var o=this;this.j.v(function(){o.g.e(!1)});this.m.a(this.j);this.g.c().g();this.g.e(!0);this.g.a(!0)}};Type.registerNamespace("_cts");_cts._TI=function(){};_cts._TI.$$cctor=function(){var r="FindMeetingTimesView._tid1";new _A(r,function(){_cts._TI.a[r]===undefined&&(_cts._TI.a[r]=[null]);var t=_cts._TI._hf.childNodes[0].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_cts._TI.a);var u="FindMeetingTimesView.MeetingTimeCandidateView._tid2";new _A(u,function(){_cts._TI.a[u]===undefined&&(_cts._TI.a[u]=[[[-1,0,["ResultLabel"],[_cts._TI.L],null,"Text",null,_cts._TI.b,1,null,null,null]],[[-1,0,["LocationEmailAddress","Name"],[_cts._TI.K,_cts._TI.j],null,"Text",null,_cts._TI.b,1,null,null,null]],[[-1,0,["AttendeeAvailabilityLabel"],[_cts._TI.J],null,"Text",null,_cts._TI.b,1,null,null,null]]]);var n=_cts._TI._hf.childNodes[1].cloneNode(!0);var r=new _fc.a(_B.a(n,[1,1]));var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i,r])},Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_cts._TI.a);var f="FindMeetingTimesView.MeetingTimeCandidateView";new _A(f,function(){_cts._TI.a[f]===undefined&&(_cts._TI.a[f]=[[[-1,5,["ContextParent","IsItemHovered"],[_cts._TI.f,_cts._TI.r],null,"ms-bg-color-neutralLight",null,null,1,null,null,null],[-1,5,["IsSelected"],[_cts._TI.s],null,"ms-bg-color-themeLight",null,null,1,null,null,null]]]);var t=_cts._TI._hf.childNodes[2].cloneNode(!0);var n=new _js.b(t.children[0]);n.w("FindMeetingTimesView.MeetingTimeCandidateView._tid2");return new _B(t,[n])},Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_cts._TI.a);var n="FindMeetingTimesView";new _A(n,function(){_cts._TI.a[n]===undefined&&(_cts._TI.a[n]=[[[-1,4,null,null,null,"Text",null,_cts._TI.b,0,null,null,null,_tss.CalTSStrings.I]],[[-1,4,null,null,null,"SpinnerSize",null,_cts._TI.n,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_cts._TI.m,0,null,null,null,_tss.CalTSStrings.H],[-1,0,["IsLoading"],[_cts._TI.E],null,"IsHidden",null,_cts._TI.g,1,_cts._TI.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_cts._TI.b,0,null,null,null,_tss.CalTSStrings.F],[-1,0,["ShowNoResultsMessage"],[_cts._TI.H],null,"IsHidden",null,_cts._TI.g,1,_cts._TI.e(),null,!0]],null,[[-1,0,["MeetingTimeCandidates"],[_cts._TI.F],null,"DataSource",null,_cts._TI.p,1,null,null,null],[-1,0,["SelectedCandidate"],[_cts._TI.G],_cts._TI.I,"SelectedItem",_cts._TI.o,_cts._TI.q,2,null,null,null]]]);var t=_cts._TI._hf.childNodes[3].cloneNode(!0);var r=new _fce.a(_B.a(t,[0,1,0]),_js.a.Instance.a(_ff.a));r.v("FindMeetingTimesView.MeetingTimeCandidateView");r.w("FindMeetingTimesView._tid1");var e=new _fce.f(_B.a(t,[0,1]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var u=new _fc.a(_B.a(t,[0,0,2]));u.C(0);var i=new _fce.g(_B.a(t,[0,0,1]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));i.C(0);i.a=6;var f=new _fc.a(_B.a(t,[0,0,0,0]));return new _B(t,[f,i,u,e,r])},Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_cts._TI.a);var t="TimeSuggestionsView.DurationItemTemplate";new _A(t,function(){_cts._TI.a[t]===undefined&&(_cts._TI.a[t]=[[[-1,1,["DataContext"],[_cts._TI.A],null,"Text",null,_cts._TI.b,1,_cts._TI.h(),null,null]]]);var n=_cts._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.a(n.children[0]);return new _B(n,[i])},Object,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_cts._TI.a);var i="TimeSuggestionsView";new _A(i,function(){_cts._TI.a[i]===undefined&&(_cts._TI.a[i]=[[[-1,4,null,null,null,"Text",null,_cts._TI.b,0,null,null,null,_tss.CalTSStrings.I]],[[-1,4,null,null,null,"Text",null,_cts._TI.b,0,null,null,null,_tss.CalTSStrings.E]],[[-1,0,["DurationPickerOptions"],[_cts._TI.N],null,"Options",null,_cts._TI.u,1,null,null,null],[-1,0,["Duration"],[_cts._TI.M],_cts._TI.Q,"SelectedValue",_cts._TI.t,_cts._TI.v,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_cts._TI.l,0,null,null,null,_tss.CalTSStrings.G],[-1,0,["ShowSuggestTimesCommand"],[_cts._TI.P],null,"ClickCommand",null,_cts._TI.k,1,null,null,null]],[[-1,0,["FindMeetingTimesViewModel"],[_cts._TI.O],null,"DataContext",null,_cts._TI.B,1,null,null,null],[0,0,["IsExpanded"],[_cts._TI.C],_cts._TI.D,"IsShown",_cts._TI.w,_cts._TI.x,2,null,null,!1]]]);var t=_cts._TI._hf.childNodes[5].cloneNode(!0);var r=new _fce.k(t.children[4],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));r.w("FindMeetingTimesView");r.v("contextMenuDropShadow");var u=new _fce.r(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));u.A(_E.b(4,null,null,null,"HorizontalAlignment",null,_cts._TI.z,0,null,null,0)).D(_E.a(["ContextParent"],[_cts._TI.f],null,"AnchorElement",null,_cts._TI.y,1));u.c=-114;u.l=1;r.b(u);var n=new _fc.b(t.children[3]);n.bw("Suggest Times");n.d("ms-font-color-neutralPrimary ms-border-color-neutralTertiary");n.a("ms-font-color-black ms-bg-color-themeLighter ms-border-color-themeSecondary");n.b("ms-font-color-black ms-bg-color-themeSecondary ms-border-color-themeSecondary");n.c(2);var o=new _fce.j(t.children[2]);o.a("TimeSuggestionsView.DurationItemTemplate");var e=new _fc.a(t.children[1]);e.N(!0);var f=new _fc.a(t.children[0]);f.N(!0);return new _B(t,[f,e,o,n,r])},Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_cts._TI.a)};_cts._TI.i=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div></div> </div><div> <span class='ms-font-weight-semibold ms-font-color-neutralPrimary'></span> <div class='_cts_5'> <span class='_cts_6 ms-font-weight ms-font-color-neutralPrimary'></span> <span class='ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <div class='_cts_4'></div> </div><div> <div class='FindMeetingTimesPopup'> <div class='_cts_3 ms-border-color-neutralLight'> <div> <span class='ms-font-weight-regular ms-font-color-themePrimary'></span> </div> <div class='_cts_2 ms-font-weight-regular'></div> <span class='_cts_2'></span> </div> <div class='scroll-region'> <div></div> </div> </div>  </div><div> <span></span> </div><div> <span class='_cts_9 ms-font-weight-semilight ms-font-color-neutralPrimary'></span> <span class='ms-font-weight-semilight ms-font-color-neutralSecondaryAlt'></span> <div class='_cts_7'></div> <button type='button' class='_cts_8 ms-fwt-r'></button> <div class='ms-bg-color-white _cts_a'></div>  </div>";_js.c.a().appendChild(n);return n};_cts._TI.L=function(n){return n.g()};_cts._TI.K=function(n){return n.a()};_cts._TI.j=function(n){return n.Name};_cts._TI.J=function(n){return n.f()};_cts._TI.f=function(n){return n.L};_cts._TI.r=function(n){return _fce.d.isInstanceOfType(n)?n.q:null};_cts._TI.s=function(n){return n.k()};_cts._TI.E=function(n){return n.j};_cts._TI.H=function(n){return n.k};_cts._TI.F=function(n){return n.f};_cts._TI.G=function(n){return n.g};_cts._TI.o=function(n){return n.Z()};_cts._TI.A=function(n){return n.E()};_cts._TI.N=function(n){return n.f};_cts._TI.M=function(n){return n.i};_cts._TI.t=function(n){return n.b()};_cts._TI.P=function(n){return n.n};_cts._TI.O=function(n){return n.g};_cts._TI.C=function(n){return n.b()};_cts._TI.w=function(n){return n.c()};_cts._TI.b=function(n,t){n.a(t)};_cts._TI.n=function(n,t){n.c(t)};_cts._TI.m=function(n,t){n.d(t)};_cts._TI.g=function(n,t){n.M(t)};_cts._TI.p=function(n,t){n.bm(t)};_cts._TI.I=function(n,t){n.n(t)};_cts._TI.q=function(n,t){n.bd(t)};_cts._TI.u=function(n,t){n.c(t)};_cts._TI.Q=function(n,t){n.c(t)};_cts._TI.v=function(n,t){n.d(t)};_cts._TI.l=function(n,t){n.h(t)};_cts._TI.k=function(n,t){n.ba(t)};_cts._TI.B=function(n,t){n.X(t)};_cts._TI.D=function(n,t){n.a(t)};_cts._TI.x=function(n,t){n.a(t)};_cts._TI.z=function(n,t){n.b=t};_cts._TI.y=function(n,t){n.d(t)};_cts._TI.e=function(){_cts._TI.c||(_cts._TI.c=new _fc.k);return _cts._TI.c};_cts._TI.h=function(){_cts._TI.d||(_cts._TI.d=new _cc.bd);return _cts._TI.d};CalendarTimeSuggestionsComponent.registerClass("CalendarTimeSuggestionsComponent",null,_a.ih);Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.TimeSuggestions.Models.a",_h.dj.$$(_gg.sy,_gg.sz));Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c.registerClass("Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.c",_a.bx,_cc.du,_js.z);Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a.registerClass("Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a",_y.hO,_cc.dt,_js.z);Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b.registerClass("Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b",_a.bx,_cc.dw,_js.z);_cts._TI.registerClass("_cts._TI");CalendarTimeSuggestionsComponent.$$cctor();Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.a.a="SelectedCandidate";Microsoft.Owa.Calendar.TimeSuggestions.ViewModels.b.a=_a.a.o;_cts._TI._hf=_cts._TI.i();_cts._TI.c=null;_cts._TI.d=null;_cts._TI.a={};_cts._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.timesuggestions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.timesuggestions.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
