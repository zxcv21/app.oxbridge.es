try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.people.core.js'] = (new Date()).getTime();
Type.registerNamespace("_pc");_pc.m=function(){};_pc.m.prototype={ComposeForms:0,PeopleModule:1,HoverCard:2,OwaOptionPage:3,MailSearchSuggestion:4,ContactManualLinking:5,BrowseInMailbox:6,BrowseInDirectory:7,RecipientCache:8,SeekInMailbox:9,ReloadInMailbox:10};_pc.m.registerEnum("_pc.m",!1);_pc.x=function(){};_pc.x.registerInterface("_pc.x");_pc.n=function(){};_pc.n.registerInterface("_pc.n");_pc.e=function(n,t,i,r){_pc.e.initializeBase(this);this.c=n;this.h=t;this.g=i;this.f=r};_pc.e.a=function(n){_a.b.a(n,"personaId");return new _pc.e(n,null,null,null)};_pc.e.b=function(n,t,i){_a.b.a(n,"personaId");return new _pc.e(n,t,null,i)};_pc.e.c=function(n){_a.b.a(n,"emailAddress");_a.b.d(_a.C.a(n.EmailAddress),"GetPersona should be called with valid emailAddress: "+n.EmailAddress);return new _pc.e(null,null,n,null)};_pc.e.prototype={c:null,g:null,h:null,b:null,d:8,e:!1,f:null,u:function(n){var i=new _gg.eU;if(this.c){var r=new _g.g(this.c.Id);r.ChangeKey=this.c.ChangeKey;i.PersonaId=r;$a(this.f)||(i.ParentFolderId=new _g.Q(this.f))}else i.EmailAddress=this.g;var u=new _gg.iZ(this.y());u.Body=i;var t=new _gg.vX(this.x);t.hasGALComponent=!_js.d.a(this.h);t.actionName=_js.d.c("{0}_{1}",this.e?"PersonaCard":"HoverCard",_bc.n.toString(this.d));t.explicitLogonUser=this.G;n.bZ(u,t,this.r,this.q)},cp:function(n){var t=_js.e.s(_a.a.cj,2,"GetPersona_ProcessResponseMessage");this.b=_pc.a.b(n.Persona,3);_js.e.e(t)}};_pc.h=function(n,t,i,r,u,f){_pc.h.initializeBase(this);_pc.h.b(n,t,i,r);this.b=n;this.f=i;this.e=t;this.c=r;this.i=u;this.k=f};_pc.h.b=function(n,t,i,r){if(!n&&(!i||_js.d.a(i.EmailAddress))&&_js.d.a(t))throw Error.argumentUndefined("itemId, emailAddress or adObjectId","At least one of the three - itemId, emailAddress or adObjectId have to be specified");_a.b.b(r,"range")};_pc.h.a=function(n){var t=null;$a(n.a())||n.r()||$a(n.a().ItemId)||_js.d.a(n.a().ItemId.Id)||(t=n.a().ItemId);t||(t=n.d());return t};_pc.h.prototype={f:null,b:null,e:null,c:null,n:null,l:null,m:null,j:null,g:0,i:0,h:null,k:!1,d:null,u:function(n){var i=new _g.T("Beginning");i.MaxEntriesReturned=this.c.b;i.Offset=this.c.a;if(this.k){var r=new _gg.uA(this.x);r.explicitLogonUser=this.G;var t;var u=(t=new _gg.iD,t.ItemId=this.b?new _g.g(this.b.Id):null,t.AdObjectId=this.e,t.EmailAddress=this.f,t.Paging=i,t.ResultSet=this.i,t.ParentFolderId=new _g.Q(this.d),t);n.bM(u,r,this.r,this.q)}else n.bL(this.b?new _g.g(this.b.Id):null,this.e,this.f,i,this.i,null,this.r,this.q)},cy:function(n,t,i){try{this.g=n.MembersCount;this.l=this.o(n.Members);this.n=this.o(n.Owners);this.m=n.Notes;this.j=n.Description;this.h=n.PersonaId}catch(r){i(r);return}t()},o:function(n){if(!n||!n.length)return[];for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=_pc.a.b(n[t],2);return i}};_pc.k=function(n){_pc.k.initializeBase(this,[n]);this.dR(3);n||(n=new _g.ef);this.d(n)};_pc.k.$$cctor=function(){_a.i.d(_pc.k,_g.ef,function(n){return new _pc.k(n)})};_pc.p=function(n,t,i,r,u,f,e){var o=80;var h=900;var s=834;this.e=n<o?o:n;this.e=this.e>h?h:this.e;this.c=t<o?o:t;this.c=this.c>s?s:this.c;this.f=i;this.g=r;this.a=u;this.d=f;this.b=e;if((_js.d.a(this.a)||_js.d.a(this.d)||_js.d.a(this.b))&&_g.a.a()&&_g.a.a().i()&&_g.a.a().c()&&_g.a.a().bh.PolicySettings&&_g.a.a().bh.PolicySettings.PlacesEnabled){this.a=_g.a.a().i().bh.StaticMapUrl;this.d=_g.a.a().i().bh.MapControlKey;this.b=_g.a.a().c().bh.UserCulture}};_pc.p.a=function(n,t,i,r){var u=new _pc.p(n,t,i,r);return u.j()};_pc.p.prototype={e:0,c:0,f:0,g:0,a:null,d:null,b:null,h:null,j:function(){!_js.d.a(this.h)||_js.d.a(this.a)||_js.d.a(this.d)||_js.d.a(this.b)||isNaN(this.f)||isNaN(this.g)||(this.h=this.i());return this.h},i:function(){return String.format(this.a+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",this.f,this.g,this.e,this.c,this.d,this.b)}};function PeopleCoreComponent(){}PeopleCoreComponent.$$cctor=function(){_a.r.a().a(PeopleCoreComponent)};PeopleCoreComponent.prototype={a:function(n,t,i){n.e(_pc.q).a().b(IUpdatePersonaActionFactory);n.e(_pc.t).a().b(ICreatePersonaResponseProcessorFactory);n.e(_pc.u).a().b(IDeletePersonaResponseProcessorFactory);n.e(_pc.v).a().b(IUpdatePersonaResponseProcessorFactory)},b:function(){return[]}};_pc.c=function(){_pc.c.initializeBase(this)};_pc.c.prototype={j:0,y:null,O:!1,V:function(n){this.apcl("SortGroupPriority",n)},P:function(n){this.j=n;this.ea("SortGroupPriority");return n},W:function(n){this.y=n;this.ea("BaseFolderId");return n},X:function(n){this.O=n;this.ea("IsReadOnly");return n},M:function(){return this.j===3?this.bh.DisplayName:null}};_pc.d=function(n,t,i,r,u){_pc.d.initializeBase(this);_a.b.j(t,"propertyUpdates");_a.b.a(i,"parentFolder");this.d=t;this.g=r;this.f=i;this.c=null;this.b=new _gg.qB(this.x);this.b.createPersonaUnderMyContactsFolder=u;if(n){this.b.personaId=new _g.g(n.Id);n.Id.startsWith("CLPID:")||(this.c=new _g.g(n.Id))}};_pc.d.prototype={d:null,g:null,e:8,c:null,f:null,b:null,u:function(n){this.b.actionName=_js.d.c("{0}_{1}","PersonaCard",_bc.n.toString(this.e));this.b.explicitLogonUser=this.G;var t=new _gg.hc(this.y());t.Body=new _gg.eq;this.h(t.Body,this.c);n.m(t,this.b,this.r,this.q)},cy:function(n,t,i){t()},h:function(n,t){n.PersonaId=t;n.PersonTypeString=this.g;n.PropertyUpdates=this.d;n.ParentFolderId=this.f}};_pc.l=function(n){this.d=n};_pc.l.prototype={d:null,c:function(){return this.d},b:function(n){var i=n;var t=i.PersonaId.Id;i.DisplayAsFavorite&&(t="*"+t);return t}};_pc.f=function(n,t,i,r){_pc.f.initializeBase(this);_a.b.j(t,"propertyUpdates");_a.b.a(n,"personaId");this.e=t;this.g=i;this.d=new _g.g(n.Id);this.c=r;this.b=new _gg.Gq(this.x);this.b.isOnlineOnlyCall=!1;this.b.personaId=this.d};_pc.f.prototype={e:null,g:null,f:8,d:null,b:null,c:null,cy:function(n,t,i){t()},u:function(n){this.b.actionName=_js.d.c("{0}_{1}","PersonaCard",_bc.n.toString(this.f));this.b.explicitLogonUser=this.G;var t=new _gg.mq(this.y());t.Body=new _gg.gk;this.h(t.Body,this.d,this.c);n.M(t,this.b,this.r,this.q)},h:function(n,t,i){n.PersonaId=t;n.PersonTypeString=this.g;n.PropertyUpdates=this.e;$a(this.c)||(n.ParentFolderId=new _g.Q(this.c))}};_pc.q=function(){};_pc.q.prototype={a:function(n,t,i,r){var u=new _pc.f(n,t,i,null);u.b.isOnlineOnlyCall=r;return u}};_pc.g=function(){_pc.g.initializeBase(this)};_pc.g.prototype={u:function(n){var i=new _gg.vV(this.x);var t=new _gg.iY;n.eR(t,i,this.r,this.q)},cy:function(n,t,i){_pc.g.a=n;t()}};_pc.w=function(){};_pc.w.registerInterface("_pc.w");var ILinkSummaryCardViewModelFactory=function(){};ILinkSummaryCardViewModelFactory.registerInterface("ILinkSummaryCardViewModelFactory");var IModernGroupMembershipPivotViewModelFactory=function(){};IModernGroupMembershipPivotViewModelFactory.registerInterface("IModernGroupMembershipPivotViewModelFactory");_pc.i=function(n,t,i){this.a=n;this.m=t;this.i=i};_pc.i.prototype={a:null,h:null,m:null,i:"",g:null,l:0,c:0,k:null,d:!1,q:function(n){this.a=n;this.f(null);return n},p:function(n){this.u(n);this.h=n;this.f(null);return n},b:function(){if($a(this.g)){this.d=!1;this.g=this.h&&this.h.length>0?this.o(this.h):this.o(this.m)}return this.g},f:function(n){this.d=!1;this.g=n;return n},e:function(){var t="";if(this.c===1)t=this.a.c();else{var n="";if($a(this.b()))t=this.i;else{if(_g.p.b(this.b()))n=_g.p.c(this.b());else if(_g.u.isInstanceOfType(this.b())){var i=this.b();switch(i.a()){case"PhonebookServices":case"Contact":n=this.c===2&&!_js.d.b(i.bh.Street)?i.bh.Street:i.e();break;case"LocationServices":n=this.c===2&&i.b().indexOf(this.a.c())===-1?null:i.e();break;default:n=i.e();break}}else _g.ed.a(this.b())?n=this.b().Number:String.isInstanceOfType(this.b())&&(n=this.b());this.c?this.c===2?t=this.n(n,!1):this.c===4?t=this.n(n,!0):this.c!==3||_js.d.a(this.k)||(t=String.format(this.k,n)):t=n}}_js.d.a(t)&&(t=" ");return t},r:function(n){if(!$a(this.a)){if(_pc.a.isInstanceOfType(this.a)){var t=this.a;switch(n){case 2:return t.du();case 3:return t.gJ();case 4:return t.l()?t.l().k():null;case 6:return t.D()?t.D().k():null;case 5:return t.x()?t.x().k():null;case 7:return t.y();case 8:return t.dd();case 9:return t.de();case 14:return t.ha();case 15:return t.hb();case 10:return t.gI();case 11:return t.I()?t.I().k():null;case 16:return t.hc();case 17:return t.dq()}}switch(n){case 0:return this.a.c();case 1:return this.a.a();case 12:return this.a.g();case 13:this.d=!0;return this.t()}}return null},j:function(n,t,i){return t===i?t:_js.d.c(n,t,i)},s:function(n,t,i){if(_g.u.isInstanceOfType(this.b())){var u=this.b();switch(u.a()){case"PhonebookServices":case"Contact":return this.j(_pecs.d.Z,this.a.c(),n);default:return n}}switch(this.l){case 11:return this.j(_pecs.d.Z,this.a.c(),n)}if(_g.p.b(this.b())){var r=this.b();return!r.RoutingType||r.RoutingType.toUpperCase()==="SMTP"?t.indexOf(n)>=0?t:this.j(i?_pecs.d.Z:_pecs.d.R,t,n):_js.d.c(_pecs.d.D,t,r.RoutingType,n)}return this.j(_pecs.d.W,t,n)},n:function(n,t){var i=this.a?this.a.c():"";if(_js.d.a(i)||_js.d.a(n))if(_js.d.a(i)){if(!_js.d.a(n))return n}else return i;else return this.s(n,i,t);return""},o:function(n){var u=null;this.l=0;if(n)for(var f=n.length,i=0;i<f;i++){var r=n[i];var t=this.r(r);if(!$a(t)&&(!String.isInstanceOfType(t)||!_js.d.b(t))){u=t;this.l=r;break}}return u},u:function(n){if(n&&n.length>10)throw Error.argument("BindingList",String.format("Binding List maximum length of {0} is exceeded",10));},t:function(){var n=this.a.S();switch(n){case 2:return _pecs.d.h;case 3:return _pecs.d.J;case 5:return _pecs.d.e;case 4:return _pecs.d.b;case 6:return _pecs.d.U;case 1:return _pecs.d.c;case 0:default:return""}}};_pc.r=function(n,t,i,r){_pc.r.initializeBase(this,[1,"VM.PersonCard.Open"]);this.a.a=n;this.a.loc=t;this.a.h=i;this.a.t=r};_pc.r.prototype={b:function(){var n=new _a.q;n.a("a",this.a.a).a("h",this.a.h).a("loc",this.a.loc).a("t",this.a.t);return n.toString()}};_pc.b=function(){};_pc.b.a=function(n,t,i){_pc.b.d(0,n,t,i)};_pc.b.h=function(n,t,i){_pc.b.d(1,n,t,i)};_pc.b.g=function(n,t,i){_pc.b.d(n,100,t,i)};_pc.b.d=function(n,t,i,r){if(_a.k.d()){var f=new _pc.r(n,t,i,r);var u=_a.d.b(_a.a.cj,"PeopleCard");u.j=f.b();_a.d.a(u)}};_pc.b.b=function(n,t,i,r,u,f){if(_a.k.d()){var o=new _pc.s(n,t,i,r,u,f);var e=_a.d.b(_a.a.cj,"RecipientCache");e.j=o.b();_a.d.a(e)}};_pc.b.c=function(n){if(_a.k.d()){var i=new _a.q;i.a("a",n);var t=_a.d.b(_a.a.p,"CommandBarContactLinking");t.j=i.toString();_a.d.a(t)}};_pc.b.e=function(n,t,i){if(_a.k.d()){var u=new _a.q;u.a("a",n).a("mc",t).a("pc",i);var r=_a.d.b(_a.a.p,"CommandBarPDL");r.j=u.toString();_a.d.a(r)}};_pc.b.j=function(n,t){var i=new _a.q;i.a("so",n).c("ss",t);return i.toString()};_pc.b.i=function(n,t){var i=new _a.q;i.a("po",n).c("fc",t);return i.toString()};_pc.b.f=function(n,t,i){if(!_js.d.b(i)){var r=_a.d.b(n,t);r.j=i;_a.d.a(r)}};_pc.s=function(n,t,i,r,u,f){_pc.s.initializeBase(this,[1,"VM.Recipient.Cache"]);this.a.A=n;this.a.QL=t;this.a.CRL=i;this.a.SI=$a(r)?-100:r;this.a.SRS=u;this.a.CT=f};_pc.s.prototype={b:function(){var n=new _a.q;n.a("a",this.a.A).a("ql",this.a.QL).a("crl",this.a.CRL).a("si",this.a.SI).a("srs",this.a.SRS).a("ct",this.a.CT);return n.toString()}};_pc.a=function(n,t,i){this.fI=Function.createDelegate(this,this.gQ);this.cV=this.dV;_pc.a.initializeBase(this,[!0,null,i]);this.dm=new _g.eS(n||new _g.cC);this.dm.B(this.fI);t&&this.cz();this.gN("LastCommaFirst")};_pc.a.m=function(){var n=_pc.a.i;if(!n){n={};n.PersonaId="PersonaId";n.PersonaTypeString="PersonaType";n.PersonaObjectStatusString="PersonaObjectStatus";n.CreationTimeString="CreationTime";n.IsFavorite="IsFavorite";n.EffectiveRights="PublicFolderEffectiveRights";n.DisplayName="DisplayName";n.FileAs="FileAs";n.FileAsId="FileAsId";n.DisplayNamePrefix="DisplayNamePrefix";n.GivenName="GivenName";n.DisplayNameFirstLast="DisplayNameFirstLast";n.DisplayNameFirstLastSortKey="DisplayNameFirstLastSortKey";n.DisplayNameFirstLastHeader="DisplayNameFirstLastHeader";n.DisplayNameLastFirst="DisplayNameLastFirst";n.DisplayNameLastFirstSortKey="DisplayNameLastFirstSortKey";n.DisplayNameLastFirstHeader="DisplayNameLastFirstHeader";n.MiddleName="MiddleName";n.Surname="Surname";n.Generation="Generation";n.Nickname="Nickname";n.Alias="Alias";n.YomiFirstName="YomiFirstName";n.YomiCompanyName="YomiCompanyName";n.YomiLastName="YomiLastName";n.Title="Title";n.Department="Department";n.CompanyName="CompanyName";n.CompanyNameSortKey="CompanyNameSortKey";n.Location="Location";n.EmailAddress="EmailAddress";n.EmailAddresses="EmailAddresses";n.PhoneNumber="PhoneNumber";n.ImAddress="ImAddress";n.HomeCity="HomeCity";n.HomeCitySortKey="HomeCitySortKey";n.WorkCity="WorkCity";n.WorkCitySortKey="WorkCitySortKey";n.RelevanceScore="RelevanceScore";n.AttributionsArray="Attributions";n.DisplayNamesArray="DisplayNames";n.FileAsesArray="FileAses";n.FileAsIdsArray="FileAsIds";n.DisplayNamePrefixesArray="DisplayNamePrefixes";n.GivenNamesArray="GivenNames";n.MiddleNamesArray="MiddleNames";n.SurnamesArray="Surnames";n.GenerationsArray="Generations";n.NicknamesArray="Nicknames";n.InitialsArray="Initials";n.YomiCompanyNamesArray="YomiCompanyNames";n.YomiFirstNamesArray="YomiFirstNames";n.YomiLastNamesArray="YomiLastNames";n.BusinessPhoneNumbersArray="BusinessPhoneNumbers";n.BusinessPhoneNumbers2Array="BusinessPhoneNumbers2";n.HomePhonesArray="HomePhones";n.HomePhones2Array="HomePhones2";n.MobilePhonesArray="MobilePhones";n.MobilePhones2Array="MobilePhones2";n.AssistantPhoneNumbersArray="AssistantPhoneNumbers";n.CallbackPhonesArray="CallbackPhones";n.CarPhonesArray="CarPhones";n.HomeFaxesArray="HomeFaxes";n.OrganizationMainPhonesArray="OrganizationMainPhones";n.OtherFaxesArray="OtherFaxes";n.OtherTelephonesArray="OtherTelephones";n.OtherPhones2Array="OtherPhones2";n.PagersArray="Pagers";n.RadioPhonesArray="RadioPhones";n.TelexNumbersArray="TelexNumbers";n.TTYTDDPhoneNumbersArray="TtyTddPhoneNumbers";n.WorkFaxesArray="WorkFaxes";n.Emails1Array="Emails1";n.Emails2Array="Emails2";n.Emails3Array="Emails3";n.BusinessHomePagesArray="BusinessHomePages";n.SchoolsArray="Schools";n.PersonalHomePagesArray="PersonalHomePages";n.OfficeLocationsArray="OfficeLocations";n.ImAddressesArray="ImAddresses";n.BusinessAddressesArray="BusinessAddresses";n.HomeAddressesArray="HomeAddresses";n.OtherAddressesArray="OtherAddresses";n.TitlesArray="Titles";n.DepartmentsArray="Departments";n.CompanyNamesArray="CompanyNames";n.ManagersArray="Managers";n.AssistantNamesArray="AssistantNames";n.ProfessionsArray="Professions";n.SpouseNamesArray="SpouseNames";n.ChildrenArray="Children";n.HobbiesArray="Hobbies";n.WeddingAnniversariesLocalArray="WeddingAnniversariesLocal";n.BirthdaysLocalArray="BirthdaysLocal";n.LocationsArray="Locations";n.ADObjectId="GALContactGuid";_pc.a.i=n}return _pc.a.i};_pc.a.b=function(n,t){_a.b.b(n,"personaServiceObject");var i=new _pc.a(null,!0,null);i.dW(n);i.dn(t);return i};_pc.a.h=function(){var n=new _pc.a(null,!0,null);n.di(_h.l.f());return n};_pc.a.e=function(n,t,i,r){var u=new _pc.a(n,i,r);u.gu(t);return u};_pc.a.n=function(n){if($a(n))throw Error.argumentNull("displayName");var t=_pc.a.h();t.dn(1);t.dj(1);t.cO(n);return t};_pc.a.l=function(n){if($a(n))throw Error.argumentNull("recipient");if($a(n.Mailbox))throw Error.argumentNull("recipient mailbox");var t=_h.l.a(n.Mailbox);t.dl();return _pc.a.c(t)};_pc.a.a=function(n){var t=_h.l.a(n);t.dl();return _pc.a.c(t)};_pc.a.c=function(n){if($a(n))throw Error.argumentNull("basePersona");if(_pc.a.isInstanceOfType(n))return n;var t=new _pc.a(null,!0,null);n.d()&&t.di(n.d());if(n.a()){t.cA(n.a());t.gz([t.a()]);t.bV(new(_bc.V.$$(_g.d)));t.j().h(n.a(),"0")}n.c()&&t.cO(n.c());if(n.g()){t.fD(n.g());t.ce(new(_bc.V.$$(String)));t.ba().h(t.g(),"0")}t.dj(n.b());t.o(n.S());t.dn(1);return t};_pc.a.j=function(n,t){if(_js.d.a(n))throw Error.argumentNull("displayName");if(_js.d.a(t))throw Error.argumentNull("imAddress");var i=new _pc.a(null,!0,null);i.cO(n);i.fD(t);i.ce(new(_bc.V.$$(String)));i.ba().h(i.g(),"0");i.dn(1);i.dj(1);return i};_pc.a.k=function(n,t){if($a(n))throw Error.argumentNull("displayName");if($a(t))throw Error.argumentNull("postalAddress");var i=_pc.a.h();i.dn(1);i.dj(4);i.cO(n);var r=new _bc.e;r.i("0");r.t(null);r.k("OWA");r.n(!0);r.r(!1);r.m(!1);r.q(null);i.cJ(new _js.f);i.e().a(r);switch(t.q()){case"Business":i.bO(new(_bc.V.$$(_g.u)));i.O().h(t,"0");break;case"Home":i.ca(new(_bc.V.$$(_g.u)));i.Q().h(t,"0");break;case"Other":default:i.ck(new(_bc.V.$$(_g.u)));i.R().h(t,"0");break}return i};_pc.a.f=function(n){var t="Contact";var f=null;var u=n.a();if(u){t=u.a();f=u.bh.LocationUri}if(t==="Contact"||t==="Resource"){var i=new _g.d;i.Name=n.bh.DisplayName;if(!_js.d.a(f)){i.MailboxType="Mailbox";i.EmailAddress=f}var e=_pc.a.a(i);e.fc(n.g());return e}else if(t==="LocationServices"||t==="PhonebookServices")return _pc.a.k(n.bh.DisplayName,n.g());var r;if(u)r=_pc.a.k(n.bh.DisplayName,n.g());else{r=_pc.a.n(n.bh.DisplayName);r.dj(0)}return r};_pc.a.o=function(n){return!$a(n)&&!_js.d.b(n.EmailAddress)?n.EmailAddress:null};_pc.a.g=function(n,t){if(!n||!t)return!1;if(!$a(n.a())&&!$a(n.a().EmailAddress)&&!$a(t.a())&&!$a(t.a().EmailAddress)&&n.a().EmailAddress.toLocaleLowerCase()===t.a().EmailAddress.toLocaleLowerCase())return!0;if(!$a(n.f())&&!$a(t.f()))for(var u=n.f().length,f=t.f().length,i=0;i<u;i++)for(var r=0;r<f;r++)if(!$a(n.f()[i].EmailAddress)&&!$a(t.f()[r].EmailAddress)&&n.f()[i].EmailAddress.toLowerCase()===t.f()[r].EmailAddress.toLowerCase())return!0;return!1};_pc.a.d=function(n,t){if(!n||!t)return n===t?!0:!1;if(_pc.a.isInstanceOfType(n)&&_pc.a.isInstanceOfType(t)&&n.h()!==1&&t.h()!==1){if(n.d()&&t.d()&&n.d().Id===t.d().Id)return!0}else if(_pc.a.g(n,t))return!0;return!1};_pc.a.prototype={fn:null,dw:null,dQ:null,dP:null,dX:null,ew:null,eP:null,dU:null,ez:null,et:null,eB:null,eU:null,eV:null,eW:null,dJ:null,dK:null,ep:null,er:null,ex:null,ey:null,dB:null,dL:null,en:null,eD:null,eF:null,eI:null,eH:null,eJ:null,eM:null,eQ:null,eS:null,eT:null,dR:null,dS:null,dT:null,dD:null,eN:null,eK:null,eC:null,es:null,dC:null,dZ:null,eE:null,eR:null,dO:null,dN:null,ev:null,dA:null,eL:null,eO:null,dM:null,dY:null,dy:null,dx:null,eu:null,fo:null,fU:!1,Y:function(){return this.b()!==4&&this.b()!==3&&this.b()!==1||!this.y()?!1:this.fp().e()},cD:function(){return this.dm.bh},h:function(){return this.gL()},dn:function(n){this.gP(n);return n},fm:function(){return this.dm.dg()},fM:function(){return this.dm.ck()},gO:function(n){this.dm.ck()!==n&&this.dm.cX(n);return n},gI:function(){return this.dm.bh.FileAs||null},gN:function(n){this.dm.bh.FileAs!==n&&this.dm.cU(n);return n},cB:function(){return this.dm.bh.GivenName||null},gr:function(){return this.dm.bh.DisplayNameFirstLastHeader||null},gs:function(){return this.dm.bh.DisplayNameLastFirstHeader||null},cC:function(){return this.dm.bh.MiddleName||null},bK:function(){return this.dm.bh.Surname||null},db:function(n){this.dm.bh.Surname!==n&&this.dm.db(n);return n},gG:function(){return this.dm.bh.Alias||null},dq:function(){return this.dm.bh.Title||null},fT:function(n){this.dm.bh.Title!==n&&this.dm.dc(n);return n},gH:function(){return this.dm.bh.Department||null},du:function(){return this.dm.bh.CompanyName||null},gJ:function(){return this.dm.bh.PhoneNumber||null},fL:function(){return this.dm.bh.HomeCity||null},fP:function(){return this.dm.bh.WorkCity||null},fN:function(){return this.dm.dh()},e:function(){if(!this.dw){if(!this.dm.bh.AttributionsArray&&this.dm.bD()){var n=this.dm.bD().f();this.dm.bh.AttributionsArray=n;this.dm.bD().H(this.dm.bh.AttributionsArray)}this.dm.bh.AttributionsArray&&(this.dw=new(_a.fK.$$(_bc.e,_g.cx))(this.dm.bh.AttributionsArray))}return this.dw?this.dw.e:null},cJ:function(n){if(n){for(var i=new Array(n.b()),t=0;t<n.b();++t)i[t]=n.c(t).x();this.dm.bh.AttributionsArray=i;this.dw&&this.dw.C(i)}else{this.dw=null;this.dm.bh.AttributionsArray=null}this.ea("Attributions");return n},X:function(){!this.dQ&&this.dm.bX()&&(this.dQ=new(_bc.V.$$(String))(this.dm.bX()));return this.dQ},bU:function(n){this.dQ&&(n?this.dQ.c(n.a):this.dQ=null);this.dm.dO(n?n.a:null);return n},bI:function(){!this.dP&&this.dm.bW()&&(this.dP=new(_bc.V.$$(String))(this.dm.bW()));return this.dP},cK:function(n){this.dP&&(n?this.dP.c(n.a):this.dP=null);this.dm.dN(n?n.a:null);return n},P:function(){!this.dX&&this.dm.cc()&&(this.dX=new(_bc.V.$$(String))(this.dm.cc()));return this.dX},bB:function(n){this.dX&&(n?this.dX.c(n.a):this.dX=null);this.dm.dY(n?n.a:null);return n},G:function(){!this.ew&&this.dm.cn()&&(this.ew=new(_bc.V.$$(String))(this.dm.cn()));return this.ew},bD:function(n){this.ew&&(n?this.ew.c(n.a):this.ew=null);this.dm.eC(n?n.a:null);return n},J:function(){!this.eP&&this.dm.cC()&&(this.eP=new(_bc.V.$$(String))(this.dm.cC()));return this.eP},bF:function(n){this.eP&&(n?this.eP.c(n.a):this.eP=null);this.dm.eY(n?n.a:null);return n},bp:function(){!this.dU&&this.dm.cb()&&(this.dU=new(_bc.V.$$(String))(this.dm.cb()));return this.dU},bY:function(n){this.dU&&(n?this.dU.c(n.a):this.dU=null);this.dm.dU(n?n.a:null);return n},bs:function(){!this.ez&&this.dm.cp()&&(this.ez=new(_bc.V.$$(String))(this.dm.cp()));return this.ez},ci:function(n){this.ez&&(n?this.ez.c(n.a):this.ez=null);this.dm.eF(n?n.a:null);return n},i:function(){!this.eB&&this.dm.bM()&&(this.eB=new(_bc.V.$$(_g.B))(this.dm.bM()));return this.eB},bm:function(n){this.eB&&(n?this.eB.c(n.a):this.eB=null);this.dm.dp(n?n.a:null);return n},cS:function(){!this.et&&this.dm.cj()&&(this.et=new(_bc.V.$$(String))(this.dm.cj()));return this.et},cZ:function(n){this.et&&(n?this.et.c(n.a):this.et=null);this.dm.ew(n?n.a:null);return n},K:function(){!this.eU&&this.dm.cK()&&(this.eU=new(_bc.V.$$(String))(this.dm.cK()));return this.eU},cw:function(n){this.eU&&(n?this.eU.c(n.a):this.eU=null);this.dm.fi(n?n.a:null);return n},bv:function(){!this.eV&&this.dm.cL()&&(this.eV=new(_bc.V.$$(String))(this.dm.cL()));return this.eV},cx:function(n){this.eV&&(n?this.eV.c(n.a):this.eV=null);this.dm.fj(n?n.a:null);return n},bw:function(){!this.eW&&this.dm.cM()&&(this.eW=new(_bc.V.$$(String))(this.dm.cM()));return this.eW},cy:function(n){this.eW&&(n?this.eW.c(n.a):this.eW=null);this.dm.fl(n?n.a:null);return n},l:function(){!this.dJ&&this.dm.bQ()&&(this.dJ=new(_bc.V.$$(_g.q))(this.dm.bQ()));return this.dJ},bQ:function(n){this.dJ&&(n?this.dJ.c(n.a):this.dJ=null);this.dm.du(n?n.a:null);return n},t:function(){$a(this.dK)&&!$a(this.dm.bP())&&(this.dK=new(_bc.V.$$(_g.q))(this.dm.bP()));return this.dK},bR:function(n){$a(this.dK)||(n?this.dK.c(n.a):this.dK=null);this.dm.ds(n?n.a:null);return n},D:function(){!this.ep&&this.dm.ch()&&(this.ep=new(_bc.V.$$(_g.q))(this.dm.ch()));return this.ep},cc:function(n){this.ep&&(n?this.ep.c(n.a):this.ep=null);this.dm.eu(n?n.a:null);return n},E:function(){$a(this.er)&&!$a(this.dm.cg())&&(this.er=new(_bc.V.$$(_g.q))(this.dm.cg()));return this.er},cd:function(n){$a(this.er)||(n?this.er.c(n.a):this.er=null);this.dm.et(n?n.a:null);return n},x:function(){!this.ex&&this.dm.co()&&(this.ex=new(_bc.V.$$(_g.q))(this.dm.co()));return this.ex},cg:function(n){this.ex&&(n?this.ex.c(n.a):this.ex=null);this.dm.eD(n?n.a:null);return n},H:function(){$a(this.ey)&&!$a(this.dm.bS())&&(this.ey=new(_bc.V.$$(_g.q))(this.dm.bS()));return this.ey},ch:function(n){$a(this.ey)||(n?this.ey.c(n.a):this.ey=null);this.dm.dw(n?n.a:null);return n},U:function(){!this.dB&&this.dm.bJ()&&(this.dB=new(_bc.V.$$(_g.q))(this.dm.bJ()));return this.dB},bM:function(n){this.dB&&(n?this.dB.c(n.a):this.dB=null);this.dm.dm(n?n.a:null);return n},W:function(){!this.dL&&this.dm.bR()&&(this.dL=new(_bc.V.$$(_g.q))(this.dm.bR()));return this.dL},bS:function(n){this.dL&&(n?this.dL.c(n.a):this.dL=null);this.dm.dv(n?n.a:null);return n},Z:function(){!this.en&&this.dm.cf()&&(this.en=new(_bc.V.$$(_g.q))(this.dm.cf()));return this.en},cb:function(n){this.en&&(n?this.en.c(n.a):this.en=null);this.dm.es(n?n.a:null);return n},bb:function(){!this.eD&&this.dm.cr()&&(this.eD=new(_bc.V.$$(_g.q))(this.dm.cr()));return this.eD},cj:function(n){this.eD&&(n?this.eD.c(n.a):this.eD=null);this.dm.eI(n?n.a:null);return n},bc:function(){!this.eF&&this.dm.ct()&&(this.eF=new(_bc.V.$$(_g.q))(this.dm.ct()));return this.eF},cl:function(n){this.eF&&(n?this.eF.c(n.a):this.eF=null);this.dm.eK(n?n.a:null);return n},bd:function(){!this.eI&&this.dm.cv()&&(this.eI=new(_bc.V.$$(_g.q))(this.dm.cv()));return this.eI},cm:function(n){this.eI&&(n?this.eI.c(n.a):this.eI=null);this.dm.eO(n?n.a:null);return n},cT:function(){$a(this.eH)&&!$a(this.dm.cu())&&(this.eH=new(_bc.V.$$(_g.q))(this.dm.cu()));return this.eH},da:function(n){$a(this.eH)||(n?this.eH.c(n.a):this.eH=null);this.dm.eN(n?n.a:null);return n},be:function(){!this.eJ&&this.dm.cw()&&(this.eJ=new(_bc.V.$$(_g.q))(this.dm.cw()));return this.eJ},cn:function(n){this.eJ&&(n?this.eJ.c(n.a):this.eJ=null);this.dm.eP(n?n.a:null);return n},bg:function(){!this.eM&&this.dm.cz()&&(this.eM=new(_bc.V.$$(_g.q))(this.dm.cz()));return this.eM},cq:function(n){this.eM&&(n?this.eM.c(n.a):this.eM=null);this.dm.eT(n?n.a:null);return n},bi:function(){!this.eQ&&this.dm.cD()&&(this.eQ=new(_bc.V.$$(_g.q))(this.dm.cD()));return this.eQ},cs:function(n){this.eQ&&(n?this.eQ.c(n.a):this.eQ=null);this.dm.eZ(n?n.a:null);return n},bj:function(){!this.eS&&this.dm.cG()&&(this.eS=new(_bc.V.$$(_g.q))(this.dm.cG()));return this.eS},ct:function(n){this.eS&&(n?this.eS.c(n.a):this.eS=null);this.dm.fb(n?n.a:null);return n},bk:function(){!this.eT&&this.dm.cJ()&&(this.eT=new(_bc.V.$$(_g.q))(this.dm.cJ()));return this.eT},cv:function(n){this.eT&&(n?this.eT.c(n.a):this.eT=null);this.dm.fg(n?n.a:null);return n},j:function(){$a(this.dR)&&!$a(this.dm.bY())&&(this.dR=new(_bc.V.$$(_g.d))(this.dm.bY()));return this.dR},bV:function(n){$a(this.dR)||(n?this.dR.c(n.a):this.dR=null);this.dm.dQ(n?n.a:null);return n},u:function(){$a(this.dS)&&!$a(this.dm.bZ())&&(this.dS=new(_bc.V.$$(_g.d))(this.dm.bZ()));return this.dS},bW:function(n){$a(this.dS)||(n?this.dS.c(n.a):this.dS=null);this.dm.dR(n?n.a:null);return n},v:function(){$a(this.dT)&&!$a(this.dm.ca())&&(this.dT=new(_bc.V.$$(_g.d))(this.dm.ca()));return this.dT},bX:function(n){$a(this.dT)||(n?this.dT.c(n.a):this.dT=null);this.dm.dS(n?n.a:null);return n},k:function(){!this.dD&&this.dm.bO()&&(this.dD=new(_bc.V.$$(String))(this.dm.bO()));return this.dD},bP:function(n){this.dD&&(n?this.dD.c(n.a):this.dD=null);this.dm.dr(n?n.a:null);return n},bJ:function(){!this.eN&&this.dm.cA()&&(this.eN=new(_bc.V.$$(String))(this.dm.cA()));return this.eN},cL:function(n){this.eN&&(n?this.eN.c(n.a):this.eN=null);this.dm.eV(n?n.a:null);return n},bf:function(){!this.eK&&this.dm.cx()&&(this.eK=new(_bc.V.$$(String))(this.dm.cx()));return this.eK},co:function(n){this.eK&&(n?this.eK.c(n.a):this.eK=null);this.dm.eQ(n?n.a:null);return n},I:function(){!this.eC&&this.dm.cq()&&(this.eC=new(_bc.V.$$(String))(this.dm.cq()));return this.eC},bE:function(n){this.eC&&(n?this.eC.c(n.a):this.eC=null);this.dm.eH(n?n.a:null);return n},ba:function(){!this.es&&this.dm.ci()&&(this.es=new(_bc.V.$$(String))(this.dm.ci()));return this.es},ce:function(n){this.es&&(n?this.es.c(n.a):this.es=null);this.dm.ev(n?n.a:null);return n},y:function(){this.fn||this.fq();return this.fn},fc:function(n){this.fn=n;this.ea("PostalAddress");return n},O:function(){!this.dC&&this.dm.bN()&&(this.dC=new(_bc.V.$$(_g.u))(this.dm.bN()));return this.dC},bO:function(n){this.dC&&(n?this.dC.c(n.a):this.dC=null);this.dm.dq(n?n.a:null);this.fq();return n},Q:function(){!this.dZ&&this.dm.ce()&&(this.dZ=new(_bc.V.$$(_g.u))(this.dm.ce()));return this.dZ},ca:function(n){this.dZ&&(n?this.dZ.c(n.a):this.dZ=null);this.dm.en(n?n.a:null);this.fq();return n},R:function(){!this.eE&&this.dm.cs()&&(this.eE=new(_bc.V.$$(_g.u))(this.dm.cs()));return this.eE},ck:function(n){this.eE&&(n?this.eE.c(n.a):this.eE=null);this.dm.eJ(n?n.a:null);this.fq();return n},m:function(){!this.eR&&this.dm.cF()&&(this.eR=new(_bc.V.$$(String))(this.dm.cF()));return this.eR},bn:function(n){this.eR&&(n?this.eR.c(n.a):this.eR=null);this.dm.fa(n?n.a:null);return n},C:function(){!this.dO&&this.dm.bV()&&(this.dO=new(_bc.V.$$(String))(this.dm.bV()));return this.dO},bA:function(n){this.dO&&(n?this.dO.c(n.a):this.dO=null);this.dm.dC(n?n.a:null);return n},q:function(){!this.dN&&this.dm.bU()&&(this.dN=new(_bc.V.$$(String))(this.dm.bU()));return this.dN},bz:function(n){this.dN&&(n?this.dN.c(n.a):this.dN=null);this.dm.dz(n?n.a:null);return n},F:function(){!this.ev&&this.dm.cm()&&(this.ev=new(_bc.V.$$(String))(this.dm.cm()));return this.ev},bC:function(n){this.ev&&(n?this.ev.c(n.a):this.ev=null);this.dm.ez(n?n.a:null);return n},A:function(){!this.dA&&this.dm.bI()&&(this.dA=new(_bc.V.$$(String))(this.dm.bI()));return this.dA},by:function(n){this.dA&&(n?this.dA.c(n.a):this.dA=null);this.dm.dl(n?n.a:null);return n},bt:function(){!this.eL&&this.dm.cy()&&(this.eL=new(_bc.V.$$(String))(this.dm.cy()));return this.eL},cp:function(n){this.eL&&(n?this.eL.c(n.a):this.eL=null);this.dm.eS(n?n.a:null);return n},bh:function(){!this.eO&&this.dm.cB()&&(this.eO=new(_bc.V.$$(String))(this.dm.cB()));return this.eO},cr:function(n){this.eO&&(n?this.eO.c(n.a):this.eO=null);this.dm.eW(n?n.a:null);return n},bo:function(){!this.dM&&this.dm.bT()&&(this.dM=new(_bc.V.$$(Array))(this.dm.bT()));return this.dM},bT:function(n){this.dM&&(n?this.dM.c(n.a):this.dM=null);this.dm.dx(n?n.a:null);return n},bq:function(){!this.dY&&this.dm.cd()&&(this.dY=new(_bc.V.$$(String))(this.dm.cd()));return this.dY},bZ:function(n){this.dY&&(n?this.dY.c(n.a):this.dY=null);this.dm.dZ(n?n.a:null);return n},bu:function(){this.dy||(this.dm.cI()?this.dy=new(_bc.V.$$(_a.c))(this.dm.cI()):this.dm.cH()&&(this.dy=new(_bc.V.$$(_a.c))(this.dm.cH())));return this.dy},cu:function(n){this.dy&&(n?this.dy.c(n.a):this.dy=null);this.dm.fd(n?n.a:null);return n},V:function(){this.dx||(this.dm.bL()?this.dx=new(_bc.V.$$(_a.c))(this.dm.bL()):this.dm.bK()&&(this.dx=new(_bc.V.$$(_a.c))(this.dm.bK())));return this.dx},bN:function(n){this.dx&&(n?this.dx.c(n.a):this.dx=null);this.dm.dn(n?n.a:null);return n},br:function(){!this.eu&&this.dm.cl()&&(this.eu=new(_bc.V.$$(String))(this.dm.cl()));return this.eu},cf:function(n){this.eu&&(n?this.eu.c(n.a):this.eu=null);this.dm.ey(n?n.a:null);return n},fO:function(){!this.fo&&this.dm.cE()&&(this.fo=new(_bc.V.$$(String))(this.dm.cE()));return this.fo},p:function(){return $a(this.d())?"":this.dm.bh.DisplayAsFavorite?"*"+this.d().Id:this.d().Id},dg:function(n){return _pc.a.d(this,n)},gS:function(n,t){_a.b.b(n,"personaServiceObject");this.dW(n);this.dn(t)},cY:function(n){for(var i="sip:"+n,t=0;t<this.ba().b();t++)if(i===this.ba().f(t))return i;return n},cU:function(){var n=new _g.hh;n.PersonaId=this.d();n.DisplayName=this.c()||this.g();n.SipUri=this.g();n.FirstName=this.cB();n.LastName=this.bK();n.EmailAddress=this.a();return n},gK:function(){return new _g.g(this.d().Id)},bL:function(){if(this.y()){var t=this.fp();if(t.e()){var n=new _js.f;n.a(t);return n}}return null},fp:function(){if(this.fR())switch(this.b()){case 1:case 3:return _g.w.f(this.c(),this.a(),this.y());case 4:return _g.w.g(this.c(),this.y())}return _g.w.a(this.c())},df:function(){var n=null;if(this.fU){if(this.e()&&this.e().b()>0&&this.e().c(0)&&this.e().c(0).c()){var t=this.e().c(0).c().Id;n=_h.l.c(n,"singleSourceId",t)}}else{n=_h.l.prototype.df.call(this);_js.d.a(this.M())||(n=_h.l.c(n,"adObjectId",this.M()))}return n},gR:function(n,t){this.dW(n);this.gu(t)},L:function(n){if($a(this.e())||!this.e().b())return null;for(var i=0;i<this.e().b();++i){var t=this.e().c(i);if(t&&t.a()===n)return t}return null},cF:function(){var i=new Array(0);if(!$a(this.e()))for(var n=0;n<this.e().b();++n){var t=this.e().c(n);t.e()||Array.add(i,t)}return i},bl:function(){var t=this.e();var r=[];if(t)for(var u=t.b(),n=0;n<u;n++){var i=t.c(n);i.f()&&Array.add(r,i)}return r},cG:function(){return this.cF().length},gM:function(){for(var i=0,n=0;n<this.e().b();++n){var t=this.e().c(n);t.e()||t.b()==="RecipientCache"||i++}return i},cX:function(n){if($a(this.e()))return!0;if(this.e().b()===1){var t=this.e().c(0);if(t&&("RecipientCache"===t.b()||_pecs.d.a===t.b()))return!0}return this.gF(n.b())},dc:function(n,t){if(!$a(n))for(var i=0;i<n.b();++i){var r=n.d(i);if(this.bH(r.b())){t.val=r;return!0}}t.val=null;return!1},cI:function(){if(!this.e())return!1;var t=this;var n=this.e().k(function(n){switch(n.b()){case"Facebook":case"LinkedIn":return!0;case"Outlook":case"GAL":return!1;default:return!1}});return n<this.e().b()},cR:function(){if(this.e())for(var n=0;n<this.e().b();n++)if(this.e().c(n).p())return!0;return!1},cE:function(){var n="";if(this.cH()){n=this.fS(this.j(),"GAL");n=_js.d.a(n)?this.fS(this.u(),"GAL"):n;n=_js.d.a(n)?this.fS(this.v(),"GAL"):n}return n},gt:function(){var t=null;if(this.e()&&this.e().b()>0){var i=this;var n=this.e().k(function(n){return n.b()==="GAL"});n<this.e().b()&&(t=this.e().c(n))}return t},cH:function(){return!!this.gt()},bx:function(){if($a(this.e()))return!1;for(var n=0;n<this.e().b();++n)if(this.e().c(n).b()!=="GAL"&&this.e().c(n).b()!=="RecipientCache")return!1;return!0},cW:function(){if(!$a(this.e()))for(var n=0;n<this.e().b();++n)if(this.e().c(n).b()!=="RecipientCache")return!1;return!0},fR:function(){switch(this.b()){case 1:case 3:return!$a(_pc.a.o(this.a()));case 4:return!$a(this.y());default:return!1}},bH:function(n){if($a(n))return!1;for(var r=n,u=r.length,t=0;t<u;++t){var f=r[t];var i=this.L(f);if(!$a(i)&&i.f())return!0}return!1},fQ:function(){if(!this.fR())throw Error.invalidOperation("Cannot get location URI for a persona that does not have a valid location identifier");switch(this.b()){case 1:return this.a().EmailAddress;case 4:return this.y().bh.LocationUri;default:throw Error.invalidOperation("Location URI is not available for this persona type");}},dW:function(n){this.dm.df(n);this.ea("PropertiesChanged")},dV:function(){return this.dm.bh},fh:function(){!_h.l.prototype.fh.call(this)&&this.dm&&this.dm.bh.PersonaId&&_h.l.prototype.fG.call(this,this.dm.bh.PersonaId);return _h.l.prototype.fh.call(this)},fG:function(n){if(_h.l.prototype.fh.call(this)!==n){var t=null;if(n){t=new _g.g(n.Id);t.ChangeKey=n.ChangeKey}_h.l.prototype.fG.call(this,n);this.dm.cY(t)}},ff:function(){!_h.l.prototype.ff.call(this)&&this.dm.bh.EmailAddress&&_h.l.prototype.fF.call(this,this.dm.bh.EmailAddress);return _h.l.prototype.ff.call(this)},fF:function(n){if(_h.l.prototype.ff.call(this)!==n){_h.l.prototype.fF.call(this,n);this.dm.cS(n)}},fg:function(){if(!_h.l.prototype.fg.call(this)&&this.dm.bx()){_h.l.prototype.fl.call(this,new Array(this.dm.bx().b()));for(var n=0;n<this.dm.bx().b();++n)_h.l.prototype.fg.call(this)[n]=this.dm.bx().a(n)}return _h.l.prototype.fg.call(this)},fl:function(n){if(n){for(var r=new(_a.fJ.$$(_g.d)),i=n,f=i.length,t=0;t<f;++t){var u=i[t];r.c(u)}_h.l.prototype.fl.call(this,n);this.dm.cT(r)}else{_h.l.prototype.fl.call(this,null);this.dm.cT(null)}},gc:function(){return this.dm.bh.DisplayName||null},gA:function(n){this.dm.bh.DisplayName!==n&&this.dm.cO(n)},eZ:function(){var n=this.dm.bh.DisplayNameFirstLast||null;_h.l.prototype.eZ.call(this)||_h.l.prototype.gj.call(this,n);return n},gj:function(n){if(this.dm.bh.DisplayNameFirstLast!==n){_h.l.prototype.gj.call(this,n);this.dm.cP(n)}},fx:function(){var n=this.dm.bh.DisplayNamePrefix||"";_h.l.prototype.fx.call(this)||_h.l.prototype.gk.call(this,n);return n},gk:function(n){if(this.dm.bh.DisplayNamePrefix!==n){_h.l.prototype.gk.call(this,n);this.dm.cR(n)}},fy:function(){var n=this.dm.bh.Generation||"";_h.l.prototype.fy.call(this)||_h.l.prototype.gl.call(this,n);return n},gl:function(n){if(this.dm.bh.Generation!==n){_h.l.prototype.gl.call(this,n);this.dm.cV(n)}},fa:function(){var n=this.dm.bh.DisplayNameLastFirst||"";_h.l.prototype.fa.call(this)||_h.l.prototype.fE.call(this,n);return n},fE:function(n){if(this.dm.bh.DisplayNameLastFirst!==n){_h.l.prototype.fE.call(this,n);this.dm.cQ(n)}},ge:function(){var n=this.dm.bh.YomiFirstName||"";_h.l.prototype.ge.call(this)||_h.l.prototype.gm.call(this,n);return n},gm:function(n){if(this.dm.bh.YomiFirstName!==n){_h.l.prototype.gm.call(this,n);this.dm.dd(n)}},gf:function(){var n=this.dm.bh.YomiLastName||"";_h.l.prototype.gf.call(this)||_h.l.prototype.gn.call(this,n);return n},gn:function(n){if(this.dm.bh.YomiLastName!==n){_h.l.prototype.gn.call(this,n);this.dm.de(n)}},gy:function(){return _js.d.b(this.dm.bh.PersonaTypeString)?0:_js.l.a(_bc.d,this.dm.bh.PersonaTypeString)},gC:function(n){this.dm.bh.PersonaTypeString!==_bc.d.toString(n)&&this.dm.da(_bc.d.toString(n))},gL:function(){if(_js.d.b(this.dm.bh.PersonaObjectStatusString))return 0;else{var n=_js.l.a(_bc.A,this.dm.bh.PersonaObjectStatusString);var t=$a(n)||!n;return n}},gP:function(n){this.dm.bh.PersonaObjectStatusString!==_bc.A.toString(n)&&this.dm.cZ(_bc.A.toString(n))},gd:function(){return this.dm&&this.dm.bh.ImAddress?this.dm.bh.ImAddress:null},gB:function(n){this.dm.bh.ImAddress!==n&&this.dm.cW(n)},gx:function(){return this.dm?this.dm.di():0},fr:function(n,t){var i=null;i=this.b()===4?this.gE(n,t):_h.l.prototype.fr.call(this,n,t);return i},ed:function(){this.dm.s(this.fI);_h.l.prototype.ed.call(this)},gQ:function(n,t){t in _pc.a.m()&&this.ea(_pc.a.m()[t])},fS:function(n,t){if(n)for(var r=0;r<n.b();r++)for(var f=n.d(r),u=f.b(),s=u.length,i=0;i<s;++i){var o=u[i];var e=this.L(o);if(e.b()===t)return f.a().EmailAddress}return""},fq:function(){this.Q()?this.fc(this.Q().k()):this.O()?this.fc(this.O().k()):this.R()?this.fc(this.R().k()):this.fc(null)},gE:function(n,t){return _pc.p.a(n,t,this.y().bh.Latitude,this.y().bh.Longitude)},gF:function(n){for(var r=n,f=r.length,t=0;t<f;++t){var i=r[t];if(i===_pecs.d.a)return!0;var u=this.L(i);if(!$a(u)&&!u.e())return!0}return!1},gu:function(n){n==="AllProperties"?this.dn(3):this.dn(2)}};_pc.CreatePersonaResponseProcessor=function(n,t){_pc.CreatePersonaResponseProcessor.initializeBase(this,[n,t,_pc.CreatePersonaResponseProcessor.a])};_pc.CreatePersonaResponseProcessor.prototype={g:function(){return this.a().personaId},h:function(n){_js.Trace.logInfo(_pc.CreatePersonaResponseProcessor.a,"Adding Correlation Client Id [{0}] to Server Id [{1}]",this.g().Id,n.Id);this.e.v(this.b,this.g(),n)}};_pc.j=function(n,t){_pc.j.initializeBase(this,[n,t,_pc.j.a])};_pc.j.prototype={p:function(){if(this.m()&&this.c.response.statusCode===200){if(!this.a()||!this.a().personaId||!this.a().personaId.Id){_js.Trace.logError(this.f,"Context or persona id is null.");return}this.d().t().a(this.b,this.a().personaId)}this.c.response.statusCode!==200}};_pc.o=function(n,t,i){_pc.o.$$(this.$$gta["_pc.o"].TContext).initializeBase(this,[n,t,i])};_pc.o.$$=function(n){var t="o"+"$"+n.getName().replace(/\./g,"_");if(!_pc[t]){var r=_pc[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_pc.o.apply(this,t)};var s=_h.dI.$$(n,_g.cC);r.registerClass("_pc."+t,s);var h={"_pc.o":{TContext:n}};var f=s.prototype.$$gta;for(var c in f){var o={key:c,value:f[c]};h[o.key]=o.value}r.prototype.$$gta=h;var u=_pc.o.prototype;for(var e in u){var i={key:e,value:u[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _pc[t]};_pc.o.prototype={p:function(){if(this.m()&&this.c.response.statusCode===200)if(this.g()&&this.g().Id&&this.j()&&this.j().PersonaId&&this.j().PersonaId.Id!==this.g().Id){var t=this.d().t();this.b.b().b(!1);var n=this;t.c(this.b,this.g(),function(i){if(i){i.PersonaId=n.j().PersonaId;t.b(n.b,i,0,null);t.a(n.b,n.g())}},null);this.h(this.j().PersonaId)}else _js.Trace.logWarning(this.f,"Either user context PersonaId or response was invalid")}};_pc.UpdatePersonaResponseProcessor=function(n,t){_pc.UpdatePersonaResponseProcessor.initializeBase(this,[n,t,_pc.UpdatePersonaResponseProcessor.a])};_pc.UpdatePersonaResponseProcessor.prototype={g:function(){return this.a().personaId},h:function(n){}};_pc.t=function(){};_pc.t.prototype={a:function(n,t,i){return new _pc.CreatePersonaResponseProcessor(n,t)}};_pc.u=function(){};_pc.u.prototype={a:function(n,t,i){return new _pc.j(n,t)}};_pc.v=function(){};_pc.v.prototype={a:function(n,t,i){return new _pc.UpdatePersonaResponseProcessor(n,t)}};_pc.y=function(n,t,i,r,u){this.Z=Function.createDelegate(this,this.bp);this.m=Function.createDelegate(this,this.bs);this.n=Function.createDelegate(this,this.by);this.v=Function.createDelegate(this,this.bd);this.z=Function.createDelegate(this,this.bo);_pc.y.initializeBase(this,[n]);this.w(u);this.p=t;this.b=i;this.i=r;this.t=new _C(this.z,_a.a.y);this.q=new _C(this.v,_a.a.y);this.a=this.b.a()==="TouchNarrow";this.H([])};_pc.y.prototype={c:null,k:null,p:null,b:null,a:!1,l:null,q:null,t:null,h:null,i:null,j:!1,r:function(){return this.a&&this.l?this.l:this},f:function(n){var t=this.E();t&&this.a&&this.u()},g:function(){this.a&&this.bb()},d:function(n){this.a&&this.o("scaleUpIn")},e:function(){},u:function(){var n=_js.e.s(_a.a.p,2,"ReadCardViewBase-HidePersonaCard");this.r().M(!0);_js.e.e(n);_js.Trace.logInfo(_a.a.y,"ReadCardViewBase::HidePersonaCard - Layout: {0}",this.b.a())},o:function(n){if(this.a)this.bh(n);else{this.u();this.bh(n)}},bb:function(){this.h&&this.h.b(!1)},bx:function(){var n=this.E();if(n){n.O();n.a()&&n.a().b()===1&&n.N(this.n);this.j=this.b.a()==="Mouse"&&!!n.c()&&n.c().bg()&&n.h().a!==6;this.j&&this.bc("mouseleave",this.jw,"ReadPersonaCardView")}},bm:function(){var n=this.E();if(n){n.bu();n.a()&&n.a().b()===1&&n.bt(this.n);this.j&&this.bj("mouseleave","ReadPersonaCardView")}},bl:function(){this.bm();_js.b.prototype.bl.call(this)},bq:function(){this.bm();_js.I.prototype.bq.call(this)},Q:function(){_js.c.prototype.Q.call(this);this.bx()},bB:function(){if(this.a)return _js.c.prototype.bB.call(this);var i=new _fc.g;var t=new _fc.c;t.k=this.q;t.i("ESC");t.l=!1;var n=new _fc.c;n.k=this.t;n.i("D");n.j=1;i.a([t,n]);return[i]},J:function(){_js.b.prototype.J.call(this);this.bg();this.i.apcl("Orientation",this.m)},cY:function(n){var t=this.E();if(t){if(t.d().c()&&t.d().c().i)return;this.bd()}},O:function(){_js.b.prototype.O.call(this);this.i.rpcl("Orientation",this.m)},K:function(){_js.b.prototype.K.call(this);if(this.F){this.l=this.F.a("PersonaCardContainer");this.bH();this.c=this.F.a("scrollRegionIdOrganization");this.bI();this.k=this.F.a("itemManager")}},bd:function(){var n=this.E();n&&n.m().a()},bo:function(){var t=this.E();if(t&&t.c()){var n=t.c().c().g();n&&n.b&&n.a()}},bp:function(){_js.Trace.logInfo(_a.a.y,"ReadCardViewBase::OnAnimationFinished - Layout: {0}",this.b.a());this.bC()},bh:function(n){this.bb();var t=_js.e.s(_a.a.p,2,"ReadCardViewBase-MakePersonaCardVisible");this.r().M(!1);_js.e.e(t);this.h=this.p.a(n,this.r().x,this.Z,!1);this.h.a();_js.Trace.logInfo(_a.a.y,"ReadCardViewBase::InternalAnimatePersonaCard - Layout: {0}",this.b.a())},bg:function(){var n=this.E();if(n&&n.C()){this.U().c(0);this.U().o(_pecs.d.f);this.U().a(48)}},bC:function(){var n=this.E();if(n&&n.C()){this.bg();var t=this;_js.g.a().a(_a.a.y,"SetFocusOnHoverCard",function(){t.x.focus()},0)}},bs:function(n,t){this.bk("IsCardOrientationPortrait")},bH:function(){var t=this.F.a("personaCardPart");if(t){var n=this.E();if(n&&n.h().a===10){var i=_js.q.getInstance().E&&!_a.UserAgent.getInstance().K;t.y.addClass(i?"ie8":"notIE8")}}},bI:function(){if(this.c){var n=this.E();if(n&&n.h().a===10){var t=_js.q.getInstance().E&&!_a.UserAgent.getInstance().K;this.c.y.addClass(t?"ie8":"notIE8")}}},by:function(){if(this.c&&this.k){this.c.d(0);this.c.v(this.k.x)}}};_pc.e.registerClass("_pc.e",_h.dj.$$(_gg.ja,_gg.je));_pc.h.registerClass("_pc.h",_h.dX.$$(_gg.uB));_pc.k.registerClass("_pc.k",_g.h);PeopleCoreComponent.registerClass("PeopleCoreComponent",null,_a.ih);_pc.c.registerClass("_pc.c",_g.l);_pc.d.registerClass("_pc.d",_h.dX.$$(_g.cC));_pc.l.registerClass("_pc.l");_pc.f.registerClass("_pc.f",_h.dX.$$(_g.cC));_pc.q.registerClass("_pc.q",null,IUpdatePersonaActionFactory);_pc.g.registerClass("_pc.g",_h.dX.$$(_gg.vW));_pc.i.registerClass("_pc.i");_pc.r.registerClass("_pc.r",_a.bm);_pc.s.registerClass("_pc.s",_a.bm);_pc.a.registerClass("_pc.a",_h.l,_a.dW,_bc.bP,_bc.z,_js.z);_pc.CreatePersonaResponseProcessor.registerClass("_pc.CreatePersonaResponseProcessor",_pc.o.$$(_gg.qB));_pc.j.registerClass("_pc.j",_h.dI.$$(_gg.rd,_pc.a));_pc.UpdatePersonaResponseProcessor.registerClass("_pc.UpdatePersonaResponseProcessor",_pc.o.$$(_gg.Gq));_pc.t.registerClass("_pc.t",null,ICreatePersonaResponseProcessorFactory,_h.fk);_pc.u.registerClass("_pc.u",null,IDeletePersonaResponseProcessorFactory,_h.fk);_pc.v.registerClass("_pc.v",null,IUpdatePersonaResponseProcessorFactory,_h.fk);_pc.y.registerClass("_pc.y",_js.b,_ff.n);_pc.k.$$cctor();PeopleCoreComponent.$$cctor();_pc.g.a=null;_pc.a.i=null;_pc.CreatePersonaResponseProcessor.a=_a.a.dL;_pc.j.a=_a.a.dR;_pc.UpdatePersonaResponseProcessor.a=_a.a.fh;
window.scriptsLoaded['microsoft.owa.people.core.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.people.core.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
