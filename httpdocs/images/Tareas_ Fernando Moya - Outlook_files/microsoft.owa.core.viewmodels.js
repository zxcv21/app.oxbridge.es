try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_d");_d.be=function(){};_d.be.prototype={sendStarted:0,sendSucceeded:1,sendFailed:2,sendResumedOnNewSendFailure:3,sendResumedOnFailedResume:4,sendResumeSucceeded:5,browserClosing:6,quickComposeReSendTrigerred:7,quickComposeSendFailed:8};_d.be.registerEnum("_d.be",!1);_d.a=function(){};_d.a.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.a.registerEnum("_d.a",!1);_d.bU=function(){};_d.bU.registerInterface("_d.bU");_d.bW=function(){};_d.bW.prototype={FifteenMinutesBeforeStart:-15,TenMinutesBeforeStart:-10,FiveMinutesBeforeStart:-5,ZeroMinutesBeforeStart:0,FiveMinutes:5,TenMinutes:10,FifteenMinutes:15,ThirtyMinutes:30,OneHour:60,TwoHours:120,FourHours:240,EightHours:480,halfDay:720,OneDay:1440,TwoDays:2880,ThreeDays:4320,FourDays:5760,OneWeek:10080,TwoWeeks:20160};_d.bW.registerEnum("_d.bW",!1);var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.bV=function(){};_d.bV.prototype={ToRecipient:0,CcRecipient:1,BccRecipient:2};_d.bV.registerEnum("_d.bV",!1);_d.bT=function(){};_d.bT.prototype={Minutes:0,Hours:1,Days:2,Weeks:3};_d.bT.registerEnum("_d.bT",!1);_d.bi=function(){};_d.bi.registerInterface("_d.bi");_d.A=function(){};_d.A.c=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_d.A.a=function(){return _fm.b.a(_fm.a.c,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.A.b=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_d.A.d=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_d.A.e=function(){return _fm.b.a(_fm.a.n,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};function CoreViewModelsComponent(){}CoreViewModelsComponent.$$cctor=function(){_a.r.a().a(CoreViewModelsComponent)};CoreViewModelsComponent.prototype={a:function(n,t,i){var tt=this;n.b(_d.Y,function(){return new _d.Y(n.a(_d.X),n.a(_ff.c),n.a(_a.w),n.a(_h.bc),n.a(_a.e),n.a(_g.a),n.a(_a.f))}).a();var it=this;n.b(_d.bd,function(){return new _d.bd(n.a(_y.a),n.a(_bc.a),n.a(_a.s),n.a(IMailComposeContextFactory),n.a(_a.e))}).b(IApprovalRequestHeaderViewModelFactory).a();var rt=this;n.b(_d.bu,function(){return new _d.bu(n.a(_a.w),n.a(IAttachmentDownloadUrlFactory))}).b(IUMMessagePostHeaderViewModelFactory).a();var nt=this;n.b(_d.bm,function(){return new _d.bm(n.a(_a.s),n.a(_pcf.a),n.c(IModernGroupsProvider))}).b(IModernGroupMembershipRequestHeaderViewModelFactory).a();var k=this;n.b(_d.X,function(){return new _d.X(n.a(_y.a))}).a();var d=this;n.b(IUnsupportedItemReadingPaneViewModel,function(){return new _d.m(n.a(_y.c),n.a(_a.f))});var g=this;n.b(_d.c,function(){return new _d.c(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),n.a(_a.f),n.d(IAttachmentsFilePickerPanelViewModel))}).b(_y.cV);var st=this;n.b(_d.br,function(){return new _d.br(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),n.a(_a.f),n.d(IAttachmentsFilePickerPanelViewModel))}).b(ITaskReadingPaneViewModelFactory).a();var ht=this;n.b(_d.M,function(){return new _d.M(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),n.a(_a.f),n.d(IAttachmentsFilePickerPanelViewModel))}).b(ITaskReadingPaneViewModelPopOutFactory);var ct=this;n.b(_d.x,function(){return new _d.x(n.a(_y.a),n.a(_pe.e),n.a(_a.f),n.a(ICompositePersonaViewModelFactory))}).b(IPeopleSearchSuggestionAdaptorViewModel);var ot=this;n.b(_d.bz,function(){return new _d.bz(n.a(IInferenceTracker))}).b(IUploadPhotoViewModelFactory).a();var ut=this;n.b(_d.bv,function(){return new _d.bv}).b(IUserOofNotificationProvider).a();if(i.a()==="Mouse"){var ft=this;n.b(_d.bq,function(){return new _d.bq(n.a(_ff.c),n.a(_js.k),n.a(_y.a))}).b(ISendNotificationProviderViewModel).a();var et=this;n.b(_d.bp,function(){return new _d.bp(n.a(_ff.c),n.a(_js.k),n.a(_y.a),n.a(IMailComposeViewModelFactory))}).b(ISendFailureNotificationProviderViewModel).a()}var b=this;n.b(_d.bn,function(){return new _d.bn(n.a(_cm.n),n.a(_ff.a),n.a(_a.z))}).b(IOwaOptionPeoplePickerViewModelFactory);n.e(_a.dM).a();var o=this;n.b(IDumpsterPopOutViewModelFactory,function(){return new _d.bB(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.a(_h.o),n.a(IInferenceTracker),n.d(IMailErrorHandler),n.a(_y.r))}).a();var s=this;n.b(_d.bh,function(){var t=n.a(_g.bd);return new _d.bh(t.bh.HelpUrl,t.bh.IsBposUser,n.a(_a.Y),n.a(_d.U),n.a(_y.q),i.a(),n.a(_y.a),n.a(_y.L))}).b(IModuleHelpProvider).a();var h=this;n.b(_d.U,function(){return new _d.U(n.a(_h.bc),n.a(_y.a),n.a(_g.a).bh.PolicySettings.AllowOfflineOn,n.a(_ff.c))}).b(IOfflineHelpProvider).a();var e=this;n.b(_d.bj,function(){return new _d.bj(n.a(_y.a),n.a(_d.J),n.a(_a.z),i.a()==="TouchNarrow"?n.a(_y.bW):null)}).b(ILinkSummaryCardViewModelFactory).a();var r=this,u=this;n.b(_d.J,function(){return new _d.J(n.a(_y.a),n.a(_a.z),i.a()==="TouchNarrow"?n.a(_y.bW):null)}).b(_d.J).a().c(function(t){t.c=n.a(_pcf.a)});var f=this;n.b(IFlowHomeScreenViewModelFactory,function(){return new _d.bC(n.a(_a.s),n.a(IBasePersonaViewModelFactory))}).a();var y=this;n.b(_d.P,function(){return new _d.P(n.a(_a.s))}).a();var p=this;n.b(_d.S,function(){return new _d.S(n.a(_fp.d),n.a(_a.s))}).b(IExtendedSharedFolderViewModel);var w=this;n.b(_d.V,function(){return new _d.V(n.a(_ff.c),n.a(_fp.d))}).b(IOpenAnotherMailboxViewModel);var v=this;n.b(_d.j,function(){return new _d.j(n.a(_fp.d),n.a(_a.s))}).b(IMailFolderPermissionsDialogViewModel);var c=this;n.b(_d.bk,function(){return new _d.bk(n.a(_ff.c))}).b(IMailErrorHandler).a();var l=this;n.b(_d.t,function(){return new _d.t(n.a(_ff.c),n.a(_js.k),n.a(_y.a))}).b(IFolderPickerContainer);var a=this;n.b(_d.bc,function(){return new _d.bc(n.d(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_y.dF,1,13),new _a.B(_d.Y,2,9),new _a.B(_a.bl,2,1),new _a.B(_y.ep,2,9),new _a.B(_d.P,2,9),new _a.B(_d.bc,1,1)]}};_d.bg=function(n,t){_d.bg.initializeBase(this);_a.b.b(n,"personaViewModelFactory");_a.b.b(t,"flowConversationItem");this.b=n;this.a=t};_d.bg.prototype={b:null,a:null,c:function(){for(var t="",n=0;n<this.a.Participants.length;n++)t+=this.a.Participants[n].Name+"; ";return t},d:function(){return _a.c.b(this.a.ReceivedTimeUtc)},f:function(){return this.a.UnReadCount>0?_js.d.c("({0})",this.a.UnReadCount):""},e:function(){var n=new _g.d;n.EmailAddress=this.a.SenderPhotoEmailAddress;n.MailboxType="Mailbox";return this.b.a(_h.l.a(n),2,!1,4)}};_d.T=function(n,t){this.c=Function.createDelegate(this,this.d);_d.T.initializeBase(this);this.b=t;this.a=new _js.f;var i=new _c.bm(_g.r.a(_g.r.d("inbox")),20);i.w(this.c);n.a(i)};_d.T.prototype={b:null,a:null,d:function(n){var i=n;var r=new _ff.d;if(i.b)for(var t=0;t<i.b.length;t++)r.c(new _d.bg(this.b,i.b[t]));this.a.n(r.h())}};_d.bC=function(n,t){_a.b.b(n,"actionSubmitter");_a.b.b(t,"personaViewModelFactory");this.b=n;this.c=t};_d.bC.prototype={b:null,c:null,a:function(){return new _d.T(this.b,this.c)}};_d.bm=function(n,t,i){this.b=n;this.d=t;this.c=i};_d.bm.prototype={b:null,d:null,c:null,a:function(n){return new _d.K(n,this.b,this.d.c(new _bc.o,1,null),this.c)}};_d.bA=function(n,t,i){_d.bA.initializeBase(this,[1,"AsyncSendDatapoint"]);this.a.ET=_d.be.toString(n);this.a.SC=t.toString();this.a.FC=i.toString()};_d.g=function(){};_d.g.i=function(n){_d.g.a(0,n,-1)};_d.g.c=function(n){_d.g.a(2,-1,n)};_d.g.d=function(n){_d.g.a(8,-1,n)};_d.g.j=function(n){_d.g.a(1,n,-1)};_d.g.g=function(n){_d.g.a(3,-1,n)};_d.g.f=function(n){_d.g.a(4,-1,n)};_d.g.h=function(n){_d.g.a(5,-1,n)};_d.g.e=function(n){_d.g.a(7,-1,n)};_d.g.b=function(n){_d.g.a(6,-1,n)};_d.g.a=function(n,t,i){var r=new _d.bA(n,t,i);_a.k.c.b()&&_a.k.c.a(r)};_d.bp=function(n,t,i,r){this.f=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.C);this.u=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.z);this.w=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.D);n.b(ISendFailedEvent,this.v);n.b(_y.ex,this.w);n.b(IQuickComposeSendFailedEvent,this.t);n.b(IQuickComposeSendFailureRemoveEvent,this.u);this.s=t;this.e=i;this.d=n;this.q=r};_d.bp.prototype={s:null,e:null,d:null,j:null,n:null,b:0,c:0,h:!1,m:!1,l:!1,q:null,i:null,a:function(){return this.b},x:function(n){if(this.b===n)return n;var t=!this.b;var i=this.b<n;this.b=n;!this.b!==t&&(this.c||(this.b?this.e.k(this.f):this.e.n(this.f)));i?!this.b!==t?this.d.a(ISendFailedO365Event,new _mcp.G(!0,this.p,!0,this.i)):this.d.a(ISendFailedO365Event,new _mcp.G(!1,this.p,!0,this.i)):!this.b!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.bc(!0));return n},r:function(n){if(this.c===n)return n;var t=!this.c;var i=this.c<n;this.c=n;!this.c!==t&&(this.b||(this.c?this.e.k(this.f):this.e.n(this.f)));i?!this.c!==t?this.d.a(ISendFailedO365Event,new _mcp.G(!0,this.o,!1,"")):this.d.a(ISendFailedO365Event,new _mcp.G(!1,this.o,!1,"")):!this.c!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.bc(!1));return n},k:function(){this.j||(this.j={});return this.j},g:function(){this.n||(this.n={});return this.n},D:function(n){_d.g.c(this.b);var t=n.a().a();this.i=t.v();this.k()[t.b()]=n.a();this.x(this.b+1);this.h=!1},C:function(){this.h?_d.g.f(this.b):_d.g.g(this.b);if(this.m){_js.Trace.logInfo(_a.a.a,"skipping resuming messages failed to send since another resume is currently in progress");return}this.m=!0;try{_js.Trace.logInfo(_a.a.a,"resuming messages failed to send per user request");var i=this.k();for(var r in i){var u={key:r,value:i[r]};var t=u.value.a();t.dE(!0);var n=this.q.a(t,null,null);n.k(!1);n.q(!1);this.e.f(n,0,!0)}}finally{this.h=!0;this.m=!1}},E:function(n){_d.g.h(this.b);var t=this.k()[n.a];var i=this;this.s.f(_a.a.a,"Clean up on SendFailure failed",function(){t.r(!0);t.j()});delete this.k()[n.a];this.x(this.b-1);this.h=!1},z:function(n){_d.g.d(this.c);var t=n.a();this.g()[t.e()]=t;this.r(this.c+1)},B:function(){_js.Trace.logInfo(_a.a.q,"resend failed message for quick compose via global header");if(this.l){_js.Trace.logInfo(_a.a.q,"skipping resending messages failed to send since another resend is currently in progress");return}this.l=!0;try{var i=this.g();for(var t in i){var r={key:t,value:i[t]};_d.g.e(this.c);var n=r.value;n.a().d();delete this.g()[n.e()];this.r(this.c-1)}}finally{this.l=!1}},A:function(n){var t=n.a();if(t.e()in this.g()){delete this.g()[t.e()];this.r(this.c-1)}},y:function(n){_d.g.b(this.b);n.a(_nbs.a.mD)}};_d.bq=function(n,t,i){this.d=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);n.b(ISendEvent,this.f);n.b(ISendSucceededEvent,this.h);n.b(ISendFailedEvent,this.g);this.e=t;this.c=i};_d.bq.prototype={e:null,c:null,b:0,a:function(){return this.b},k:function(n){_d.g.i(this.b);this.b++;this.b===1&&this.c.k(this.d)},m:function(n){_d.g.j(this.b);var t=this;this.e.f(_a.a.a,"Clean up on send succeeded",function(){n.a().j()});this.i()},l:function(n){this.i()},i:function(){this.b--;this.b||this.c.n(this.d)},j:function(n){n.a(_nbs.a.Sw)}};_d.bv=function(){this.h=Function.createDelegate(this,this.o);this.g=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.m);this.d=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.l);_d.bv.initializeBase(this);this.c=new _c.z;this.j=new _C(this.e,_a.a.x);this.i=new _C(this.d,_a.a.x);_js.g.a().c(_a.a.x,"UserOofNotificationProvider::ctor",this.f)};_d.bv.prototype={c:null,j:null,i:null,m:function(){var n=new _c.bq(this.c);n.w(this.g);OwaApplication.a.a(n)},n:function(n){this.c.a()},b:function(n){this.c=n;!this.c.a()},a:function(){return new _c.z},l:function(){},k:function(){this.c.b(!1);var n=new _c.bx(this.c);n.v(this.h);OwaApplication.a.a(n)},o:function(n){_a.F.a(_nbs.a.Mw,0)}};_d.I=function(){};_d.I.c=function(n){for(var r=[],t=0;t<n.b();++t){var i={};i.DisplayName=n.c(t).bh.Mailbox.Name;i.SmtpAddress=n.c(t).bh.Mailbox.EmailAddress;i.RoutingType=n.c(t).bh.Mailbox.RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.I.a=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.f;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _g.t;var i=new _g.d;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.g(i);t.a(u)});return t};_d.I.d=function(n){for(var r=[],t=0;t<n.y.length;++t){var i={};i.DisplayName=n.y[t].a().c();i.SmtpAddress=n.y[t].a().a().EmailAddress;i.RoutingType=n.y[t].a().a().RoutingType;i.GALContactGuid=n.y[t].a().M();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.I.b=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.f;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.d;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.a(i)});return t};_d.h=function(n,t,i){this.o=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.w);_d.h.initializeBase(this,[_d.h.f(),_d.h.h(),_d.h.i(),_d.h.g(t,i),n,null,t,i]);this.h=_d.h.c("AllowMultipleSelection");this.i=new _C(this.n,_a.a.b);this.j=new _C(this.o,_a.a.b);var r=this.y();this.z(_y.k.a(null,r,null));this.d.M(!1);this.G()};_d.h.d=function(){var n=_d.h.a;if(!n){n={};n[_d.a.toString(0)]=_nbs.a.Qh;n[_d.a.toString(1)]=_nbs.a.t;n[_d.a.toString(2)]=_nbs.a.t;n[_d.a.toString(3)]=_nbs.a.Qh;n[_d.a.toString(4)]=_nbs.a.fn;n[_d.a.toString(6)]=_nbs.a.IO;n[_d.a.toString(5)]=_nbs.a.NS;n[_d.a.toString(7)]=_nbs.a.y;n[_d.a.toString(8)]=_nbs.a.MR;n[_d.a.toString(9)]=_nbs.a.jS;n[_d.a.toString(10)]=_nbs.a.jS;n[_d.a.toString(11)]=_nbs.a.jS;_d.h.a=n}return _d.h.a};_d.h.e=function(){var n=_d.h.b;if(!n){n={};n[_d.a.toString(0)]=_nbs.a.PX;n[_d.a.toString(1)]=_nbs.a.WB;n[_d.a.toString(2)]=_nbs.a.WB;n[_d.a.toString(3)]=_nbs.a.PX;n[_d.a.toString(4)]=_nbs.a.Et;n[_d.a.toString(6)]=_nbs.a.kG;n[_d.a.toString(5)]=_nbs.a.ht;n[_d.a.toString(7)]=_nbs.a.CY;n[_d.a.toString(8)]=_nbs.a.Nh;n[_d.a.toString(9)]=_nbs.a.HL;n[_d.a.toString(10)]=_nbs.a.HL;n[_d.a.toString(11)]=_nbs.a.HL;_d.h.b=n}return _d.h.b};_d.h.f=function(){var n=window.dialogArguments;return _d.I.a(n)};_d.h.c=function(n){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);return t[n]};_d.h.h=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.h.d()[_d.a.toString(n)]};_d.h.i=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.h.e()[_d.a.toString(n)]};_d.h.g=function(n,t){var r=window.dialogArguments;var f=JsonParser.deserialize(r.Metadata);var u=f.PickerCallerType;var i=null;switch(u){case 4:case 6:case 5:case 7:case 8:case 10:case 11:i=_fp.a.x;break;case 0:case 1:case 2:case 3:case 9:default:i=_fp.a.g;break}return new _fp.b(i,_fp.a.a(),n,t,_d.h.c("AllowAddAsSmtpAddress"),null,!1,null,null,null,null,null,0,null,null,0,0,null)};_d.h.prototype={i:null,j:null,d:null,h:!1,z:function(n){if(this.d!==n){this.d=n;this.ea("ApplicationBarViewModel")}return n},q:function(n){return this.h?!0:n.b()>=1?!1:!0},v:function(n){n.k(1,new Array(0),n.bA.a().EmailAddress)},r:function(n){return this.g.e(_pe.c.a,n)},w:function(){var n=window.dialogArguments;n.Properties=_d.I.c(this.a);window.close()},x:function(){window.close()},y:function(){var n=new Array(2);n[0]=new _y.f(_y.b.i(),_y.b.j(),_u.W.i,this.i);n[1]=_y.f.a(_u.R.aL,this.j);return n}};_d.bn=function(n,t,i){this.e=n;this.d=t;this.c=i};_d.bn.prototype={e:null,d:null,c:null,b:function(n,t,i){return new _d.h(this.e,this.d,this.c)},a:function(n,t,i){return new _d.h(this.e,this.d,this.c)}};_d.s=function(n){this.h=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.l);_d.s.initializeBase(this);this.d=n;var t=this;this.f=new _C(this.i,_a.a.F,this,"Persona",function(){return!!t.a})};_d.s.a=function(n){return n.b()!==5};_d.s.prototype={d:null,b:null,f:null,a:null,e:function(){if(!this.b){this.b=this.d.a(_fp.a.J,_fp.a.a(),!1,"PersonaDetailedView",!1,_d.s.a,null,0,null);this.b.W();this.b.y(!0);this.b.bI(!0);this.b.J(!1);this.b.q(this.h);this.b.bv(100);this.b.K(0)}return this.b},g:function(n){if(this.a!==n){this.a=n;this.ee("Persona","RemoveRecipientText")}return n},j:function(){return!this.a||!this.a.a()?String.format(_u.P.o,""):String.format(_u.P.o,this.a.a().c())},c:function(){this.g(null);this.e().h("")},k:function(n,t){var i=n.i();i&&this.g(i)},l:function(){this.g(null);this.e().k(!0)}};_d.bD=function(){this.$$d_onActivateFolderPickerSelectionCommand=Function.createDelegate(this,this.onActivateFolderPickerSelectionCommand);this.$$d_remove=Function.createDelegate(this,this.remove);this.$$d_openFolderPicker=Function.createDelegate(this,this.openFolderPicker);_d.bD.initializeBase(this);_a.b.a(folderPickerContainer,"folderPickerContainer shouldn't be null");_a.b.a(owaShell,"owaShell shouldn't be null");_a.b.a(passFolderCheck,"passFolderCheck shouldn't be null");_a.b.a(conductor,"conductor shouldn't be null");this.c=folderPickerContainer;this.owaShell=owaShell;this.set_folderName(folderName);this.set_folderId(folderId);this.passFolderCheck=passFolderCheck;this.conductor=conductor;this.a=new _C(this.$$d_openFolderPicker,_a.a.bb);this.d=new _C(this.$$d_remove,_a.a.bb)};_d.bD.prototype={c:null,b:null,a:null,d:null};_d.t=function(n,t,i){this.j=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.l);_d.t.initializeBase(this);this.e=n;this.f=t;this.i=i};_d.t.prototype={e:null,f:null,i:null,d:null,c:null,h:null,a:function(){return this.c},k:function(n){if(n!==this.c){this.c=n;this.ea("FolderPickerDialog")}return n},b:function(){if(this.q()){this.k(new _y.ct(new _y.bi(this.e,this.d,_g.a.a(),this.i,null,null,!0,!1,!1,null,null,null)));this.f.a(_d.t.a,"RemovePickerDialog",this.g,9e5)}},q:function(){var n=_h.a.b("msgfolderroot");var t=n.h||_g.l.a("msgfolderroot");if(n&&t){this.d=new _js.f;var i=new _y.X(this.e,"msgfolderroot",t,n,_g.a.a());this.d.a(i);return!0}else{this.p();return!1}},l:function(){this.c&&this.c.i?this.f.a(_d.t.a,"RemovePickerDialog",this.g,9e5):this.n()},m:function(){_js.Trace.logInfo(_d.t.a,"FolderPickerContainer.RemoveFolderPickerScreen");this.h.c?this.f.a(_d.t.a,"RemoveFolderPickerScreen",this.j,9e5):this.o()},n:function(){this.d=null;this.k(null)},o:function(){this.d=null;this.h=null},p:function(){var n=new _a.n([_nbs.a.Mo],0,null,0,!1,_bcs.D.D,null,_nbs.a.Eg);this.e.a(_a.n,n)}};_d.bf=function(){this.c=timeRange;this.isDueDate=isDueDate;this.d=flagStatus;this.e=this.getHeader()};_d.bf.prototype={e:null,c:null,d:"NotFlagged",a:function(){return this.e},b:function(n){var t=n;return t?this.c.d(t):!1},toString:function(){return this.e},w:function(n){if(_d.bf.isInstanceOfType(n)){var t=n;if(this.d===this.d)return this.c?this.c.w(t.c):!t.c}return!1}};_d.bh=function(n,t,i,r,u,f,e,o){this.f=t;this.e="";this.j=i;this.l=r;this.h=u;this.k=f;this.n=e;this.i=o;this.g=n};_d.bh.prototype={g:null,i:null,f:!1,j:null,l:null,e:null,h:null,k:0,n:null,c:function(n){this.e=_js.d.b(n)?"":n.startsWith("&")?n:"&"+n;return n},b:function(){if(this.i.q())this.a(this.i.s());else{var t=0;this.h&&this.h.a()&&(t=this.h.a().a);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.a(n)}},a:function(n){this.q(n)},d:function(n,t){var r=this.o(n,t);var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.j.a(r,i,this.m())},r:function(n){var t=this.p(n);if(t){var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.j.a(t,i,this.m())}},p:function(n){var t=null;if(this.g){t=n!==119?String.format(this.g,_js.l.b(_y.fy,n)):this.g;this.f&&(t+=this.e)}return t},o:function(n,t){var i=null;i=_js.d.c("http://office.microsoft.com/client/15/help/results?ShowNav=true&lcid=1033&ns=OLWAO365E&ver=15&mode=Desktop&helpid=ms.exch.owap.{0}&qu={1}",n,t);this.f&&(i+=this.e);return i},m:function(){return this.k==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""},q:function(n){this.l.c(_g.j.a)||this.r(n)}};_d.V=function(n,t){this.g=Function.createDelegate(this,this.i);_d.V.initializeBase(this);this.e=n;this.c=new _d.s(t);this.h()};_d.V.prototype={e:null,f:null,d:null,c:null,a:function(){return this.d},j:function(n){if(this.d!==n){this.d=n;this.ea("DialogViewModel")}return n},b:function(){this.c.c();this.d.g(!0)},i:function(){if(this.c.a){this.e.a(_y.dW,new _y.dW(this.c.a.a().a().EmailAddress));this.d.j.a();_a.k.b("VM.MailUsage.OpenFromExplicitLogonWindow")}},h:function(){var n=new _bc.i;n.k(_nbs.a.ku);n.m(this);var t=this;this.f=new _C(this.g,_a.a.dV,this.c,"Persona",function(){return!!t.c.a});n.h.a(new _ff.f(this.f,_nbs.a.el,null,!0));n.h.a(new _ff.f(n.j,_u.R.ba));this.j(n)}};_d.U=function(n,t,i,r){this.i=Function.createDelegate(this,this.l);this.j=Function.createDelegate(this,this.n);_a.b.b(n,"offlineSettings");_a.b.b(t,"owaShell");_a.b.b(r,"eventAggregator");this.d=n;this.g=t;this.e=i;r.b(_a.cD,this.j);var u=this;this.h=new _ff.l(function(){return new _y.fc})};_d.U.prototype={d:null,g:null,h:null,e:0,f:function(){return this.h.e()},k:function(){return!this.d.c()&&this.d.f(this.e,!1)},c:function(n){if(n&&!n.n.a){if(this.d.c()){this.m();return!0}if(this.k()){this.l();return!0}}return!1},a:function(n){this.k()&&!n.j(9600)&&n.d(9600,null,_nbs.a.f,this.i)},b:function(n){n.b(9600)},m:function(){this.f().f(!1);this.g.d(this.f())},l:function(){this.f().f(!0);this.g.d(this.f())},n:function(n){var t=n.a;this.e=t.bh.PolicySettings.AllowOfflineOn}};_d.o=function(n,t){this.g=Function.createDelegate(this,this.j);_d.o.initializeBase(this);this.b=t;this.a=n;this.c=_d.o.b();this.h=new _C(this.g,_a.a.u);this.k();switch(this.a.e()){case 0:case 1:break;default:throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.a.e()));}};_d.o.a=function(n,t){_a.b.b(n,"object1");_a.b.b(t,"object2");var r=n.a;var i=t.a;return r.a().b(i.a())};_d.o.b=function(){var n=_a.c.a();return new _a.c(n.e(),n.d(),n.i(),n.l(),n.p(),0)};_d.o.prototype={b:null,h:null,a:null,c:null,f:!1,d:null,e:null,i:function(){var n="";this.a.e()?this.a.e()===1&&(n=this.a.b().a(18)):n=_a.c.l(this.a.a(),this.c)&&_a.c.l(this.a.a(),this.a.f())?String.format(_nbs.a.Le,this.a.a().a(18),this.a.f().a(18)):String.format(_nbs.a.NT,this.a.a().a(18),this.a.a().a(3));return n},k:function(){var i=null;this.a.e()?this.a.e()===1&&(i=this.a.b()):i=this.a.a();var n=Math.floor(i.g(this.c)/1e3);var t=_a.c.bF(n<0?-n:n,!0,!0);this.f=n<0;if(n&&t.length){this.d=t[1];this.e=t[0]}else{this.d=_nbs.a.NG;this.e=""}this.el("TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")},j:function(){var n=this.a.h();if((n&1)==1){var i=new _y.O;i.b(this.a.c());var r=(n&4)==4?IBirthdayFactory:ICalendarItemDetailsViewModelFactory;this.b.v(r,null,i.a,_bc.c.a())}else if(n===2){var t={};t.ItemID=this.a.c().Id;this.b.v(ITaskReadingPaneViewModelPopOutFactory,null,t,_bc.c.a())}}};_d.X=function(n){_d.X.initializeBase(this);this.a=n};_d.X.prototype={a:null,b:function(n){return new _d.o(n,this.a)}};_d.Y=function(n,t,i,r,u,f,e){this.w=Function.createDelegate(this,this.I);this.z=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.L);this.k=Function.createDelegate(this,this.K);this.v=Function.createDelegate(this,this.H);this.x=Function.createDelegate(this,this.J);this.t=Function.createDelegate(this,this.G);_d.Y.initializeBase(this);_a.b.b(i,"nativeBridge");_a.b.b(r,"offlineSettings");_a.b.b(u,"userAgent");this.q=n;this.d=new _h.cf;this.e={};this.p=r;this.h=u;this.b=f;this.l=e;this.a=new _a.dr(this.t);this.a.d(this.x);this.c=new _a.dr(this.v);this.j=i;if(t){t.d(_h.dd,new _h.dd);var o=this;t.b(_a.bw,function(n){n.a&&o.M()})}};_d.Y.prototype={p:null,q:null,h:null,b:null,l:null,a:null,c:null,j:null,d:null,e:null,g:null,i:null,f:null,m:!0,o:!1,M:function(){if(!this.A()){this.b.a().apcl("EnableReminders",this.k);this.o=!0;_js.Trace.logInfo(_a.a.u,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",this.b.a().bh.EnableReminders,this.h.c(),this.b.e().bh.Calendar,this.b.e().bh.Tasks);return}this.E();if(this.p.a())_js.Trace.logInfo(_a.a.u,"Fetch reminders on OwaStarted event skipped as offline is enabled.");else{_js.Trace.logInfo(_a.a.u,"Fetch reminders on OwaStarted event.");this.n(0,null)}},n:function(n,t){_js.Trace.logInfo(_a.a.u,"Calling GetReminders. ReminderType = {0}",n);n&&n!==1||this.r(null);this.f=_js.g.a().b(this.f);var u=!this.h.c()||this.l.a().l().Enabled;var i=new _h.ds(u,this.b.e());i.c=n;i.j(this.h.b()?64:200);var r=_a.c.a();switch(n){case 0:i.b=r.c(10);break;case 1:i.d=r.m(-864e5);i.b=i.b=r.c(10);break;case 2:i.b=r.m(-864e5);break}i.w(this.y);if(t){var f=this;i.z(function(n){t()})}OwaApplication.a.a(i)},F:function(n){for(var i=[],t,f,e,r=this.c.y.length-1;r>=0;r--){t=this.c.y[r];f=this.q.b(t);if(t.b().t().b(n)<=0){var u=t.d()?t.d().Id:"";if(this.e[u]){e=this.e[u];this.a.m(e,!0);e.dispose();this.e[u]=f}Array.add(i,f)}else break}if(i.length>0){this.a.n(i);this.c.t(this.c.y.length-i.length,i.length)}this.C(n)},E:function(){_js.Trace.logInfo(_a.a.u,"Subscribe for reminders notifications.");var n=new _g.bc;n.NotificationType="ReminderNotification";var t=new _h.K(n);t.l(_a.a.u,"ReminderNotification",this.z,0)},H:function(n,t){return _h.cf.a(t,n)},G:function(n,t){return _d.o.a(t,n)},J:function(n,t){this.m&&this.ek("ActiveRemindersChanged",n,t)},N:function(n){_a.b.a(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_js.Trace.logInfo(_a.a.u,"Received reminder notification");var i=n;if(i.shouldGetReminders){this.f&&(this.f=_js.g.a().b(this.f));var t=this;this.f=_js.g.a().a(_a.a.u,"ReminderNotification",function(){t.n(0,null)},8e3)}},L:function(n){var t=n;_js.Trace.logInfo(_a.a.u,"GetReminders succeeded. Received {0} reminders",t.f.y.length);this.O(t)||this.P(t)},P:function(n){this.ek("BeforeRemindersRefresh",this,null);this.g=_js.g.a().b(this.g);this.c.g();this.m=!1;var h=this.d;this.d=n.f;for(var c=this.a.y.length,u=0;u<c;u++)this.a.y[u]&&this.a.y[u].dispose();this.a.g();this.e={};for(var s=_a.c.get_utcNow(),t,r=-1,i=!1,f=this.d.y.length-1;f>=0;f--){t=this.d.y[f];if(t.b().t().b(s)>0)this.c.a(t);else{this.a.y.length||(r=h.j(t));var o=!!t.d();if(!o||!(t.d().Id in this.e)){var e=this.q.b(t);this.a.a(e);o&&(this.e[t.d().Id]=e);if(i)continue;i=r<0||!h.y[r].w(t)}r--}}i=!!(i|c!==this.a.y.length);i&&this.ek("ActiveRemindersChanged",this.a,new _js.B(4,0,[],[]));this.c.y.length>0&&this.C(s);this.r(n);this.m=!0;this.ek("AfterRemindersRefresh",this,null)},O:function(n){_js.Trace.logInfo(_a.a.u,"Scheduling reminders in PAL...");if(!this.j.b(this.j.i()))return!1;for(var i=n.A.Body.Reminders,h=this.l.a().l().Enabled,u=new Array(0),f=i,c=f.length,r=0;r<c;++r){var t=f[r];!t.ReminderGroup&&_a.c.b(t.EndDate).b(_a.c.a())>=0?Array.add(u,t):t.ReminderGroup===1&&h&&Array.add(u,t)}i=u;_js.Trace.logInfo(_a.a.u,"Serializing {0} reminders...",i.length);var s=JsonParser.serialize(i);_js.Trace.logInfo(_a.a.u,"Scheduling {0} reminders on PAL...",i.length);var o=this,e=this;this.j.i().b(s,function(){_js.Trace.logInfo(_a.a.u,"Schedule reminders on PAL succeeded.");o.r(n)},function(t){_js.Trace.logError(_a.a.u,"Failed to schedule reminders on PAL : {0}",t.message);e.r(n)});return!0},r:function(n){this.i&&(this.i=_js.g.a().b(this.i));if(this.p.a()){_js.Trace.logInfo(_a.a.u,"Offline is enabled and so no need to schedule reminders timer");return}if(n){if(!n.c||n.c===1){var r=_a.c.get_utcNow();var i=null;this.d.y.length===n.e&&this.d.y.length>=1&&(i=this.d.y[this.d.y.length-1].b().t());var u=r.m(288e5);var t=288e5;if(i)if(i.b(r)<=0)t=6e5;else if(i.b(u)<0){t=i.g(r);t=Math.max(t,6e5)}this.D(t)}}else this.D(6e5)},D:function(n){_js.Trace.logInfo(_a.a.u,"Scheduling next GetReminers call to happen in {0} milliseconds",n);this.i=_js.g.a().a(_a.a.u,"GetReminders",this.w,n)},I:function(){_js.Trace.logInfo(_a.a.u,"GetReminers timer expired");this.n(0,null)},C:function(n){this.g=_js.g.a().b(this.g);if(this.c.y.length){var r=this.c.y[this.c.y.length-1];var i=r.b().t().g(n);var t=this;this.g=_js.g.a().a(_a.a.u,"ActivateReminders",function(){t.F(_a.c.get_utcNow())},i)}},A:function(){var i=this.b.a().bh.EnableReminders;var t=this.b.e().bh.Calendar;var n=this.b.e().bh.Tasks;return this.h.c()?this.b.e().bh.Calendar:i&&(t||n)},K:function(n,t){if(this.A()){this.E();this.n(0,null);this.b.a().rpcl("EnableReminders",this.k);this.o=!1}},ed:function(){this.o&&this.b.a().rpcl("EnableReminders",this.k);_a.iX.prototype.ed.call(this)}};_d.B=function(){this.$$d_openSelectedReminder=Function.createDelegate(this,this.openSelectedReminder);this.$$d_updateCalculatedProperties=Function.createDelegate(this,this.updateCalculatedProperties);this.$$d_dismissAllReminders=Function.createDelegate(this,this.dismissAllReminders);this.$$d_dismissSelectedReminders=Function.createDelegate(this,this.dismissSelectedReminders);this.$$d_onSnoozeReminderButtonPressed=Function.createDelegate(this,this.onSnoozeReminderButtonPressed);this.$$d_onSelectedRemindersCountChanged=Function.createDelegate(this,this.onSelectedRemindersCountChanged);this.$$d_onAfterRemindersRefresh=Function.createDelegate(this,this.onAfterRemindersRefresh);this.$$d_onBeforeRemindersRefresh=Function.createDelegate(this,this.onBeforeRemindersRefresh);this.$$d_onActiveRemindersChanged=Function.createDelegate(this,this.onActiveRemindersChanged);_d.B.initializeBase(this);this.f=remindersManager;remindersManager.a.d(this.$$d_onActiveRemindersChanged);remindersManager.add_beforeRemindersRefresh(this.$$d_onBeforeRemindersRefresh);remindersManager.add_afterRemindersRefresh(this.$$d_onAfterRemindersRefresh);this.c=new _js.f;this.c.apcl("Count",this.$$d_onSelectedRemindersCountChanged);this.previouslySelectedReminders=[];var i=this;this.snoozeRemindersCommand=new _C(this.$$d_onSnoozeReminderButtonPressed,_d.B.a,this,"CanActOnSelectedReminders",function(){return i.get_canActOnSelectedReminders()});var t=this;this.dismissRemindersCommand=new _C(this.$$d_dismissSelectedReminders,_d.B.a,this,"CanActOnSelectedReminders",function(){return t.get_canActOnSelectedReminders()});this.dismissAllRemindersCommand=new _C(this.$$d_dismissAllReminders,_d.B.a);this.g=new _C(this.$$d_updateCalculatedProperties,_d.B.a);this.e=new _C(this.$$d_openSelectedReminder,_d.B.a);this.a=new _js.f;this.generateDefaultSnoozeOptions();this.m(!1);if(_y.c.a.a()!=="Mouse"){var n=[new _y.f(_y.b.v(),_y.b.w(),_nbs.a.Wx,this.snoozeRemindersCommand),new _y.f(_y.b.n(),_y.b.o(),_u.R.Rx,this.dismissRemindersCommand)];this.dC(_y.k.b(this,n,null))}};_d.B.prototype={g:null,f:null,b:null,c:null,a:null,d:0,e:null,l:function(){return _y.c.a.a()!=="Mouse"?_y.hO.prototype.l.call(this):0},h:function(n){if(this.b!==n){this.b=n;this.ea("SelectedReminder");this.m(!0)}return n},k:function(n){if(n!==this.d){this.d=n;this.ea("SelectedSnoozeTime")}return n},j:function(n){this.c!==n&&(this.c=n);return n},m:function(n){var t=[];if(this.b&&this.c.y.length===1){var r=_a.c.a();var u=this.b.a.a().r(-15);r.b(u)<=0&&Array.add(t,-15);r.b(u.r(5))<=0&&Array.add(t,-10);r.b(u.r(10))<=0&&Array.add(t,-5);r.b(this.b.a.a())<=0&&Array.add(t,0)}if(!t.length||t[0]!==this.a.y[0]){for(var i=0;i<this.a.y.length;i++)if(this.a.y[i]===5)break;this.a.t(0,i);t.length>0&&this.a.v(0,t)}(this.d<this.a.y[0]||n)&&this.k(this.a.y[0])}};_d.bo=function(n,t,i,r){this.a=this.$$gta["_d.bo"].T===Number||Type.isEnum(this.$$gta["_d.bo"].T)?0:this.$$gta["_d.bo"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.a=n;this.b=t;this.c=i;this.d=r};_d.bo.$$=function(n){var t="bo"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.bo.apply(this,t)};r.registerClass("_d."+t);var e={"_d.bo":{T:n}};r.prototype.$$gta=e;var f=_d.bo.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.bo.prototype={b:null,c:null,d:null,e:function(n){if(!this.b(this.a)){var t=this;n.j(function(n){n?t.a=t.c():t.d(t.a)})}}};_d.bB=function(n,t,i,r,u,f,e){this.g=Function.createDelegate(this,this.o);this.e=n;this.f=t;this.h=i;this.l=r;this.j=u;this.k=f;this.i=e};_d.bB.prototype={l:null,j:null,k:null,e:null,f:null,h:null,d:null,i:null,b:function(n,t,i){var u=n.IsArchive.toString()==="true";var r=new _y.K(this.e,this.f,null,null);r.t(2);var e=new _d.R(this.e,this.f,this.h,this.l,this.j,this.k,this.i,n.FilterContacts.toString()==="1",n.IsConsumer.toString()==="1");this.d=new _d.H(e,r);if(u&&!_g.b.a.nameToId("archiverecoverableitemsdeletions"))this.n();else{var f=u?_g.l.a("archiverecoverableitemsdeletions"):_g.l.a("recoverableitemsdeletions");this.m(f)}return this.d},a:function(n,t,i){throw Error.notImplemented("Creating from context is not supported");},c:function(n,t,i){var r={};r.IsArchive=n;r.FilterContacts=t?1:0;r.IsConsumer=i?1:0;this.e.v(IDumpsterPopOutViewModelFactory,null,r,_bc.c.d())},n:function(){var t="archiverecoverableitemsdeletions";var n=new _h.bz("GetFolderAction_DumpsterPopOutViewModelFactory_"+t,!1);n.d=new _h.bL;n.c=[new _g.A(t)];n.z(this.g);OwaApplication.a.a(n)},o:function(n){var t=n;t.K(this.g);if(t.t){this.d.a.dr(11);return}var i=t.d.y[0];this.m(i)},m:function(n){this.d.b.bB.E(n);this.d.a.cz(n,null);this.d.a.U(0)}};_d.G=function(n,t,i,r,u,f,e,o){this.f=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.K);this.C=Function.createDelegate(this,this.P);this.A=Function.createDelegate(this,this.O);this.D=Function.createDelegate(this,this.R);this.z=Function.createDelegate(this,this.N);_d.G.initializeBase(this);_a.b.a(n,"message");this.d=n;this.i=t;this.q=f;this.n=i;this.e=r;this.x=u;this.v=e;this.m=o;this.h=new _C(this.z,_a.a.cd);this.k=new _C(this.D,_a.a.cd);this.r=new _C(this.A,_a.a.cd);this.t=new _C(this.C,_a.a.cd);this.p=new _C(this.y,_a.a.cd);this.m=_a.UserAgent.getInstance();this.g=this.E(!0);this.j=this.E(!1);this.g||(this.o=this.h);this.j||(this.w=this.k);this.J();this.d.apcl("LastVerbExecuted",this.f);this.d.r().apcl("IsUndecidedApprovalRequest",this.f)};_d.G.prototype={d:null,e:null,v:null,q:null,n:null,h:null,k:null,r:null,t:null,o:null,w:null,p:null,x:null,i:!1,m:null,g:null,j:null,l:!1,H:null,G:!1,S:function(n){if(n!==this.l){this.l=n;this.ea("ShowApproveRejectButtons")}return n},M:function(){return this.m.f().d()},a:function(n){this.H=n;return n},b:function(n){this.G=n;return n},c:function(){this.d.rpcl("LastVerbExecuted",this.f);this.d.r().rpcl("IsUndecidedApprovalRequest",this.f)},J:function(){this.S(!!this.d.r()&&this.d.r().e()&&this.d.A()!==1&&this.d.A()!==2)},Q:function(n,t){this.J()},E:function(n){var i=n?0:1;if(this.d.bh.VotingInformation&&this.d.bh.VotingInformation.UserOptions&&this.d.bh.VotingInformation.UserOptions.length>=i&&this.d.bh.VotingInformation.UserOptions[i].SendPrompt==="Send")return null;var t=[new _fm.d(_u.W.T,null,n?this.r:this.t),new _fm.d(_u.W.x,null,n?this.h:this.k)];this.e.a()==="TouchNarrow"&&Array.add(t,new _fm.d(_nbs.a.gK,null,this.p));return new _fm.f(t)},N:function(){this.I(!0)},R:function(){this.I(!1)},I:function(n){if(!this.i){var t=new _c.u(this.d,null,n,1);this.n.a(t);this.L()}},O:function(){this.F(!0)},P:function(){this.F(!1)},F:function(n){if(!this.i){var t=this.v.a(!1,!1);t.f(n?9:10);t.j(!0);t.o(this.e.a()==="Mouse"?1:2);t.O(this.d);this.q().a(t)}},K:function(){},L:function(){switch(this.e.a()){case"TouchNarrow":this.x.c();break;case"TouchWide":break;case"Mouse":if(!this.e.c()){var n=window.self;_js.g.a().c(_a.a.w,"ApprovalRequestHeaderViewModel.PopOutClose",n.$$d_close||(n.$$d_close=Function.createDelegate(n,n.close)))}break}}};_d.bd=function(n,t,i,r,u){this.d=n;this.e=t;this.b=i;this.c=r;this.f=u};_d.bd.prototype={d:null,e:null,b:null,c:null,f:null,a:function(n,t,i){t||(t=_y.bs.a);return new _d.G(n,i,this.b,this.d,this.e,t,this.c,this.f)}};_d.H=function(n,t){this.g=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);_d.H.initializeBase(this);this.a=n;var u=this;this.f=new _C(function(){u.a.fO()},_a.a.bN);var f=this;this.e=new _C(function(){f.a.fN()},_a.a.bN);var i=this;this.a.apcl("SelectedItemsCount",function(n,t){i.n(i.a.dy.y.length>0);i.p(i.c&&!i.a.dO)});var r=this;this.a.apcl("CurrentTableLoaded",function(n,t){r.ea("DumpsterDescription")});this.q(new _y.g("Mouse"));this.b.J(!1);this.b.bI(!0);this.b.K(1);this.b.y(!0);this.b.bX=!1;this.b.eT(t);this.b.bo(new _C(this.h,_a.a.bN));this.b.cN(new _C(this.g,_a.a.bN))};_d.H.prototype={f:null,e:null,a:null,b:null,c:!1,d:!1,p:function(n){if(this.d!==n){this.d=n;this.ea("IsPurgeButtonEnabled")}return n},n:function(n){if(this.c===n)return n;this.c=n;this.ea("AreActionCommandsEnabled");return n},j:function(){return this.a.bT?String.format(_nbs.a.IN,this.a.dw.f()):_nbs.a.kh},q:function(n){if(this.b!==n){this.b=n;this.ea("SearchVM")}return n},m:function(){if(!_js.d.a(this.b.by)&&this.b.by.trim().length>0){this.b.ct(!0);this.a.H(this.b,!0)}},k:function(){_a.k.u("VM.FindMail.Search");this.b.cJ();if(this.a.dA){this.a.cw(!0);var n=this;_js.g.a().c(_a.a.bN,"LoadItemsOnCancelSearch",function(){n.a.U(0)})}}};_d.R=function(n,t,i,r,u,f,e,o,s){this.eY=Function.createDelegate(this,this.gR);this.eZ=Function.createDelegate(this,this.hO);_d.R.initializeBase(this,[n,t,i,u,r,f,null,null,null,null,null,null,e,null,null,null]);this.bT=o;this.cI=s;this.iY();this.z(new _h.y("DateTimeReceived","Descending"));this.iv=this.gQ()};_d.R.prototype={cI:!1,dO:0,bT:!1,gR:function(n,t){var i=this;this.fM(n,function(){i.fr("HardDelete",i.k());_a.k.b("VM.MailUsage.PurgeFromDumpster")})},hO:function(n,t){var i=this;this.fM(n,function(){for(var e=i.dy,f=[],s=[],o=[],r=[],n=null,t=0;t<e.y.length;t++){var u=e.y[t];switch(u.bh.ItemClass){case"IPM.Appointment":n=f;break;case"IPM.DistList":case"IPM.Contact":n=r;break;case"IPM.Task":n=o;break;case"IPM.Note":default:n=s;break}Array.add(n,u)}i.eW(s,_g.l.a("inbox"));i.eW(f,_g.l.a("calendar"));i.eW(o,_g.l.a("tasks"));i.eW(r,_g.l.a("contacts"));_a.k.b("VM.MailUsage.RecoverFromDumpster")})},jD:function(){return!0},fO:function(){if(this.dy.y.length){var t=this.bT&&this.cI?[_nbs.a.So]:[_nbs.a.ZI,_nbs.a.ja,_nbs.a.HF,_nbs.a.Z,_nbs.a.BA];var n=new _a.n(t,1,this.eZ,1,!1,_u.P.T,_u.R.ho,_nbs.a.Wi);this.dJ.a(_a.n,n)}},fN:function(){if(this.dy.y.length){var n=new _a.n([_nbs.a.nC],1,this.eY,1,!1,_u.P.T,_u.R.ho,_nbs.a.lb);this.dJ.a(_a.n,n)}},hx:function(n,t){if(this.cI)if(t.c){if(t.c===2)for(var i=0;i<t.b.length;i++){var u=t.b[i].bh.ItemClass;(u==="IPM.DistList"||u==="IPM.Contact")&&this.dO--}}else for(var r=0;r<t.a.length;r++){var f=t.a[r].bh.ItemClass;(f==="IPM.DistList"||f==="IPM.Contact")&&this.dO++}this.ea("SelectedItemsCount")},iY:function(){var n=[];var i=this;Array.add(n,new _fm.d(_nbs.a.YK,null,new _C(function(){i.fO()},_a.a.bN)));var t=this;Array.add(n,new _fm.d(_nbs.a.Wy,null,new _C(function(){t.fN()},_a.a.bN)));this.dq(new _fm.f(n))},iz:function(){return!1},fM:function(n,t){if(n&&!(this.dy.y.length<=0)){t();this.et()}},eW:function(n,t){if(!(n.length<=0)){var i=new _h.be(n,t.bh.FolderId,0);OwaApplication.a.a(i)}},gQ:function(){if(this.cI&&this.bT){var t=this.bT?new _g.cf:new _gg.bX;var n=this.bT?new _g.cf:new _gg.bX;var i=this.bT?new _gg.fC:new _gg.dU;t=this.fI(t,"IPM.Contact");n=this.fI(n,"IPM.DistList");i.Items=[t,n];return new _g.bP(i)}return null},fI:function(n,t){n.Item=new _g.e("ItemClass");var r;var u=(r=new _g.bJ,r.Value=t,r);var i;n.FieldURIOrConstant=(i=new _g.bK,i.Item=u,i);return n}};_d.bk=function(n){this.b=n};_d.bk.prototype={b:null,a:function(n){if(n){if(_h.bK.isInstanceOfType(n)){var i=n;var t=_h.a.a(i.c);if(!t||!t.b)return}_h.dw.isInstanceOfType(n)&&this.c(n.p())}},c:function(n){switch(n){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":this.d();return;case"ErrorFolderExists":this.e();return}},e:function(){var n=new _a.n([_u.R.fd],0,null);this.b.a(_a.n,n)},d:function(){var n=new _a.n([_u.R.Bu],0,null,0,!1,null,null,_u.R.Tj);this.b.a(_a.n,n)}};_d.bl=function(n,t){this.f=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.h);_d.bl.initializeBase(this);this.a=new _d.s(n);this.c=t};_d.bl.prototype={b:null,c:null,a:null,d:function(){this.b||this.i();return this.b},j:function(n){if(this.b!==n){this.b=n;this.ea("DialogViewModel")}return n},i:function(){var n=new _bc.i;n.k(_nbs.a.Ux);n.m(this);var u=this;var f=new _C(this.e,_a.a.r,this.a,"Persona",function(){return!!u.a.a});var t=new _C(this.f,_a.a.r);n.t(t);var r=new _ff.f(f,_nbs.a.Dp,null,!0);var i=new _ff.f(t,_u.R.ho);n.h.a(r);n.h.a(i);this.j(n)},h:function(){if(this.a.a){var n=new _g.fU;n.DisplayName=this.a.a.a().c();n.PrimarySmtpAddress=this.a.a.a().a().EmailAddress;n.DistinguishedUser="None";this.g();this.c(n)}},g:function(){this.d().g(!1);this.a.c()}};_d.j=function(n,t){this.V=Function.createDelegate(this,this.bo);this.W=Function.createDelegate(this,this.bp);this.R=Function.createDelegate(this,this.ba);this.U=Function.createDelegate(this,this.bn);this.S=Function.createDelegate(this,this.bl);this.T=Function.createDelegate(this,this.bm);_d.j.initializeBase(this);this.m(this);this.z(!0);this.J=t;this.P=new _C(this.T,_d.j.a);this.L=new _C(this.S,_d.j.a);this.Q=new _C(this.U,_d.j.a);this.d=new _js.f;this.O=new _y.t;this.F=new _d.bl(n,this.R);var r=new _ff.f(this.P,_nbs.a.TJ,null,!0);var i=new _ff.f(this.j,_nbs.a.Ov);this.o(new _js.f);this.h.a(r);this.h.a(i);this.k(_nbs.a.dj)};_d.j.$$cctor=function(){_d.j.b=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};_d.j.prototype={J:null,P:null,L:null,Q:null,F:null,H:null,d:null,f:null,c:null,O:null,N:null,C:!1,n:!1,x:!1,E:!1,A:function(){this.H||(this.H=new _bc.b);return this.H},bj:function(){if($a(this.f)){this.f=new _js.f;this.f.a("Owner");this.f.a("PublishingEditor");this.f.a("Editor");this.f.a("PublishingAuthor");this.f.a("Author");this.f.a("NoneditingAuthor");this.f.a("Reviewer");this.f.a("Contributor");this.f.a("None")}return this.f},I:function(n){if(this.c===n)return n;this.c=n;this.ea("SelectedItem");this.Z();return n},bg:function(){return this.c.a()},bD:function(n){if(this.c.a()!==n){this.c.g(n);this.e(!0);this.c.w();this.ea("PermissionLevel");this.Z()}return n},bk:function(){return this.c.r()},bE:function(n){if(this.c.r()!==n){this.c.n(n);this.e(!0);this.l();this.ea("ReadAccess")}return n},bc:function(){return this.c.o()},bt:function(n){if(this.c.o()!==n){this.c.k(n);this.e(!0);this.l();this.ea("DeleteAccess")}return n},br:function(n){if(this.c.bh.CanCreateItems!==n){this.c.i(n);this.e(!0);this.l();this.ea("CanCreateItems")}return n},bs:function(n){if(this.c.bh.CanCreateSubFolders!==n){this.c.j(n);this.e(!0);this.l();this.ea("CanCreateSubfolders")}return n},be:function(){return this.c.b()==="Owned"||this.c.b()==="All"},bv:function(n){if(n){if(this.c.b()==="None"){this.c.e("Owned");this.e(!0);this.l();this.ee("EditOwn","EditAll")}}else if(this.c.b()==="None"){this.e(!0);this.l();this.ee("EditOwn","EditAll")}else this.c.b()==="All"&&this.ea("EditOwn");this.M();return n},bw:function(n){if(this.x!==n){this.x=n;this.ea("EditOwnEnabled")}return n},bd:function(){return this.c.b()==="All"},bu:function(n){if(n){(this.c.b()==="None"||this.c.b()==="Owned")&&this.c.e("All");this.e(!0);this.l();this.ee("EditOwn","EditAll")}else if(this.c.b()==="All"){this.e(!0);this.c.e("None");this.l();this.ee("EditOwn","EditAll")}this.M();return n},bB:function(n){if(this.c.bh.IsFolderOwner!==n){this.c.m(n);this.e(!0);this.l();this.ea("IsFolderOwner")}return n},bf:function(){return this.c.q()},bz:function(n){if(this.c.q()!==n){this.c.c(n);this.e(!0);this.l();this.ea("IsFolderContact")}return n},bA:function(n){if(this.E!==n){this.E=n;this.ea("IsFolderContactEnabled")}return n},bC:function(n){if(this.c.bh.IsFolderVisible!==n){this.c.f(n);this.e(!0);this.l();this.ea("IsFolderVisible")}return n},by:function(n){if(this.d!==n){this.d=n;this.ea("FolderPermissionList")}return n},a:function(){return this},e:function(n){if(this.C!==n){this.C=n;this.ea("IsDIrty")}return n},b:function(n,t){this.N=n;this.k(String.format(_nbs.a.dj,n.bh.DisplayName));this.d.g();this.d.n(t.b().f());this.I(this.d.y[0]);this.e(!1);this.n=!1;this.g(!0)},ba:function(n){var r=this;var i=this.d.k(function(t){return t.A(n)});if(i!==this.d.y.length){this.A().a(0,String.format(_nbs.a.hO,n.DisplayName),null);return}var t=_g.G.c.p();t.t(n);this.d.a(t);this.e(!0);this.I(this.d.y[this.d.y.length-1])},bq:function(){var n=this.d.j(this.c);if(n!==-1){if(this.Y(this.c.bh.UserId)){this.A().a(0,_nbs.a.WT,null);return}var i=n===this.d.y.length-1?n-1:n;this.d.m(this.c,!0);this.e(!0);var t=this.d.y[i];this.I(t)}},l:function(){var n=this.c.y();if(n!==this.c.a()){this.c.g(n);this.ea("PermissionLevel")}},bm:function(){if(!this.n)if(this.C){this.bF();this.n=!0}else this.X()},bF:function(){var n=new _h.fa;n.b=new _g.cK;n.b.f(new(_a.fK.$$(_g.G,_g.dw)));for(var t=0;t<this.d.y.length;t++){var r=this.d.y[t];var i=r.p();i.t(this.bb(r.bh.UserId));n.b.b().c(i)}n.c=this.N;n.z(this.W);n.v(this.V);this.J.a(n)},bb:function(n){var t=new _g.fU;t.DistinguishedUser=n.DistinguishedUser;t.ExternalUserIdentity=n.ExternalUserIdentity;t.PrimarySmtpAddress=n.PrimarySmtpAddress;t.SID=n.SID;return t},bl:function(){this.F.d().g(!0)},bn:function(){this.bq()},Z:function(){if(this.c){for(var n=0;n<_d.j.b.length;n++)this.ea(_d.j.b[n]);this.M()}},M:function(){if(this.c){this.bw(this.c.b()!=="All");this.bA(!this.Y(this.c.bh.UserId))}},Y:function(n){return n.DistinguishedUser==="Anonymous"||n.DistinguishedUser==="Default"},bp:function(n){this.n=!1;n.t||this.X()},X:function(){this.d.g();this.e(!1);this.j.a()},bo:function(n){this.n=!1;var t=n.c.bh.DisplayName;this.A().a(0,String.format(_nbs.a.Ej,t),null)}};_d.K=function(n,t,i,r){this.q=Function.createDelegate(this,this.D);this.n=Function.createDelegate(this,this.z);this.o=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.C);_d.K.initializeBase(this);_a.b.a(n,"message");_a.b.a(i,"personaCardFacade");this.j=t;this.e=n;this.m=i;this.f=!0;this.g=!1;if(r){var u=this;r.a(function(n){u.l=n;u.y()})}};_d.K.prototype={m:null,e:null,j:null,k:null,f:!1,g:!1,h:null,l:null,i:null,t:null,r:!1,E:function(n){if(this.h!==n){this.h=n;this.ea("ProcessMembershipCommand")}return n},b:function(){return new Array(0)},c:function(){},w:function(n){if(this.f!==n){this.f=n;this.ea("HideProcessMembershipButton")}return n},v:function(n){if(this.i!==n){this.i=n;this.ea("ErrorMessage")}return n},x:function(n){if(this.g!==n){this.g=n;this.ea("IsLoading")}return n},a:function(n){this.t=n;return n},d:function(n){this.r=n;return n},y:function(){if(!this.h){var n=this.l.a(this.e.bh.ItemId);n.w(this.p);n.v(this.o);n.z(this.n);this.x(!0);this.j.a(n);this.E(new _C(this.q,_d.K.a))}},z:function(n){this.x(!1)},A:function(n){this.w(!0);this.v(_nbs.a.Ge)},C:function(n){var t=n;this.k=_pc.a.b(t.c().GroupPersona,2);this.v("");this.w(!t.c().IsOwner||this.e.bh.From.Mailbox.EmailAddress===_g.a.a().c().bh.UserEmailAddress)},D:function(){var t=_pc.a.a(this.e.bh.From.Mailbox);var n=new _d.bx;n.n=[t];this.m.m(this.k,n)}};_d.S=function(n,t){this.m=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.y);this.q=Function.createDelegate(this,this.z);this.o=Function.createDelegate(this,this.r);this.l=Function.createDelegate(this,this.v);_d.S.initializeBase(this);this.g=new _d.s(n);this.h=t};_d.S.prototype={f:null,j:null,h:null,g:null,i:null,k:null,a:function(){if(!this.f){this.f=new _bc.i;this.f.k(_nbs.a.mw);this.f.m(this);var u=this;var r=new _C(this.l,_a.a.r,this.g,"Persona",function(){return!!u.g.a});var n=new _C(this.o,_a.a.r);this.f.t(n);var t=new _ff.f(r,_nbs.a.ai,null,!0);var i=new _ff.f(n,_u.R.ho);this.f.h.a(t);this.f.h.a(i)}return this.f},b:function(){this.j||(this.j=new _bc.b);return this.j},d:function(n){this.i=n;return n},e:function(n){this.k=n;return n},c:function(n){if(n){var t=new _c.bu(n);t.w(this.q);t.v(this.p);this.h.a(t)}},v:function(){if(this.g.a){var t=this.g.a.a().c();var i=this.g.a.a().a().EmailAddress;var n=new _c.bC(t,i);n.w(this.n);n.v(this.m);this.h.a(n);this.r()}},r:function(){this.a().g(!1);this.g.c()},w:function(n){this.t()},x:function(n){if(this.i){var t=n;this.i(t.b,t.c)}},y:function(n){this.t()},t:function(){this.b().a(0,_u.R.Tj,null,!1,null,null,_nbs.a.ZE)},z:function(n){if(this.k){var t=n;this.k(t.b)}}};_d.bE=function(n,t,i,r,u){_d.bE.initializeBase(this,[n,i,r,u]);this.e=t};_d.bE.prototype={e:null,bE:!1,bh:!1,C:!1,J:!1,x:!1,bD:null,bC:null,bB:null,ca:function(){this.n.g();this.p.g();var f=this.d.a()==="TouchNarrow";var n=new _ph.O;n.g=_h.a.b("msgfolderroot");for(var r=null,u=new _ph.d(this.d,this.e,null,n,_nbs.a.XR,f,!0,!1,null,!1,null,null),i=null,e=new _ph.d(this.d,this.e,null,n,_nbs.a.FD,!0,!0,!1,null,!1,null,null),o=0;o<this.q.y.length;o++){var t=this.q.y[o];if(t.a===1){r=new _ph.d(this.d,this.e,t,n,null,f,!0,!1,null,!1,null,null);this.n.a(t);continue}if(t.a>=1e3)if(t.a===1e3){i||(i=new _ph.d(this.d,this.e,null,n,_nbs.a.Xs,!0,!0,!1,null,!1,null,null));this.cp()&&i.c.a(new _ph.d(this.d,this.e,t,n,null,!0,!0,!1,null,!1,null,null))}else this.cR(t,n,this.d)&&e.c.a(new _ph.d(this.d,this.e,t,n,null,!0,!0,!1,null,!1,null,null));else if(t.c()){r.c.a(new _ph.d(this.d,this.e,t,n,null,f,!0,!1,null,!1,null,null));this.n.a(t)}else{u.c.a(new _ph.d(this.d,this.e,t,n,null,f,!0,!1,null,!1,null,null));this.p.a(t)}}if(!$a(r)&&!this.bh){n.j(r);n.d.a(r);r.g(!1);r.e(!0);n.k(u);r.c.a(u);r.c.d(this.bX);u.c.d(this.bY);u.g(!0)}if(!$a(i)&&!this.bE){n.d.a(i);if(this.cp()){i.c.a(e);e.g(!0)}else{this.bD&&i.c.a(this.bD);this.bB&&i.c.a(this.bB);this.bC&&i.c.a(this.bC)}this.cQ(i)}this.ch(n);this.dw(!this.p.y.length)},cp:function(){return!(this.C||this.J||this.x)},cR:function(n,t,i){if((this.C||this.x)&&n.b.j===1002){this.bD=new _ph.d(i,this.e,n,t,null,!0,!0,!1,null,!1,null,null);return!1}if(this.C&&!this.x&&n.b.j===1004){this.bB=new _ph.d(i,this.e,n,t,null,!0,!0,!1,null,!1,null,null);return!1}if((this.J||this.x)&&n.b.j===1003){this.bC=new _ph.d(i,this.e,n,t,null,!0,!0,!1,null,!1,null,null);return!1}return this.C||this.J||this.x?!1:!0},cQ:function(n){this.bh&&n.l&&this.t(n.c.y[0].b)}};_d.J=function(n,t,i){this.b=n;this.a=t;this.d=i};_d.J.prototype={b:null,a:null,c:null,d:null,e:function(n,t,i,r){return new _d.F(this.b,this.c,n,t,i,r,this.a,this.d)}};_d.bj=function(n,t,i,r){this.d=n;this.c=t;this.b=i;this.e=r};_d.bj.prototype={d:null,c:null,b:null,e:null,a:function(n){return new _d.z(this.d,this.c,n,this.b,this.e)}};_d.x=function(n,t,i,r){this.O=Function.createDelegate(this,this.T);this.w=-1;_d.x.initializeBase(this);this.K=n;this.q=new _js.f;this.M=t;this.H=i;this.E=i.a().i().Enabled;this.G=r;this.F=2};_d.x.prototype={K:null,G:null,q:null,M:null,z:null,I:!1,J:!1,x:!1,C:!1,Q:0,L:null,y:null,A:null,D:null,E:!1,F:0,H:null,r:function(){if(this.E){for(var n=0;n<this.q.y.length;n++)if(this.q.y[n].r())return!0;return!1}return!!this.y&&this.y.r()},n:function(){return this.J},N:function(n){if(this.J!==n){this.J=n;this.bk("IsSuggestionPopulationInProgress");this.P(!n)}return n},g:function(){return this.x},u:function(n){if(this.x!==n){this.x=n;this.bk("IsModuleLinkSelected")}return n},m:function(){return this.C},P:function(n){if(this.C!==n){this.C=n;this.bk("IsPeopleModuleSuggestionVisible");if(this.x&&!n){this.u(!1);this.d(-1)}}return n},a:function(){return this.w},d:function(n){if(this.w!==n){this.w=n;this.bk("ItemHighlightedIndex");if(this.w>=0&&this.w<this.q.y.length){this.y=this.q.y[this.w];this.E||this.y.f(!0)}}return n},S:function(){return!!this.H&&this.H.a().N().Enabled},b:function(){return this.q},l:function(n){this.A=n;return n},c:function(){return this.D},f:function(n){if(this.D!==n){var t=null;n&&(t=_a.d.b(_d.x.a,"SelectContactFromSuggestion"));this.D=n;this.bk("SelectedItem");this.R();_a.d.a(t)}return n},h:function(){return this.L},i:function(n){if(this.L!==n){this.L=n;this.R()}return n},v:function(n){this.F=n;return n},p:function(){this.y=null;this.z=null;this.q.g();this.d(-1);this.N(!1);this.P(!1);this.u(!1);this.I=!1},e:function(){if(!_js.d.a(this.A)&&this.I)if(this.A&&this.q.y.length<5){this.S()?this.z=_fp.a.h(this.A,5,"","",4,["Mailbox","Directory"]):this.A.trim().length>=4&&(this.z=_fp.a.d(this.A,_g.l.a("directory"),null,_fp.a.c(0,5),null,null,_fp.a.b,null,4,!1,!1));if(this.z){this.z.Z=_a.d.b(_d.x.a,"SearchPeopleSuggestionsOnServer");this.z.z(this.O);OwaApplication.a.a(this.z)}}else this.N(!1)},j:function(n){this.y&&this.y.f(!1);var t=1;(n||this.C)&&(t=0);this.x&&this.u(!1);this.w<this.q.y.length-t&&this.d(this.w+1);this.w===this.q.y.length&&this.C&&this.u(!0);return this.w<this.q.y.length||this.x},k:function(n){this.y&&this.y.f(!1);var t=n?1:0;if(this.w===this.q.y.length&&this.C&&!this.x)this.u(!0);else{this.x&&this.u(!1);this.w>=t&&this.d(this.w-1)}return this.w>=0||this.x},o:function(){var i=_a.d.b(_d.x.a,"ShowPeopleSuggestions");var t=this.A.trim().length;this.q.g();this.d(-1);if(this.K.a()==="Mouse"||this.K.a()==="TouchNarrow"){this.I=!0;var u=[1];var r=_fp.c.f(this.A,5,0,null);var n=this;Array.forEach(r,function(t){var i=n.M.d(t,_pe.c.a,!1,n.F);i.k(1,u,"");i.b(!n.E);i.ce(n.G.a(i));i.bE.a(1);n.q.a(i)});this.q.y.length<5&&t>=this.Q&&t>=4?this.N(!0):this.P(!0)}_a.d.a(i)},t:function(){for(var n=0;n<this.q.y.length;n++)this.q.y[n].r()&&this.q.y[n].f(!1)},T:function(n){n.K(this.O);var i=n.Z;i&&(i.j=_js.d.c("sq:{0}",this.z===n));if(this.z!==n){_a.d.a(i);return}if(this.q.y.length<5&&$a(n.t)){for(var o=n.b(),h=[1],s=this.q.y.length,u=0;u<o.y.length&&this.q.y.length<5;u++){for(var e=o.y[u],f=!0,r=0;r<s;r++)if(_pc.a.g(e,this.q.y[r].bA)){f=!1;break}if(f){var t=this.M.d(e,_pe.c.a,!1,this.F);t.k(1,h,"");this.E||t.b(!0);t.ce(this.G.a(t));t.bE.a(1);this.q.a(t)}}this.x&&this.d(this.q.y.length)}else n.t&&(i.k=n.D());this.N(!1);_a.d.a(i)},R:function(){for(var n=0;n<this.q.y.length&&this.D;n++)if(this.D===this.q.y[n]){this.u(!1);this.y=this.D;this.d(n);break}}};_d.u=function(n){this.e=Function.createDelegate(this,this.h);_d.u.initializeBase(this);this.d=n;this.c=new _C(this.e,_d.u.a);this.a=new _js.f};_d.u.prototype={d:null,a:null,c:null,b:null,i:function(n){if(this.b!==n){this.b=n;this.ea("TotalResultsInRecipientCache")}return n},cC:function(){this.a.g();for(var t=_fp.a.a(),n=0;n<t.bm.y.length;n++)this.a.a(this.f(t.bm.y[n]));this.i(String.format(_nbs.a.na,t.bm.y.length))},cE:function(){},cD:function(){},cF:function(){},f:function(n){var t=this.d.l(n,_pe.c.a,!1,8,0);var i=[1];t.k(1,i,"");t.dH();return t},h:function(){console.log(this.g("\r\n"))},g:function(n){var t=new Sys.StringBuilder;t.append("Name,Main Email,Secondary Email"+n);for(var u=0;u<this.a.y.length;u++){var i=this.a.y[u];t.append("Name: "+i.bD+",");t.append("Email: "+i.bJ);if(!$a(i.bC))for(var r=0;r<i.bC.y.length;r++){t.append(",");var f=i.bC.y[r];t.append("Email "+(r+1).toString()+": "+f.EmailAddress)}t.append(n)}return t.toString()}};_d.P=function(n){n.a(new _h.dl(!0))};_d.W=function(n){var t=new _pc.g;n.a(t)};_d.bc=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_d.e,"TaskReadingPaneContext")})}};_d.Q=function(n,t,i){this.l=Function.createDelegate(this,this.n);_d.Q.initializeBase(this,[n,t,i]);this.e=new _d.bF};_d.Q.prototype={e:null,i:null,w:function(n){if(this.i!==n){this.i=n;this.bk("FilterByButtonLabel")}return n},t:function(){this.r(new _fm.f(new Array(0)));this.x();this.m();this.c.h.a(new _fm.j);this.v();this.k();this.c.h.a(new _fm.j);this.u();this.bk("SortByContextMenu")},m:function(){this.w(this.e.a.b)},x:function(){this.c.h.a(new _fm.n(_u.R.GW));for(var t=0;t<this.e.b.y.length;t++){var n=this.e.b.y[t];var i=new(_a.gi.$$(_d.C))(n,this.l);this.c.h.a(new _fm.h(n.b,null,new _C(i.a,_d.w.a),n.c,!1,null,null,"ViewFilter_"+n.a))}},n:function(n,t){if(this.e.a.a===n.a){this.f("ViewFilter_"+n.a,!0);return}this.f("ViewFilter_"+this.e.a.a,!1);this.e.c(n);this.f("ViewFilter_"+n.a,!0);this.h.b(this.y(this.e.a.a));this.m()},y:function(n){switch(n){case"TaskActive":return 1;case"TaskOverdue":return 2;case"TaskCompleted":return 3;default:return 0}}};_d.v=function(){this.r=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.y);this.p=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.A);_d.v.initializeBase(this);this.h=new _bc.b;this.c=new _js.f;this.c.a(new _ff.f(new _C(this.q,_d.v.a),_nbs.a.eQ));this.c.a(new _ff.f(new _C(this.p,_d.v.a),_nbs.a.bY));this.c.a(new _ff.f(new _C(this.o,_d.v.a),_bcs.D.A,null,!0))};_d.v.prototype={j:null,c:null,i:!1,h:null,m:null,e:null,b:null,d:null,a:0,g:null,f:null,n:0,k:function(n){if(this.i!==n){this.i=n;this.ea("RecurrenceDeletionDialogIsShow")}return n},D:function(n){if(this.j!==n){this.j=n;this.ea("RecurrenceDialogMessage")}return n},l:function(n,t,i,r){if(!this.a){if(this.C(n)){_a.F.a(_u.R.Zj,1);return}this.e=n;this.m=t;this.g=i;this.f=r;var o=n.y.length;if(o){var u=0;if(n.y.length===1){var e=n.y[0];_pc.a.isInstanceOfType(e)?u=4:_g.F.isInstanceOfType(e)||(u=2)}else for(var f=0;f<o;f++){var s=n.y[f];_g.F.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.a.a().a().A())===u){this.E(u);return}this.v(!0,!1)}}},C:function(n){for(var t=0;t<n.y.length;t++){var i=n.y[t];if(_g.F.isInstanceOfType(i)&&i.u())return!0}return!1},E:function(n){var t="";n===2?t=_nbs.a.gf:n===4?t=_nbs.a.an:n===8&&(t=_nbs.a.dg);this.n=n;this.h.a(2,t,this.r,!0,_bcs.D.C,_bcs.D.J,_u.R.Cg)},v:function(n,t){if(t){var i;(i=_g.a.a().a()).R(i.A()&~this.n);_h.h.a(_g.a.a().a().v,OwaApplication.a)}if(n){this.b=[];this.d=[];this.a=0;this.x()}},x:function(){while(this.a<this.e.y.length){var n=this.e.y[this.a];if(_g.F.isInstanceOfType(n)&&n.O()){this.D(String.format(_nbs.a.ON,n.bh.Subject));this.k(!0);return}Array.add(this.b,n.bh.ItemId);this.a++}this.b.length>0&&this.w(this.b,0,!this.d.length);this.d.length>0&&this.w(this.d,1,!0);this.a=0},A:function(){this.t(this.d)},z:function(){this.t(this.b)},t:function(n){var t=this.e.y[this.a];Array.add(n,t.bh.ItemId);this.k(!1);this.a++;this.x()},y:function(){this.k(!1)},w:function(n,t,i){var r=new _h.bd(n,"MoveToDeletedItems",0);r.o=t;r.d=this.m;r.p=1;if(i){var u=this;r.z(function(n){$a(u.f)||u.f()})}OwaApplication.a.a(r);i&&($a(this.g)||this.g())}};_d.Z=function(n,t,i,r){this.d=new _fm.i(t,_nbs.a.IF,_d.A.b(),0,null,null,!1,!1,!1);this.c=new _fm.i(i,_u.R.aL,null,0,null,null,!1,!1,!1);this.f=new _fm.i(n,_nbs.a.oB,_d.A.e(),0,null,null,!1,!1,!1);this.e=new _fm.i(r,null,_d.A.d(),0,null,null,!0,!1,!1)};_d.Z.prototype={f:null,d:null,c:null,e:null,b:null,a:null,g:function(n,t){_js.Trace.logInfo(_d.Z.a,"Initializing task edit commanding bar");if(!this.a){this.a=new _fm.o;this.a.P=!0;this.a.E=!0;this.a.b(this.f);this.a.b(this.d);this.b=n;this.a.b(this.b);this.a.b(this.c);this.a.b(this.e)}this.b.a(!t);return this.a}};_d.C=function(n,t){_d.C.initializeBase(this);_a.b.a(n,"contextMenuDisplayName");_a.b.a(t,"viewFilter");this.b=n;this.a=t};_d.C.prototype={a:"All",b:null,c:!1,d:function(n){if(this.c!==n){this.c=n;this.ea("IsSelected")}return n}};_d.bF=function(){_d.bF.initializeBase(this);this.b=new _js.f;this.d();this.c(this.b.y[1])};_d.bF.prototype={b:null,a:null,c:function(n){_a.b.a(n,"filterOption");this.a&&this.a.a!==n.a&&this.a.d(!1);this.a=n;this.a.d(!0)},d:function(){this.b.a(new _d.C(_nbs.a.Rk,"All"));this.b.a(new _d.C(_nbs.a.cU,"TaskActive"));this.b.a(new _d.C(_nbs.a.RV,"TaskOverdue"));this.b.a(new _d.C(_nbs.a.ec,"TaskCompleted"))}};_d.L=function(n,t){this.e=Function.createDelegate(this,this.x);_d.L.initializeBase(this);this.m(this);this.z(!0);this.a=new _d.ba(n,t,!1,!0);this.a.f();this.a.apcl("SelectedTreeNode",this.e)};_d.L.prototype={a:null,d:null,b:null,c:null,f:function(){return this.a.c()?this.d?!_g.r.b(this.d,this.a.c().bh.FolderId)&&this.a.c().a()!=="todosearch":!1:!1},A:function(n,t,i,r){var e=this,f=this;var u=new _C(function(){n.a();e.g(!1)},_d.L.a,this,"CanExecuteAction",function(){return f.f()});this.o(new _js.f);this.h.a(this.l(u,i));this.h.a(this.n());this.k(t);this.d=r;this.ea("CanExecuteAction");this.a.f();this.g(!0)},x:function(n,t){this.ea("CanExecuteAction")},n:function(){this.c||(this.c=new _ff.f(this.j,_u.R.ho));return this.c},l:function(n,t){this.b?this.b.a!==n&&this.b.f(n):this.b=new _ff.f(n,t,null,!0);return this.b}};_d.bG=function(n,t){_d.bG.initializeBase(this,[n]);this.e(!!t&&t.a().e().Enabled)};_d.bG.prototype={c:!1,l:function(){return this.c},e:function(n){this.c=n;return n},v:function(){return!0},w:function(){return!1}};_d.D=function(n){_d.D.initializeBase(this);_a.b.a(n,"parentTaskFolderPicker");this.b=new _js.f;this.d=n;this.z=n.h};_d.D.prototype={q:null,m:null,k:null,C:null,t:null,D:0,b:null,o:!1,F:!1,y:!1,A:null,z:null,a:!1,r:null,d:null,x:!1,h:function(n){if(n!==this.y){this.y=n;this.ea("IsEdit")}return n},V:function(){return this.b.y.length>0},p:function(n){if(this.o!==n){this.o=n;this.ea("IsSelected")}return n},O:function(n){if(n!==this.F){this.F=n;this.ea("DisableSelection")}return n},g:function(n){if(n!==this.D){this.D=n;this.ea("TreeNodeMode")}return n},P:function(n){if(n!==this.A){this.A=n;this.ea("NewNodeViewModel")}return n},X:function(n){if(n!==this.t){this.t=n;this.ea("CreateCommand")}return n},bb:function(n){if(n!==this.C){this.C=n;this.ea("RenameCommand")}return n},Y:function(n){if(n!==this.k){this.k=n;this.ea("DeleteTaskFolderPromptCommand")}return n},Z:function(n){if(n!==this.m){this.m=n;this.ea("InitiateRenameTaskFolderCommand")}return n},W:function(n){if(n!==this.q){this.q=n;this.ea("CancelRenameCommand")}return n},ba:function(n){if(n!==this.x){this.x=n;this.ea("IsCollapsed")}return n},G:function(n){this.z.a(0,n,null,!1,null,null,_nbs.a.jp)}};_d.ba=function(n,t,i,r){this.m=Function.createDelegate(this,this.n);this.r=_g.l.a("tasks").bh.FolderId;_d.ba.initializeBase(this);this.g=r;this.k=i;this.h=new _bc.b;this.d=t;this.b=n;this.b.m(this.m);this.f()};_d.ba.prototype={h:null,g:!1,k:!1,d:null,e:null,a:null,j:null,p:null,b:null,q:function(n){if(this.a!==n){this.a=n;this.ea("SelectedTreeNode")}return n},c:function(){if(!this.a||!this.b.b)return null;var n=this.a;return this.b.j(n.f.bh.TaskFolderId)},t:function(n){if(n!==this.j){this.j=n;this.ea("RootTreeNode")}return n},f:function(){this.b.b&&this.n(this.b)},n:function(n){for(var i=null,e=null,c=n.c,o=new _d.bG(this,this.d),t,f,r,u,s=0;s<c.y.length;s++){t=c.y[s];if(!$a(t)){f=new _d.E(t,this,this.d);if(!$a(t.a())){for(var h=0;h<t.a().b();h++){u=t.a().a(h);r=new _d.l(u,f,this,this.d);if(u.b()===1){e=r;if(this.k)i=r;else continue}u.bh.TaskFolderId.Id!==this.r.Id||this.k||(i=r);f.b.a(r)}o.b.a(f)}}}if(!o.b.y.length)throw Error.invalidOperation("Unable to get task folders");if(!i&&e){o.b.y[0].b.u(0,e);i=e}if($a(i))throw Error.argumentNull("Couldn't get default task folder");this.t(o);this.e=i;this.e.p(!0)}};_d.l=function(n,t,i,r){this.I=Function.createDelegate(this,this.bf);this.H=Function.createDelegate(this,this.be);this.K=Function.createDelegate(this,this.bk);this.J=Function.createDelegate(this,this.bj);this.Q=Function.createDelegate(this,this.bc);this.U=Function.createDelegate(this,this.bi);this.R=Function.createDelegate(this,this.bd);this.S=Function.createDelegate(this,this.bg);this.T=Function.createDelegate(this,this.bh);_d.l.initializeBase(this,[i]);this.f=n;this.e=t;this.c=n.bh.FolderName;this.bl(!!r&&r.a().e().Enabled);this.g(1);this.Z(new _C(this.T,_d.l.a));this.Y(new _C(this.S,_d.l.a));this.M=new _C(this.R,_d.l.a);if(n.b()){this.m.c(!1);this.k.c(!1)}this.bb(new _C(this.U,_d.l.a));this.W(new _C(this.Q,_d.l.a));this.d.g||(this.r=new _fm.f([new _fm.d(_u.R.co,null,this.m),new _fm.d(_u.R.Xv,null,this.k)]))};_d.l.prototype={j:null,i:null,M:null,n:0,f:null,c:null,e:null,N:!1,E:function(n){if(n!==this.c){this.c=n;this.ea("FolderName")}return n},L:!1,l:function(){return this.L},bl:function(n){this.L=n;return n},v:function(){return!1},w:function(){return!1},bh:function(){if(!this.a){this.P(this);this.h(!0);this.g(4)}},bc:function(){this.h(!1);this.E(this.f.bh.FolderName);this.g(1)},bi:function(){if(_js.d.b(this.c)){this.E(this.f.bh.FolderName);this.h(!1);return}if(this.c.trim()===this.f.bh.FolderName){this.h(!1);return}if(!$a(this.j)){this.j.M(this.J);this.j.N(this.K);this.j=null}var n=this.j=new _c.bv(this.f,this.c,this.d.b);n.v(this.J);n.w(this.K);this.a=!0;OwaApplication.a.a(n);this.h(!1)},bk:function(n){this.a=!1},bj:function(n){this.a=!1;this.E(this.f.bh.FolderName);this.G(this.j.t.message)},bg:function(){var n=this;this.z.a(1,String.format(_u.R.Oy,this.c),function(t,i){t&&n.M.a()},!1,null,null,_u.R.NG)},bd:function(){if(!this.a){if(!$a(this.i)){this.i.M(this.H);this.i.N(this.I);this.i=null}var n=this.i=new _c.bi(this.f,this.e.f,this.d.b);n.v(this.H);n.w(this.I);this.a=!0;this.e.a=!0;OwaApplication.a.a(n);this.N=this.o;this.p(!1);this.n=this.e.b.j(this);this.n>=0&&this.e.b.o(this.n)}},bf:function(n){this.e.a=!1;this.a=!1;this.N&&this.d.e.p(!0)},be:function(n){this.n>=0&&this.e.b.u(this.n,this);this.e.a=!1;this.a=!1;this.G(this.i.t.message)}};_d.E=function(n,t,i){this.i=Function.createDelegate(this,this.M);this.j=Function.createDelegate(this,this.N);this.J=Function.createDelegate(this,this.Q);this.I=Function.createDelegate(this,this.L);_d.E.initializeBase(this,[t]);this.f=n;this.H=n.bh.GroupName;this.E=i;this.R(!!i&&i.a().e().Enabled);this.X(new _C(this.I,_d.E.a));var r=new _C(this.J,_d.E.a);this.O(!0);this.g(1);if(!this.d.g){this.K=new _fm.d(null,_d.A.a(),r);this.r=new _fm.f([new _fm.d(_u.R.df,null,r)])}};_d.E.prototype={f:null,E:null,K:null,e:null,c:null,H:null,n:!1,l:function(){return this.n},R:function(n){this.n=n;return n},v:function(){return!0},w:function(){return!0},Q:function(){if(!this.a){if(!$a(this.c)){this.c.N(this.j);this.c.M(this.i);this.c=null}this.c=new _c.bh(this.f,this.d.b);this.c.w(this.j);this.c.v(this.i);var n=new _d.l(this.c.b,this,this.d,this.E);n.h(!0);n.O(!0);this.P(this.e=n);this.g(3)}},L:function(){if(!_js.d.b(this.e.c)){this.e.h(!1);this.e.g(2);this.c.g(this.e.c);this.a=!0;OwaApplication.a.a(this.c);this.b.a(this.e)}},M:function(n){this.b.m(this.e,!0);this.a=!1;this.G(this.c.e)},N:function(n){this.e.g(1);this.a=!1}};_d.bH=function(){_d.bH.initializeBase(this,[displayName,order])};_d.p=function(n,t,i,r,u,f,e,o,s){this.fM=Function.createDelegate(this,this.gQ);this.fN=Function.createDelegate(this,this.gR);this.fI=Function.createDelegate(this,this.fO);_d.p.initializeBase(this,[n,t,i,r,u,f,e,null,null,null,null,null,o,null,null,null]);this.bT=new _C(this.fI,_d.p.a);this.eZ=new _C(this.fN,_d.p.a);this.dO=new _d.v;this.eW=!!s&&s.a().f().Enabled;this.eY=!!s&&s.a().e().Enabled};_d.p.prototype={bT:null,eZ:null,cI:null,dO:null,cK:function(){return!0},eW:!1,eY:!1,gn:function(n,t,i){if((n&1)==1)throw Error.notImplemented();var f=new _c.bB(this.h(),this.ex,this.dF);var e=this;var r=_h.d.b(f,_h.g.a(),function(n){return new _c.R(n)});var u=new _h.q(0,this.fv());u.c=1;r.ba(u,null,null,null);this.es=!1;return r},iz:function(){return!1},gf:function(n){this.M(!0);var i=new _y.cv(!1);var t=new _y.bn;switch(this.dF.a){case"TaskStartDate":var e=this;return new _y.bQ(i,function(n){if(_g.F.isInstanceOfType(n)&&n.m())return n.m();else if(n.bq())return n.bq().c();return null},n,null,!0);case"TaskDueDate":var o=this;return new _y.bQ(i,function(n){if(_g.F.isInstanceOfType(n)&&n.e())return n.e();else if(n.bq())return n.bq().b();return null},n,null,!0);case"ItemClass":var s=this,r=this;return new _y.bk(t,function(n){return n.bh.ItemClass},function(n){return $a(n)?"":n.startsWith("IPM.Note")?_nbs.a.BU:n.startsWith("IPM.Task")?_nbs.a.UN:_nbs.a.fg},_u.R.fz);case"TaskStatus":var u=this,f=this;return new _y.bk(t,function(n){if(_g.F.isInstanceOfType(n))return n.i();else if(n.bq())return n.bq().e()?"Completed":"NotStarted";return null},function(n){var t=new _d.bN;return t.a(n,!0)},_u.R.fz);default:return _lv.g.prototype.gf.call(this,n)}},fr:function(n,t){var i=this;this.dO.l(this.dy,this.h(),function(){i.et()},null)},fx:function(n,t){if(!$a(this.dP)){if(!_g.r.b(this.dw.d(),this.dP)){var i=n;if(i&&i.length>0){var r=new _h.be(i,this.dP,0);OwaApplication.a.a(r)}}this.et()}},hK:function(){if(this.dH)if(_g.F.isInstanceOfType(this.dH)){var n=this.dH;var t=n.i()==="Completed"?"Today":"MarkComplete";this.fG(t,[n],0)}else _lv.a.prototype.hK.call(this)},fG:function(n,t,i){if(t){var h=t.length;if(!h)return;for(var e=[],o=[],s=0;s<h;s++){var r=t[s];if(_g.F.isInstanceOfType(r)){if(r.u()){_a.F.a(_u.R.Zj,1);return}Array.add(e,r)}else Array.add(o,r)}if(e.length>0){var u=new _c.bk(n,this.h(),this.ey());u.g(e);this.hc=u;u.z(this.fM);OwaApplication.a.a(u)}if(o.length){var f=new _h.by(n,this.h());f.g(o);f.e=this.ey();this.hc=f;OwaApplication.a.a(f);this.ff()}else this.ff()}},hk:function(){return"Sort by"},ge:function(n){return n.c(this)},iX:function(){_lv.a.prototype.iX.call(this);var n=this;this.dZ.apcl("IsShown",function(t,i){if(n.dZ.i&&n.dH){var r=n.dZ.h.y[n.dZ.h.y.length-1];r.a(_g.F.isInstanceOfType(n.dH))}})},fO:function(){var n=this.k();n&&this.fG("MarkComplete",n,0)},gR:function(){var n=this.k();n&&this.fG("Today",n,0)},gQ:function(n){$a(this.cI)||this.cI.d()}};_d.bb=function(n,t,i,r,u,f,e,o,s){this.h=n;this.i=t;this.a=i;this.e=r;this.g=u;this.f=f;this.b=e;this.d=o;this.c=s};_d.bb.prototype={h:null,i:null,a:null,g:null,e:null,f:null,b:null,d:null,c:null,j:function(){return new _d.p(this.h,this.i,this.a,this.e,this.g,this.f,this.b,this.d,this.c)}};_d.q=function(n,t,i){_d.q.initializeBase(this);this.g(!1);this.h=t;this.f=i;this.c=!!i&&i.a().e().Enabled};_d.q.prototype={f:null,d:0,b:!1,e:null,a:null,h:null,j:function(){return this.b?_u.R.Op:_u.R.iE},g:function(n){if(this.b!==n){this.b=n;this.ee("IsExpanded","FolderPaneExpandCollapseButtonLabel")}this.m(this.b?this.c?_d.q.c:_d.q.b:_d.q.a);return n},c:!1,m:function(n){if(this.d!==n){this.d=n;this.ea("Width")}return n},k:function(){this.a=new _d.ba(this.h,this.f,!0,!1);this.a.f()}};_d.bI=function(){_d.bI.initializeBase(this,[!1])};_d.bI.prototype={g:function(n){var t=this.d.m;return new _h.y(t,this.f)},w:function(){this.c.a(new _d.r(_nbs.a.Yr,_nbs.a.RM,_u.R.XJ,_u.R.Wo,"Ascending",11,"TaskDueDate",!0));this.c.a(new _d.r(_nbs.a.gh,_nbs.a.SA,_u.R.XJ,_u.R.Wo,"Ascending",10,"TaskStartDate",!0));this.c.a(new _d.r(_nbs.a.v,_nbs.a.ml,_nbs.a.ZK,_nbs.a.kz,"Ascending",12,"TaskStatus",!0));this.c.a(new _d.r(_u.R.XO,_u.R.fU,_u.R.MM,_u.R.YW,"Ascending",8,"Subject",!0));this.c.a(new _d.r(_u.R.dP,_u.R.UE,_u.R.Ix,_u.R.PO,"Descending",4,"HasAttachments",!0));this.c.a(new _d.r(_u.R.NI,_u.R.YK,_u.R.ag,_u.R.Xr,"Descending",5,"Importance",!0));this.c.a(new _d.r(_u.R.SS,_u.R.EH,_u.R.SD,_u.R.ZA,"Ascending",6,"ItemClass",!0))}};_d.bJ=function(n,t){this.b=n;this.c=!!t&&t.a().e().Enabled};_d.bJ.prototype={b:null,c:!1,a:function(n,t){return this.c?new _d.Q(this.b,n,t):new _d.w(this.b,n,t)}};_d.r=function(n,t,i,r,u,f,e,o){_d.r.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.m=e};_d.r.prototype={m:"FolderId"};_d.e=function(){_d.e.initializeBase(this)};_d.e.prototype={b:function(){return this.ec(_d.e.c)},j:function(n){this.eb(_d.e.c,n);return n},c:function(){return this.ec(_d.e.d)},e:function(n){this.eb(_d.e.d,n);return n},g:function(){return this.ec(_d.e.a)},h:function(n){this.eb(_d.e.a,n);return n},d:function(){return this.ec(_d.e.f)},f:function(n){this.eb(_d.e.f,n);return n},a:function(){return this.ec(_d.e.b)},i:function(n){this.eb(_d.e.b,n);return n},V:function(){return this.c()?null:[this.d()]},bR:function(){return null},bs:function(){return null},cA:function(){return this.ec(_d.e.e)},bS:function(n){this.eb(_d.e.e,n);return n}};_d.c=function(n,t,i,r,u,f){this.ca=Function.createDelegate(this,this.cO);this.bv=Function.createDelegate(this,this.cN);this.bw=Function.createDelegate(this,this.cP);this.bO=Function.createDelegate(this,this.ce);this.bb=Function.createDelegate(this,this.cK);this.bu=Function.createDelegate(this,this.cJ);this.bY=Function.createDelegate(this,this.cL);this.bZ=Function.createDelegate(this,this.cM);this.bt=Function.createDelegate(this,this.cI);this.cc=Function.createDelegate(this,this.bo);this.bT=Function.createDelegate(this,this.cp);this.bW=Function.createDelegate(this,this.cz);this.bP=Function.createDelegate(this,this.cn);this.bU=Function.createDelegate(this,this.cr);this.bX=Function.createDelegate(this,this.cH);this.bN=Function.createDelegate(this,this.cm);this.cb=Function.createDelegate(this,this.cQ);this.bR=Function.createDelegate(this,this.co);this.cd=Function.createDelegate(this,this.bJ);this.bV=Function.createDelegate(this,this.cs);this.j=this.c;_d.c.initializeBase(this);this.D=n;this.L=t;this.bf=i||null;this.bB=r;this.bi=u;this.bg=f;this.bE=new _C(this.bV,_d.c.a);this.X=new _C(this.cd,_d.c.a);this.P=new _C(this.bR,_d.c.a);this.W=new _C(this.cb,_d.c.a);this.bc=new _C(this.bN,_d.c.a);this.bn=new _C(this.bX,_d.c.a);this.be=new _C(this.bU,_d.c.a);this.bC=new _C(this.bP,_d.c.a);this.H=new _C(this.bW,_d.c.a);this.bD=new _d.Z(this.X,this.bc,this.P,this.W);this.I=new _bc.b;this.Y=new _d.v;this.C()&&this.cj();this.D.k(this.bT);this.D.i(this.cc);this.bA=!!u&&u.a().e().Enabled;this.bz=!!u&&u.a().f().Enabled};_d.c.prototype={bf:null,bi:null,bg:null,D:null,L:null,A:null,z:!1,bl:!1,v:null,x:null,V:!1,bk:!0,y:!1,bs:!1,U:!1,bE:null,X:null,P:null,W:null,bc:null,bn:null,be:null,bC:null,bH:null,F:null,J:null,G:null,I:null,H:null,bj:null,M:null,R:null,E:null,Y:null,bM:null,bI:null,S:!1,bm:!1,T:!1,O:null,bB:null,bh:null,bF:null,bD:null,k:function(n){this.ef("NewTaskClosed",n)},m:function(n){this.ef("TaskDelete",n)},n:function(n){this.ef("TaskEditing",n)},ci:function(){return this.L.f()},cg:function(){return this.v?this.v.c:null},bp:function(n){if(this.T!==n){this.T=n;this.ea("IsSaving")}return n},N:function(n){if(this.V!==n){this.V=n;this.ee("Loading","HideTaskForm")}return n},cl:function(n){if(this.bk!==n){this.bk=n;this.ea("HideTaskForm")}return n},cv:function(){return this.V||!this.bk},b:function(){return this.y},K:function(n){if(this.y!==n){this.y=n;this.ea("IsEditMode");this.ek("TaskEditing",this,n);if(this.y){this.bl&&this.bo();this.v&&(this.bM=new _a.ek(this.v))}}return n},f:function(n){if(this.z!==n){this.z=n;this.ea("IsNewTask");if(this.z){this.x=null;this.ck();this.K(!0)}}return n},bL:function(n){if(this.U!==n){this.U=n;this.ea("IsShowDetails");this.bo()}return n},cu:function(){return this.D.a()!=="Mouse"},a:function(n){if(this.x!==n){_a.l.b(_d.c.a,"TasksOpen.ItemOpen");this.x&&this.x.remove_onCacheOperation(this.bt);this.x=n;this.ea("CurrentTask");this.x&&this.x.add_onCacheOperation(this.bt);this.f(!1);this.ck()}return n},br:function(n){if(this.v!==n){this.v=n;this.ea("TaskViewModel");this.ea("IsReadOnly")}return n},bK:function(n){this.bF=n;this.ea("EditorCallContext");return n},cf:function(){if(!this.bj){var n=this;this.bj=new _C(function(){n.bK(new _cmc.x)},_d.c.a)}return this.bj},cy:function(){if(!this.F){this.F=new _js.f;this.F.a("NotStarted");this.F.a("InProgress");this.F.a("Completed");this.F.a("WaitingOnOthers");this.F.a("Deferred")}return this.F},cx:function(){if(!this.J){this.J=new _js.f;this.J.a("High");this.J.a("Normal");this.J.a("Low")}return this.J},ct:function(){if(!this.G){this.G=new _js.f;this.G.a(0);this.G.a(1);this.G.a(2);this.G.a(3)}return this.G},C:function(){return!this.D.c()},d:function(n){if(this.S!==n){this.S=n;this.ea("IsDiscoveryMode");this.ea("IsReadOnly")}return n},e:function(n){if(this.bm!==n){this.bm=n;this.ea("IsItemAttachment");this.ea("IsReadOnly")}return n},bG:function(){var n=!1;this.v&&this.v.a&&this.v.a.u()&&(n=!0);return this.S||n||this.bm},cw:function(){return!this.C()&&this.bz},p:function(){return this.A},g:function(n){this.A=n;return n},by:function(){return!1},cR:function(n){if(this.E!==n){this.E=n;this.ea("ComposeRecurrenceViewModel")}return n},bx:function(){return 1},w:function(){return null},ch:function(){if(this.y){this.H&&this.H.a();return this.bM.c.length>0||this.v.i.b()!==this.v.a.t()||this.v.j.b()!==this.v.a.z()||!_g.br.a(this.v.p.b(),this.v.a.A())||this.v.d.bw()||this.v.l}else return!1},h:function(n){this.bI=n;return n},bA:!1,bz:!1,c:function(n){if(!this.I.i)if(this.ch()){var t=this;this.I.a(2,_nbs.a.Nj,function(i,r){if(i){t.C()&&(t.bs=!0);t.Q()}n&&n(i)},!1,_u.R.aL,_nbs.a.lv,_nbs.a.EW)}else if(n){this.y&&this.Q();n(!0)}},t:function(n){this.bH=n;this.cj()},r:function(){var n=new _c.i(500,[this.x.bh.ItemId],0,this.S);n.w(this.bZ);n.v(this.bY);this.N(!0);OwaApplication.a.a(n)},cC:function(){_y.hO.prototype.cC.call(this);this.bl=!0;this.z&&this.bo()},cD:function(){_y.hO.prototype.cD.call(this);this.bl=!1},q:function(n){return this.bD.g(n,this.z)},cA:function(){var n={};if(this.x.br()&&this.x.br().b()>0){var t=this.x.br().f();n["Tasks reading pane item categories"]=t}return n},ck:function(){this.N(!1);this.K(!1);this.z?this.bd():this.x?!this.x.y()&&this.x.by()&&this.x.by().bh.Value?this.bd():this.r():this.br(null)},cI:function(n,t){var i=t;i.a!=="NeedsUpdate"||this.y||this.r()},cL:function(n){this.N(!1);this.cl(!1);var t=[_nbs.a.lk,n.t.message];_a.F.b(t,0,this.A)},cM:function(n){var t=n;if(this.x&&t.e.length===1&&t.e[0].Id===this.x.bh.ItemId.Id){var i=_h.e.a().a(this.x.bh.ItemId.Id);this.x=i;this.x.q(!1);this.bd();this.N(!1);this.cl(!0)}},bd:function(){this.br(new _d.bs(this.x,this.bB,this.D,!1));this.bL(this.v.T());this.v.apcl("DueDate",this.bu);this.v.apcl("Status",this.bu);this.v.apcl("ReminderIsSet",this.bb);this.v.apcl("ReminderDueBy",this.bb);this.v.apcl("IsPrivate",this.bb);this.cG();this.z?_a.l.a("TasksCompose.New"):_a.l.a("TasksOpen.ItemOpen")},cK:function(n,t){this.bG()||this.y||this.bJ()},cJ:function(n,t){this.v.Z()},cB:function(){this.O=new _y.ck(this.ci(),this.bO,this.bC,this.bH)},cn:function(){this.ce(null,null,!0,null)},cz:function(){this.bK(new _cmc.c(!1))},ce:function(n,t,i,r){var f=_g.bm.a(this.x.br(),i,t?t.bh.Name:null,n?n.bh.Name:null);if(f){var u=new _h.cl([f],null,null);u.g([this.x]);OwaApplication.a.a(u)}},cs:function(){this.K(!0)},bJ:function(){if(this.v.bd())if(this.T){_js.Trace.logInfo(_d.c.a,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.bp(!0);else{this.I.a(0,this.v.k,null);return}this.H&&this.H.a();this.z&&!this.v.l?this.cq():this.cT(this.v.l)},cq:function(){var i=this.v.U();var t=new _c.N(i,this.bI);var n=this;t.w(function(i){n.br(null);n.K(!1);n.f(!1);n.bp(!1);n.N(!0);n.C()?n.A&&n.A():n.ek("NewTaskClosed",n,t.b)});t.v(this.bw);OwaApplication.a.a(t)},cT:function(n){var r=this.v.U();var i=new _c.S(r);var t=this;i.w(function(i){t.K(!1);t.bp(!1);t.N(!0);if(t.C()){t.x&&_h.d.a(t.x,"NeedsUpdate",t.x.y(),!0,function(n,t){n.q(t)});t.A&&t.A()}else if(n){var r=t.v?t.v.a.bh.ItemId:null;t.ek("NewTaskClosed",t,r)}else t.r()});i.v(this.bw);OwaApplication.a.a(i)},cP:function(n){var t=n;if(t&&t.t){this.cg().e(this.v.V());var i=_y.t.c(t.t,41,51,63,700,88,89,42,41);this.cg().a(i);this.bp(!1)}},co:function(){var n=this;this.c(function(t){t&&n.Q()})},Q:function(n){this.K(!1);if(this.v&&this.v.l&&!n){var t=new _js.f;t.a(this.v.a);this.Y.l(t,null,null,null)}if(this.z){this.br(null);this.ek("NewTaskClosed",this,null)}else this.bd();this.f(!1);this.C()&&this.A&&this.A()},cQ:function(){if(this.v.d.h()){this.I.a(0,_nbs.a.Ih,null);return}var t={};this.z||(t.ItemID=this.x.bh.ItemId);var n=new _d.e;n.f(this.x);n.j(this.y);n.e(this.z);if(this.y){this.H&&this.H.a();n.h(this.v.bm());n.i(this.v.l);if(n.a()){n.e(!1);n.f(this.v.a)}}this.D.g(ITaskReadingPaneViewModelPopOutFactory,null,t,_bc.c.a(),n,!1);this.Q(!0)},cm:function(){if(this.bi&&this.bi.a().w().Enabled&&this.L&&this.L.p()&&this.L.p().AttachmentDataProviderAvailable){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_js.Trace.logInfo(_a.a.i,"Opening OWA's file picker from calendar compose");this.cS(n)}else{_js.Trace.logInfo(_a.a.a,"Opening OS's file picker");this.v.d.f(!1,null,null)}},cS:function(n){if(this.bg){var t=this;this.bg.a(function(i){t.bh=i;if(t.bh){var r=t.D;t.bh.a(t.v.d,n,!0,r.t||(r.t=Function.createDelegate(r,r.d)),null,!1)}})}},cH:function(){this.v.D(_a.c.a().f());this.bJ()},cj:function(){this.cB();this.M=new _fm.f([new _fm.d(_u.R.Xv,null,this.be),this.O.c()]);this.C()||this.M.h.a(new _fm.d(_u.R.OU,null,this.W));this.R=new _fm.f([new _fm.d(_u.R.Xv,null,this.be),this.O.c(),new _fm.d(_nbs.a.Vy,null,this.bn)]);this.M.apcl("IsShown",this.bv);this.R.apcl("IsShown",this.bv)},cN:function(n,t){(this.M.i||this.R.i)&&this.O.a(this.cA(),1)},cr:function(){if(!this.bG())if(this.C()){var n=new _js.f;n.a(this.x);this.Y.l(n,this.x.bh.ParentFolderId,null,this.A)}else this.ek("TaskDelete",this,this.x)},cG:function(){this.cR(new _cm.l(this.v.p,this.L.a().w().bh.WorkDays,new _bc.b,this.D,!1));this.E.apcl("RecurrenceSelected",this.ca);this.E.g(!1)},cO:function(n,t){this.E.d&&!_cc.B.isInstanceOfType(this.E.d)&&this.E.g(!0)},cp:function(n){if(!this.bs&&this.ch()){n.a(_nbs.a.Nj);!this.C()&&this.bf&&this.bf.a(_y.v,new _y.v(3,null))}else this.bs=!1},bo:function(){this.cf()&&this.cf().a()}};_d.br=function(n,t,i,r,u,f){this.f=n;this.g=t;this.c=i;this.b=r;this.e=u;this.d=f};_d.br.prototype={f:null,g:null,c:null,b:null,e:null,d:null,a:function(){return new _d.c(this.f,this.g,this.c,this.b,this.e,this.d)}};_d.M=function(n,t,i,r,u,f){this.g=n;this.h=t;this.d=i;this.c=r;this.f=u;this.e=f};_d.M.prototype={g:null,h:null,d:null,c:null,f:null,e:null,b:function(n,t,i){var e=n.ItemID;var r=new _d.c(this.g,this.h,this.d,this.c,this.f,this.e);if($a(e))r.f(!0);else{var l=new _g.g(e);var u=new _g.F;u.bG(l);_h.e.a().b(e,u);r.a(u)}var c=n.DiscoveryMode;!$a(c)&&Boolean.parse(c)&&r.d(!0);var s=n.Source;if(!_js.d.b(s)){var o=_a.d.b(_d.M.a,"TasksOpen.ItemOpenFromSource");var f=new _a.q;f.b("SR",s);var h=n.Reason;_js.d.b(h)||f.b("RS",h);o.j=f.toString();_a.d.a(o)}return r},a:function(n,t,i){var u=n;var r=new _d.c(this.g,this.h,this.d,this.c,this.f,this.e);var f=this;r.apcl("TaskViewModel",function(n,t){if(u.b()&&r.v){r.K(u.b());r.v.bl(u.g());r.v.l=u.a();r.bL(r.v.T())}});r.a(u.d());r.f(u.c());return r}};_d.bs=function(n,t,i,r){this.O=Function.createDelegate(this,this.bi);this.M=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bj);this.L=Function.createDelegate(this,this.bf);this.N=Function.createDelegate(this,this.bh);this.Q=Function.createDelegate(this,this.bk);this.K=Function.createDelegate(this,this.be);_d.bs.initializeBase(this);this.H=i;this.A=r;this.a=n?n:_d.bs.a();this.ba(this.a);this.bq(new _y.t);this.Z();this.x=new _a.ek(this.a);if(t){var u=this;t.a(function(n){if(r)u.I(n.a(u.a.bh.ItemId,u.a.S()?u.a.S().e:new _js.f,!1,!0,null,!0,u.c,null));else{u.G=n.a(u.a.bh.ItemId,u.a.S()?u.a.S().e:new _js.f,!0,!0,null,!0,null,null);u.I(n.d(u.a.bh.ItemId,u.a.S()?u.a.S().e:new _js.f,!1,3,!0,null,!0,new _y.t,null,null))}u.d.p(u.K)})}this.apcl("Status",this.Q);this.apcl("PercentComplete",this.N);this.apcl("CompleteDate",this.L);this.apcl("StartDate",this.P);this.apcl("DueDate",this.M);this.apcl("ReminderIsSet",this.O)};_d.bs.a=function(){var n=new _g.F;n.dC("Normal");n.cr(new _g.B(new _g.D("Text","")));return n};_d.bs.prototype={H:null,A:!1,l:!1,t:null,n:null,r:null,w:null,m:null,q:!1,v:!1,e:null,g:null,o:"Low",h:"NotStarted",f:null,R:null,b:null,a:null,j:null,i:null,y:null,F:null,c:null,G:null,d:null,p:null,k:null,S:null,C:null,x:null,bv:function(n){if(this.y!==n){this.y=n;this.ea("Subject")}return n},bq:function(n){if(this.c!==n){this.c=n;this.ea("InfoBarViewModel")}return n},X:function(n){if(!_a.c.c(this.b,n)){this.b=n;this.ea("DueDate")}return n},Y:function(n){if(!_a.c.c(this.f,n)){this.f=n;this.ea("StartDate")}return n},z:function(n){if(this.h!==n){this.h=n;this.ea("Status")}return n},bp:function(n){if(this.o!==n){this.o=n;this.ea("Importance")}return n},D:function(n){if(!_a.c.c(this.g,n)){this.g=n;this.ea("CompleteDate")}return n},J:function(n){if(this.e!==n){this.e=n;this.ea("PercentComplete")}return n},br:function(n){if(this.v!==n){this.v=n;this.ea("IsPrivate")}return n},bu:function(n){if(this.q!==n){this.q=n;this.ea("ReminderIsSet")}return n},E:function(n){if(!_a.c.c(this.m,n)){this.m=n;this.ea("ReminderDueBy")}return n},bs:function(n){if(this.w!==n){this.w=n;this.ea("Mileage")}return n},bn:function(n){if(this.r!==n){this.r=n;this.ea("BillingInformation")}return n},bo:function(n){if(this.n!==n){this.n=n;this.ea("Companies")}return n},W:function(n){if(this.t!==n){this.t=n;this.ea("Body")}return n},bt:function(n){this.C!==n&&(this.C=n);return n},T:function(){return!!this.f||this.h!=="NotStarted"||this.o!=="Normal"||!!this.g||_a.bC.a(this.e)>0||this.v||this.q||!!this.m||this.j.b()>0||this.i.b()>0||!_js.d.a(this.w)||!_js.d.a(this.r)||!_js.d.a(this.n)||!!this.p.b()},bd:function(){var t=!0;if(this.d.h()){this.k=_nbs.a.Ih;return!1}if(_js.d.b(this.y)){this.k=_nbs.a.UG;return!1}if(this.b&&this.f&&this.f.b(this.b)>0){this.k=_nbs.a.RN;return!1}var n=_a.bC.a(this.e);if(isNaN(n)||n<0||n>100){this.k=_nbs.a.Ox;return!1}if(isNaN(_a.bC.a(this.j.a))||_a.bC.a(this.j.a)<0){this.k=_nbs.a.Nn;return!1}if(isNaN(_a.bC.a(this.i.a))||_a.bC.a(this.i.a)<0){this.k=_nbs.a.hM;return!1}if(this.j.b()>1525252319){this.k=_nbs.a.HI;return!1}if(this.i.b()>1525252319){this.k=_nbs.a.XX;return!1}return t},U:function(){this.bb(this.a);return this.x},I:function(n){if(this.d!==n){this.d=n;this.ea("EditAttachmentWellViewModel")}return n},bm:function(){var n=this.a.M();this.bb(n);return n},bl:function(n){this.ba(n)},V:function(){this.F||(this.F=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.F},Z:function(){this.c.e(this.V());if(!this.A){this.a.u()&&this.c.a(10010);if(this.h==="Completed")this.c.a(10080,this.g.a(1));else if(this.b){var t=_a.cn.a(_a.c.a().f(),this.b.f()).a/864e5;var n=Math.floor(t);n?n===1?this.c.a(10040):n>1&&n<15?this.c.a(10050,n.toString()):n===-1?this.c.a(10030):n<-1&&n>-15?this.c.a(10070,Math.abs(n).toString()):n<-14&&this.c.a(10060):this.c.a(10020)}}},ba:function(n){this.y=n.bh.Subject;this.R=n.N()?n.N().x():null;this.b=n.e()?n.e().x():null;this.f=n.m()?n.m().x():null;this.h=n.i();this.o=n.bx();this.g=n.g()?n.g().x():null;this.e=n.bh.PercentComplete?n.bh.PercentComplete:"0";isNaN(_a.bC.a(this.e))&&(this.e="0");this.v=n.bF()==="Private";this.q=n.bh.ReminderIsSet;this.m=n.eT()?n.eT().x():null;this.w=n.bh.Mileage;this.r=n.bh.BillingInformation;this.bt(n.E());var t=n.C()?n.C().bh.Value:"";_js.d.a(t)&&!this.A&&(t="<html><head></head></html>");if(this.A){var u;var f,e;e=_a.u.e(t,f={val:u}),u=f.val,e;t=u.trim()}this.W(t);var r=new Sys.StringBuilder;if(!$a(n.f()))for(var i=0;i<n.f().b();i++){r.append(n.f().a(i));i!==n.f().b()-1&&r.append(" ")}this.n=r.toString();this.j=new _d.N(n.z());this.i=new _d.N(n.t());this.p=new _cc.co(n.M(),new _gg.GU,_a.c.a(),null)},bb:function(n){n.bV(this.y);_a.c.c(n.e(),this.b)||n.T(this.b);_a.c.c(n.m(),this.f)||n.W(this.f);n.i()!==this.h&&n.r(this.h);n.bx()!==this.o&&n.dC(this.o);_a.c.c(n.g(),this.g)||n.H(this.g);n.bh.PercentComplete!==this.e&&n.L(this.e);var r=this.v?"Private":"Normal";n.bF()!==r&&n.cQ(r);n.cP(this.q);_a.c.c(n.eT(),this.m)||n.iU(this.m);n.V(this.w);n.Q(this.r);n.bH(this.C);if(n.C()&&n.C().bh.Value!==this.t){var i;i=this.H.a()!=="Mouse"?new _g.D("Text",this.t):new _g.D("HTML",this.t);var u=new _g.B(i);n.cr(u)}var t=new(_a.fJ.$$(String));_js.d.a(this.n)||t.c(this.n);this.bc(n.f(),t)||n.be(t);n.z()!==this.j.b()&&n.X(this.j.b());n.t()!==this.i.b()&&n.P(this.i.b());n.i()!=="Completed"&&this.x.b("CompleteDate");if(this.x.a("CompleteDate")){this.x.b("Status");this.x.b("PercentComplete")}_g.br.a(n.A(),this.p.b())||n.bg(this.p.b())},bc:function(n,t){if(n)if(t){if(n.b()!==t.b())return!1}else return!n.b();else return!t||!t.b();for(var i=0;i<n.b();i++)if(n.a(i)!==t.a(i))return!1;return!0},bk:function(n,t){if(this.h==="Completed"){this.g||this.D(_a.c.a().f());this.J("100")}else{this.D(null);(this.h==="NotStarted"||_a.bC.a(this.e)===100)&&this.J("0")}},bh:function(n,t){var i=_a.bC.a(this.e);i?i>0&&i<100?this.z("InProgress"):i===100&&this.z("Completed"):this.z("NotStarted")},bf:function(n,t){this.g?this.z("Completed"):this.z("NotStarted")},bj:function(n,t){this.f&&(!this.b||this.b.b(this.f)<0)&&this.X(this.f)},bg:function(n,t){this.b||this.Y(null)},bi:function(n,t){if(this.q&&!this.m){var i=_a.c.a();this.b?this.b.k(i)<=0?this.E(new _a.c(i.e(),i.d(),i.i(),8,0,0)):this.E(new _a.c(this.b.e(),this.b.d(),this.b.i(),8,0,0)):this.E(new _a.c(i.e(),i.d(),i.i(),8,0,0).c(1))}},be:function(){if($a(this.a.bh.ItemId)){var i=new _a.ek(this.a);var t=new _c.N(i,this.S);var n=this;t.z(function(i){n.a.bG(t.b);n.l=!0;$a(n.d)||n.d.e(n.a.bh.ItemId,n.a.S()?n.a.S().e:new _js.f,null)});OwaApplication.a.a(t)}else this.l&&($a(this.d)||this.d.e(this.a.bh.ItemId,this.a.S().e,null))}};_d.N=function(n){_d.N.initializeBase(this);this.d(n)};_d.N.prototype={c:0,a:null,e:function(n){if(this.a!==n){this.a=n;this.bk("WorkAmount")}return n},f:function(n){if(this.c!==n){this.c=n;this.bk("WorkUnit")}return n},b:function(){var n=_a.bC.a(this.a);switch(this.c){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.bw;var t=_a.bC.a(this.a)===1?n.a(this.c,1):n.a(this.c,2);return String.format(_nbs.a.Oo,this.a,t)},w:function(n){if(!n||!_d.N.isInstanceOfType(n))return!1;var t=n;return this.b()===t.b()},d:function(n){this.a=n.toString();this.c=0;if(n){if(n>0){for(var r=[1,60,480,2400],f=[10,4],t=0;t<r.length-1&&n>=r[t+1];)t++;while(t>0){for(var i=0;i<f.length;i++)for(var u=1;u<=f[i];u++)if(!(n%(r[t]*u/f[i]))){this.a=(n/r[t]).toString();this.c=t;return}t--}}}else this.c=1}};_d.b=function(n){this.i=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.w);this.h=Function.createDelegate(this,this.r);this.n=Function.createDelegate(this,this.I);this.k=Function.createDelegate(this,this.G);this.m=Function.createDelegate(this,this.p);this.l=Function.createDelegate(this,this.H);_d.b.initializeBase(this);this.e=n;this.L(new _C(this.l,_d.b.a));this.M(new _C(this.m,_d.b.a));this.K(new _C(this.k,_d.b.a));this.c=new _bc.b;this.q(_g.a.a().c().bh.PlayOnPhoneDialString);this.f()};_d.b.prototype={a:null,e:null,c:null,D:function(){return this.ec(_d.b.h)},L:function(n){this.eb(_d.b.h,n);return n},E:function(){return this.ec(_d.b.i)},M:function(n){this.eb(_d.b.i,n);return n},C:function(){return this.ec(_d.b.f)},K:function(n){this.eb(_d.b.f,n);return n},x:function(){return this.ec(_d.b.b)},g:function(n){this.eb(_d.b.b,n);return n},y:function(){return this.ec(_d.b.d)},d:function(n){this.eb(_d.b.d,n);return n},A:function(){return this.ec(_d.b.g)},J:function(n){this.eb(_d.b.g,n);return n},o:function(){return this.ec(_d.b.c)},q:function(n){this.eb(_d.b.c,n);return n},z:function(){return this.ec(_d.b.e)},b:function(n){this.eb(_d.b.e,n);return n},t:function(){$a(this.a)||this.p()},I:function(n){if(n.EventType!=="Reload"){var t=n;this.b(this.F(t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&this.f()}},N:function(){var n=new _g.bc;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.K(n);t.l(_d.b.a,"PlayOnPhoneNotification",this.n,1)},O:function(){var n=new _g.bc;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.K(n);t.t()},H:function(){this.b(_nbs.a.eC);var n=new _c.br(this.e.bh.ItemId.Id,this.o());this.d(!0);n.w(this.h);n.v(this.j);OwaApplication.a.a(n)},p:function(){var n=new _c.bs(this.a);this.b(_nbs.a.Jd);n.z(this.i);OwaApplication.a.a(n)},G:function(){this.J(!0)},r:function(n){this.a=n.d.PhoneCallId.Id;this.g(!1);this.N()},w:function(n){var i=n;var t=_nbs.a.ch;if(i.A&&i.A.Body){var r=i.A.Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_nbs.a.hJ;break;case"ErrorPhoneNumberNotDialable":t=_nbs.a.FT;break;case"ErrorIPGatewayNotFound":t=_nbs.a.JW;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_nbs.a.Rg;break}}this.b("");this.c.a(0,t,null);this.g(!0);this.d(!1)},F:function(n){switch(n){case"Idle":case"Disconnected":return"";case"Connecting":return _nbs.a.eC;case"Connected":return _nbs.a.XZ;default:throw Error.invalidOperation("Invalid Call State.");}},v:function(n){this.f()},f:function(){if(!$a(this.a)){this.O();this.a=""}this.g(!0);this.b("");this.d(!1)}};_d.k=function(n,t,i){_d.k.initializeBase(this);_a.b.b(t,"nativeBridge");this.w(n);this.f=!1;this.m=_g.a.a().c().bh.IsRequireProtectedPlayOnPhone;this.i=t;this.j=i;this.x(new _d.b(n));this.A()};_d.k.prototype={m:!1,i:null,j:null,f:!1,n:!1,g:null,r:null,q:!1,e:function(){return this.ec(_d.k.a)},w:function(n){this.eb(_d.k.a,n);return n},v:function(){return this.ec(_d.k.c)},z:function(n){this.eb(_d.k.c,n);return n},o:function(){return this.ec(_d.k.b)},x:function(n){this.eb(_d.k.b,n);return n},l:function(){var n=!1;this.k()&&this.f&&!this.h()&&(this.t()||this.i.b(this.i.n()))&&(n=!0);return n},p:function(){return!this.h()&&this.k()&&!this.l()&&_a.UserAgent.getInstance().bk},b:function(){return this.g},k:function(){return _g.h.u(this.e().bh.ItemClass)},y:function(n){this.n=n;this.ea("SignalCleanup");return n},h:function(){return this.m&&_g.h.h(this.e().bh.ItemClass)},a:function(n){this.r=n;return n},d:function(n){this.q=n;return n},t:function(){return _a.UserAgent.getInstance().Y},c:function(){this.y(!0);this.o().t()},A:function(){if(this.e().S())for(var t=0;t<this.e().S().b();t++){var n=this.e().S().a(t);if(n.bh.Name===this.e().q()){if(!this.h()){var i=this.j.a(n.bh.AttachmentId,!1,null);this.z(new _d.bt(n,i,this.e().bh.ItemId.Id));this.f=_g.h.h(this.e().bh.ItemClass)?!0:n.bh.ContentType==="audio/mp3"?!0:!1}if(this.l()||this.p()){this.g=new Array(1);this.g[0]=n.bh.AttachmentId.Id}break}}}};_d.bu=function(n,t){this.c=n;this.b=t};_d.bu.prototype={c:null,b:null,a:function(n){return new _d.k(n,this.c,this.b)}};_d.bX=function(){};_d.bX.registerInterface("_d.bX");_d.w=function(n,t,i){this.o=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.C);_d.w.initializeBase(this);this.q=n;this.h=t;this.g=i};_d.w.prototype={q:null,j:null,c:null,d:null,h:null,g:null,a:function(){return this.c},r:function(n){if(this.c!==n){this.c=n;this.bk("SortByContextMenu")}return n},z:function(n){if(this.j!==n){this.j=n;this.bk("SortByButtonLabel")}return n},b:function(n){this.d=new _d.bI;this.d.h=n.b;this.d.m(n.d);this.d.n(n.e);this.t();this.g.z(this.d.g(!1))},t:function(){this.r(new _fm.f(new Array(0)));this.v();this.c.h.a(new _fm.j);this.u();this.k();this.bk("SortByContextMenu")},k:function(){this.z(String.format(_u.R.Yy,_u.R.Sq,this.d.d.e()))},C:function(n){if(this.d.d.a()===n.i){this.f("ColumnId_"+n.i,!0);return}this.f("ColumnId_"+this.d.d.a(),!1);this.d.t(n);this.f("ColumnId_"+n.i,!0);this.D();this.g.z(this.d.g(!1));this.g.U(4);this.h.a(this.d);this.k()},f:function(n,t){for(var i=0;i<this.c.h.y.length;i++)if(_fm.h.isInstanceOfType(this.c.h.y[i])&&this.c.h.y[i].n===n){this.c.h.y[i].b(t);this.c.h.y[i].i(t);break}},v:function(){this.c.h.a(new _fm.n(_u.R.KW));for(var t=0;t<this.d.c.y.length;t++){var n=this.d.c.y[t];if(n.j){var i=new(_a.gi.$$(_d.r))(n,this.p);this.c.h.a(new _fm.h(n.l,null,new _C(i.a,_d.w.a),n.k,!1,null,null,"ColumnId_"+n.i))}}},u:function(){this.c.h.a(new _fm.n(_u.R.PE));for(var t=0;t<this.d.e.y.length;t++){var n=this.d.e.y[t];var i=new(_a.gi.$$(_d.bH))(n,this.o);this.c.h.a(new _fm.h(n.b,null,new _C(i.a,_d.w.a),n.a===this.d.f,!1,null,null,"Order_"+n.a))}},D:function(){for(var n=0;n<this.c.h.y.length;n++)if(_fm.n.isInstanceOfType(this.c.h.y[n])&&this.c.h.y[n].i===_u.R.PE){this.c.h.y[n+1].A("Order_"+this.d.e.y[0].a);this.c.h.y[n+1].m(this.d.e.y[0].b);this.c.h.y[n+1].i(!0);this.c.h.y[n+1].b(!0);this.c.h.y[n+2].A("Order_"+this.d.e.y[1].a);this.c.h.y[n+2].m(this.d.e.y[1].b);this.c.h.y[n+2].i(!1);this.c.h.y[n+2].b(!1);break}},A:function(n){if(n.a===this.d.f){this.f("Order_"+n.a,!0);return}this.f("Order_"+this.d.f,!1);this.f("Order_"+n.a,!0);this.d.k(n.a);this.g.z(this.d.g(!1));this.h.a(this.d);this.g.U(4)}};_d.bz=function(n){this.c=n};_d.bz.prototype={c:null,a:function(n,t,i){return new _d.d(n,t,i,this.c,_g.a.a().c().bh.UserEmailAddress,!0,!1)},b:function(n,t,i,r){return new _d.d(t,i,r,this.c,n,!1,!0)}};_d.bx=function(){_d.bx.initializeBase(this)};_d.bx.prototype={n:null,o:null,m:!1};_d.by=function(n,t,i,r,u,f,e,o,s,h){this.R=Function.createDelegate(this,this.bz);_d.by.initializeBase(this,[n,t,i,r,u,e,o,s,h]);this.S=f};_d.by.prototype={S:!1,bc:function(n,t){var i=n.b(2,_bc.f.a,t,!1,!1,null,null,0,0);var r=i.v();r?r.d(!1):i.apcl("FindRecipientViewModel",this.R);return i},L:function(){this.h().bi();_ph.f.prototype.L.call(this)},N:function(n){this.S||this.h().t.g();_ph.f.prototype.N.call(this,n)},bz:function(n,t){var i=n;var r=i.v();r.d(!1);i.rpcl("FindRecipientViewModel",this.R)}};_d.bP=function(n,t,i,r){this.m=Function.createDelegate(this,this.o);this.n=Function.createDelegate(this,this.p);_d.bP.initializeBase(this,[n,t,i,r]);this.h=new _d.O(_nbs.a.aC,this.n,this)};_d.bP.prototype={h:null,b:function(){return 0},p:function(){this.a(!0);var n=new _pcm.d(this.c().d(),this.c().e().c(0).c());n.z(this.m);OwaApplication.a.a(n)},o:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.BO);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.O=function(n,t,i){var r=this;_d.O.initializeBase(this,[t,_a.a.ct,i,_d.n.b,function(){return!i.e}]);this.g=n};_d.O.prototype={g:null};_d.n=function(n,t,i,r){_d.n.initializeBase(this);_a.b.b(n,"personaGetter");_a.b.b(t,"updatePersona");_a.b.b(i,"closeLinkPersonaCard");_a.b.b(r,"showErrorMessage");this.j=n;this.l=t;this.i=i;this.k=r};_d.n.a=function(n){var i=n.cF();var t;switch(i.length){case 0:t="";break;case 1:t=i[0].g();break;default:t=String.format(_nbs.a.Fw,i.length);break}return t};_d.n.d=function(n,t){t.val=n[_d.n.c];return!$a(t.val)};_d.n.prototype={l:null,i:null,k:null,j:null,e:!1,a:function(n){if(this.e!==n){this.e=n;this.bk(_d.n.b)}return n},c:function(){return this.j()},g:function(n){this.l(n)},d:function(){this.i()},f:function(n,t){var f=t;var i;var u,r;(r=_d.n.d(n,u={val:i}),i=u.val,r)&&(_g.bD.a(i)||(f=_nbs.a.TN));this.k(f)}};_d.y=function(n,t,i,r,u,f,e){this.g=Function.createDelegate(this,this.z);this.d=Function.createDelegate(this,this.r);_d.y.initializeBase(this);_a.b.b(n,"owaShell");_a.b.b(i,"parentSummaryCardViewModel");_a.b.b(u,"persona");_a.b.b(f,"onLinkActionCompleted");this.b=n;this.n=t;this.e=new _C(this.d,_d.y.a);this.m=new _pe.d(u,2,!1,this.b,e,8);this.j=new _pe.d(u,8,!1,this.b,e);this.j.d(1,_d.n.a(u),0);this.c=this.t(u);this.c.c(u);this.h=new _bc.b;var s=this;var o=function(n){s.h.a(0,n,null)};r?r===1?this.a=new _d.bQ(i.j,this.g,f,this.d,o):r===2&&(this.a=new _d.bS(i.j,this.g,f,this.d,o)):this.a=new _d.bP(this.g,f,this.d,o);this.f=i;this.dC(this.q())};_d.y.prototype={b:null,n:null,a:null,e:null,m:null,j:null,c:null,h:null,f:null,y:function(){return this.b.a()==="Mouse"},v:function(){return!this.a.b()},x:function(){return this.a.b()===1},w:function(){return this.a.b()===2},t:function(n){var t=new _bc.o;t.a=9;if(this.b.a()!=="TouchNarrow"){t.k=!0;t.d=!0}t.c=!0;t.i=!0;t.g=!0;return this.n.c(t,0,null)},r:function(){if(_d.y.isInstanceOfType(this.f.bS().a())){this.c.dispose();this.f.br();this.f.bS().c()}},z:function(){return this.c.L.a()}};_d.F=function(n,t,i,r,u,f,e,o){_d.F.initializeBase(this,[n,t,i,r,u,f,e]);this.p=e;this.k=o};_d.F.prototype={p:null,k:null,l:function(){return this.b.a()==="TouchWide"?1:this.b.a()==="TouchNarrow"?2:0},q:function(){if(this.b.a()==="TouchWide"){var n=new Array(1);n[0]=_y.f.a(_u.R.aL,this.e);return _y.k.a(this,n,null)}else this.b.a()==="TouchNarrow"&&this.dI(this.k.a(this.e));return null}};_d.bQ=function(n,t,i,r,u){this.q=Function.createDelegate(this,this.v);this.p=Function.createDelegate(this,this.u);this.r=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.t);_d.bQ.initializeBase(this,[t,i,r,u]);_a.b.b(n,"originalPersona");this.h=n;this.m=new _d.O(_nbs.a.SW,this.o,this);this.n=new _d.O(_nbs.a.ZD,this.r,this)};_d.bQ.prototype={h:null,m:null,n:null,b:function(){return 1},t:function(){this.a(!0);var n=new _pcm.a(this.h.d(),this.c().d());n.z(this.p);OwaApplication.a.a(n)},u:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.Vg);else{var i=t.b;this.d();this.g(i)}this.a(!1)},w:function(){this.a(!0);var n=new _pcm.f(this.h.d(),this.c().d());n.z(this.q);OwaApplication.a.a(n)},v:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.Xt);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.bR=function(){this.f=Function.createDelegate(this,this.j);_d.bR.initializeBase(this);this.g()};_d.bR.prototype={b:0,c:null,a:null,e:null,h:function(){switch(this.b){case 0:case 1:return _u.R.Vq;case 2:return _nbs.a.iA;case 3:return _nbs.a.VM;case 4:return _nbs.a.QT;default:throw Error.invalidOperation("LinkSuggestionIdsViewModel are in an unknown status: "+this.b);}},g:function(){this.d(0,null,null,null)},i:function(n){_a.b.b(n,"newPersonaId");if(!this.b||n!==this.c){this.d(1,n,null,null);var t=new _pcm.b(n);t.z(this.f);OwaApplication.a.a(t)}},j:function(n){var t=n;_ff.g.b(t.c,this.c)&&(t.t?this.k(this.c,t.t):this.l(this.c,t.b))},l:function(n,t){_a.b.b(n,"personaId");var i=$a(t)||!t.length?3:2;this.d(i,n,t,null)},k:function(n,t){_a.b.b(n,"personaId");this.d(4,n,null,t)},d:function(n,t,i,r){var u=!1;if(this.b!==n){this.b=n;u=!!(u|!0)}if(this.c!==t){this.c=t;u=!!(u|!0)}if(this.a!==i){this.a=i;u=!!(u|!0)}if(this.e!==r){this.e=r;u=!!(u|!0)}u&&this.ee("LinkSuggestionIdsStatusText","LinkSuggestionsAvailable")}};_d.bR.a=function(){};_d.bR.a.prototype={NotRetrieved:0,Retrieving:1,Available:2,NotAvailable:3,FailedToRetrieve:4};_d.bR.a.registerEnum("_d.bR.a",!1);_d.i=function(n,t,i,r,u){this.N=Function.createDelegate(this,this.bw);this.bb=Function.createDelegate(this,this.bz);this.m=Function.createDelegate(this,this.bA);this.bd=Function.createDelegate(this,this.bJ);this.W=Function.createDelegate(this,this.be);this.Y=Function.createDelegate(this,this.bs);this.O=Function.createDelegate(this,this.bC);this.P=Function.createDelegate(this,this.bD);this.M=Function.createDelegate(this,this.bv);this.bc=Function.createDelegate(this,this.bB);this.X=Function.createDelegate(this,this.bf);_d.i.initializeBase(this);_a.b.b(n,"owaShell");_a.b.b(t,"linkPersonaCardViewModelFactory");_a.b.b(i,"persona");this.d=n;this.T=t;this.C=r;this.q=new _C(this.X,_d.i.a);this.H=new _bc.b;this.r=new _js.f;this.bm(!0);this.e=new _d.bR;this.e.apcl("LinkSuggestionsAvailable",this.bc);this.f=new _js.f;this.k=new _js.f;this.b(i);n.a()==="TouchNarrow"&&u?this.dI(u.a(this.dK)):this.dC(this.bg());this.A("");this.Q=new _C(this.M,_d.i.a);this.V=new _C(this.P,_d.i.a);this.U=new _C(this.O,_d.i.a)};_d.i.prototype={d:null,T:null,q:null,Q:null,V:null,U:null,H:null,e:null,C:null,j:null,I:null,D:null,J:null,r:null,f:null,k:null,K:!1,L:null,F:!1,E:null,h:null,G:null,t:null,S:null,x:null,z:null,y:null,bn:function(n){this.ef("SearchCompletedWithResults",n)},bE:function(n){this.eg("SearchCompletedWithResults",n)},bF:function(n){if(this.I!==n){this.I=n;this.ea(_d.i.b)}return n},bG:function(n){if(this.D!==n){this.D=n;this.ea(_d.i.c)}return n},bt:function(){this.G||(this.G=new _C(this.Y,_d.i.a));return this.G},bu:function(){return this.d.a()==="Mouse"},c:function(){if(!this.h){this.h=new _y.g(this.d.a());this.h.bI(!1);this.h.J(!1);this.h.R(_nbs.a.Dm);this.h.cN(new _C(this.W,_d.i.a));this.h.bo(new _C(this.bd,_d.i.a));var n=this;this.h.apcl("IsExpanded",function(t,i){n.h.bG||n.c().k(!1)})}return this.h},bj:function(n){if(this.x!==n){this.x=n;this.ea("SelectedComponentItem");this.d.a()==="TouchNarrow"&&n&&this.v(this.n(0,n.bA,this.m))}return n},bl:function(n){if(this.z!==n){this.z=n;this.ea("SelectedSuggestionItem");this.d.a()==="TouchNarrow"&&n&&this.v(this.n(1,n.bA,this.m))}return n},bk:function(n){if(this.y!==n){this.y=n;this.ea("SelectedSearchItem");this.d.a()==="TouchNarrow"&&n&&this.v(this.n(2,n.bA,this.m))}return n},bm:function(n){if(this.K!==n){this.K=n;this.ea(_d.i.d)}return n},bH:function(n){if(this.L!==n){this.L=n;this.ea(_d.i.e)}return n},A:function(n){this.S=n;this.ea("CurrentSearchPeopleMessage");return n},bx:function(){return 0},w:function(){return null},p:function(){return this.E},g:function(n){this.E=n;return n},by:function(){return!0},b:function(n){_a.b.b(n,"newPersona");this.bi(n);this.bh()},a:function(){this.d.d(this)},br:function(){this.bj(null);this.bl(null);this.bk(null)},bA:function(n){_a.b.b(n,"newPersona");this.bi(n);this.bh()},bh:function(){this.e.g();this.e.i(this.j.d())},bf:function(){$a(this.E)||_d.y.isInstanceOfType(this.bS().a())?this.bS().c():this.E()},bi:function(n){if(this.j!==n||!this.F){this.F=!0;this.j=n;this.bF(new _pe.d(n,2,!1,this.d,this.C,8));this.bG(new _pe.d(n,4,!1,this.d,this.C));this.bo();this.bH(String.format(_nbs.a.Xi,this.D.bD));this.be()}},bo:function(){this.J=new _pcm.c(this.j,!1);this.r.g();for(var n=0;n<this.J.b.length;n++){var t=this.J.b[n];this.r.a(this.R(t,_d.n.a(t),this.M))}this.bm(this.r.y.length===1)},bB:function(n,t){this.bp()},bp:function(){if(this.e.b!==1){var o=!1;if($a(this.e.a))this.f.g();else{for(var n=0;n<this.f.y.length;n++){for(var a=this.f.y[n],v=a.bA.d(),s=!1,i=0;i<this.e.a.length;i++){var c=this.e.a[i];if(_ff.g.b(c,v)){s=!0;break}}if(!s){this.f.o(n);n--}}for(var t=0;t<this.e.a.length;t++){for(var f=this.e.a[t],u=!0,r=0;r<this.f.y.length;r++){var l=this.f.y[r];var h=l.bA.d();if(_ff.g.b(f,h)){u=!1;break}}if(u){o=!0;var e=_pc.e.a(f);e.z(this.bb);OwaApplication.a.a(e)}}}o||_a.l.a("PersonCard.ContactLinking")}},bz:function(n){var r=n;if(r.t){if(this.F){this.H.a(0,_nbs.a.QT,null);this.bf();this.F=!1}return}var e=!1;if(!$a(this.e.a)&&this.e.a.length>0)for(var u=0;u<this.e.a.length;u++){var s=this.e.a[u];if(_ff.g.b(s,r.c)){e=!0;break}}if(e){for(var i=r.b,f=this.R(i,_d.n.a(i),this.P),t=0;t<this.f.y.length;t++){var o=this.f.y[t];if(_ff.g.b(o.bA.d(),i.d())){this.f.o(t);this.f.u(t,f);return}}this.f.a(f)}this.e.a.length===this.f.y.length&&_a.l.a("PersonCard.ContactLinking")},bJ:function(){if(!_js.d.b(this.c().by)){var n=_fp.a.H(this.c().by);this.t=n;this.t.z(this.N);this.A(_bcs.D.H);this.k.g();OwaApplication.a.a(this.t)}},bw:function(n){if($a(n.t)&&$a(n.b()))throw Error.invalidOperation("The response is not processed correctly!");n===this.t&&this.bI(n);n.K(this.N)},bI:function(n){if($a(n.t)){var r=n.b();this.k.g();for(var t=0;t<r.y.length;t++){var i=r.y[t];_ff.g.b(i.d(),this.j.d())||this.k.a(this.R(i,"",this.O))}if(this.k.y.length){this.A("");this.eh("SearchCompletedWithResults")}else this.A(_nbs.a.Qw)}else this.A(_nbs.a.Fx)},bs:function(){this.c().bE(!0);this.c().k(!0)},be:function(){this.A("");this.k.g();this.c().bE(!1);this.c().h("");this.c().k(!1);this.t=null},R:function(n,t,i){var r=new _pe.d(n,10,!1,this.d,this.C,4,null,!0);r.d(1,t,0);r.br(new _C(i,_d.i.a));r.b(!0);return r},bv:function(){this.x&&this.d.a()!=="TouchNarrow"&&this.v(this.n(0,this.x.bA,this.m))},bD:function(){this.z&&this.d.a()!=="TouchNarrow"&&this.v(this.n(1,this.z.bA,this.m))},bC:function(){this.y&&this.d.a()!=="TouchNarrow"&&this.v(this.n(2,this.y.bA,this.m))},v:function(n){this.bS().d(n)}};_d.z=function(n,t,i,r,u){_d.z.initializeBase(this,[n,t,i,r,u])};_d.z.prototype={l:function(){return this.d.a()==="TouchWide"?1:this.d.a()==="TouchNarrow"?2:0},n:function(n,t,i){return this.T.e(this,n,t,i)},bg:function(){if(this.d.a()==="TouchWide"){var n=new Array(1);n[0]=_y.f.a(_u.R.aL,this.q);return _y.k.a(this,n,null)}else if(this.d.a()==="TouchNarrow")return _y.k.b(this);return null}};_d.bS=function(n,t,i,r,u){this.o=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.p);_d.bS.initializeBase(this,[t,i,r,u]);_a.b.b(n,"originalPersona");this.m=n;this.h=new _d.O(_nbs.a.SW,this.n,this)};_d.bS.prototype={m:null,h:null,b:function(){return 2},p:function(){this.a(!0);var n=new _pcm.e(this.m.d(),this.c().d());n.z(this.o);OwaApplication.a.a(n)},q:function(n){var t=n;if(t.t)this.f(t.t,_nbs.a.eP);else{var i=t.d;this.d();this.g(i)}this.a(!1)}};_d.bY=function(n,t,i,r,u,f,e,o,s,h){this.cw=Function.createDelegate(this,this.cT);_d.bY.initializeBase(this,[n,t,i,r,u,e,o,s,h,null]);this.cs=f};_d.bY.prototype={cs:null,ci:-1,bM:null,cd:null,ct:null,cc:null,bY:null,cG:function(){if(!this.bM&&this.bH()){var n=this;this.cs.a(function(t){n.bM=t.a(n.bH().y[0],!0);n.ea("LocationMapViewModel")})}return this.bM},bH:function(){this.cd||(this.cd=this.bE.bL());return this.cd},cS:function(){this.bH()&&(this.ct=this.bH().y[0].q());return this.ct},cB:function(){return this.ci===-1?!1:this.bk()===this.ci},cA:function(){return!this.cf()&&this.bF.a===2||this.cx()},e:function(){_rpc.p.prototype.e.call(this);this.bY=new _C(this.cw,_a.a.Z);this.bY.c(!this.R()&&!this.cA());this.cc="";(!this.cp()||this.bF.a===2||!this.bF.a)&&!this.bV()&&this.bI.a()!=="TouchNarrow"||(this.cc="mapErrorMessage")},cr:function(){this.ea("IsMapPivotSelected")},cT:function(){this.cf()&&this.bH()&&this.cG().a()}};_d.d=function(n,t,i,r,u,f,e){this.bh=Function.createDelegate(this,this.bL);this.bm=Function.createDelegate(this,this.bT);this.y=Function.createDelegate(this,this.cb);this.z=Function.createDelegate(this,this.cc);this.T=Function.createDelegate(this,this.bW);this.S=Function.createDelegate(this,this.bs);this.bi=Function.createDelegate(this,this.bc);this.bg=Function.createDelegate(this,this.bK);this.br=Function.createDelegate(this,this.ca);this.bj=Function.createDelegate(this,this.bO);this.bl=Function.createDelegate(this,this.bR);this.bf=Function.createDelegate(this,this.L);this.bp=Function.createDelegate(this,this.bE);this.bn=Function.createDelegate(this,this.bU);this.bo=Function.createDelegate(this,this.bV);this.bk=Function.createDelegate(this,this.bP);_d.d.initializeBase(this);if(_js.d.a(u))throw Error.argumentNull("emailAddress");this.O=n;this.t=t;this.k=i;this.bd=r;this.dC(this.bJ());this.W=u.toLocaleLowerCase();this.x=_d.d.b(u);this.J=f;this.V=e;this.Q(this.x)};_d.d.b=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetPersonaPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};_d.d.prototype={O:null,t:null,k:null,x:null,A:null,G:null,N:null,D:null,m:0,r:!1,q:0,E:null,W:null,J:!1,V:!1,P:null,K:null,M:null,v:null,I:!1,C:!1,bd:null,b:function(n){this.ef("UploadPhotoClosed",n)},d:function(n){this.eg("UploadPhotoClosed",n)},bI:function(n){this.ef("UploadPhotoSucceeded",n)},bZ:function(n){this.eg("UploadPhotoSucceeded",n)},bH:function(n){this.ef("UploadPhotoFailed",n)},bY:function(n){this.eg("UploadPhotoFailed",n)},a:function(){return this.V||_g.a.a().e().bh.SetPhoto&&this.bB()},bb:function(){return this.O.a()==="Mouse"},bC:function(){return this.O.a()==="TouchNarrow"},H:function(){this.N||(this.N=new _bc.b);return this.N},bz:function(){return!this.Y()&&_a.UserAgent.getInstance().J&&(!this.k.b(this.k.d())||!this.k.d().a().c())?!0:!1},R:function(n){if(this.I!==n){this.I=n;this.ea("IsDiscardChangesDialogShown")}return n},n:function(n){if(this.r!==n){this.r=n;this.ea("IsWorking")}return n},bM:function(){return this.bA()&&_g.a.a().e().bh.SetPhoto?new _C(this.bk,_d.d.a):null},bD:function(){return this.bB()&&_g.a.a().e().bh.SetPhoto?new _C(this.bo,_d.d.a):null},bG:function(n){this.D=n;this.ea("OpenPhotoPickerCommand");return n},bt:function(){return new _C(this.bn,_d.d.a)},bF:function(n){this.G=n;this.ea("Files");return n},l:function(){return this.bb()?0:1},h:function(){this.P||(this.P=new _C(this.bp,_d.d.a));return this.P},bw:function(){this.K||(this.K=new _C(this.bf,_d.d.a));return this.K},X:function(){this.M||(this.M=new _C(this.bl,_d.d.a));return this.M},c:function(){return new _y.f(_y.b.O(),_y.b.P(),_nbs.a.oB,this.h())},e:function(){return new _y.f(_y.b.n(),_y.b.o(),_u.R.XC,this.X())},bx:function(){return this.bb()?2:0},w:function(){return this.bj},U:null,p:function(){return this.U},g:function(n){this.U=n;return n},by:function(){return!0},f:function(){return this.m===1||this.m===2},be:function(n){if(this.m!==n){this.m=n;this.ea("CurrentState")}return n},bu:function(){return _y.f.a(_nbs.a.mi,this.bw())},Y:function(){return this.J&&this.k.b(this.k.d())&&this.k.d().a().f()},bA:function(){return this.J&&this.k.b(this.k.d())&&this.k.d().a().e()},bB:function(){return this.Y()||this.bA()||_a.UserAgent.getInstance().J},Q:function(n){this.A=n!==""?n+String.format("&sc={0}",+new Date):n;this.ea("ImageSource");return n},bv:function(){if(!this.v){this.v=new _js.f;this.v.a(new _ff.f(new _C(this.br,_d.d.a),_u.P.d,null,!0));this.v.a(new _ff.f(new _C(this.bg,_d.d.a),_u.R.Ik,null));this.v.a(new _ff.f(new _C(this.bi,_d.d.a),_bcs.D.A,null))}return this.v},cD:function(){_y.hO.prototype.cD.call(this);this.j()},j:function(){this.be(0);this.q=0;this.n(!1);this.Q(this.x);this.E=this.A;this.C=!1},bJ:function(){var n;n=this.a()?[this.c(),this.e(),this.bu()]:[this.bu()];return _y.k.a(this,n,null)},bV:function(){if(this.Y()){_js.Trace.logInfo(_d.d.a,"Call to get photo from gallery");this.k.d().c(!1,this.S,this.T);return}if(this.k.b(this.k.d())&&this.k.d().a().c()){_js.Trace.logInfo(_d.d.a,"Call to native file picker");var t=this,n=this;this.k.d().d(!1,"*",1,function(n){n.length>0&&t.bs(n[0])},function(t){n.bN(t)});return}_a.UserAgent.getInstance().J&&this.D&&this.D.a()},F:function(n,t,i){return new _phu.a(n,t,i,this.W,!this.J)},bP:function(){_js.Trace.logInfo(_d.d.a,"Call to get photo from camera");this.k.d().b(!1,this.S,this.T)},bU:function(){this.bX(this.G.b(0))},bs:function(n){var t=this.F(1,null,n);t.w(this.z);t.v(this.y);this.q=1;this.E=this.x+"&isPreview=true";this.n(!0);this.t.a(t)},bX:function(n){var t=new _at.s;t.a(n,this.bm,this.bh,_d.d.a,!1)},bT:function(n,t,i,r){var u=this.F(1,n,null);u.w(this.z);u.v(this.y);this.q=1;this.E=this.x+"&isPreview=true";this.n(!0);this.t.a(u)},cc:function(n){this.n(!1);this.Q(this.E);this.be(this.q);if(this.q===3){this.C=!0;this.eh("UploadPhotoClosed");this.eh("UploadPhotoSucceeded");this.L();this.bd.bp()}},cb:function(n){this.n(!1);var t=n.t.message;_js.d.a(t)&&(t=_nbs.a.DS);this.H().a(0,t,null);this.q===3&&this.eh("UploadPhotoFailed")},bE:function(){if(!this.r)switch(this.m){case 0:this.L();break;case 1:var t=this.F(0,"",null);t.w(this.z);t.v(this.y);this.q=3;this.n(!0);this.t.a(t);break;case 2:var n=this.F(2,"",null);n.w(this.z);n.v(this.y);this.q=3;this.n(!0);this.t.a(n);break}},bR:function(){if(!this.r)switch(this.m){case 0:this.Q("");this.be(2);break;case 1:var n=this.F(3,"",null);n.w(this.z);n.v(this.y);this.q=0;this.E=this.x;this.n(!0);this.t.a(n);break;case 2:break}},bO:function(n,t){if(this.r)return!0;if(this.C)return!1;if(this.m){this.R(!0);return!0}return!1},bN:function(n){var t=null;switch(n){case 1:t=_nbs.a.Xj;break;case 0:t=_nbs.a.lz;break;default:break}_js.d.a(t)||this.H().a(0,t,null)},bW:function(n){_js.Trace.logError(_d.d.a,n.message)},bL:function(){this.H().a(0,"Error when reading the file",null)},L:function(){this.bS()&&this.bS().a()===this&&this.dT()},ca:function(){this.C=!0;this.bc();this.bE()},bK:function(){this.C=!0;this.bc();this.L();this.bC()&&this.eh("UploadPhotoClosed")},bc:function(){this.R(!1)}};_d.bL=function(){};_d.bL.prototype={singular:1,plural:2};_d.bL.registerEnum("_d.bL",!1);_d.bK=function(){};_d.bK.prototype={a:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if($a(n))return"";if(!_js.f.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.f,"Value must be an ObservableCollection");if(!n.y.length)return"";for(var f=n,i=null,r=0;r<f.y.length;r++){i=f.y[r];i.b()||u.append(_js.d.c(e,i.a().bh.Name))}return u.toString()},b:function(n,t){throw Error.notImplemented();}};_d.bw=function(){};_d.bw.prototype={a:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_js.l.c(_d.bL,t.toString());switch(n){case 0:i=r===1?_nbs.a.Ru:_nbs.a.HW;break;case 1:i=r===1?_nbs.a.IL:_nbs.a.UQ;break;case 2:i=r===1?_nbs.a.Gk:_nbs.a.Jf;break;case 3:i=r===1?_nbs.a.Hn:_nbs.a.Kn;break}}return i},b:function(n,t){throw Error.notImplemented();}};_d.bM=function(){};_d.bM.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.mb;break;case"Personal":i=_nbs.a.TC;break;case"Private":i=_nbs.a.LB;break;case"Confidential":i=_nbs.a.s;break;default:i=_nbs.a.mb;break}return i},b:function(n,t){throw Error.notImplemented();}};_d.bN=function(){};_d.bN.prototype={a:function(n,t){if($a(n))return"";else{var i=t?t:!1;switch(n){case"NotStarted":return i?_u.R.Bk:_u.R.RB;case"InProgress":return i?_u.R.RR:_u.R.Sa;case"Completed":return i?_u.R.Ff:_u.R.Tg;case"Deferred":return i?_u.R.Fl:_u.R.MZ;case"WaitingOnOthers":return i?_u.R.hp:_u.R.PD;default:return""}}},b:function(n,t){throw Error.notImplemented();}};_d.bO=function(){};_d.bO.prototype={a:function(n,t){var i=n;return i?i.toLocaleString():""},b:function(n,t){throw Error.notImplemented();}};_d.f=function(n,t){this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);_d.f.initializeBase(this);this.g=n;this.h=t};_d.f.prototype={g:null,b:null,a:null,h:null,c:!1,d:!1,o:function(){return this.d&&_d.f.b},f:function(n){if(this.d!==n){this.d=n;this.ea("IsEnabled")}return n},i:function(n){if(this.c!==n){this.c=n;this.ea("IsLoading")}return n},j:function(n){if(this.b!==n){this.b=n;this.ea("SelectedCulture")}return n},t:function(n){if(_d.f.b!==n){_d.f.b=n;this.ea("IsInitialized")}return n},m:function(){if(_d.f.b){this.e(_g.a.a().c().bh.UserCulture);this.f(!0)}else{this.i(!0);this.e(_g.a.a().c().bh.UserCulture);this.p()}},n:function(n){if(!_d.f.b){var t;this.a=(t=new _gg.Y,t.LCID=n,t);return}var r=this;var i=_d.f.a.k(function(t){return t.LCID===n});i<_d.f.a.y.length&&this.j(_d.f.a.y[i])},e:function(n){if(!_d.f.b){var t;this.a=(t=new _gg.Y,t.Name=n,t);return}var r=this;var i=_d.f.a.k(function(t){return t.Name===n});i<_d.f.a.y.length&&this.j(_d.f.a.y[i])},p:function(){var n=new _c.bn;n.w(this.l);n.v(this.k);this.g.a(n)},q:function(n){this.i(!1)},r:function(n){_d.f.a=new _js.f;for(var i=n.c,t=0;t<i.length;t++)_d.f.a.a(i[t]);this.t(!0);this.i(!1);if(this.a){_js.d.a(this.a.Name)?this.a.LCID>0&&this.n(this.a.LCID):this.e(this.a.Name);this.a=null}this.f(!0)}};_d.m=function(n,t){_d.m.initializeBase(this);this.k=n;this.t=t};_d.m.prototype={k:null,t:null,n:null,p:null,e:null,g:!1,j:null,f:null,h:null,r:null,m:null,a:function(){return this.e},w:function(n){if(n===this.e)return n;this.e=n;this.ea(_d.m.a);return n},b:function(n){this.m=n;return n},q:function(n){if(n===this.h)return n;this.h=n;this.ea(_d.m.b);return n},v:function(n){if(n===this.j)return n;this.j=n;this.ea(_d.m.c);return n},l:function(){return this.k.a()==="TouchNarrow"?_y.hO.prototype.l.call(this):0},cC:function(){_js.Trace.logInfo(_a.a.z,"UIRPVM ->PostTransitionIn");_y.hO.prototype.cC.call(this)},cD:function(){_y.hO.prototype.cD.call(this);this.m&&this.m.G(!1)},c:function(n,t){this.n=n;this.p=t},d:function(n,t){if($a(n))throw Error.argumentNull("item");if(n!==this.e){this.w(n);this.g=t;var i=this.e.gN();this.f=_h.a.a(i);$a(this.f)?this.v(_u.R.Nt):this.v(String.format(_nbs.a.l,this.f.bh.DisplayName));this.e.bs()?this.e.bs()===3&&this.g?this.q(_nbs.a.BS):this.q(_nbs.a.iT):this.q(_nbs.a.Yn);this.x()}},x:function(){if(this.k.a()==="TouchNarrow"){var n=_y.k.a(this);n.o(new _C(this.hP,_a.a.z));this.dC(n)}}};_d.bt=function(n,t,i){this.a=n;this.b=t;this.c=i};_d.bt.prototype={a:null,b:null,c:null};CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.ih);_d.bg.registerClass("_d.bg",_a.bx);_d.T.registerClass("_d.T",_a.bx);_d.bm.registerClass("_d.bm",null,IModernGroupMembershipRequestHeaderViewModelFactory);_d.bA.registerClass("_d.bA",_a.bm);_d.bp.registerClass("_d.bp",null,ISendFailureNotificationProviderViewModel);_d.bq.registerClass("_d.bq",null,ISendNotificationProviderViewModel);_d.bv.registerClass("_d.bv",_js.u,IUserOofNotificationProvider);_d.h.registerClass("_d.h",_cm.bE);_d.bn.registerClass("_d.bn",null,IOwaOptionPeoplePickerViewModelFactory,_bc.bf);_d.s.registerClass("_d.s",_a.bx);_d.bD.registerClass("_d.bD",_a.bx);_d.t.registerClass("_d.t",_a.iX,IFolderPickerContainer);_d.bf.registerClass("_d.bf",null,_y.eP,_js.t);_d.bh.registerClass("_d.bh",null,IModuleHelpProvider);_d.V.registerClass("_d.V",_a.bx,IOpenAnotherMailboxViewModel);_d.U.registerClass("_d.U",null,IOfflineHelpProvider);_d.o.registerClass("_d.o",_a.bx);_d.X.registerClass("_d.X",_a.bx);_d.Y.registerClass("_d.Y",_a.bx);_d.B.registerClass("_d.B",_y.hO);_d.G.registerClass("_d.G",_a.bx,_y.he);_d.bd.registerClass("_d.bd",null,IApprovalRequestHeaderViewModelFactory);_d.H.registerClass("_d.H",_y.hO);_d.R.registerClass("_d.R",_lv.g);_d.bk.registerClass("_d.bk",null,IMailErrorHandler);_d.bl.registerClass("_d.bl",_a.bx);_d.j.registerClass("_d.j",_bc.i,IMailFolderPermissionsDialogViewModel);_d.K.registerClass("_d.K",_a.bx,_y.ht);_d.S.registerClass("_d.S",_a.bx,IExtendedSharedFolderViewModel);_d.bE.registerClass("_d.bE",_ph.h);_d.J.registerClass("_d.J");_d.bj.registerClass("_d.bj",null,ILinkSummaryCardViewModelFactory);_d.x.registerClass("_d.x",_js.u,IPeopleSearchSuggestionAdaptorViewModel,_y.hx,_js.z);_d.u.registerClass("_d.u",_a.bx,_y.bc);_d.P.registerClass("_d.P");_d.W.registerClass("_d.W");_d.bc.registerClass("_d.bc");_d.w.registerClass("_d.w",_js.u,_d.bX);_d.Q.registerClass("_d.Q",_d.w);_d.v.registerClass("_d.v",_a.bx);_d.C.registerClass("_d.C",_a.bx);_d.bF.registerClass("_d.bF",_a.bx);_d.L.registerClass("_d.L",_bc.i);_d.D.registerClass("_d.D",_a.bx);_d.bG.registerClass("_d.bG",_d.D);_d.ba.registerClass("_d.ba",_y.hO);_d.l.registerClass("_d.l",_d.D);_d.E.registerClass("_d.E",_d.D);_d.bH.registerClass("_d.bH",_lv.y);_d.p.registerClass("_d.p",_lv.g);_d.bb.registerClass("_d.bb");_d.q.registerClass("_d.q",_y.hO);_d.bI.registerClass("_d.bI",_lv.m);_d.r.registerClass("_d.r",_lv.l);_d.e.registerClass("_d.e",_a.dT,_bc.bl);_d.c.registerClass("_d.c",_y.hO,_bc.j,_bc.p,_bc.u,_a.iT,_js.z,Sys.IDisposable,_d.bU,_y.cV);_d.br.registerClass("_d.br",null,ITaskReadingPaneViewModelFactory);_d.M.registerClass("_d.M",null,ITaskReadingPaneViewModelPopOutFactory,_bc.bf);_d.bs.registerClass("_d.bs",_a.bx);_d.N.registerClass("_d.N",_js.u,_js.t);_d.b.registerClass("_d.b",_a.bx);_d.k.registerClass("_d.k",_a.bx,_y.ht);_d.bu.registerClass("_d.bu",null,IUMMessagePostHeaderViewModelFactory);_d.bz.registerClass("_d.bz",null,IUploadPhotoViewModelFactory);_d.bx.registerClass("_d.bx",_rpc.J);_d.by.registerClass("_d.by",_ph.f);_d.n.registerClass("_d.n",_js.u);_d.bP.registerClass("_d.bP",_d.n);_d.O.registerClass("_d.O",_C);_d.y.registerClass("_d.y",_y.hO);_d.F.registerClass("_d.F",_d.y,_y.cE);_d.bQ.registerClass("_d.bQ",_d.n);_d.bR.registerClass("_d.bR",_a.bx);_d.i.registerClass("_d.i",_y.hO,_bc.j,_bc.p,_bc.u,_a.iT,_js.z,Sys.IDisposable,_pc.w);_d.z.registerClass("_d.z",_d.i,_y.cE);_d.bS.registerClass("_d.bS",_d.n);_d.bY.registerClass("_d.bY",_rpc.p);_d.d.registerClass("_d.d",_y.hO,_bc.j,_bc.p,_bc.u,_a.iT,_js.z,Sys.IDisposable,_y.hL);_d.bK.registerClass("_d.bK",null,_js.T);_d.bw.registerClass("_d.bw",null,_js.T);_d.bM.registerClass("_d.bM",null,_js.T);_d.bO.registerClass("_d.bO",null,_js.T);_d.f.registerClass("_d.f",_a.bx);_d.m.registerClass("_d.m",_y.hO,IUnsupportedItemReadingPaneViewModel);_d.bt.registerClass("_d.bt");CoreViewModelsComponent.$$cctor();_d.h.a=null;_d.h.b=null;_d.t.a=_a.a.r;_d.B.a=_a.a.u;_d.j.a=_a.a.r;_d.j.b=null;_d.j.$$cctor();_d.K.a=_a.a.dk;_d.x.a=_a.a.A;_d.u.a=_a.a.bd;_d.v.a=_a.a.bv;_d.Z.a=_a.a.bv;_d.L.a=_a.a.bv;_d.l.a=_a.a.bv;_d.E.a=_a.a.bv;_d.p.a=_a.a.eZ;_d.q.b=175;_d.q.a=47;_d.q.c=200;_d.e.f=new _H("Task",_g.F,_d.e);_d.e.a=new _H("EditedTask",_g.F,_d.e);_d.e.d=new _H("IsNewTask",Boolean,_d.e);_d.e.c=new _H("IsEditMode",Boolean,_d.e);_d.e.b=new _H("IsDraft",Boolean,_d.e);_d.e.e=new _H("PopoutPerfContext",_a.bL,_d.e);_d.c.a=_a.a.bv;_d.M.a=_a.a.bv;_d.b.a=_a.a.eD;_d.b.b=new _H("CanDial",Boolean,_d.b,!0);_d.b.g=new _H("PlayOnPhoneActive",Boolean,_d.b,!1);_d.b.c=new _H("DialString",String,_d.b,"");_d.b.e=new _H("MessageText",String,_d.b,"");_d.b.h=new _H("PlayOnPhoneCommand",_js.v,_d.b);_d.b.i=new _H("PlayOnPhoneDisconnectCommand",_js.v,_d.b);_d.b.f=new _H("PlayOnPhoneActiveCommand",_js.v,_d.b);_d.b.d=new _H("IsPhoneCallActive",Boolean,_d.b,!1);_d.k.a=new _H("Item",_g.cw,_d.k);_d.k.c=new _H("Source",_d.bt,_d.k,null);_d.k.b=new _H("PlayOnPhoneViewModel",_d.b,_d.k);_d.w.a=_a.a.bv;_d.n.b="LinkingActionInProgress";_d.n.c="ErrorCode";_d.y.a=_a.a.ct;_d.i.c="HeaderTextViewModel";_d.i.b="HeaderImageViewModel";_d.i.d="SingleComponent";_d.i.e="SingleComponentText";_d.i.a=_a.a.ct;_d.d.a=_a.a.cV;_d.f.a=null;_d.f.b=!1;_d.m.a="CurrentItem";_d.m.b="ItemNotSupported";_d.m.c="MoveButtonText";
window.scriptsLoaded['microsoft.owa.core.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
