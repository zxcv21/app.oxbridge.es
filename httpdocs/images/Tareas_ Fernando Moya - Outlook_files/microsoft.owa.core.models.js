try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.models.js'] = (new Date()).getTime();
Type.registerNamespace("_c");_c.bC=function(n,t){_c.bC.initializeBase(this);this.b=n;this.c=t};_c.bC.prototype={b:null,c:null,u:function(n){n.di(this.b,this.c,null,this.r,this.q)},cy:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.bD=function(){};_c.bD.prototype={a:function(n,t,i,r){return new _c.A(n,t,new _g.eE(r),i,_g.j.b)}};_c.A=function(n,t,i,r,u){_c.A.initializeBase(this,[null,n,t,i,r]);this.a=u};_c.A.prototype={a:null,x:function(){return this.a},v:function(n,t,i){},w:function(n,t,i){},q:function(n){return n},B:function(n,t,i,r,u){_js.Trace.logInfo(_c.A.a,"ExecuteWithActionQueue {0}",n);this.a.hq(n,t,i,r,u);return}};_c.w=function(n,t,i){_a.b.b(n,"activityManager");_a.b.b(t,"chatManagerFactory");_a.b.b(i,"owaLayout");if(i!=="Mouse")this.a=new _c.y(n);else if(OwaApplication.b)this.a=new _c.y(n);else{var r=this;t.a(function(t){var i=t.a();r.a=i.f()?new _c.bt(n,i):new _c.y(n)})}};_c.w.prototype={a:null};_c.T=function(n,t){_c.T.initializeBase(this);this.b=n;this.c=t};_c.T.prototype={b:null,d:null,c:"EwsLegacyId",e:function(){return this.d},u:function(n){var i=new _gg.em(this.c);i.DestinationFormat=this.c;i.SourceIds=new Array(this.b.length);for(var t=0;t<this.b.length;t++){var f=new _gg.bp(this.b[t].Format,this.b[t].Id,this.b[t].Mailbox);i.SourceIds[t]=f}var u=new _gg.el(this.y(),i);var r=new _gg.mL(this.x);n.X(u,r,this.r,this.q)},cp:function(n){this.d=n.AlternateId}};_c.i=function(n,t,i,r){_c.i.initializeBase(this,[n,t,_c.i.b(),"None",i,r])};_c.i.b=function(){if(!_c.i.a){_c.i.a=new _g.bE("IdOnly");_c.i.a.AddBlankTargetToLinks=!0;_c.i.a.ClientSupportsIrm=!0;_c.i.a.FilterHtmlContent=!0;_c.i.a.InlineImageUrlTemplate=_g.S.b();_c.i.a.MaximumBodySize=0;_c.i.a.AdditionalProperties=[new _g.e("UID"),new _g.e("ItemParentId"),new _g.e("InstanceKey"),new _g.e("Subject"),new _g.e("TaskDueDate"),new _g.e("Body"),new _g.e("NormalizedBody"),new _g.e("HasAttachments"),new _g.e("Attachments"),new _g.e("TaskStartDate"),new _g.e("Importance"),new _g.e("TaskStatus"),new _g.e("TaskCompleteDate"),new _g.e("TaskPercentComplete"),new _g.e("Sensitivity"),new _g.e("TaskOwner"),new _g.e("Categories"),new _g.e("TaskTotalWork"),new _g.e("TaskActualWork"),new _g.e("TaskMileage"),new _g.e("TaskBillingInformation"),new _g.e("TaskCompanies"),new _g.e("TaskRecurrence"),new _g.e("ReminderDueBy"),new _g.e("ReminderIsSet"),new _g.e("ReminderNextTime"),new _g.e("ReminderMinutesBeforeStart"),new _g.e("ItemLastModifiedTime"),new _g.e("TaskIsComplete"),new _g.e("TaskIsTaskRecurring"),new _g.e("ItemClass"),new _g.e("TaskDelegationState"),new _g.e("TaskDoItTime")]}return _c.i.a};_c.i.prototype={cp:function(n){try{_h.cB.prototype.cp.call(this,n)}catch(t){this.bX("ProcessResponseMessageFailed",this);throw t;}}};_c.cX=function(){};_c.cX.prototype={success:0,warning:1,error:2};_c.cX.registerEnum("_c.cX",!1);_c.cY=function(){};_c.cY.prototype={Id:0,Dictionary:1,XmlData:2,BinaryData:3,All:4};_c.cY.registerEnum("_c.cY",!1);_c.P=function(){};_c.P.prototype={public:1,private:2,secret:3,recommendation:4};_c.P.registerEnum("_c.P",!1);_c.cU=function(){};_c.cU.registerInterface("_c.cU");_c.bm=function(n,t){_c.bm.initializeBase(this);_a.b.b(n,"folderId");_a.b.b(t,"conversationCount");this.d=n;this.c=t};_c.bm.prototype={d:null,c:0,b:null,u:function(n){n.ex(this.d,this.c,null,this.r,this.q)},cy:function(n,t,i){this.b=n.Conversations;t()}};_c.bn=function(){_c.bn.initializeBase(this)};_c.bn.prototype={c:null,b:null,u:function(n){var t=new _gg.ni(this.x);t.actionName="GetRegionalConfiguration";this.b=_a.d.b(_a.a.dM,"GetRegionalConfiguration",!0);var i=new _gg.eV;n.z(i,t,this.r,this.q)},cy:function(n,t,i){if(this.b){this.b.l=this.C();_a.d.a(this.b);this.b=null}if(n.SupportedCultures&&n.SupportedCultures.length>0){this.c=n.SupportedCultures;t();return}i(Error.create("Get regional information failed to retrieve at least one valid language."))},Q:function(n){_h.dX.prototype.Q.call(this,Error.create(n.message));if(this.b){this.b.l=this.C();this.b.k=n.name.toString();_a.d.a(this.b);this.b=null}}};_c.bp=function(){_c.bp.initializeBase(this)};_c.bp.prototype={b:null,u:function(n){var t=new _gg.nm(this.x);n.cg(t,this.r,this.q)},cy:function(n,t,i){try{_a.b.b(n,"themeSelectionInfo");this.b=n;t()}catch(r){i(r)}}};_c.bw=function(n){_c.bw.initializeBase(this);this.b=n};_c.bw.prototype={b:null,u:function(n){var t=new _gg.nw(this.x);n.cN(this.b,t,this.r,this.q)},cy:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.bf=function(n,t,i){_c.bf.initializeBase(this);_a.b.c(n,"sipUri");_a.b.c(i,"modernGroupSmtp");this.d=n;this.e=t;this.b=i};_c.bf.prototype={d:null,e:null,c:null,b:null,u:function(n){var i=new _g.kh(this.x);i.explicitLogonUser=this.b;var t;var r=(t=new _g.hc,t.SipUri=this.d,t.Subject=this.e,t);n.cu(r,i,this.r,this.q)},cy:function(n,t,i){if($a(n)){i(Error.argumentNull("onlineMeetingType"));return}this.c=n;t()}};_c.y=function(n){_c.y.initializeBase(this,[n])};_c.y.prototype={d:function(){return"KeepAliveActivityMonitor"},b:function(){return 24e4},e:function(){return 3e5},g:function(n){var t=new Sys.Net.WebRequest;t.set_url(_js.d.a(OwaApplication.m)?"ping.owa":OwaApplication.m);t.set_timeout(6e4);t.invoke()}};function CoreModelsComponent(){}CoreModelsComponent.$$cctor=function(){_a.r.a().a(CoreModelsComponent)};CoreModelsComponent.prototype={a:function(n,t,i){n.e(_c.bD).b(IPopOutMailboxDataContextFactory).a();var r=this;n.b(_c.w,function(){return new _c.w(n.a(_a.bl),n.c(IChatManagerFactory),i.a())}).a();n.e(_c.bE).a().b(IAddEventToMyCalendarResponseProcessorFactory);n.e(_c.bF).a().b(ICreateAttachmentResponseProcessorFactory);n.e(_c.bG).a().b(IDeleteAttachmentResponseProcessorFactory);n.e(_c.bH).a().b(IDeletePlaceResponseProcessorFactory);n.e(_c.bI).a().b(IPerformReminderActionResponseProcessorFactory)},b:function(){return[new _a.B(_c.w,2,17)]}};_c.u=function(n,t,i,r){_c.u.initializeBase(this,[2]);_a.b.a(n,"approvalMessage");this.d=r;this.X=!0;this.g="CreateApprovalResponse";this.c=n;this.b=t;this.e=i};_c.u.prototype={c:null,b:null,e:!1,F:function(){_a.cX.prototype.F.call(this);this.d===1&&_h.d.l(this.c.bh.ItemId,this.c.bh.ConversationId.Id)},l:function(){var n;n=this.e?new _gg.bq:new _gg.ch;this.i=this.d?_g.b.a.nameToId("outbox"):_g.b.a.nameToId("drafts");n.ReferenceItemId=_g.g.a(this.c.bh.ItemId);this.j(n);return[n]},cp:function(n){!this.d&&n.Items&&n.Items[0]?this.f=n.Items[0].ItemId:this.d===1&&_h.d.e(this.c.bh.ItemId,this.c.bh.ConversationId.Id)},H:function(){_a.cX.prototype.H.call(this);this.d===1&&_h.d.e(this.c.bh.ItemId,this.c.bh.ConversationId.Id)},j:function(n){if(!this.b){var u=this.e?_nbs.a.kP:_nbs.a.MZ;var r=String.format(_nbs.a.gG,u,this.c.cN());n.Subject=r;if(this.c.bh.Sender){var t=new(_a.fJ.$$(_g.d));t.c(this.c.bh.Sender.Mailbox);n.ToRecipients=_h.p.a(t)}return}var i;_h.p.d(this.b.C(),i={val:this.ba},this.T),this.ba=i.val;n.Importance=this.b.bx();this.b.k()&&this.b.k().b()>0&&(n.ToRecipients=_h.p.a(this.b.k()));this.b.m()&&this.b.m().b()>0&&(n.CcRecipients=_h.p.a(this.b.m()));this.b.o()&&this.b.o().b()>0&&(n.BccRecipients=_h.p.a(this.b.o()));n.Sensitivity=this.b.bF();n.IsDeliveryReceiptRequested=this.b.bh.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.b.bh.IsReadReceiptRequested;$a(this.b.C())||(n.Body=new _g.D(this.b.C().a()==="HTML"?"HTML":"Text",this.b.C().bh.Value));n.Subject=this.b.bh.Subject}};_c.bg=function(n,t){_c.bg.initializeBase(this);this.c=n;this.b=t};_c.bg.prototype={c:null,b:null,d:null,u:function(n){var t=new _gg.qE(this.x);n.bg(this.c,this.b,t,this.r,this.q)},cy:function(n,t,i){this.d=n;t()}};_c.bj=function(n,t,i){_c.bj.initializeBase(this,[t,i]);this.d=n};_c.bj.prototype={d:null,c:function(){return!0},i:function(n){n.ActionType=0},h:function(n,t){for(var i=0;i<this.d.y.length;i++){var r=this.d.y[i];if(_ff.g.b(n.c(),r.c())){this.d.o(i);break}}}};_c.bl=function(){this.b=-1;_c.bl.initializeBase(this)};_c.bl.prototype={cy:function(n,t,i){this.b=n;t()},u:function(n){n.bG(null,this.r,this.q)}};_c.by=function(n,t,i){_c.by.initializeBase(this,[n,i]);this.d=t};_c.by.prototype={d:null,c:function(){return!0},i:function(n){var t=_a.c.k(this.d);n.ActionType=1;n.NewReminderTime=t},h:function(n,t){n.j(this.d)}};_c.br=function(n,t){_c.br.initializeBase(this);this.c=n;this.b=t};_c.br.prototype={c:null,b:null,d:null,u:function(n){var r=new _g.g(this.c);var u=new _gg.kt(r,this.b);var t=new _gg.ks(this.y(),u);var i=new _gg.Ak(this.x);n.fJ(t,i,this.r,this.q)},cp:function(n){this.d=n}};_c.bs=function(n){_c.bs.initializeBase(this);this.b=n};_c.bs.prototype={b:null,u:function(n){var r=new _gg.kr(this.b);var u=new _gg.hw(r);var t=new _gg.hv(this.y(),u);var i=new _gg.rA(this.x);n.dP(t,i,this.r,this.q)},cp:function(n){}};_c.bq=function(n){_c.bq.initializeBase(this);this.b=n};_c.bq.prototype={b:null,u:function(n){var t=new _gg.vR(0);t.timeZone=this.V();n.bY(t,this.r,this.q)},cy:function(n,t,i){try{if($a(n)){i(Error.create(_nbs.a.SU));return}this.b.d(n.ExternalAudience);this.b.e(n.ExternalReply);this.b.f(n.InternalReply);this.b.b(n.IsOofOn);this.b.g(n.IsScheduled);this.b.c(_a.c.b(n.EndTime));t()}catch(r){i(r)}}};_c.x=function(){this.c=Function.createDelegate(this,this.e);_c.x.initializeBase(this);if(!model)throw Error.argumentNull("model");this.b=model};_c.x.a=function(n){_a.b.b(n,"UserAgent shouldn't be null.");return n.q()?_nbs.a.Ti:n.t()?_nbs.a.GL:n.d()?_nbs.a.nA:_nbs.a.Xh};_c.x.prototype={b:null,a:null,O:function(){try{var n=_a.bc.a();var t=n.b("MOWA.IsSignatureChanged")==="true"?!0:!1;this.b.a(t?Boolean.parse(n.b("MOWA.AutoAddSignature")):!0);this.b.c(t?n.b("MOWA.SignatureText"):_c.x.a(_a.UserAgent.getInstance()));this.b.e(t?Boolean.parse(n.b("MOWA.UseDesktopSignature")):!1);this.a=new _h.cq;this.a.w(this.c);OwaApplication.a.a(this.a)}catch(i){this.d(i)}return 1},f:function(){this.J(null)},d:function(n){this.J(n)},e:function(n){this.b.b(this.a.b.UserOptions.SignatureText);this.f()}};_c.bx=function(n){_c.bx.initializeBase(this);this.b=n};_c.bx.prototype={b:null,u:function(n){var t=new _gg.mx;t.ExternalAudience=this.b.h();t.ExternalReply=this.b.i();t.InternalReply=this.b.j();t.IsOofOn=this.b.a();n.gD(t,null,this.r,this.q)},cy:function(n,t,i){if(!n){i(Error.create(_bms.E.BA));return}t()}};_c.bu=function(n){_c.bu.initializeBase(this);this.b=n};_c.bu.prototype={b:null,u:function(n){n.fT(this.b,null,this.r,this.q)},cy:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.cV=function(n,t){_c.cV.initializeBase(this);_a.b.b(n,"remindersToPerformAction");_a.b.b(t,"nativeBridge");this.b=n;this.g=t};_c.cV.prototype={b:null,g:null,u:function(n){var i=this.k();var t=new _gg.Ad(this.x);t.shouldPrecedeOfflineSyncActions=this.c();n.cv(i,t,this.f,this.e)},F:function(){_a.cX.prototype.F.call(this);for(var n=0;n<this.b.length;n++)this.h(this.b[n],this.g)},k:function(){var t=new _gg.fE;t.ReminderItemActions=this.j();var n=new _gg.ko(this.y());n.Body=t;return n},j:function(){for(var i=new Array(this.b.length),n=0;n<this.b.length;n++){var u=this.b[n];var r=new _g.g(u.c().Id);r.ChangeKey=u.c().ChangeKey;var t=new _gg.kB;t.ItemId=r;this.i(t);i[n]=t}return i}};_c.N=function(n,t){_c.N.initializeBase(this,[0]);this.c=n;var i=_g.l.a("todosearch").bh.FolderId;($a(t)||t===i)&&(t=_g.l.a("tasks").bh.FolderId);this.R=_g.r.c(t);this.g="CreateTask"};_c.N.prototype={c:null,b:null,l:function(){return[this.d()]},cp:function(n){this.b=n.Items[0].ItemId},d:function(){for(var t=new _g.cl,f=this.c.d,o=this.c.f(),r=o,e=r.length,n=0;n<e;++n){var u=r[n];var i=_c.e.b(u);i&&i(t,f)}t.Owner=_g.a.a().c().bh.UserDisplayName;return t}};_c.bh=function(n,t){_c.bh.initializeBase(this);_a.b.b(n,"ParentGroup");this.d=n;var i=new _gg.bn;i.c(n.bh.GroupId);this.b=i;this.c=new _gg.dP;this.f=t};_c.bh.prototype={b:null,c:null,d:null,f:null,g:function(n){if(!_js.d.b(n)){this.b.a(n);this.c.f(n)}},u:function(n){n.dB(this.b.bh.FolderName,this.b.bh.ParentGroupId,null,this.r,this.q)},h:function(n){var t=new _g.n(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.c.i(t);this.c.v(_g.l.a("tasks").bh.FolderId);this.b.e(t);this.b.f(n.NewTaskFolderEntryId);var i=_h.a.b("msgfolderroot");i.bm.a(this.c);this.f.n(this.d,this.b,this.c)}};_c.bi=function(n,t,i){_c.bi.initializeBase(this);_a.b.b(n,"taskFolderToDelete");_a.b.b(t,"parentGroup");_a.b.b(i,"taskGroupsCache");this.b=n;this.c=t;this.d=i};_c.bi.prototype={b:null,c:null,d:null,u:function(n){var t=new _g.g(this.b.bh.ItemId.Id);t.ChangeKey=this.b.bh.ItemId.ChangeKey;n.dK(t,null,this.r,this.q)},h:function(n){this.d.u(this.c,this.b)}};_c.bk=function(n,t,i){_c.bk.initializeBase(this,[n,t])};_c.bk.prototype={Y:function(){this.o&&(this.k=new _g.Q(_g.r.a(this.o)));var t=[];var r=this.U(this.d);var n=new _g.M(new _g.e("TaskStatus"));n.Item=new _g.cl;n.Item.Status=r;Array.add(t,n);if(r==="InProgress"){var i=null;if($a(this.d.c())){i=new _g.bA(new _g.e("TaskStartDate"));Array.add(t,i)}else{n=new _g.M(new _g.e("TaskStartDate"));n.Item=new _g.cl;n.Item.StartDate=this.d.c().j();Array.add(t,n)}if($a(this.d.b())){i=new _g.bA(new _g.e("TaskDueDate"));Array.add(t,i)}else{n=new _g.M(new _g.e("TaskDueDate"));n.Item=new _g.cl;n.Item.DueDate=this.d.b().j();Array.add(t,n)}}if(r==="InProgress"||r==="Completed")if($a(this.d.e())){var u=new _g.bA(new _g.e("TaskCompleteDate"));Array.add(t,u)}else{n=new _g.M(new _g.e("TaskCompleteDate"));n.Item=new _g.cl;n.Item.CompleteDate=this.d.e().j();Array.add(t,n)}return t},i:function(){for(var r=this.Y(),t=new Array(this.c.length),n=0;n<this.c.length;n++){var i=new _g.g(this.c[n].bh.ItemId.Id);i.ChangeKey=this.c[n].bh.ItemId.ChangeKey;t[n]=new _g.bN;t[n].ItemId=i;t[n].Updates=r}return t},F:function(){var t=this.U(this.d);var n=this.c;var l=this,c=this;_h.d.c(_g.F,String,n,"Status",function(n){return n.i()},t,function(n,t){n.r(t)});var h=this,a=this;_h.d.c(_g.F,Boolean,n,"IsComplete",function(n){return n.v()},t==="Completed",function(n,t){n.J(t)});if(t==="InProgress"){if(!$a(this.d.c())){var p=this,y=this;_h.d.c(_g.F,_a.c,n,"StartDate",function(n){return n.m()},this.d.c(),function(n,t){n.W(t)})}if(!$a(this.d.b())){var v=this,u=this;_h.d.c(_g.F,_a.c,n,"DueDate",function(n){return n.e()},this.d.b(),function(n,t){n.T(t)})}if(!$a(this.d.e())){var r=this,i=this;_h.d.c(_g.F,_a.c,n,"CompleteDate",function(n){return n.g()},this.d.e(),function(n,t){n.H(t)})}}else if(t==="Completed"){var f=this,s=this;_h.d.c(_g.F,String,n,"PercentComplete",function(n){return n.bh.PercentComplete},"100",function(n,t){n.L(t)});var o=this,e=this;_h.d.c(_g.F,_a.c,n,"CompleteDate",function(n){return n.g()},this.d.e().f(),function(n,t){n.H(t)})}},U:function(n){var t="NotStarted";switch(n.a()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":t="Completed";break;case"Flagged":t="InProgress";break}return t}};_c.bo=function(){_c.bo.initializeBase(this)};_c.bo.prototype={b:null,u:function(n){var t=new _gg.wJ(this.x);n.fd(t,this.r,this.q)},cy:function(n,t,i){try{this.c(n)}catch(r){i(r);return}t()},c:function(n){$a(n)||(this.b=n.TaskGroups)}};_c.O=function(n,t,i,r,u,f){_c.O.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,f,!1,null,null])};_c.O.prototype={bo:function(){return _h.dU.a(this.m.a,this.m.b,this.j)}};_c.bv=function(n,t,i){_c.bv.initializeBase(this);_a.b.b(n,"taskFolderToRename");_a.b.c(t,"newTaskFolderName");_a.b.b(i,"taskGroupsCache");this.b=n;this.c=t;this.d=i};_c.bv.prototype={b:null,c:null,d:null,u:function(n){var t=new _g.g(this.b.bh.ItemId.Id);t.ChangeKey=this.b.bh.ItemId.ChangeKey;n.ga(t,this.c,null,this.r,this.q)},h:function(n){this.b.bh.ItemId.ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.b.a(this.c);if(this.d.b){var t=this.d.j(this.b.bh.TaskFolderId);if(!$a(t)){t.bh.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.c)}}}};_c.Q=function(){this.e=String.format(_nbs.a.Ca,-1);_c.Q.$$(this.$$gta["_c.Q"].T).initializeBase(this)};_c.Q.$$=function(n){var t="Q"+"$"+n.getName().replace(/\./g,"_");if(!_c[t]){var r=_c[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_c.Q.apply(this,t)};var s=_h.dX.$$(n);r.registerClass("_c."+t,s);var h={"_c.Q":{T:n}};var f=s.prototype.$$gta;for(var c in f){var o={key:c,value:f[c]};h[o.key]=o.value}r.prototype.$$gta=h;var u=_c.Q.prototype;for(var e in u){var i={key:e,value:u[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _c[t]};_c.Q.prototype={cy:function(n,t,i){if(!n.WasSuccessful){this.e=_c.bz.a(n.ErrorCode);i(Error.create(this.e));return}try{this.h(n)}catch(r){i(r);return}t()}};_c.bz=function(){};_c.bz.a=function(n){switch(n){case 11:return _nbs.a.aq;case 13:return _nbs.a.eS;case 7:return _nbs.a.Hk;default:return String.format(_nbs.a.Ca,n)}};_c.f=function(n,t){this.b=n;this.a=t};_c.f.prototype={b:"FolderId",a:!1};_c.e=function(){};_c.e.b=function(n){_c.e.c();return _c.e.a[n]};_c.e.c=function(){if($a(_c.e.a)){_c.e.a={};_c.e.a.Subject=function(n,t){n.Subject=t.bh.Subject;return new _c.f("Subject",!1)};_c.e.a.DueDate=function(n,t){var i=$a(t.e());i||(n.DueDate=t.e().j());return new _c.f("TaskDueDate",i)};_c.e.a.Body=function(n,t){n.Body=new _g.D(t.C().a()==="HTML"?"HTML":"Text",t.C().bh.Value);return new _c.f("Body",!1)};_c.e.a.StartDate=function(n,t){var i=$a(t.m());i||(n.StartDate=t.m().j());return new _c.f("TaskStartDate",i)};_c.e.a.Importance=function(n,t){n.Importance=t.bx();return new _c.f("Importance",!1)};_c.e.a.Status=function(n,t){n.Status=t.i();return new _c.f("TaskStatus",!1)};_c.e.a.CompleteDate=function(n,t){var i=$a(t.g());i||(n.CompleteDate=t.g().j());return new _c.f("TaskCompleteDate",i)};_c.e.a.PercentComplete=function(n,t){n.PercentComplete=t.bh.PercentComplete;return new _c.f("TaskPercentComplete",!1)};_c.e.a.Sensitivity=function(n,t){n.Sensitivity=t.bF();return new _c.f("Sensitivity",!1)};_c.e.a.TotalWork=function(n,t){n.TotalWork=t.z();return new _c.f("TaskTotalWork",!1)};_c.e.a.ActualWork=function(n,t){n.ActualWork=t.t();return new _c.f("TaskActualWork",!1)};_c.e.a.Mileage=function(n,t){n.Mileage=t.bh.Mileage;return new _c.f("TaskMileage",!1)};_c.e.a.BillingInformation=function(n,t){n.BillingInformation=t.bh.BillingInformation;return new _c.f("TaskBillingInformation",!1)};_c.e.a.Companies=function(n,t){var r=$a(t.f())&&t.f().b()>0;if(!r){for(var u=new Array(t.f().b()),i=0;i<t.f().b();i++)u[i]=t.f().a(i);n.Companies=u}return new _c.f("TaskCompanies",r)};_c.e.a.ReminderIsSet=function(n,t){n.ReminderIsSet=t.bh.ReminderIsSet;return new _c.f("ReminderIsSet",!1)};_c.e.a.ReminderDueBy=function(n,t){var i=$a(t.eT());i||(n.ReminderDueBy=t.eT().j());return new _c.f("ReminderDueBy",i)};_c.e.a.Recurrence=function(n,t){var i=$a(t.F());i||(n.Recurrence=t.F().bh);return new _c.f("TaskRecurrence",i)};_c.e.a.ModernReminders=function(n,t){var i=$a(t.E());i||(n.ModernReminders=t.E().i.p);return new _c.f("ModernReminders",i)}}};_c.S=function(n){_c.S.initializeBase(this,[0]);this.b=n;var t=n.d;$a(t.bh.ParentFolderId)||(this.R=_g.r.c(t.bh.ParentFolderId));this.j="UpdateTask"};_c.S.a=function(n,t,i){if(i){var f=new _g.cl;var e=i(f,t);var r=new _g.e(e.b);if(e.a){var o=new _g.bA(r);Array.add(n,o)}else{var u=new _g.M(r);u.Item=f;Array.add(n,u)}}};_c.S.prototype={b:null,i:function(){for(var i=[],u=this.b.d,o=this.b.f(),r=o,f=r.length,n=0;n<f;++n){var e=r[n];_c.S.a(i,u,_c.e.b(e))}var t=new _g.bN;t.ItemId=_g.g.a(u.bh.ItemId);t.Updates=i;return[t]}};_c.CalendarTimePeriodSchema=function(){};_c.bt=function(n,t){_c.bt.initializeBase(this,[n]);this.f=t};_c.bt.prototype={f:null,d:function(){return"PresenceActivityMonitor"},b:function(){return 24e4},e:function(){return 3e5},g:function(n){this.f.r()}};_c.z=function(){_c.z.initializeBase(this)};_c.z.prototype={k:0,l:null,m:null,n:!1,p:!1,o:null,h:function(){return this.k},d:function(n){if(n===this.k)return n;this.k=n;this.ea("ExternalAudience");return n},i:function(){return this.l},e:function(n){if(n===this.l)return n;this.l=n;this.ea("ExternalReply");return n},j:function(){return this.m},f:function(n){if(n===this.m)return n;this.m=n;this.ea("InternalReply");return n},a:function(){return this.n},b:function(n){if(n===this.n)return n;this.n=n;this.ea("IsOofOn");return n},g:function(n){if(n===this.p)return n;this.p=n;this.ea("IsScheduled");return n},c:function(n){if(n===this.o)return n;this.o=n;this.ea("EndTime");return n}};_c.d=function(){_c.d.initializeBase(this)};_c.d.prototype={j:function(n){this.eb(_c.d.f,n);return n},a:function(){return this.ec(_c.d.a)},f:function(n){this.eb(_c.d.a,n);return n},c:function(){return this.ec(_c.d.c)},h:function(n){this.eb(_c.d.c,n);return n},d:function(){return this.ec(_c.d.d)},i:function(n){this.eb(_c.d.d,n);return n},b:function(){return this.ec(_c.d.b)},g:function(n){this.eb(_c.d.b,n);return n},e:function(){return this.ec(_c.d.e)},k:function(n){this.eb(_c.d.e,n);return n}};_c.cW=function(){_c.cW.initializeBase(this)};_c.cW.prototype={callState:null};_c.bB=function(n,t,i){_c.bB.initializeBase(this,[n]);this.g=$a(t)?"All":t;this.f=i?i:new _h.y("TaskDueDate","Ascending");this.e=this.e+"_item_"+this.g+"_"+this.f.a.toString()+"_"+this.f.b.toString()+"_"};_c.bB.prototype={g:"All",f:null,c:function(){return this.g},d:function(){return _h.dU.a(this.f.a,this.f.b,this.i)}};_c.R=function(n,t){_c.R.initializeBase(this,[n,null,t?t:_c.R.a(n)])};_c.R.a=function(n){return[new _h.u(n,!1,n.d(),n.c())]};_c.R.prototype={bo:function(){return _a.a.eY},L:function(){return this.bp.g},bA:function(){return this.bp.f},q:function(){return null},m:function(){return!1},C:function(n,t){var i=this;n.o(function(){i.cc==="ErrorConnectionFailed"&&n.j()&&n.h()?t(6):t(1)})},cw:function(n){},bG:function(n){var t=Math.max(this.cS(),this.bm.y.length);this.bR(4);this.bB(this.cA(t,this.e()))},bv:function(n,t){if(!_h.q.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.q,"range needs to be an IndexedRange object");return this.cA(n.b,n.a)},cy:function(n){return!1},cU:function(n,t){var i=n;i.dP(t)},cV:function(n,t){return!0},ct:function(n,t){return-2},da:function(n,t,i){return new _c.O(this.d(),this.q(),n,!1,this.L(),this.bA())},cA:function(n,t){return new _c.O(this.d(),this.q(),_h.w.b(t,n),!1,this.L(),this.bA())}};_c.bA=function(){this.g=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.t);this.a={};this.e=[];_c.bA.initializeBase(this)};_c.bA.prototype={c:null,b:!1,d:!1,f:0,m:function(n){this.bt("CachePopulated",n)},v:function(n){if(n!==this.b){this.b=n;this.bk("IsLoaded")}return n},p:function(){return _nbs.a.ZX},j:function(n){return $a(this.a)?null:n.Id in this.a?this.a[n.Id]:null},k:function(n){if(this.b){$a(n)||n();return!0}$a(n)||Array.add(this.e,n);this.o();return!1},n:function(n,t,i){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolderEntry");_a.b.a(i,"folder");t.c(n.bh.GroupId);n.a().c(t);this.a[t.bh.TaskFolderId.Id]=i},u:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolder");delete this.a[t.bh.TaskFolderId.Id];n.a().p(t)},o:function(){if(!this.d){this.d=!0;this.l()}},l:function(){var n=new _c.bo;n.w(this.i);n.v(this.h);n.z(this.g);OwaApplication.a.a(n)},t:function(n){var c=n;this.c=new _js.f;this.a={};for(var l=!1,s=0;s<c.b.length;s++){var i=new _gg.dO(c.b[s]);i.e()||i.c(_nbs.a.Lg);for(var f=i.a().b()-1;f>=0;f--){var t=i.a().a(f);var u=null;if(t.b()===1){u=_g.l.a("todosearch");l=!0;t.a(_nbs.a.Zi);u.f(_nbs.a.Zi)}else{u=_h.a.a(t.bh.TaskFolderId);t.b()===2&&t.a(u.f(this.p()))}u?this.a[t.bh.TaskFolderId.Id]=u:i.a().k(f)}this.c.a(i)}if(!l&&this.c.y.length>0){var h=this.c.y[0];var o=_g.l.a("todosearch");o.f(_nbs.a.Zi);var r=new _gg.bn;r.a(_nbs.a.Zi);r.g(1);r.e(o.bh.FolderId);r.c(h.bh.GroupId);h.a().r(0,r);this.a[r.bh.TaskFolderId.Id]=o}this.v(!0);this.d=!1;this.bP("CachePopulated",this,null);for(var e=0;e<this.e.length;e++)this.e[e]();this.e=[]},r:function(n){if(this.f<3){var t=this;_js.g.a().a(_a.a.bv,"GetTaskFoldersActionRetry",function(){t.l()},2e3);this.f++}else{this.f=0;this.d=!1}},q:function(n){n.N(this.i);n.M(this.h);n.K(this.g)}};_c.B=function(n,t){_c.B.initializeBase(this,[n,t,_c.B.a])};_c.bE=function(){};_c.bE.prototype={a:function(n,t,i){return new _c.B(n,t)}};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.a]);_a.b.b(i,"nativeBridge");this.i=i};_c.CreateAttachmentResponseProcessor.prototype={i:null,k:function(n,t){var r=null;var i=null;if(t.ResponseClass==="Success"){r=t.Attachments[0].AttachmentId;i=new _g.g(r.RootItemId);i.ChangeKey=r.RootItemChangeKey;var f=this.g().Body.ParentItemId;this.e.w(this.b,f,i)}if(this.a()){var e=this.a().attachmentIds[n];this.o(t.ResponseClass,e,r,i);if(this.a().palContext&&this.a().palContext.palActionNeeded&&this.i.b(this.i.g())){var u=this.i.g().b();u.g(this.a().dataFile);this.i.g().a(u.d())}}_h.dF.prototype.k.call(this,n,t)},o:function(n,t,i,r){n==="Success"?this.w(t,i,r):this.v(t)},w:function(n,t,i){var u=new _g.by(t.Id);this.e.v(this.b,n,u);if(this.m()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this;this.d().a().d(this.b,this.d().h().b(i.Id),function(t){if($a(t)){_js.Trace.logWarning(r.f,"Message with id {0} not found in local store",i.Id);return}r.A(t,n,u)})}},v:function(n){if(this.m()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this.c.request.parameters;var t=new _g.g(r.Body.Attachments[0].AttachmentId.RootItemId);var i=this;this.d().a().d(this.b,this.d().h().b(t.Id),function(r){if($a(r)){_js.Trace.logWarning(i.f,"Message with id {0} not found in local store",t.Id);return}i.l(r,n)})}},A:function(n,t,i){var u=n;if(!u.HasAttachments){_js.Trace.logError(this.f,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if($a(u.Attachments)){_js.Trace.logError(this.f,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var e=u.Attachments,o=e.length,r=0;r<o;++r){var f=e[r];if(f.AttachmentId.Id===t.Id){f.AttachmentId.Id=i.Id;return}}_js.Trace.logWarning(this.f,"Attachment with id {0} not found in local store",t.Id)},l:function(n,t){var i=n;if(i.HasAttachments&&!$a(i.Attachments)){for(var r=0;r<i.Attachments.length;r++)if(i.Attachments[r].AttachmentId.Id===t.Id){Array.removeAt(i.Attachments,r);break}_js.Trace.logWarning(this.f,"Attachment with id {0} not found in local store",t.Id)}}};_c.bF=function(){};_c.bF.prototype={a:function(n,t,i){return new _c.CreateAttachmentResponseProcessor(n,t,i)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.a])};_c.DeleteAttachmentResponseProcessor.prototype={k:function(n,t){var i=this.a().itemContexts[n];if(t.ResponseClass==="Success"){var f=this.e.q(i.parentItemId);var r=new _g.g(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.e.w(this.b,f,r)}else if(this.m()&&i.clientStoreItem===2){this.b.b().b(!1);var u=this.e.q(i.parentItemId);this.d().a().g(this.b,this.d().h().b(u.Id),i.deletedAttachment)}_h.dF.prototype.k.call(this,n,t)}};_c.bG=function(){};_c.bG.prototype={a:function(n,t,i){return new _c.DeleteAttachmentResponseProcessor(n,t)}};_c.C=function(n,t){_c.C.initializeBase(this,[n,t,_c.C.a])};_c.bH=function(){};_c.bH.prototype={a:function(n,t,i){return new _c.C(n,t)}};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.a])};_c.bI=function(){};_c.bI.prototype={a:function(n,t,i){return new _c.PerformReminderActionResponseProcessor(n,t)}};_c.cZ=function(){};_c.cZ.registerInterface("_c.cZ");_c.da=function(){};_c.da.registerInterface("_c.da");_c.bC.registerClass("_c.bC",_h.dX.$$(Boolean),_a.fA);_c.bD.registerClass("_c.bD",null,IPopOutMailboxDataContextFactory);_c.A.registerClass("_c.A",_g.j);_c.w.registerClass("_c.w");_c.T.registerClass("_c.T",_h.dj.$$(_gg.pZ,_gg.qb));_c.i.registerClass("_c.i",_h.cB);_c.bm.registerClass("_c.bm",_h.dX.$$(_gg.uz));_c.bn.registerClass("_c.bn",_h.dX.$$(_gg.wi));_c.bp.registerClass("_c.bp",_h.dX.$$(_gg.Fv),_a.fA);_c.bw.registerClass("_c.bw",_h.dX.$$(Boolean));_c.bf.registerClass("_c.bf",_h.dX.$$(_gg.zR));_c.y.registerClass("_c.y",_a.hP);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.ih);_c.u.registerClass("_c.u",_h.p);_c.bg.registerClass("_c.bg",_h.dX.$$(String));_c.cV.registerClass("_c.cV",_h.fL);_c.bj.registerClass("_c.bj",_c.cV);_c.bl.registerClass("_c.bl",_h.dX.$$(Number));_c.by.registerClass("_c.by",_c.cV);_c.br.registerClass("_c.br",_h.dj.$$(_gg.Al,_gg.Am));_c.bs.registerClass("_c.bs",_h.dj.$$(_gg.rB,_gg.rC));_c.bq.registerClass("_c.bq",_h.dX.$$(_gg.mx));_c.x.registerClass("_c.x",_a.cX);_c.bx.registerClass("_c.bx",_h.dX.$$(Boolean));_c.bu.registerClass("_c.bu",_h.dX.$$(Boolean),_a.fA);_c.N.registerClass("_c.N",_h.fp);_c.bh.registerClass("_c.bh",_c.Q.$$(_gg.Fs));_c.bi.registerClass("_c.bi",_c.Q.$$(_gg.Ft));_c.bk.registerClass("_c.bk",_h.by);_c.bo.registerClass("_c.bo",_h.dX.$$(_gg.wK));_c.O.registerClass("_c.O",_h.bp);_c.bv.registerClass("_c.bv",_c.Q.$$(_gg.Fs));_c.S.registerClass("_c.S",_h.dh);_c.CalendarTimePeriodSchema.registerClass("_c.CalendarTimePeriodSchema");_c.bt.registerClass("_c.bt",_a.hP);_c.z.registerClass("_c.z",_a.bP);_c.d.registerClass("_c.d",_a.bP);_c.cW.registerClass("_c.cW",_a.hH);_c.cW.prototype.toString=_a.hH.prototype.toString;_c.bB.registerClass("_c.bB",_h.dT.$$(_c.R),_h.fz);_c.R.registerClass("_c.R",_lv.u);_c.bA.registerClass("_c.bA",_js.u);_c.B.registerClass("_c.B",_h.dI.$$(_gg.nW,Boolean));_c.bE.registerClass("_c.bE",null,IAddEventToMyCalendarResponseProcessorFactory,_h.fk);_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.dF.$$(_gg.mM,_gg.en,_gg.gX,_gg.gI));_c.bF.registerClass("_c.bF",null,ICreateAttachmentResponseProcessorFactory,_h.fk);_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.dF.$$(_gg.qW,_gg.hg,_gg.hh,_gg.hj));_c.bG.registerClass("_c.bG",null,IDeleteAttachmentResponseProcessorFactory,_h.fk);_c.C.registerClass("_c.C",_h.dI.$$(_gg.rg,_pc.a));_c.bH.registerClass("_c.bH",null,IDeletePlaceResponseProcessorFactory,_h.fk);_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.dF.$$(_gg.Ad,_gg.ko,_gg.kp,_g.hC));_c.bI.registerClass("_c.bI",null,IPerformReminderActionResponseProcessorFactory,_h.fk);_c.A.a=_a.a.eE;_c.i.a=null;CoreModelsComponent.$$cctor();_c.e.a=null;_c.CalendarTimePeriodSchema.c=new _H("Start",_a.c,_g.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.a=new _H("End",_a.c,_g.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.b=new _H("Recurrence",_g.bi,_g.ICalendarTimePeriod);_c.d.f=new _H("SharePointUrl",String,_c.d);_c.d.a=new _H("DocumentsUrl",String,_c.d);_c.d.c=new _H("NotebookUrl",String,_c.d);_c.d.d=new _H("PlannerUrl",String,_c.d);_c.d.b=new _H("IntegrationsUrl",String,_c.d);_c.d.e=new _H("ProfileUrl",String,_c.d);_c.B.a=_a.a.cY;_c.CreateAttachmentResponseProcessor.a=_a.a.c;_c.DeleteAttachmentResponseProcessor.a=_a.a.c;_c.C.a=_a.a.dS;_c.PerformReminderActionResponseProcessor.a=_a.a.eB;
window.scriptsLoaded['microsoft.owa.core.models.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.models.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
