try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['suiteextensions.js'] = (new Date()).getTime();
var __extends=this.__extends||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);function r(){this.constructor=n}r.prototype=t.prototype;n.prototype=new r};var AzureDataPipe=function(){function n(){this.unittestFlag=!1}n.prototype.getData=function(n,t){t.getDataCall(n,SuiteExtensionsDataStore.dataPipeSuccessCallback,SuiteExtensionsDataStore.dataPipeFailCallback)};return n}();var AddInsFlights=function(){function n(){}n.AzureDataPipe=0;n.FileHandlerAddInPicker=1;n.FileHandlerFileCreation=2;return n}();var HostConfig=function(){function n(n,t){this.enabledFlights=[];this.host="Office365";this.logging=new Logging;this.cultureName="en-us";this.resourceId="http://office365.com/";this.set_logging(null);this.userId=n;this.getDataCall=t}n.prototype.set_logging=function(n){switch(this.host){case"SharePoint":this.logging=new SharePointLogging(n);break;case"OWA":this.logging=new OwaLogging(n);break;case"OneDrive":this.logging=new OneDriveLogging(n);break;default:}};n.prototype.addFlight=function(n){this.enabledFlights.push(n)};n.prototype.isFlightEnabled=function(n){return this.enabledFlights.indexOf(n)>=0};return n}();var Logging=function(){function n(){this.prefix=null;this.traceComponent=null}n.prototype.WriteDebugLog=function(n,t,i){};n.prototype.WriteEngagementLog=function(n,t){};n.prototype.WriteStart=function(n){};n.prototype.WriteSuccess=function(n){};n.prototype.WriteFailure=function(n){};return n}();var SharePointLogging=function(){function n(n){this.prefix=AddInType.FileHandler+"_";this.traceComponent=n}n.prototype.WriteDebugLog=function(n,t,i){WriteDebugLog(this.prefix+n,t,i)};n.prototype.WriteEngagementLog=function(n,t){WriteEngagementLog(this.prefix+n,t)};n.prototype.WriteStart=function(n){WriteStart(this.prefix+n)};n.prototype.WriteSuccess=function(n){WriteSuccess(this.prefix+n)};n.prototype.WriteFailure=function(n){WriteFailure(this.prefix+n)};return n}();var OwaLogging=function(){function n(n){this.prefix=AddInType.FileHandler+"_";this.traceComponent=n}n.prototype.WriteDebugLog=function(n,t,i){t==!0?_js.Trace.logError(this.traceComponent,"{0} {1}",this.prefix+n,i):_js.Trace.logWarning(this.traceComponent,"{0} {1}",this.prefix+n,i)};n.prototype.WriteEngagementLog=function(n,t){_js.Trace.logWarning(this.traceComponent,"{0} {1}",this.prefix+n,t)};n.prototype.WriteStart=function(n){_js.Trace.logWarning(this.traceComponent,this.prefix+n)};n.prototype.WriteSuccess=function(n){_js.Trace.logWarning(this.traceComponent,this.prefix+n)};n.prototype.WriteFailure=function(n){_js.Trace.logError(this.traceComponent,this.prefix+n)};return n}();var OneDriveLogging=function(){function n(n){this.prefix=AddInType.FileHandler+"_";this.traceComponent=n}n.prototype.WriteDebugLog=function(n,t,i){t==!0?this.traceComponent.log(i,this.prefix+n):this.traceComponent.verbose(i,this.prefix+n)};n.prototype.WriteEngagementLog=function(n,t){this.traceComponent.log(t,this.prefix+n)};n.prototype.WriteStart=function(n){this.traceComponent.log("",this.prefix+n)};n.prototype.WriteSuccess=function(n){this.traceComponent.log("",this.prefix+n)};n.prototype.WriteFailure=function(n){this.traceComponent.log("",this.prefix+n)};return n}();function callInitializeIconControls(){typeof InitializeIconControls=="function"?InitializeIconControls():setTimeout("callInitializeIconControls()",300)}var ScriptOnDemand=function(){function n(){}n.AddScriptToDocument=function(n,t){var i=document.createElement("script");i.setAttribute("id",t);i.setAttribute("src",n);i.setAttribute("type","text/javascript");document.getElementsByTagName("head")[0].appendChild(i);return i};n.LoadControlsJavascript=function(){var t=SuiteExtensionsDataStore.GetInstance();var i=document.getElementById("SuiteExtensionsControlsScript");if(t.hostConfig.host==="SharePoint"){t.hostConfig.controlsScriptPath="/_layouts/15/online/scripts/SuiteExtensionsControls.js";t.hostConfig.controlsScriptLoadCallback=callInitializeIconControls}if(i==null&&t.hostConfig.controlsScriptPath){i=n.AddScriptToDocument(t.hostConfig.controlsScriptPath,"SuiteExtensionsControlsScript");i.onload=function(){typeof t.hostConfig.controlsScriptLoadCallback=="function"&&t.hostConfig.controlsScriptLoadCallback()}}else typeof t.hostConfig.controlsScriptLoadCallback=="function"&&t.hostConfig.controlsScriptLoadCallback()};n.LoadLocalizedStrings=function(t){if(t!=null&&typeof t.localizedStringsPath=="string"&&t.localizedStringsPath!=null&&t.localizedStringsPath.length>0&&(typeof Strings=="undefined"||typeof Strings.CloudApps=="undefined")){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4)if(i.status===200){t.logging.WriteSuccess("SuccessLoadLocalizedStrings");n.AddScriptToDocument(t.localizedStringsPath,"CloudAppsLocalizationScript")}else t.logging.WriteFailure("FailedLoadLocalizedStrings")};i.open("GET",t.localizedStringsPath,!0);i.send("");t.logging.WriteStart("StartLoadLocalizedStrings")}};return n}();var RefreshDetectorStatus=function(){function n(){}n.NotRefresh=0;n.StorageNotSupported=1;n.PerformanceNotSupported=2;n.UnknownException=3;n.Refresh=4;return n}();var RefreshDetector=function(){function n(){this.status=this.CheckRefresh()}n.GetInstance=function(){n.instance==null&&(n.instance=new n);return n.instance};n.prototype.IsRefresh=function(){return this.status==RefreshDetectorStatus.Refresh||this.status==RefreshDetectorStatus.PerformanceNotSupported};n.prototype.GetStatus=function(){return this.status};n.prototype.ListenForRefresh=function(){this.pageUnloadListener==null&&(this.pageUnloadListener=this.OnPageUnload.bind(this));Window.prototype.addEventListener.call(window,"unload",this.pageUnloadListener)};n.prototype.OnPageUnload=function(){var i=(location.href+"").split(location.hash||"#")[0];var t=+new Date;try{sessionStorage.setItem(n.LastPageKey,i);sessionStorage.setItem(n.UnloadTimeKey,t.toString())}catch(r){}};n.prototype.CheckRefresh=function(){try{if(!this.IsSessionStorageSupported())return RefreshDetectorStatus.StorageNotSupported;var r=sessionStorage.getItem(n.LastPageKey);var i=sessionStorage.getItem(n.UnloadTimeKey);if(r==null||i==null)return RefreshDetectorStatus.NotRefresh;var f=(location.href+"").split(location.hash||"#")[0];if(f!=r)return RefreshDetectorStatus.NotRefresh;if(window.performance==null||performance.timing==null||performance.timing.navigationStart==null)return RefreshDetectorStatus.PerformanceNotSupported;var u=Number(i);var t=performance.timing.navigationStart;return t==0?RefreshDetectorStatus.PerformanceNotSupported:t-u>n.MaxDelay?RefreshDetectorStatus.NotRefresh:RefreshDetectorStatus.Refresh}catch(e){return RefreshDetectorStatus.UnknownException}};n.prototype.IsSessionStorageSupported=function(){try{sessionStorage.setItem("Test","2");sessionStorage.removeItem("Test");return!0}catch(n){return!1}};n.UnloadTimeKey="RefreshDetector.UnloadTime";n.LastPageKey="RefreshDetector.LastPage";n.MaxDelay=100;return n}();var SuiteExtensionsLocalStorage=function(){function n(){if(n.instance)throw new Error("Error: Instantiation failed: Use SuiteExtensionsLocalStorage.GetInstance() instead of new.");n.instance=this}n.GetInstance=function(){if(!n.Supported())return null;n.instance===null&&(n.instance=new n);return n.instance};n.prototype.SetItem=function(n,t){this.SetItemInternal(this.GetExtensionTypeKey(n),t);this.SetItemInternal(this.GetExpirationKey(n),(+new Date).toString())};n.prototype.GetItem=function(n){return this.GetItemInternal(this.GetExtensionTypeKey(n))};n.prototype.SetItemObject=function(n,t){this.SetItem(n,JSON.stringify(t))};n.prototype.GetItemObject=function(n){return JSON.parse(this.GetItem(n))};n.prototype.GetExpirationKey=function(n){return this.GetExtensionTypeKey(n)+".LocalStorageSetTime"};n.prototype.IsExpired=function(t){var i=this.GetItemInternal(this.GetExpirationKey(t));if(i==null||i==undefined)return!0;else{var u=+i;var r=+new Date;return r-u>=n.MaximumExpiredPeriod?!0:!1}};n.Supported=function(){try{localStorage.setItem("Test","2");localStorage.removeItem("Test");return!0}catch(n){return!1}};n.prototype.GetExtensionTypeKey=function(n){return"Office365.AddIns."+n+"."+SuiteExtensionsDataStore.GetInstance().hostConfig.userId};n.prototype.SetItemInternal=function(n,t){localStorage.setItem(n,t)};n.prototype.GetItemInternal=function(n){return localStorage.getItem(n)};n.MaximumExpiredPeriod=72e5;n.instance=null;return n}();var TestDataPipe=function(){function n(){}n.prototype.getData=function(n,t){var u=n;var r=[{type:"FileHandler",appId:"4463c52c-491f-4559-a2b1-8b688fca9eb9",displayName:"GPX App",addInId:"12b4c4f2-d1c5-c12a-6245-1b5c3fdd85b1",properties:{extension:"gpx",fileIcon:"https://gpxfileapp-int.azurewebsites.net/content/pinpoint-16x16.png",openUrl:"https://gpxfileapp-int.azurewebsites.net/FileHandler/Open",previewUrl:"https://gpxfileapp-int.azurewebsites.net/FileHandler/Preview",newFileUrl:"https://gpxfileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"6f7b9f0c-e0f9-41f9-9bff-bcf66d599c2b",displayName:"TEST or INI App",addInId:"5f0b526b-f1e4-4def-9d43-3b0d28d4ff53",properties:{extension:"test",fileIcon:"https://testorinifileapp-int.azurewebsites.net/content/test.png",openUrl:"https://testorinifileapp-int.azurewebsites.net/FileHandler/Open",newFileUrl:"https://testorinifileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"6f7b9f0c-e0f9-41f9-9bff-bcf66d599c2b",displayName:"TEST or INI App",addInId:"e94ca6fe-66c3-4212-b4db-3c32c2b00d85",properties:{extension:"ini",previewUrl:"https://testorinifileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"f02cf431-6830-4090-9e3e-f8526e676852",displayName:"DRW App",addInId:"b0497361-9dff-4fcf-a8ac-ae11b5f27f1c",properties:{extension:"drw",openUrl:"https://drwfileapp-int.azurewebsites.net/FileHandler/Open",previewUrl:"https://drwfileapp-int.azurewebsites.net/FileHandler/Preview"}},{type:"FileHandler",appId:"523f34b4-200f-4239-aa3d-67682bf24bdc",displayName:"OFF App",addInId:"55d5929b-e6d3-4518-8297-98078e4f0ee8",properties:{extension:"off",fileIcon:"https://offfileapp-int.azurewebsites.net/content/off.png",openUrl:"https://offfileapp-int.azurewebsites.net/FileHandler/Open",newFileUrl:"https://offfileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"f266399a-ab8d-4407-9f2d-797a35a75d3f",displayName:"OFF or OFFICE App",addInId:"5afb40fd-3604-4cbe-b991-82d01a66a29b",properties:{extension:"off",fileIcon:"https://offorofficefileapp-int.azurewebsites.net/content/off-mt.png",previewUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Preview",newFileUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"f266399a-ab8d-4407-9f2d-797a35a75d3f",displayName:"OFF or OFFICE App",addInId:"3a3ff70e-23c7-4dae-8bad-43c314a98b82",properties:{extension:"office",fileIcon:"https://offorofficefileapp-int.azurewebsites.net/content/office.png",previewUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/Open",newFileUrl:"https://offorofficefileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"0c21f706-6071-4b2c-9273-59ea1f486eb9",properties:{extension:"ext1",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"88551be5-def0-4aeb-b2b6-6bf2e259f3ea",properties:{extension:"ext2",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext2.png",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"da4b51ef-4b12-434a-b79d-0e930db6f133",properties:{extension:"ext3",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext3.png",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview",newFileUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"92f9bcf2-aa0f-4a68-8714-c648af3fb715",properties:{extension:"ext4",fileIcon:"https://extfileapp-int.azurewebsites.net/content/ext4.png",newFileUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",appId:"b565d800-242f-4eef-aa2e-1b5f09529a94",displayName:"EXT App",addInId:"7fed2d59-55b3-490d-819c-474dfd772900",properties:{extension:"ext5",previewUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Preview",openUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/Open",newFileUrl:"https://extfileapp-int.azurewebsites.net/FileHandler/NewFile"}},{type:"FileHandler",addInId:"0436ffad-8131-4307-963b-9595ebb34e85",displayName:"Code View App",appId:"41e0235f-7bc4-4b32-83ec-2f4a7951be84",properties:{extension:"txa;txb;txc;off",fileIcon:"https://codeviewapp.azurewebsites.net/content/fileicon.png",openUrl:"https://codeviewapp.azurewebsites.net/filehandler/open",previewUrl:"https://codeviewapp.azurewebsites.net/filehandler/preview",newFileUrl:"https://codeviewapp.azurewebsites.net/filehandler/newfile"}}];var i=JSON.stringify(r);SuiteExtensionsDataStore.dataPipeSuccessCallback(u,i)};return n}();var SuiteExtensionsDataStore=function(){function n(){this.extensionsDictionary={};this.refreshRequested=!1;if(n._instance)throw new Error("Error: Instantiation failed: Use SuiteExtensionsDataStore.GetInstance() instead of new.");n._instance=this;this.localStorage=SuiteExtensionsLocalStorage.GetInstance();this.useAzureDataPipe=!1;var t=RefreshDetector.GetInstance();t.IsRefresh()&&(this.refreshRequested=!0);t.ListenForRefresh()}n.Initialize=function(t){ScriptOnDemand.LoadLocalizedStrings(t);var u=t.isFlightEnabled(AddInsFlights.AzureDataPipe);var i=n.GetInstance();if(i.hostConfig==null){var r=RefreshDetector.GetInstance();t.logging.WriteStart("StartIsRefresh");r.IsRefresh()?t.logging.WriteSuccess("SuccessIsRefresh"):t.logging.WriteFailure("FailedIsRefresh");t.logging.WriteStart("StartRefreshDetectorStatus");switch(r.GetStatus()){case RefreshDetectorStatus.NotRefresh:case RefreshDetectorStatus.Refresh:t.logging.WriteSuccess("SuccessRefreshDetectorStatus");break;case RefreshDetectorStatus.StorageNotSupported:t.logging.WriteFailure("FailedRefreshDetectorStatus_StorageNotSupported");break;case RefreshDetectorStatus.PerformanceNotSupported:t.logging.WriteFailure("FailedRefreshDetectorStatus_PerformanceNotSupported");break;case RefreshDetectorStatus.UnknownException:t.logging.WriteFailure("FailedRefreshDetectorStatus_UnknownException");break}}i.set_host(t);i.SetDataPipe(u);i.GetDataFromLocalStorage()};n.GetInstance=function(){n._instance===null&&(n._instance=new n);return n._instance};n.dataPipeSuccessCallback=function(t,i){var r=n.GetInstance();try{r.hostConfig.logging.WriteDebugLog("StartSetLocalStorage",!1,"Starting to set local storage with add-in data");r.hostConfig.logging.WriteStart("StartSetLocalStorage");r.localStorage.SetItem(t,i);r.hostConfig.logging.WriteSuccess("SuccessSetLocalStorage");r.hostConfig.logging.WriteDebugLog("SuccessSetLocalStorage",!1,"Successfully set local storage with add-in data")}catch(u){r.hostConfig.logging.WriteFailure("FailedSetLocalStorage");r.hostConfig.logging.WriteDebugLog("FailedSetLocalStorage",!0,"Failed to set local storage with add-in data in this browser "+u.message)}r.GetDataFromStorageAndLoadControlsJS(t,"StartLoadControlsScriptOnNewData","SuccessLoadControlsScriptOnNewData")};n.dataPipeFailCallback=function(t){n.GetInstance().hostConfig.logging.WriteDebugLog("FailedAzureDataPipe",!0,"Failed to get the add-in data from azure"+t.message)};n.prototype.SetDataPipe=function(n){this.useAzureDataPipe=n;this.dataPipe=this.useAzureDataPipe===!0?new AzureDataPipe:new TestDataPipe};n.prototype.set_host=function(n){this.hostConfig=n};n.prototype.GetDataFromLocalStorage=function(){var n=AddInType.FileHandler;if(this.localStorage!=null){this.GetDataFromStorageAndLoadControlsJS(n,"StartLoadControlsScript","SuccessLoadControlsScript");if(this.localStorage.IsExpired(n)||this.refreshRequested){this.refreshRequested=!1;this.dataPipe.getData(n,this.hostConfig)}}else{this.hostConfig.logging.WriteEngagementLog("LocalStorageNotSupportedInBrowser",null);var t=navigator.appCodeName+navigator.appName+navigator.appVersion;this.hostConfig.logging.WriteDebugLog("LocalStorageNotSupportedInBrowser",!0,"Local Storage is not supported in this browser: "+t)}};n.prototype.GetExtensions=function(n){return this.extensionsDictionary[n]?this.extensionsDictionary[n]:null};n.prototype.GetDataFromStorageAndLoadControlsJS=function(n,t,i){if(this.localStorage!=null){try{this.hostConfig.logging.WriteDebugLog("StartGetLocalStorageItem",!1,"Trying to get add-ins from local storage");this.hostConfig.logging.WriteStart("StartGetLocalStorageItem");var r=this.localStorage.GetItemObject(n);this.hostConfig.logging.WriteSuccess("SuccessGetLocalStorageItem");this.hostConfig.logging.WriteDebugLog("SuccessGetLocalStorageItem",!1,"Successfully retrieved add-ins from local storage")}catch(u){this.hostConfig.logging.WriteFailure("FailedGetLocalStorageItem");this.hostConfig.logging.WriteDebugLog("FailedGetLocalStorageItem",!0,"Failed to retrive add in from local storage: "+u.message)}if(r!=null&&r.length>0){this.extensionsDictionary[n]=r;this.hostConfig.logging.WriteDebugLog(t,!1,"Trying to load suite extensions controls javascript");this.hostConfig.logging.WriteStart(t);ScriptOnDemand.LoadControlsJavascript();this.hostConfig.logging.WriteSuccess(i);this.hostConfig.logging.WriteDebugLog(i,!1,"Successfully loaded suite extensions controls javascript")}}};n.prototype.getAddIns=function(n,t){var o=[];var r=this.GetExtensions(n);var e=0;if(r!=null)for(var i=0;i<r.length;i++){var u=r[i];if(u.type===n){var f=new FileHandlerAddIn(u);if(t.IsMatch(f)){o[e]=f;e++}}}return o};n._instance=null;return n}();var ControlType=function(){function n(){}n.Icon=0;n.Preview=1;n.Edit=2;n.FileCreation=3;return n}();var ControlCreationProperty=function(){function n(){}n.FileExtension="fileExtension";return n}();var SuiteExtensionsControlFactory=function(){function n(){}n.CreateControl=function(t,i){var u=SuiteExtensionsDataStore.GetInstance();if(u.hostConfig==null)throw new Error("Create Control: SuiteExtensionsDataStore.Initialize has not been called");if(!u.hostConfig.isFlightEnabled(AddInsFlights.FileHandlerFileCreation)&&i==ControlType.FileCreation)return null;var o="Creating File Handler Control: [extension="+t+"][control="+i+"]";u.hostConfig.logging.WriteDebugLog("CreatingControl",!1,o);var e={};e[ControlCreationProperty.FileExtension]=t;var r=new AddInFilter;switch(i){case ControlType.Icon:r.add(FileHandlerAddInPropertyName.Extension,AddInFilterOperation.Contains,t);u.hostConfig.isFlightEnabled(AddInsFlights.FileHandlerAddInPicker)||r.add(FileHandlerAddInPropertyName.FileIcon,AddInFilterOperation.NotNull,"");break;case ControlType.Preview:r.add(FileHandlerAddInPropertyName.Extension,AddInFilterOperation.Contains,t);u.hostConfig.isFlightEnabled(AddInsFlights.FileHandlerAddInPicker)||r.add(FileHandlerAddInPropertyName.PreviewUrl,AddInFilterOperation.NotNull,"");break;case ControlType.Edit:r.add(FileHandlerAddInPropertyName.Extension,AddInFilterOperation.Contains,t);u.hostConfig.isFlightEnabled(AddInsFlights.FileHandlerAddInPicker)||r.add(FileHandlerAddInPropertyName.OpenUrl,AddInFilterOperation.NotNull,"");break;case ControlType.FileCreation:if(t!="")throw new Error("Error: CreateControl: parameter fileExtension must be empty string when control type is file creation");r.add(FileHandlerAddInPropertyName.Extension,AddInFilterOperation.NotNull,"");r.add(FileHandlerAddInPropertyName.NewFileUrl,AddInFilterOperation.NotNull,"");break;default:break}var f=u.getAddIns(AddInType.FileHandler,r);u.hostConfig.logging.WriteDebugLog("CreatingControl",!1,"Found "+(f==null?0:f.length)+"AddIn");return f!=null&&f.length>0?n.CreateControlCommon(f,i,e):null};n.CreateControlCommon=function(n,t,i){if(typeof SuiteExtensionsControl!="undefined"){var f=SuiteExtensionsDataStore.GetInstance();var e="Creating Common Control:[control="+t+"]";f.hostConfig.logging.WriteDebugLog("CreatingCommonControl",!1,e);if(n.length>0&&n[0].type===AddInType.FileHandler){var r=n;switch(t){case ControlType.Icon:var u=i[ControlCreationProperty.FileExtension];return new IconControl(r,u);case ControlType.Preview:var u=i[ControlCreationProperty.FileExtension];return new PreviewControl(r,u);case ControlType.Edit:var u=i[ControlCreationProperty.FileExtension];return new EditControl(r,u);case ControlType.FileCreation:return new FileCreationMenu(r);default:f.hostConfig.logging.WriteDebugLog("CreatingCommonControl",!0,"Invalid Control Type");return null}}}return null};return n}();var AddInType=function(){function n(){}n.FileHandler="FileHandler";return n}();var AddIn=function(){function n(n){this.addInId=n[AddInPropertyName.AddInId];this.type=n[AddInPropertyName.Type];this.appId=n[AddInPropertyName.AppId];this.displayName=n[AddInPropertyName.DisplayName];this.id=this.appId+"_"+this.addInId}return n}();var AddInPropertyName=function(){function n(){}n.AddInId="addInId";n.Type="type";n.AppId="appId";n.DisplayName="displayName";return n}();var AddInFilterOperation=function(){function n(){}n.Equals=1;n.NotNull=2;n.Contains=3;return n}();var FilterClause=function(){function n(n,t,i){this.name=n;this.operation=t;this.value=i}n.prototype.IsMatch=function(n){var t=n[this.name];switch(this.operation){case AddInFilterOperation.Equals:if(t==undefined)return!1;if(typeof t=="object")throw new Error("Error: FilterClause: the property to test for Equals shouldn't be an object.");return t==this.value?!0:!1;case AddInFilterOperation.NotNull:return t!=undefined?!0:!1;break;case AddInFilterOperation.Contains:if(t==undefined)return!1;if(typeof t!="object"||typeof t.indexOf!="function")throw new Error("Error: FilterClause: the property to test for Contains should be an Array.");return t.indexOf(this.value)>=0?!0:!1;break;default:return!1}};return n}();var AddInFilter=function(){function n(){this.clauses=[]}n.prototype.add=function(n,t,i){this.clauses.push(new FilterClause(n,t,i))};n.prototype.IsMatch=function(n){var t=!0;for(var i in this.clauses)t=t&&this.clauses[i].IsMatch(n);return t};return n}();var FileHandlerAddIn=function(n){__extends(t,n);function t(t){n.call(this,t);var u=t.properties[FileHandlerAddInPropertyName.Extension];if(u!=undefined){this.extension=u.split(";");var f=this.extension.length>1;if(f){var i=SuiteExtensionsDataStore.GetInstance().hostConfig;if(i!=null){i.logging.WriteStart("StartParsingLongExtensionsProperty");i.logging.WriteDebugLog("ParsingLongExtensionsProperty",!1,"Number of extensions is "+this.extension.length)}}this.extension=this.extension.filter(function(n){return n.length>0});var r={};this.extension.forEach(function(n){r[n]=!0});this.extension=Object.keys(r);if(f&&i!=null){i.logging.WriteDebugLog("ParsingLongExtensionsProperty",!1,"Number of unique extensions is "+this.extension.length);i.logging.WriteSuccess("SuccessParsingLongExtensionsProperty")}}else this.extension=undefined;this.fileIcon=t.properties[FileHandlerAddInPropertyName.FileIcon];this.openUrl=t.properties[FileHandlerAddInPropertyName.OpenUrl];this.previewUrl=t.properties[FileHandlerAddInPropertyName.PreviewUrl];this.newFileUrl=t.properties[FileHandlerAddInPropertyName.NewFileUrl]}return t}(AddIn);var FileHandlerAddInPropertyName=function(n){__extends(t,n);function t(){n.apply(this,arguments)}t.Extension="extension";t.FileIcon="fileIcon";t.OpenUrl="openUrl";t.PreviewUrl="previewUrl";t.NewFileUrl="newFileUrl";return t}(AddInPropertyName);
window.scriptsLoaded['suiteextensions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['suiteextensions.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
