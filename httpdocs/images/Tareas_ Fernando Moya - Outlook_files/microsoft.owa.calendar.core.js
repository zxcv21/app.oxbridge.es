try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.core.js'] = (new Date()).getTime();
Type.registerNamespace("_cc");_cc.cr=function(n,t,i,r){_cc.cr.initializeBase(this);this.b=n;this.i=n.J();this.d=t;this.h=i;this.g=r};_cc.cr.prototype={b:null,h:null,d:null,i:!1,g:null,c:function(){return!0},u:function(n){var i=new _gg.po(this.x);i.shouldPrecedeOfflineSyncActions=this.c();i.explicitLogonUser=this.h;var t=new _gg.ef;t.CalendarId=new _g.Q(_g.r.a(this.b.bh.ParentFolderId));t.EventId=_g.g.a(_h.R.a(this.b));t.Notes=new _g.D("HTML",this.g);var r=new _gg.gM(this.y());r.Body=t;n.i(r,i,this.f,this.e)},F:function(){_a.cX.prototype.F.call(this);var n=this.d;n&&(this.i?n.j(this.b.bh.InstanceKey):n.L(this.b.bh.ItemId))}};_cc.cZ=function(){};_cc.cZ.registerInterface("_cc.cZ");_cc.N=function(n,t,i,r){this.h=Function.createDelegate(this,this.g);this.c=n;this.e=t;this.d=i;this.b=r};_cc.N.prototype={c:null,b:null,e:null,d:null,a:null,f:null,g:function(){this.a&&(this.a.n!==this?this.a.V(this):this.a.o&&this.a.V(null))}};_cc.cv=function(n,t,i,r,u,f){_cc.cv.initializeBase(this,[n,t,null,f]);this.G=n;this.Y(r);this.V(u);this.H=i};_cc.cv.prototype={G:null,n:null,H:null,R:!0,o:!0,I:!1,V:function(n){if(this.n!==n){this.n&&!this.I&&this.n.f.i(!1);this.n=n;this.n&&!this.I&&this.n.f.i(!0);this.bk("CurrentOption");this.X();this.H&&(this.n?this.H(this.n.d):this.H(null));this.I&&(this.n=null)}return n},W:function(n){if(this.R===n)return n;this.R=n;this.X();return n},Y:function(n){for(var u=n.length,r=new Array(u),i=0;i<u;i++){var t=n[i];t.a=this;r[i]=new _fm.h(t.c,t.e,new _C(t.h,_a.a.F),this.n===t,!1,null,t.b,t.d);r[i].Q(!1);t.f=r[i]}this.D(new _fm.f(r))},X:function(){!this.R||$a(this.n)||_js.d.b(this.n.c)?this.m(this.G):_js.d.b(this.G)?this.m(this.n.c):this.m(String.format("{0}: {1}",this.G,this.n.c))}};_cc.L=function(n,t){_cc.L.initializeBase(this);if(n)this.d=new _C(n,_cc.L.a);else{var r=this;var i=function(){};this.d=new _C(i,_cc.L.a)}this.c(t)};_cc.L.prototype={d:null,e:!1,a:function(){return this.d},b:function(){return this.e},c:function(n){this.e=n;this.bk("ShowPopOutControl");return n}};var ICalendarMiniatureQueryTableFactory=function(){};ICalendarMiniatureQueryTableFactory.registerInterface("ICalendarMiniatureQueryTableFactory");function CalendarCoreComponent(){}CalendarCoreComponent.$$cctor=function(){_a.r.a().a(CalendarCoreComponent)};CalendarCoreComponent.prototype={a:function(n,t,i){var r=n.a(_a.f);_cc.b.w(i.e(),i.a(),i.h(),n.a(_a.bG));var nt=this;n.b(_cc.a,function(){return new _cc.a(n.a(_a.f),n.a(_g.f))}).a();var tt=this;n.b(CalendarsCache,function(){return new CalendarsCache(n.d(IBirthdayCalendarFactory),n.a(_g.gb),n.a(ICalendarsConfiguration),n.a(_cc.T),n.a(_a.f),n.a(_g.f),n.a(_a.s))}).b(ICalendars).a().c(_g.i.g);var it=this;n.b(CalendarsConfiguration,function(){return new CalendarsConfiguration(n.a(_cc.T),n.a(_g.f),n.a(_a.s))}).b(ICalendarsConfiguration).b(IMasterCategoryListProvider).a();var k=this;n.b(_cc.ba,function(){return new _cc.ba(n.a(_g.f),n.a(_a.s),n.c(IBookingManagementFactory))}).b(_g.gb).a();var d=this;n.b(_cc.bE,function(){return new _cc.bE}).b(_cc.T).a();var g=this;n.b(_cc.bK,function(){return new _cc.bK(n.a(_a.s),n.a(_a.f))}).a();var rt=this;n.b(_cc.U,function(){return new _cc.U(10,n.a(ICalendars),n.a(_cc.bO),r.a().c().Enabled?n.c(IModernGroupCalendarsProvider):null,n.a(_js.k),n.a(_ff.c),n.a(_cc.a))}).a().b(_cc.s);var ot=this;n.b(_cc.bO,function(){return new _cc.bO(i.a(),i.d()==="AnonymousCalendar",n.a(_g.f),n.a(_a.s))}).a();var st=this;n.b(_cc.bL,function(){return new _cc.cA}).a();var ht=this;n.b(_cc.u,function(){return new _cc.u(n.a(_a.f),n.a(_cc.s).a(),n.a(_cc.bK),n.a(ICalendars),n.a(_cc.bL))}).a();var ut=this;n.b(_cc.bq,function(){return new _cc.bq(n.a(_y.a),n.d(IComposeCalendarItemViewModelFactory))}).a();var ft=this;n.b(ICalendarPrefetcher,function(){return OwaApplication.b?null:new _cc.cF(n.a(ICalendars),n.a(_cc.bL),n.a(_ff.a),i.b())}).a();var et=this;n.b(_cc.h,function(){return new _cc.h(n.a(_y.a))}).a();var b=this;n.b(_cc.bX,function(){var t=!n.a(_h.o).a();return new _cc.bX(n.a(_a.s),n.a(_y.a),n.c(IMailComposeContextFactory),n.f(_cc.bv),n.a(_cc.u),n.a(_ff.c),n.a(_cc.h),n.a(_cc.bA),t)}).a();var o=this;n.b(_cc.bk,function(){return new _cc.bk(n.a(_ff.c))}).b(_cc.f).a();var s=this;n.b(_cc.I,function(){return new _cc.I(n.a(_y.cW),n.a(_cc.bw),n.f(_cc.bX),n.a(_a.e),n.f(_cc.bW),n.f(_cc.bv),n.a(_gg.t),n.a(_a.Y))}).a();var h=this;n.b(_cc.bW,function(){return new _cc.bW(n.c(IComposeCalendarItemViewModelFactory),n.c(IComposeBookingItemViewModelFactory),n.d(ICalendarItemDetailsViewModelFactory),n.d(IBirthdayFactory),n.a(_y.a),n.a(ICalendars),n.a(_cc.f))}).a();var u=this;n.b(IScheduleFollowupViewModelFactory,function(){return new ScheduleFollowupViewModelFactory(n.d(IComposeCalendarItemViewModelFactory),n.a(_a.s),n.a(_y.a))}).a();var f=this;n.b(_cc.bv,function(){return new _cc.bv(n.c(IMailComposeViewModelFactory),n.a(_y.a))}).b(ICalendarMailComposeConductorFactory).a();var e=this;n.b(_cc.bw,function(){return new _cc.bw(n.a(IInferenceTracker),n.a(_a.s),n.a(_y.a),n.a(_gg.t),n.a(_a.e),n.f(IProposeNewTimeManager),_cc.z.a(n.a(_a.f)),n.a(_cc.bA),n.a(_cc.u))}).b(IMeetingResponseViewModelFactory).a();var c=this;n.b(_cc.bB,function(){return new _cc.bB(n.a(_ff.c),n.a(_a.f),n.a(_y.a).a())}).a();var y=this;n.b(_cc.bg,function(){return new _cc.bg(n.a(_y.a),n.a(ICalendars),n.a(_a.s))}).a();var p=this;n.b(_cc.bD,function(){return r.a().bh().Enabled?new _cc.bD(n.f(ICalendars),n.f(_cc.s),n.a(_ff.c)):null}).a();var w=this;n.b(IGetCalendarItemActionFactory,function(){return new _cc.ct}).a();var l=this;n.b(ICancelCalendarItemActionFactory,function(){return new _cc.cs}).a();var a=this;n.b(ICalendarTimeConverterFactory,function(){return new _cc.cu}).a();var v=this;n.b(_cc.bA,function(){return new MessageEditorViewModelFactory}).a()},b:function(){return[new _a.B(_cc.bB,2,9),new _a.B(_cc.bD,2,1)]}};_cc.bB=function(n,t,i){var r=this;_cc.ca.$$(_g.eZ).a=function(t){(_cc.bG.isInstanceOfType(t)||_cc.bH.isInstanceOfType(t)||_cc.bM.isInstanceOfType(t)||_cc.bN.isInstanceOfType(t)||_cc.bI.isInstanceOfType(t)||_cc.bJ.isInstanceOfType(t)||_cc.bP.isInstanceOfType(t))&&n.a(_h.cc,new _h.cc)}};_cc.dj=function(){};_cc.dj.registerInterface("_cc.dj");_cc.T=function(){};_cc.T.registerInterface("_cc.T");_cc.dh=function(){};_cc.dh.registerInterface("_cc.dh");_cc.bL=function(){};_cc.bL.registerInterface("_cc.bL");_cc.di=function(){};_cc.di.registerInterface("_cc.di");_cc.w=function(){};_cc.w.prototype={Disabled:0,AvailabilityOnly:1,LimitedDetails:2,FullDetails:3,Editor:4,Delegate:5};_cc.w.registerEnum("_cc.w",!1);_cc.k=function(){};_cc.k.prototype={invalid:0,Day:1,Week:2,WorkWeek:3,Month:4,Agenda:5,Miniature:6,PrefetchMonth:7,PrefetchDay:8,ClearCalendar:9};_cc.k.registerEnum("_cc.k",!1);var IModernGroupCalendarsProvider=function(){};IModernGroupCalendarsProvider.registerInterface("IModernGroupCalendarsProvider");_cc.s=function(){};_cc.s.registerInterface("_cc.s");_cc.cO=function(){};_cc.cO.prototype={None:0,Internal:1,Federated:2,Publishing:3,Consumer:4};_cc.cO.registerEnum("_cc.cO",!1);_cc.ca=function(){this.b=String.format(_bms.E.b,-1);_cc.ca.$$(this.$$gta["_cc.ca"].T).initializeBase(this);_cc.ca.$$(_g.eZ).a&&this.z(_cc.ca.$$(_g.eZ).a)};_cc.ca.$$=function(n){var i="ca"+"$"+n.getName().replace(/\./g,"_");if(!_cc[i]){var t=_cc[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_cc.ca.apply(this,t)};var h=_h.dX.$$(n);t.registerClass("_cc."+i,h);var s={"_cc.ca":{T:n}};var e=h.prototype.$$gta;for(var c in e){var o={key:c,value:e[c]};s[o.key]=o.value}t.prototype.$$gta=s;var u=_cc.ca.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.a=null}return _cc[i]};_cc.ca.prototype={cy:function(n,t,i){if(!n.WasSuccessful){this.b=_h.cz.a(n.ErrorCode);i(Error.create(this.b));return}try{this.m(n)}catch(r){i(r);return}t()}};_cc.h=function(n){this.c=Function.createDelegate(this,this.e);this.b=n};_cc.h.a=function(n,t){_cc.h.c(n.t,t)};_cc.h.c=function(n,t){if(!n){_js.Trace.logError(_cc.h.b,"Action shouldn't fail without an error.");return""}var e;var o;var i=null;var w,y,v;(v=_h.P.a(n,w={val:o},y={val:i}),o=w.val,i=y.val,v)?_js.Trace.logWarning(_cc.h.b,"Offline service command rejected with the following rejection error code: {0}",_bc.S.toString(o)):i=n;var s;var u;var r="";var p,a,c,l;if(l=_cc.h.i(i,p={val:s},a={val:e},c={val:u}),s=p.val,e=a.val,u=c.val,l)if(s){r=_h.P.f(u);if(r===""){r=_u.c.e;var h=String.format("Action finished with an unknown response code: {0}. Status code {1}",u,e);i.message&&(h=h+String.format(" Server message: {0}",i.message));_js.Trace.logWarning(_cc.h.b,h)}}else r=_h.P.g(e);if(r===""){var f=String.format("Action failed with an unknown error format.");i.message&&(f=f+String.format(" Server message: {0}",i.message));_js.Trace.logError(_cc.h.b,f);return f}var k=_u.c.Q;var b=[k,r];_a.F.b(b,0,t);return r};_cc.h.i=function(n,t,i,r){i.val=0;t.val=!1;r.val="NoError";if(_cc.h.h(n,i)){if(i.val>=200&&i.val<300){t.val=!0;r.val="ErrorInternalServerError"}return!0}var u=n[_cc.h.g];if(u===_g.U.dataContractName){t.val=!0;r.val=_cc.h.d(n);return!0}return!1};_cc.h.d=function(n){var t=n[_cc.h.e];if($a(t)){_js.Trace.logWarning(_cc.h.b,"Server exception doesn't contain a response code.");return"ErrorInternalServerError"}return t};_cc.h.h=function(n,t){t.val=n[_cc.h.f];return $a(t.val)?!1:!0};_cc.h.prototype={b:null,a:0,d:function(n){n===1&&n>this.a&&this.b.k(this.c);this.a=n;n||this.b.n(this.c);return n},e:function(n){n.a(_u.c.DM)}};_cc.bG=function(n,t,i){_cc.bG.initializeBase(this);_a.b.c(n,"parentGroupId");this.c=t;this.d=i};_cc.bG.prototype={c:null,d:null,u:function(n){var t=_g.s.isInstanceOfType(this.c)?this.c.bh.OwnerEmailAddress:null;n.dt(this.c.bh.CalendarName,this.c.bh.ParentGroupId,t,null,this.r,this.q)},m:function(n){if(_g.C.isInstanceOfType(this.c)){this.d.i(n.NewFolderId);this.c.n(n.NewFolderId)}this.c.m(n.NewCalendarEntryId)}};_cc.S=function(n,t){this.h=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.o);_cc.S.initializeBase(this);this.q(n);this.g=t;n.bh.ParentFolderId&&(this.b=_g.r.c(n.bh.ParentFolderId))};_cc.S.b=function(n){var t=new _g.L;n.bh.ItemId&&!n.co()&&(t.ItemId=n.bh.ItemId);n.cY()&&(t.CalendarItemType="RecurringMaster");t.ClientSeriesId=n.bh.ClientSeriesId||"testID"+Math.random();t.Subject=n.bh.Subject;if(n.C()){var i=n.C().a();i||(i="Text");t.Body=new _g.D(i,n.C().bh.Value)}$a(n.bF())||(t.Sensitivity=n.bF());n.br()&&n.br().b()>0&&(t.Categories=n.br().f());t.Charm=n.cb();t.ReminderIsSet=n.bh.ReminderIsSet;t.ReminderMinutesBeforeStart=n.bh.ReminderMinutesBeforeStart;t.IsResponseRequested=!!n.bh.IsResponseRequested;$a(n.bh.IsAllDayEvent)||(t.IsAllDayEvent=n.bh.IsAllDayEvent);n.a()&&(t.Start=n.a().j());n.b()&&(t.End=t.IsAllDayEvent?n.b().f().c(1).j():n.b().j());$a(n.k())||(t.FreeBusyType=n.k());n.q()&&n.q().b()>0&&(t.RequiredAttendees=_cc.m.a(n.q().i.p));n.v()&&n.v().b()>0&&(t.OptionalAttendees=_cc.m.a(n.v().i.p));n.G()&&n.G().b()>0&&(t.Resources=_cc.m.a(n.G().i.p));if(n.cY())t.EventOccurrences=_cc.S.d(n);else{var u=_cc.S.c(n);u&&(t.Recurrence=u)}var r=_g.w.d(n.r());r&&(t.Location=r);!n.bE()&&n.bH()&&n.bH().b()>0&&(t.InboxReminders=n.bH().i.p);_h.j.h(t,n);return t};_cc.S.d=function(n){for(var u=new _ff.d,r=n.cY().e.f(),t=0;t<=r.length-1;t++){var i=new _g.L;i.Start=r[t].a().j();i.End=r[t].b().j();i.Location=new _g.dN;i.Location.DisplayName=r[t].r().bh.DisplayName;u.c(i)}return u.h()};_cc.S.c=function(n){var i=null;var t=n;t&&t.A()&&(i=_g.bi.a(t.A()));return i};_cc.S.prototype={b:null,g:!1,d:function(){return this.ec(_cc.S.a)},q:function(n){this.eb(_cc.S.a,n);return n},c:function(){return!1},j:function(){return"CreateCalendarEventAction"},l:function(){return[_cc.S.b(this.d())]},u:function(n){var i=this.m();var t=this.k();$a(this.j())||t.actionName||(t.actionName=this.j());this.g?n.du(i,t,this.i,this.e):n.k(i,t,this.f,this.e)},k:function(){return new _gg.qs(this.x)},m:function(){var n=new _g.eg;n.Items=this.l();n.ClientSupportsIrm=!0;$a(this.b)||(n.SavedItemFolderId=this.b);var t=new _g.fg(this.y());t.Body=n;return t},p:function(n,t,i){var u=n.Body.ResponseMessages.Items[0];var r=u.Items[0];if(r){this.d().bG(r.ItemId);this.d().eF(r.InstanceKey);t()}else i(Error.create("No Item in response"))},n:function(){this.S()!==3&&this.J(null)},o:function(n,t){this.E=n;this.p(t,this.h,this.e)}};_cc.bf=function(){_cc.bf.resolveInheritance();this.h=this.cB;_cc.bf.initializeBase(this)};_cc.bf.a=function(n,t){var r=n.d();var i=_a.c.p(r,t);var u=n.i()>i?i:n.i();return new _a.c(t,r,u)};_cc.bf.prototype={i:null,e:null,R:null,b:function(){return this.R},j:function(n){this.R=n;return n},X:null,d:function(){return this.X},o:function(n){this.X=n;return n},T:null,g:function(){return this.T},l:function(n){this.T=n;return n},Y:0,k:function(n){this.Y=n;return n},ba:!1,m:function(n){this.ba=n;return n},U:!1,c:function(){return this.U},n:function(n){this.U=n;return n},Z:null,f:function(){return this.Z},u:function(n){this.i=_a.d.b(_a.a.W,"GetBirthdayCalendarView");var u=this.e.a.j();var f=this.e.b.j();var r=new _gg.ii(u,f);var t=new _gg.tx(this.x);t.actionName="GetBirthdayCalendarViewAction";var i=new _gg.ih(this.y(),r);n.ej(i,t,this.r,this.q)},cp:function(n){if(!n.BirthdayEvents){_a.d.a(this.i);this.i=null;return}this.R.g();for(var e=n.BirthdayEvents.length,o=n.BirthdayEvents,u=0;u<e;u++){var t=new _g.i;var i=new _g.df(o[u]);var h=i.c();var f=this.bb(h);if(this.e.c(f,!0,!0)){t.be(f);t.L(t.a().c(1));t.bG(i.bh.Id);t.H(!0);t.bV(i.bh.Name);t.cs=i;t.cd(this.T);this.R.a(t)}}var s=this.e.b.g(this.e.a)/864e5;var r=new _a.q;r.a("N",e);r.a("D",s);if(this.i){this.i.j=r.toString();_a.d.a(this.i);this.i=null}},Q:function(n){_a.d.a(this.i);this.i=null;_h.dX.prototype.Q.call(this,n)},bb:function(n){var t=_cc.bf.a(n,this.e.a.e());return this.e.c(t,!0,!0)?t:_cc.bf.a(n,this.e.b.e())}};_cc.m=function(n,t,i,r){_cc.m.initializeBase(this,[1]);_a.b.a(n,"item");this.f(n);this.j(t);this.m=_cc.m.d;n.bh.ParentFolderId&&(this.R=_g.r.c(n.bh.ParentFolderId));this.d=r;this.c=i;this.g="CreateCalendarItemAction"};_cc.m.a=function(n){if(n)for(var i=0;i<n.length;i++){var t=n[i];t.Mailbox&&t.Mailbox.ItemId&&(t.Mailbox.ItemId.ChangeKey=null)}return n};_cc.m.e=function(n){var t=new _g.L;n.bh.ItemId&&!n.co()&&(t.ItemId=n.bh.ItemId);t.Subject=n.bh.Subject;if(n.C()){var i=n.C().a();i||(i="Text");t.Body=new _g.D(i,n.C().bh.Value)}$a(n.bF())?n.cQ("Normal"):t.Sensitivity=n.bF();n.br()&&n.br().b()>0&&(t.Categories=n.br().f());t.Charm=n.cb();t.ReminderIsSet=n.bh.ReminderIsSet;t.ReminderMinutesBeforeStart=n.bh.ReminderMinutesBeforeStart;t.IsResponseRequested=!!n.bh.IsResponseRequested;t.IsAllDayEvent=$a(n.bh.IsAllDayEvent)?!1:n.bh.IsAllDayEvent;n.a()&&(t.Start=n.a().j());n.b()&&(t.End=t.IsAllDayEvent?n.b().f().c(1).j():n.b().j());$a(n.k())||(t.FreeBusyType=n.k());n.q()&&n.q().b()>0&&(t.RequiredAttendees=_cc.m.a(n.q().i.p));n.v()&&n.v().b()>0&&(t.OptionalAttendees=_cc.m.a(n.v().i.p));n.G()&&n.G().b()>0&&(t.Resources=_cc.m.a(n.G().i.p));var u=_cc.m.f(n);u&&(t.Recurrence=u);var r=_g.w.d(n.r());r&&(t.Location=r);!n.bE()&&n.bH()&&n.bH().b()>0&&(t.InboxReminders=n.bH().i.p);_h.j.h(t,n);return t};_cc.m.g=function(){var n=new _g.bE("IdOnly");n.AdditionalProperties=[new _g.e("InstanceKey")];return n};_cc.m.f=function(n){var i=null;var t=n;t&&t.A()&&(i=_g.bi.a(t.A()));return i};_cc.m.prototype={c:null,d:null,b:function(){return this.ec(_cc.m.b)},f:function(n){this.eb(_cc.m.b,n);return n},e:function(){return this.ec(_cc.m.c)},j:function(n){this.eb(_cc.m.c,n);return n},h:function(){var n=_h.fp.prototype.h.call(this);n.userDisplayName=_g.a.a().c().bh.UserDisplayName;n.userEmailAddress=_g.a.a().c().bh.UserEmailAddress;n.calendarFolderId=new _g.n(_g.b.a.nameToId("calendar").Id);n.explicitLogonUser=this.d;return n},k:function(){var n=_h.fp.prototype.k.call(this);n.Body.SendMeetingInvitations=_h.bs.toString(this.e());return n},l:function(){return[_cc.m.e(this.b())]},cp:function(n){var i=n.Items[0];this.b().bG(i.ItemId);this.b().eF(i.InstanceKey);var t=this.c;if(t)if(this.b().F())this.b().F()&&_cc.x.isInstanceOfType(t)&&t.H();else{_g.i.e(this.b());t.q(this.b(),0,!1)}}};_cc.bH=function(n){_cc.bH.initializeBase(this);this.c=n};_cc.bH.prototype={c:null,u:function(n){n.dv(this.c.e(),null,this.r,this.q)},m:function(n){this.c.g(n.NewGroupClassId);this.c.h(n.NewGroupItemId)}};_cc.bI=function(n,t,i){_cc.bI.initializeBase(this);this.c=n;this.e=t;this.d=i};_cc.bI.prototype={c:null,e:null,d:null,u:function(n){var t=new _g.g(this.c.bh.ItemId.Id);t.ChangeKey=this.c.bh.ItemId.ChangeKey;n.dE(t,null,this.r,this.q)},m:function(n){this.d.K(this.e,this.c)}};_cc.bJ=function(n){_cc.bJ.initializeBase(this);this.c=n};_cc.bJ.prototype={c:null,u:function(n){n.dF(this.c.d().Id,null,this.r,this.q)},m:function(n){}};_cc.bn=function(n,t){_cc.bn.initializeBase(this,[n,[t.i],null,"FullBookingItem",1,t.j==="discoveryMailboxMode"]);this.i=t;this.g="GetBookingItem";this.d=t.h==="Text"?_h.b.M():_h.b.H()};_cc.bn.b=function(n,t,i,r,u,f){i=$a(i)?_cc.bn.a:i;r=$a(r)?"defaultMode":r;u=$a(u)?0:u;n=t?new _h.R(n):n;return new _cc.ce(n,i,r,u,f)};_cc.bn.prototype={i:null,j:null,b:function(){return this.j},c:function(){return this.i},y:function(){return this.P("Exchange2015")},cp:function(n){var t=new _gg.e(n.Items[0]);t.bS(2);t.bc();this.j=t}};_cc.cI=function(){_cc.cI.initializeBase(this)};_cc.cI.prototype={e:null,y:function(){return this.P("Exchange2015")},u:function(n){_cc.cf.prototype.u.call(this,n);var t=new _g.em;t.ItemShape=_h.b.f();t.ShapeName="PartialBookingItem";t.Traversal="Shallow";var f=new _g.n(this.U.Id);f.ChangeKey=this.U.ChangeKey;t.ParentFolderIds=[f];if(_h.k.isInstanceOfType(this.R)){var e=this.R;var o=new _gg.E(e.a.j(),e.b.j());t.Paging=o}else throw Error.invalidOperation("Unsupported paging type");var i=new _g.bB(this.x);i.isAutomated=this.ba;i.isReload=this.Y;i.actionName=this.X?"GetBookingItemsAction_"+_cc.k.toString(this.X):"GetBookingItemsAction";if(this.G)i.explicitLogonUser=this.G;else throw Error.argumentNull("ExplicitLogonUser","ExplicitLogonUser can't be null while accessing a Booking mailbox");var s=new _g.el(this.y(),t);_js.Trace.logInfo(_a.a.i,String.format("FindItem paging: {0}",Object.getType(this.R).getName()));this.e=i;n.d(s,i,this.r,this.q);var r=t.ItemShape?t.ItemShape.AdditionalProperties:null;var u=r?r[0]:null;_js.Trace.logWarning(_a.a.i,"GetCalendarItems: {0}, {1}",u?u.FieldURI:"<null>",JsonParser.serialize(t.ParentFolderIds))},cp:function(n){if(n.RootFolder&&n.RootFolder.Items){var i=_js.e.s(_a.a.i,2,"ProcessResponseMessages:FindItem_GetBookingItems_"+n.RootFolder.Items.length);this.T.g();for(var t=0;t<n.RootFolder.Items.length;t++)this.bh(n.RootFolder.Items[t]);_js.e.e(i)}},bh:function(n){var t=new _gg.e(n);this.T.a(t)}};_cc.cd=function(n,t){_cc.cd.initializeBase(this,[n]);var i=_js.e.s(_a.a.b,2,"GetCalendarEventAction");this.f=null;this.d=t;this.e=[t.b()];_js.e.e(i)};_cc.cd.a=function(n){if(n.bh.IsOrganizer&&n.q())if(n.bh.Organizer)for(var r=n.bh.Organizer.Mailbox.EmailAddress,f=r?r.toLowerCase():"",t=0;t<n.q().b();t++){var i=n.q().a(t).bh.Mailbox.EmailAddress;if(i&&i.toLowerCase()===f){var u=n.q().t();_js.Trace.logInfo(_a.a.i,"Normalizing the RequiredAttendees Collection.");u.k(t);n.ba(u);break}}else _js.Trace.logWarning(_a.a.i,"model.Organizer is null.")};_cc.cd.prototype={d:null,f:null,e:null,b:function(){return this.f},c:function(){return this.d},cp:function(n){var i=_js.e.s(_a.a.i,2,"ProcessResponseMessage:GetCalItem");var t=new _g.i(n.Items[0]);t.bS(2);(this.d.c()==="discoveryMailboxMode"||this.d.c()==="archiveMode")&&t.ev(!0);OwaApplication.i||_cc.cd.a(t);t.bc();this.f=t;_js.e.e(i)},u:function(n){var r=new _gg.eK;r.EventIds=new Array(this.e.length);for(var i=0;i<this.e.length;i++)r.EventIds[i]=_g.g.a(this.e[i]);var t;var f=(t=new _gg.io,t.Header=this.y(),t.Body=r,t);var u=new _gg.mS(this.x);this.d.d()&&(u.explicitLogonUser=this.d.d());n.bA(f,u,this.r,this.q)}};_cc.cJ=function(n){_cc.cJ.initializeBase(this);_a.b.a(n,"requestedLinkedCalendar");this.c=n};_cc.cJ.prototype={c:null,e:null,f:null,d:!1,u:function(n){var i=new _g.fm;i.FolderId=this.g(this.c);var t=new _gg.tP(300);t.explicitLogonUser=this.c.bh.OwnerEmailAddress;n.q(i,t,this.r,this.q)},m:function(n){this.e=new _g.bS(n.CalendarFolder);n.MasterList&&(this.f=new _g.bm(n.MasterList));this.d=!0},Q:function(n){this.A&&(this.d=this.A.ErrorCode===31);_h.dX.prototype.Q.call(this,n)},g:function(n){var i;if(n.bh.IsGeneralScheduleCalendar){var t=new _g.A("calendar");t.Mailbox=new _g.d;t.Mailbox.EmailAddress=this.c.bh.OwnerEmailAddress;i=t}else i=new _g.n(this.c.a().Id);return i}};_cc.O=function(n,t){_cc.O.initializeBase(this,[n,[t.b()],null,"FullCalendarItem",1,t.c()==="discoveryMailboxMode"]);var i=_js.e.s(_a.a.b,2,"GetCalendarItemAction");this.j=null;this.i=t;this.g="GetCalendarItem";this.d=t.e()==="Text"?_h.b.M():_h.b.H();t.c()==="unblockMode"&&(this.d.BlockExternalImagesIfSenderUntrusted=!1);t.d()&&(this.f.explicitLogonUser=t.d());if(_cc.b.o()||_cc.b.n()){this.d=_ff.g.a(this.d);this.d.AdditionalProperties||(this.d.AdditionalProperties=[]);Array.add(this.d.AdditionalProperties,new _g.e("SuggestionCategory"));Array.add(this.d.AdditionalProperties,_g.c.Y());_cc.b.v()&&Array.add(this.d.AdditionalProperties,new _g.e("EntityDocument"));_cc.b.h(this.G)&&Array.add(this.d.AdditionalProperties,new _g.e("EntityNamesMap"))}_js.e.e(i)};_cc.O.a=function(n,t,i,r,u,f){i=$a(i)?_cc.O.b:i;r=$a(r)?"defaultMode":r;u=$a(u)?0:u;n=t?new _h.R(n):n;return new _cc.ce(n,i,r,u,f)};_cc.O.c=function(n){if(n.bh.IsOrganizer&&n.q())if(n.bh.Organizer)for(var r=n.bh.Organizer.Mailbox.EmailAddress,f=r?r.toLowerCase():"",t=0;t<n.q().b();t++){var i=n.q().a(t).bh.Mailbox.EmailAddress;if(i&&i.toLowerCase()===f){var u=n.q().t();_js.Trace.logInfo(_a.a.i,"Normalizing the RequiredAttendees Collection.");u.k(t);n.ba(u);break}}else _js.Trace.logWarning(_a.a.i,"model.Organizer is null.")};_cc.O.prototype={i:null,j:null,b:function(){return this.j},c:function(){return this.i},cp:function(n){var i=_js.e.s(_a.a.i,2,"ProcessResponseMessage:GetCalItem");var t=new _g.i(n.Items[0]);t.bS(2);(this.i.c()==="discoveryMailboxMode"||this.i.c()==="archiveMode")&&t.ev(!0);OwaApplication.i||_cc.O.c(t);t.bc();this.j=t;_js.e.e(i)}};_cc.ce=function(n,t,i,r,u){this.i=n;this.h=t;this.j=i;this.k=r;this.g=this.m();this.l=u};_cc.ce.prototype={i:null,g:null,h:"Best",j:"defaultMode",k:0,l:null,b:function(){return this.i},e:function(){return this.h},c:function(){return this.j},a:function(){return this.g},f:function(){return this.k},d:function(){return this.l},m:function(){var i=_g.bu.isInstanceOfType(this.i)?_g.bu.getName():_g.g.getName();var t=$a(this.h)?"":this.h;var n=$a(this.j)?"":this.j;return String.format("{0}_{1}_{2}_{3}",this.i.Id,i,t,n)}};_cc.P=function(){_cc.P.initializeBase(this)};_cc.P.$$cctor=function(){_cc.P.a=new _g.bE("IdOnly");_cc.P.a.AdditionalProperties=[new _g.e("ItemParentId"),new _g.e("Sensitivity"),new _g.e("AppointmentState"),new _g.e("IsCancelled"),new _g.e("HasAttachments"),new _g.e("LegacyFreeBusyStatus"),new _g.e("CalendarItemType"),new _g.e("Start"),new _g.e("End"),new _g.e("IsAllDayEvent"),new _g.e("Organizer"),new _g.e("Subject"),new _g.e("IsMeeting"),new _g.e("UID"),new _g.e("InstanceKey"),new _g.e("ItemEffectiveRights"),new _g.e("JoinOnlineMeetingUrl"),new _g.e("ConversationId"),new _g.e("CalendarIsResponseRequested"),new _g.e("Categories"),new _g.e("IsRecurring"),new _g.e("IsOrganizer"),_g.c.V(),new _g.e("IsSeriesCancelled")]};_cc.P.prototype={e:null,u:function(n){_cc.cf.prototype.u.call(this,n);this.U||(this.U=_g.b.a.nameToId("calendar"));var t=_cc.P.a;if(_cc.b.a()&&_js.d.a(this.G)){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("Charm"))}if(_cc.b.o()||_cc.b.n()){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("SuggestionCategory"));_cc.b.h(this.G)&&Array.add(t.AdditionalProperties,new _g.e("EntityNamesMap"))}if(_cc.b.r()&&_js.d.a(this.G)){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("IsNonPatternRecurring"))}if(_cc.b.d()&&_js.d.a(this.G)){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("MeetingRequestWasSent"))}var r=new _g.em(t,"Shallow");var o=new _g.n(this.U.Id);o.ChangeKey=this.U.ChangeKey;r.ParentFolderIds=[o];if(_g.ic.isInstanceOfType(this.R))r.Paging=this.R;else if(_h.k.isInstanceOfType(this.R)){var e=this.R;var s=new _gg.E(e.a.j(),e.b.j());r.Paging=s}else throw Error.invalidOperation("Unsupported paging type");var i=new _g.bB(this.x);i.isAutomated=this.ba;i.isReload=this.Y;i.actionName=this.X?"GetCalendarItemsAction_"+_cc.k.toString(this.X):"GetCalendarItemsAction";this.G&&(i.explicitLogonUser=this.G);var h=new _g.el(this.y(),r);_js.Trace.logInfo(_a.a.i,String.format("FindItem paging: {0}",Object.getType(this.R).getName()));this.e=i;n.d(h,i,this.r,this.q);var f=r.ItemShape?r.ItemShape.AdditionalProperties:null;var u=f?f[0]:null;_js.Trace.logWarning(_a.a.i,"GetCalendarItems: {0}, {1}",u?u.FieldURI:"<null>",JsonParser.serialize(r.ParentFolderIds))},cp:function(n){if(n.RootFolder&&n.RootFolder.Items){var i=_js.e.s(_a.a.i,2,"ProcessResponseMessages:FindItem_"+n.RootFolder.Items.length);this.T.g();for(var t=0;t<n.RootFolder.Items.length;t++)this.bh(n.RootFolder.Items[t]);_js.e.e(i)}}};_cc.cf=function(){_cc.cf.$$(this.$$gta["_cc.cf"].TResult,this.$$gta["_cc.cf"].TResponseMessage).resolveInheritance();this.h=this.cB;_cc.cf.$$(this.$$gta["_cc.cf"].TResult,this.$$gta["_cc.cf"].TResponseMessage).initializeBase(this)};_cc.cf.$$=function(n,t){var i="cf"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_cc[i]){var u=_cc[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_cc.cf.apply(this,t)};var h=_h.dj.$$(n,t);u.registerClass("_cc."+i,h,_cc.dj);var o={"_cc.cf":{TResult:n,TResponseMessage:t}};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}u.prototype.$$gta=o;var f=_cc.cf.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _cc[i]};_cc.cf.prototype={ba:!1,X:0,U:null,T:null,R:null,Y:!1,g:function(){return this.U},l:function(n){this.U=n;return n},b:function(){return this.T},j:function(n){this.T=n;return n},d:function(){return this.R},o:function(n){this.R=n;return n},m:function(n){this.ba=n;return n},k:function(n){this.X=n;return n},c:function(){return this.Y},n:function(n){this.Y=n;return n},f:function(){return this.C()},u:function(n){},bh:function(n){var t=new _g.i(n);this.T.a(t)}};_cc.cL=function(n,t,i){_cc.cL.initializeBase(this);this.f=n;this.k=t;this.j=i};_cc.cL.prototype={f:null,k:!1,j:!1,i:null,h:null,c:null,e:null,d:null,l:null,u:function(n){var t=new _gg.tQ(this.x);n.r(t,this.r,this.q)},W:function(){if(PageDataPayload.calendarFolders){this.m(PageDataPayload.calendarFolders);OwaApplication.i||(PageDataPayload.calendarFolders=null);return!0}return!1},m:function(n){var w=_js.e.s(_a.a.b,2,"ProcessResponse:GetCalendar");var t;var l;var i;var r;this.e=new _js.f;var o={};var v={};var a={};var f;this.f&&(a[this.f.toLowerCase()]=!0);for(var c=0;c<n.CalendarGroups.length;c++){t=new _cc.j;t.dW(n.CalendarGroups[c]);switch(t.c()){case 0:t.f(_u.c.Br);this.l=t;break;case 1:t.f(_u.c.f);this.d=t;break;case 2:t.f(_u.c.BZ);break}if(t.b())for(var e=t.b().y.length-1;e>=0;e--){i=t.b().y[e];if(i.f()){this.c=i;this.c.r(_u.c.Bh)}else if(_g.s.isInstanceOfType(i)){r=i;if(r.bh.IsOwnerEmailAddressInvalid)continue;if(r.g()){if(!this.j){t.b().o(e);continue}r.n(_g.a.a().c().bh.DefaultPublicFolderMailbox.toLowerCase())}else r.n(r.bh.OwnerEmailAddress.toLowerCase());if(this.k&&r.bh.IsGroupMailboxCalendar){_js.Trace.logInfo(_a.a.b,"Ommitting modern group calendar from Calendar folder list. OwnerEmail: {0}",r.bh.OwnerEmailAddress);t.b().m(i,!0);continue}f=r.bh.IsGeneralScheduleCalendar?r.bh.OwnerEmailAddress:r.bh.SharedFolderId.Id;if(f in a){_js.Trace.logInfo(_a.a.b,"Ommitting duplicate shared calendar from Calendar folder list. OwnerEmail: {0} DuplicateKey: {1}",r.bh.OwnerEmailAddress,f);t.b().m(i,!0);continue}a[f]=!0;var y=new _g.dl;y.FolderId=i.a();var s=new _g.bS(y);s.f(i.bh.CalendarName);var u=new _g.dp;u.CreateAssociated=u.CreateContents=u.CreateHierarchy=u.Read=u.Modify=u.ViewPrivateItems=!1;s.J(u);s.A(r.g());o[i.a().Id]=s}v[i.a().Id]=i;i.k(i.o())}this.e.a(t)}for(var h=0;h<n.CalendarFolders.length;h++){l=new _g.bS(n.CalendarFolders[h]);o[l.bh.FolderId.Id]=l}var p=o[this.c.a().Id];p.N("calendar");this.i=o;this.h=v;_js.e.e(w)}};_cc.cg=function(n){_cc.cg.initializeBase(this);_a.b.a(n,"calendarEntry can't be null");this.f=n};_cc.cg.prototype={f:null,c:null,e:0,g:0,d:!1,u:function(n){var i=new _gg.is;var t=new _g.n(this.f.a().Id);t.ChangeKey=this.f.a().ChangeKey;i.CalendarId=t;var r=new _gg.tU(this.x);n.ep(i,r,this.r,this.q)},m:function(n){this.c=new _js.f;this.d=n.IsAnonymousSharingEnabled;this.g=n.CurrentDeliveryOption;this.e=n.IsAnonymousSharingEnabled?_js.l.a(_cc.w,n.AnonymousSharingMaxDetailLevel):0;for(var r=n.Recipients,u=r.length,t=0;t<u;++t){var f=r[t];var i=new _cc.d;i.dW(f);this.c.a(i)}}};_cc.J=function(n,t,i,r){_cc.J.initializeBase(this,[n]);var u=_js.e.s(_a.a.b,2,"GetExpandedCalendarItemAction");this.f(null);this.g(t);this.e=r;i&&(this.d=i);_js.e.e(u)};_cc.J.prototype={d:null,e:null,b:function(){return this.ec(_cc.J.b)},f:function(n){this.eb(_cc.J.b,n);return n},c:function(){return this.ec(_cc.J.a)},g:function(n){this.eb(_cc.J.a,n);return n},u:function(n){var i;var f=null;if(this.c().b)i=f=new _gg.hG(this.c().b.j());else{i=new _gg.km;i.Start=this.c().a.a.j();i.End=this.c().a.b.j()}i.Count=this.c().c;var u=new _gg.dj(this.c().Id);f?u.ExpandAroundDateOccurrenceRange=f:u.Ranges=[i];var t=_cc.P.a;if(_cc.b.a()&&_js.d.a(this.e)){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("Charm"))}if(_cc.b.o()||_cc.b.n()){t=_ff.g.a(t);Array.add(t.AdditionalProperties,new _g.e("SuggestionCategory"));_cc.b.h(this.G)&&Array.add(t.AdditionalProperties,new _g.e("EntityNamesMap"))}var e=new _g.cR(t);e.ItemIds[0]=u;var o=new _g.cQ(this.y(),e);var r=new _g.ds(this.x);r.clientStoreItem=1;r.actionName="GetExpandedCalendarItemAction";_js.d.a(this.e)||(r.explicitLogonUser=this.e);n.a(o,r,this.r,this.q)},cp:function(n){throw Error.notImplemented("Messages are processed in ProcessResponseMessages method.");},cq:function(n){var u=_js.e.s(_a.a.i,2,"ProcessResponseMessages:GetExpandedCalendarItemAction");if(!n.length||n[0].ResponseClass==="Error")throw Error.create("GetExpandedCalendarItemAction failed.");if(n.length>0&&n[0].ResponseClass==="Success"){var i=n[0];if(i.Items.length>1){this.f(new _js.f);for(var t=1;t<i.Items.length;t++){var r=new _g.i(i.Items[t]);r.bS(0);this.b().a(r)}}}_js.e.e(u)}};_cc.ch=function(n,t){this.bg=new(_a.eB.$$(String));this.bf=new(_a.eB.$$(_g.cd));_cc.ch.initializeBase(this);this.Z=n;this.bg.b(n.bh.OwnerEmailAddress);this.bb=t};_cc.ch.prototype={Z:null,bb:null,be:null,e:function(){return this.bg},i:function(){return this.bf},u:function(n){var o=_js.e.s(_a.a.b,2,"GetSharedCalendarItemsRequest:PreProcessing");_cc.cf.prototype.u.call(this,n);var t=new _gg.fc(this.y());var f=new Array(1);var e=f[0]=new _gg.fo;e.Email=new _gg.ev;e.Email.Address=this.Z.bh.OwnerEmailAddress;var i=new _gg.eD;i.RequestedView="Detailed";var u=this.R;i.TimeWindow=new _gg.cV(_a.c.d(u.a),_a.c.d(u.b));t.Body.MailboxDataArray=f;t.Body.FreeBusyViewOptions=i;var r=new _gg.np(this.x);r.isAutomated=this.ba;r.actionName=_js.d.b(this.bb)?this.bo():this.bb;_js.e.e(o);this.be=_js.e.s(_a.a.b,517,"GetUserAvailabilityInternalRequest");n.C(t,r,this.r,this.q);_js.Trace.logWarning(_a.a.i,"GetSharedCalendarItems: {0}",JsonParser.serialize(t.Body))},H:function(){_a.cX.prototype.H.call(this);_js.e.e(this.be);_js.Trace.logWarning(_a.a.i,"Unable to fetch calendar data for user: "+this.Z.bh.OwnerEmailAddress)},ca:function(n,t){var u=_h.dj.prototype.ca.call(this,n,t);if(!u){var f=t.h[0];var i=f.Responses;if(!i||i.length!==1||!i[0].ResponseMessage)return Error.create("GetSharedCalendarItemsAction received malformed response.",n);var r=i[0].ResponseMessage;if(r.ResponseClass!=="Success"||r.ResponseCode!=="NoError"){n.responseCode=r.ResponseCode;return Error.create(r.MessageText,n)}}return u},cp:function(n){_js.e.e(this.be);var u=_js.e.s(_a.a.i,2,"ProcessResponseMessages:GetUserAvailabilityInternal");this.T.g();var t=n.Responses[0].CalendarView;var r=t.WorkingHours;if(r)this.bf.b(new _g.cd(r));else{_js.Trace.logInfo(_a.a.i,"Unable to fetch working hours for user: "+this.Z.bh.OwnerEmailAddress);this.bf.b(null)}this.Z.F=t.FreeBusyViewType==="Detailed"?"Detailed":"FreeBusy";for(var i=0;i<t.Items.length;i++)this.bh(t.Items[i]);_js.e.e(u)},bo:function(){return String.format("{0}_{1}","GetSharedCalendarItemsAction",_cc.k.toString(this.X))}};_cc.bM=function(n,t,i){_cc.bM.initializeBase(this);_a.b.b(n,"calendarToRename");_a.b.c(t,"newCalendarName");_a.b.b(i,"calendarsCache");this.c=n;this.d=t;this.e=i};_cc.bM.prototype={c:null,d:null,e:null,u:function(n){var t=new _g.g(this.c.bh.ItemId.Id);t.ChangeKey=this.c.bh.ItemId.ChangeKey;n.fY(t,this.d,null,this.r,this.q)},m:function(n){this.c.bh.ItemId.ChangeKey=n.NewCalendarEntryId.ChangeKey;this.c.r(this.d);if(_g.C.isInstanceOfType(this.c)){var i=this.c;if(this.e.c()){var t=this.e.b(i.a());if(t){t.bh.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.d)}}}}};_cc.bN=function(n,t){_cc.bN.initializeBase(this);this.c=n;this.d=t};_cc.bN.prototype={c:null,d:null,u:function(n){var t=new _g.g(this.c.d().Id);t.ChangeKey=this.c.d().ChangeKey;n.fZ(t,this.d,null,this.r,this.q)},m:function(n){this.c.f(this.d);this.c.d().ChangeKey=n.NewGroupItemId.ChangeKey}};_cc.cM=function(n){_cc.cM.initializeBase(this);this.d=n;n.bh.ParentFolderId&&(this.b=_g.r.c(n.bh.ParentFolderId))};_cc.cM.prototype={b:null,d:null,e:function(){return"ScheduleFollowupAction"},c:null,y:function(){return this.P("Exchange2015")},cp:function(n){n&&n.Item&&(this.c=n.Item.ItemId)},u:function(n){var i=this.g();var t=this.f();$a(this.e())||t.actionName||(t.actionName=this.e());n.ge(i,t,this.r,this.q)},f:function(){return new _gg.BY(this.x)},g:function(){var n=new _gg.fN;n.ClientId=Math.random().toString();$a(this.b)||(n.SavedItemFolderId=this.b);n.FollowupSourceItemId=_g.g.a(this.d.bh.ItemId);var t=new _gg.kW;t.Header=this.y();t.Body=n;return t}};_cc.bP=function(n,t){_cc.bP.initializeBase(this);_a.b.a(n,"Calendar to modify the color of must be specified.");this.c=n;this.d=t};_cc.bP.prototype={c:null,d:0,u:function(n){var t=new _g.g(this.c.bh.ItemId.Id);t.ChangeKey=this.c.bh.ItemId.ChangeKey;n.gj(t,this.d,null,this.r,this.q)},m:function(n){this.c.k(this.d);this.c.y(this.d);this.c.bh.ItemId.ChangeKey=n.NewCalendarEntryId.ChangeKey}};_cc.cN=function(n,t){_cc.cN.initializeBase(this);this.b=n;this.c=t};_cc.cN.prototype={b:null,c:"None",u:function(n){var u=new _g.dl;u.Charm=this.c;var e=new _g.da(new _g.e("Charm"),u);var r=new _g.dr(_g.r.a(this.b.bh.FolderId));r.Updates=[e];var t=new _g.db;t.FolderChanges=[r];var i=new _g.dz(this.y());i.Body=t;var f=new _g.eM(this.x);n.b(i,f,this.r,this.q)},cp:function(n){this.b.O(this.c);this.b.bh.FolderId.ChangeKey=n.Folders[0].FolderId.ChangeKey}};_cc.bQ=function(n,t,i,r){_cc.bQ.initializeBase(this);_a.b.a(n,"calendarEntry can't be null");this.d=n;this.c=t;this.h=i;this.i=r};_cc.bQ.prototype={d:null,c:0,h:!1,i:!1,g:null,e:null,f:null,j:0,k:0,u:function(n){this.g=_js.e.s(_a.a.b,517,"SetCalendarPublishingAction:Request");var t=new _gg.le;var i=new _g.n(this.d.a().Id);i.ChangeKey=this.d.a().ChangeKey;t.CalendarId=i;t.Publish=this.c&&this.h?!0:!1;t.DetailLevel=_cc.w.toString(this.c);t.ResetUrl=this.i;var r=new _gg.CC(this.x);n.gl(t,r,this.r,this.q)},m:function(n){this.e=n.BrowseUrl;this.f=n.ICalUrl;this.j=n.CurrentDetailLevel?_js.l.a(_cc.w,n.CurrentDetailLevel):0;this.k=n.MaxDetailLevel?_js.l.a(_cc.w,n.MaxDetailLevel):0;_js.e.e(this.g)}};_cc.cR=function(n,t,i,r,u,f){_cc.cR.initializeBase(this,[n,t,i,r,u,f]);this.j="UpdateBookingItemAction"};_cc.G=function(n,t,i,r,u,f){_cc.G.initializeBase(this,[1]);this.d=n;this.b=t;this.bo=i;this.U=r;this.l=u;this.o=f;this.j="UpdateCalendarItemAction";var e=n;e.bh.ParentFolderId&&(this.R=_g.r.c(e.bh.ParentFolderId))};_cc.G.e=function(n){if($a(n))return new _g.bA(new _g.e("Recurrence"));var i=new _g.M(new _g.e("Recurrence"));var t=new _g.L;t.Recurrence=_g.bi.a(n);i.Item=t;return i};_cc.G.c=function(n){var i=new _g.M(new _g.e("EnhancedLocation"));var t=new _g.L;t.Location=_g.w.d(n);i.Item=t;return i};_cc.G.a=function(n,t){if(!t||!t.b())return new _g.bA(new _g.e(n));var r=_cc.m.a(t.i.p);var u=new _g.M(new _g.e(n));var i=new _g.L;n==="RequiredAttendees"?i.RequiredAttendees=r:n==="OptionalAttendees"?i.OptionalAttendees=r:i.Resources=r;u.Item=i;return u};_cc.G.b=function(n){var r=new _g.e("Categories");if(!n||!n.b())return new _g.bA(r);var u=n.f();var t=new _g.M(r);var i=new _g.L;i.Categories=u;t.Item=i;return t};_cc.G.d=function(n){if(!n||!n.b())return new _g.bA(new _g.e("InboxReminders"));var i=new _g.M(new _g.e("InboxReminders"));var t=new _g.L;t.InboxReminders=n.i.p;i.Item=t;return i};_cc.G.f=function(n,t){t.val=null;if(!n||!n.b())return!1;for(var r=new _ff.d,u=0;u<n.b();u++){var h=n.a(u);var i;var s,f;if(f=_h.I.c(h,s={val:i}),i=s.val,f){var e=new _g.L;var o=new _g.M(i.ExtendedFieldURI);_h.j.c(e,i);o.Item=e;r.c(o)}}r.d.length>0&&(t.val=r.h());return r.d.length>0};_cc.G.prototype={U:!1,o:null,l:null,d:null,b:null,Y:null,Z:function(n,t){var i=[];if(n.bh.Subject!==t.bh.Subject){var ct=new _g.M(new _g.e("Subject"));var et=new _g.L;et.Subject=t.bh.Subject;ct.Item=et;Array.add(i,ct)}if(t.fI()){var ft=new _g.M(new _g.e("Body"));var st=new _g.L;st.Body=new _g.D(t.C().a()==="HTML"?"HTML":"Text",t.C().bh.Value);ft.Item=st;Array.add(i,ft)}_g.h.i(n.br(),t.br())&&Array.add(i,_cc.G.b(t.br().e));if(t.bz()&&n.bh.IsResponseRequested!==t.bh.IsResponseRequested){var ot=new _g.M(new _g.e("CalendarIsResponseRequested"));var it=new _g.L;it.IsResponseRequested=t.bh.IsResponseRequested;ot.Item=it;Array.add(i,ot)}var wt=!_a.c.c(n.a(),t.a());var bt=!_a.c.c(n.b(),t.b());var kt=n.bh.IsAllDayEvent!==t.bh.IsAllDayEvent;if(kt||wt||bt){if(t.bh.IsAllDayEvent!==undefined){var tt=new _g.M(new _g.e("IsAllDayEvent"));var ut=new _g.L;ut.IsAllDayEvent=t.bh.IsAllDayEvent;tt.Item=ut;Array.add(i,tt)}if(t.a()){var rt=new _g.M(new _g.e("StartTimeZone"));var yt=new _g.L;var ht=new _g.dy;ht.Id=this.V();yt.StartTimeZone=ht;rt.Item=yt;Array.add(i,rt);var lt=new _g.M(new _g.e("Start"));var vt=new _g.L;vt.Start=t.a().j();lt.Item=vt;Array.add(i,lt)}if(t.b()){var at=new _g.M(new _g.e("EndTimeZone"));var p=new _g.L;var nt=new _g.dy;nt.Id=this.V();p.EndTimeZone=nt;at.Item=p;Array.add(i,at);var c=new _g.M(new _g.e("End"));var l=new _g.L;var f;f=t.bh.IsAllDayEvent?t.b().f().c(1):t.b();l.End=f.j();c.Item=l;Array.add(i,c)}}if(n.k()!==t.k()){var a=new _g.M(new _g.e("LegacyFreeBusyStatus"));var h=new _g.L;h.FreeBusyType=t.k();a.Item=h;Array.add(i,a)}var dt=n.bh.ReminderIsSet!==t.bh.ReminderIsSet;var pt=n.bh.ReminderMinutesBeforeStart!==t.bh.ReminderMinutesBeforeStart;if(dt||pt){var e=new _g.M(new _g.e("ReminderIsSet"));var o=new _g.L;o.ReminderIsSet=t.bh.ReminderIsSet;e.Item=o;Array.add(i,e);var s=new _g.M(new _g.e("ReminderMinutesBeforeStart"));var k=new _g.L;k.ReminderMinutesBeforeStart=t.bh.ReminderMinutesBeforeStart;s.Item=k;Array.add(i,s)}if(n.bF()!==t.bF()){var b=new _g.M(new _g.e("Sensitivity"));var g=new _g.L;g.Sensitivity=t.bF();b.Item=g;Array.add(i,b)}if(n.cb()!==t.cb()){var d=new _g.M(new _g.e("Charm"));var y=new _g.L;y.Charm=t.cb();d.Item=y;Array.add(i,d)}_g.br.a(n.r(),t.r())||Array.add(i,_cc.G.c(t.r()));_g.br.a(n.F(),t.F())||Array.add(i,_cc.G.e(t.F()));_g.t.b(n.q(),t.q())&&Array.add(i,_cc.G.a("RequiredAttendees",t.q()));_g.t.b(n.v(),t.v())&&Array.add(i,_cc.G.a("OptionalAttendees",t.v()));_g.t.b(n.G(),t.G())&&Array.add(i,_cc.G.a("Resources",t.G()));_g.bL.a(n.bH(),t.bH())&&Array.add(i,_cc.G.d(t.bH()));$a(t.dp())||Array.add(i,this.T(_g.c.G(),t.dp()));$a(t.cK())||Array.add(i,this.T(_g.c.F(),t.cK()));$a(t.dL())||Array.add(i,this.T(_g.c.E(),t.dL()));if(t.bC()&&t.bC().b()>0){var u;var v,w;n.bC()&&_h.cJ.a(n.bC().e,t.bC().e)||(w=_cc.G.f(t.bC(),v={val:u}),u=v.val,!w)||Array.addRange(i,u)}var r=new _g.bN;if(t.es()===1){r.ItemId=new _g.bu(t.bh.ItemId.Id);r.ItemId.__type=_g.bu._dataContractName}else{r.ItemId=t.bh.ItemId;r.ItemId.__type=_g.g._dataContractName}r.Updates=i;return r},n:function(){_h.dh.prototype.n.call(this);this.h.isReferencedItemRecurring=this.U;this.h.explicitLogonUser=this.o},cp:function(n){this.d.bG(n.Items[0].ItemId);this.b.bG(n.Items[0].ItemId);this.l&&_cc.x.isInstanceOfType(this.l)&&this.l.H()},F:function(){this.Y=this.Z(this.d,this.b);_a.cX.prototype.F.call(this)},i:function(){return[this.Y]},T:function(n,t){var r=new _g.M(n);var i=new _g.L;i.ExtendedProperty=new Array(1);i.ExtendedProperty[0]=new _g.bk;i.ExtendedProperty[0].ExtendedFieldURI=n;i.ExtendedProperty[0].Value=t;r.Item=i;return r}};_cc.bl=function(n){this.k=Function.createDelegate(this,this.w);_cc.bl.initializeBase(this,[n,new _cc.bR(n.b().Id)]);if(!_h.s.b){var t=new _g.bc;t.NotificationType="HierarchyNotification";var i=new _h.K(t);i.l(this.bo(),"HierarchyNotification",this.k,1)}};_cc.bl.a=function(n,t,i){var u=new _gg.fP(n.a(),n.bh.unfoldedIndex);var r=new _gg.k("Beginning",u);r.Offset=t;r.MaxEntriesReturned=i;return r};_cc.bl.prototype={g:null,h:null,j:!1,bo:function(){return _a.a.da},q:function(){this.g=null;this.h=null;this.j=!1;this.bm.g()},Y:function(n){return null},bf:function(n){return!1},bu:function(n){return new _g.i(n)},bL:function(n,t,i,r,u,f){f=this.v();if(this.h){if(this.ca===4)_h.s.prototype.bL.call(this,n,t,i,r,u,f);else if(this.j){_h.s.prototype.bL.call(this,n,t,i,!1,!1,f);var o=Math.min(this.h.a-this.e(),this.bm.y.length);o>0&&this.bm.G(0,o,f)}else{_h.s.prototype.bL.call(this,n,t,i,!1,!0,f);var e=this.bm.y.length-this.h.b;if(e>0){var s=this.bm.y.length-e;this.bm.G(s,e,f)}}this.bN(this.h.a);this.cI=-1}else _h.s.prototype.bL.call(this,n,t,i,r,u,f)},bG:function(n){if(this.g){this.bR(4);var i=_g.T.isInstanceOfType(this.g)?_cc.bl.a(this.bm.y[0],0,this.g.MaxEntriesReturned):this.g;var t=this.p(i);this.bB(t)}else this.bR(0)},dQ:function(n,t){var i=n;var u=i.a();this.bz(n,t);var r=i.a();return u.k(r)?!0:!1},bz:function(n,t){var i=n;i.di(t)},bv:function(n,t){var u;if(_h.q.isInstanceOfType(n)){var i=n;this.h=i;this.j=i.a>this.e();u=this.x(i);var e=new _g.T("Beginning");e.Offset=i.a;e.MaxEntriesReturned=i.b;this.g=e}else if(_h.bF.isInstanceOfType(n)){var f=n;var r=new _gg.k("Beginning",f.a);r.Offset=f.b;r.MaxEntriesReturned=f.c;u=r;this.g=u;this.h=null;var o=r.Condition.Item;var s=o.FieldURIOrConstant.Item}else throw Error.argumentType("loadRowsArg");this.bR(1);return this.p(u)},by:function(n){var t=n;this.bH(t.e.tableSize);this.cs=_gg.k.isInstanceOfType(this.g);if(this.cs){this.bN(t.e.loadedStartIndex);this.cI=t.e.firstMatchingRowIndex}var i=t.A.Body.ResponseMessages.Items[0].RootFolder.Items;return new _cc.cK(i)},dN:function(n){var t=n;return t.p()==="ErrorCalendarSeekToConditionNotSupported"?!0:_h.s.prototype.dN.call(this,n)},x:function(n){var r;var i;var t=this.bm;if(this.j){i=0;r=t.y[t.y.length-1]}else{i=n.a-this.e();r=t.y[0]}var u=Math.abs(n.a-this.e())+1;return _cc.bl.a(r,i,u)},p:function(n){var t=new _cc.P;t.U=_g.b.a.nameToId("calendar");t.R=n;t.T=new _js.f;t.Y=this.ca===4;return t},v:function(){return this.ca===4&&this.bm.y.length>0?4:this.cs?5:this.j?2:3},w:function(n){if(n.clientGenerated){var t=n;this.d().Id===t.folderId&&_cc.bR.a(n,this)}}};_cc.cC=function(n,t,i,r){this.a=n;var e=this;this.c=t||function(){};var f=this;this.d=i||function(){};var u=this;this.b=r||function(){}};_cc.cC.prototype={a:null,c:null,d:null,b:null,dispose:function(){this.c=null;this.d=null;this.b=null}};_cc.bm=function(n){_cc.bm.initializeBase(this,[n,new _cc.cQ(n.b().Id)])};_cc.bm.prototype={bu:function(n){return new _g.df(n)},v:function(n,t,i,r){_cc.bC.prototype.v.call(this,n,t,i,r);if(_cc.bf.isInstanceOfType(n)){var u=n;u.e=t}},F:function(){return new _cc.bf}};_cc.M=function(n,t){_cc.M.initializeBase(this,[n,t||new _cc.cP(n.b().Id)])};_cc.M.prototype={F:function(){return new _cc.P}};_cc.bC=function(n,t){this.O=Function.createDelegate(this,this.ct);this.x=Function.createDelegate(this,this.cu);this.P=Function.createDelegate(this,this.cv);_cc.bC.initializeBase(this,[n,t]);if(t&&!_cc.bT.isInstanceOfType(t)&&!_h.s.b){this.w=t;var i=new _g.bc;i.NotificationType="HierarchyNotification";this.G=new _h.K(i);this.G.l(this.bo(),"HierarchyNotification",this.P,1)}this.R(this.bm,null)};_cc.bC.b=function(n,t){var r=n;var i=t;return r.a().b(i.a())};_cc.bC.a=function(n){return new _h.k(n.a.m(1),n.b)};_cc.bC.prototype={G:null,w:null,br:90,g:null,I:0,bj:!1,h:null,bI:function(n){this.bt("CalendarDataLoaded",n)},cz:function(n){this.bJ("CalendarDataLoaded",n)},bS:function(n){this.bt("CalendarError",n)},cA:function(n){this.bJ("CalendarError",n)},bT:function(n){this.bt("CalendarNotification",n)},cB:function(n){this.bJ("CalendarNotification",n)},bQ:function(n){this.bt("CacheContentsChanged",n)},cy:function(n){this.bJ("CacheContentsChanged",n)},bo:function(){return _a.a.K},m:function(){return!1},bx:function(n){if(n&&!this.h){this.h=new _cc.cD(this.bm);this.R(this.h.a,this.bm)}else if(!n&&this.h){this.h.dispose();this.h=null;this.R(this.bm,null)}this.h&&this.h.i(n);return n},bh:function(){return this.h?this.h.a:this.bm},bC:function(){},bD:function(){},cM:function(){this.w&&this.w.A()},cC:function(){this.w&&this.w.z(this)},J:function(n,t){this.I=t;if(this.g&&this.g.d(n,!0)){_js.Trace.logInfo(this.bo(),"[CalendarItemsCache] Requesting items from cache. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);this.K(!0,this.d(),n,!1,null,!0)}else{if(this.cn(n)){_js.Trace.logInfo(this.bo(),"[CalendarItemsCache] Ignoring the request because the date range is already requested. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);return}_js.Trace.logInfo(this.bo(),"[CalendarItemsCache] Requesting items from data store. Source: {0}, date range: {1}, calendar: {2}.",_cc.k.toString(t),n,this.d().Id);this.bj=!0;this.ba(n,null,null,null)}},bu:function(n){return new _g.i(n)},p:function(){_js.Trace.logInfo(this.bo(),"[CalendarQueryItemTableBase] Clearing cache.");this.g=null;this.bm.g()},Q:function(n){var t=_ff.t.a(n,_cc.bC.b,this.bm);t!==-1&&this.bm.u(t,n);return t},L:function(n){var t;var r,i;(i=this.dd(n.Id,r={val:t}),t=r.val,i)&&this.bm.o(t);return t},j:function(n,t){for(var u=!1,i=this.bm.y.length-1;i>=0;i--){var r=this.bm.y[i];if(r.bh.InstanceKey===n||t&&r.bh.InstanceKey===t){this.bm.o(i);u=!0}}return u},q:function(n,t,i){if(this.g){var r=-1;switch(t){case 0:r=this.bK(n);break;case 1:r=this.ci(n);break;default:_js.Trace.logError(this.bo(),"Unknown AddOrModifyMode value: "+t);break}if(r!==-1){var u=this.bm.y[r];u.bh.IsRecurring&&t===1?this.j(u.bh.InstanceKey,null):this.bm.o(r);if(this.g.h(n.a(),n.b())){var e=this.Q(n);e===-1&&_js.Trace.logWarning(this.bo(),"Couldn't find index to insert calendar item. Id="+n.bh.ItemId.Id)}}else if(!i&&this.g.h(n.a(),n.b())){var f=this.Q(n);f===-1&&_js.Trace.logWarning(this.bo(),"Couldn't find index to insert new calendar item. Id="+n.bh.ItemId.Id)}}},bK:function(n){_a.b.b(n,"calItem");var t;var u,f;if(f=this.dd(n.bh.ItemId.Id,u={val:t}),t=u.val,f)return t;var i,r;return(r=this.dd(_g.i.c(n).Id,i={val:t}),t=i.val,r)?t:-1},bg:function(n,t){var i;var f=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;var u,r;return(r=this.dd(t.Id,u={val:i}),i=u.val,r)?this.bm.y[i]:f},cj:function(n,t){_js.j.b(n,"dateRange");var f=[];var r=t?this.bh():this.bm;if(this.cl(n))for(var e=r.y.length,i=0;i<e;++i){var o=r.y[i];var u=n.i(o);if(u){if(u>0)break}else Array.add(f,r.y[i])}return f},bG:function(n){if(this.g){_js.Trace.logInfo(this.bo(),"[CalendarQueryItemTableBase] Reloading cache.");var i=this.g;if(this.bq){var r=this.bi(this.bq);i=_h.k.d(this.g,r)}var t=this.F();this.v(t,i,!0,!0);this.bB(t)}},bl:function(){!_h.s.b&&this.G&&this.G.p(this.P);if(this.bq){this.bq.dispose();this.bq=null}_h.s.prototype.bl.call(this)},by:function(n){throw Error.invalidOperation();},df:function(n){var t=n;this.K(!1,t.g(),this.bi(n),t.c(),t.f(),!1)},bv:function(n,t){if(!_h.k.isInstanceOfType(n))throw Error.argumentType("loadRowsArg",n?Object.getType(n):null,_h.k,"loadRowsArg needs to be a DateRange object");var u=n;this.g&&_h.k.c(this.g,u)&&this.p();var r=this.ck(u);if(r){var i=this.F();this.v(i,r,!1,!1);return i}return null},cF:function(n,t){var r=n;var i=r.d();if(this.bq&&this.bq!==n){var u=String.format("Detected invalid action in merge rows, table [{0}], action: [{1}], date range: [{2}]. Will discard results as there is another action in progress.",this.bp.a(),n.L,i);_js.Trace.logError(this.bo(),u);return!1}this.bh().e(this.x);try{i.a.y()===1&&(i.a=i.a.m(-1));r.c()&&this.p();this.bY(r);this.cd(i)}finally{this.bh().d(this.x)}this.K(!0,r.g(),i,r.c(),r.f(),!1);return!0},v:function(n,t,i,r){n.l(this.d());this.I&&n.k(this.I);n.o(_cc.bC.a(t));var u=new _js.f;n.j(u);n.m(i);n.n(r)},R:function(n,t){if(t){t.e(this.x);t.e(this.O)}n.d(this.x);n.d(this.O)},cn:function(n){if(!this.bq)return!1;var i=this.bi(this.bq);var t=_cc.bC.a(n);return i.d(t,!0)},ci:function(n){var i=this;var t=this.bm.k(function(t){return t.bh.InstanceKey===n.bh.InstanceKey});return t<this.bm.y.length?t:-1},cl:function(n){return!!this.g&&(this.g.b.b(n.a)>=0||this.g.a.b(n.b)<=0)},cv:function(n){var t=n;t.folderId?n.clientGenerated&&n.EventType==="Reload"&&this.bV&&this.d().Id===t.folderId&&this.Z():this.Z()},bY:function(n){var i=n.d();_js.Trace.logInfo(this.bo(),"AddResultsToCache: Item Count: {0}",n.b().y.length);var u;var f=!0;var l=!!this.g&&_h.k.c(this.g,i);if(l){var y=String.format("CalendarItemQueryTableBase.AddResultsToCache: Disjointed range encountered when adding items, range in cache: {0}, range in action: {1}",this.g,i);_js.Trace.logError(this.bo(),y);this.p()}if(this.g)if(i.d(this.g,!1)){this.p();u=!0;f=!1}else if(this.g.d(i,!0)){_js.Trace.logInfo(this.bo(),"AddResultsToCache: Not adding items to cache because the range in cache already contains the range in action. RangeInCache: {0}, RangeInAction: {1}",this.g,i);return}else u=i.a.b(this.g.a)>=0;else{u=!0;f=!1}var r=[];if(this.g&&_h.k.a(i,this.g)){var t;if(u)for(var o=n.b().y.length-1;o>=0;o--){t=n.b().y[o];if(t.a().b(this.g.b)<0)break;this.bA(t,f)||Array.insert(r,0,t)}else for(var s,e=0,a=n.b().y.length;e<a;e++){t=n.b().y[e];if(t.a().b(this.g.a)>=0)break;s=this.g.i(t);s<0?this.bA(t,f)||Array.add(r,t):s>0&&_js.Trace.logError(this.bo(),"Unexpected item that occurs after the range in cache")}}else for(var c,h=0,v=n.b().y.length;h<v;h++){c=n.b().y[h];this.bA(c,f)||Array.add(r,c)}r.length>0&&(u?this.bm.n(r):this.bm.v(0,r));this.g=_h.k.d(i,this.g)},bA:function(n,t){return t&&(n.i()||n.a().i()!==n.b().i())&&this.cc(n)},cc:function(n){return this.bK(n)!==-1},cd:function(n){if(!n.d(this.g,!0)){var s=this.g.a.c(this.br);if(!(this.g.b.b(s)<=0)){var h=n.a.w(this.g.a);var r;var t=-1;var o=[];var u=0;var i;if(h){r=new _h.k(this.g.a,s);for(var e=this.bm.y.length-1;e>=0;--e){i=this.bm.y[e];if(i.a().b(r.b)<=0){t=e;break}}if(t!==-1){t=Math.min(t+1,this.bm.y.length);u=Math.max(0,this.bm.y.length-t)}}else{r=new _h.k(this.g.b.c(-this.br),this.g.b);for(var f=0;f<this.bm.y.length-1;f++){i=this.bm.y[f];if(i.a().b(r.a)>=0){t=0;u=f;break}r.i(i)||Array.add(o,i)}}if(t!==-1&&u>0){this.bm.t(t,u);o.length>0&&this.bm.v(0,o)}this.g=r}}},cm:function(n){var t=!1;this.g&&(t=this.g.d(n,!0));return t},ck:function(n){return this.g?this.cm(n)?null:n:n},K:function(n,t,i,r,u,f){var e=n?"CalendarDataLoaded":"CalendarError";this.bP(e,this,new _cc.cb(null,t,i,r,u,null,f))},cu:function(n,t){this.bP("CalendarNotification",this,new _cc.cc(this.d(),t))},ct:function(n,t){this.cg("CacheContentsChanged")},bi:function(n){return n.d()}};_cc.cD=function(n){this.d=Function.createDelegate(this,this.h);this.b=n;this.a=new _js.f;this.a.C(this.b);this.b.d(this.d)};_cc.cD.prototype={b:null,c:null,e:null,a:null,i:function(n){if(n===this.e)return n;this.e=n;this.c=n?n.toLocaleUpperCase():null;this.f();return n},dispose:function(){if(this.a){this.b.e(this.d);this.a.g();this.a.C(this.b);this.a.dispose();this.a=null}},f:function(){for(var t=new _ff.d,n=0;n<this.b.y.length;n++)this.g(this.b.y[n],t);this.a.g();t.d.length&&this.a.n(t.d)},g:function(n,t){var i=!!n.bh.Subject&&n.bh.Subject.toLocaleUpperCase().indexOf(this.c)>-1;i&&t.c(n)},h:function(n,t){this.f()}};_cc.cE=function(n,t,i,r,u,f,e){this.b={};_cc.cE.initializeBase(this);this.j=n;this.d=i;this.h=r;this.e=u;this.i=f;this.g=e;this.c=t};_cc.cE.prototype={c:null,d:null,i:null,h:null,e:null,g:null,j:null,f:null,H:function(n){if(this.f===n)return n;var r=null;this.f||(r=_a.d.b(_a.a.i,"FilterSurfaceItems"));this.f=n;var i=this.b;for(var t in i){var f={key:t,value:i[t]};var u=f.value;u.bx(n)}_a.d.a(r);return n},J:function(n,t){if(t in this.b){var i=this.b[t];this.r(i);_h.g.a().c(i);var r=this.c.d(i.d());this.l(r);delete this.b[t]}},m:function(n,t,i){if(_g.s.isInstanceOfType(n)){var r=this;this.c.j().e(n.a(),function(){if(!r.c.n(n)){_js.Trace.logWarning(_a.a.K,"Skipping RequestItems as user does not have access. ItemId:{0}",n.bh.ItemId);return}var u=r.l(n);u.bF||u.J(t,i)})}else{var u=this.l(n);u.J(t,i)}},y:function(n,t){var i=this.a(n);return i?i.bg(_g.i,t):null},E:function(n){this.x(n);this.C(n)},t:function(n){n.co()&&_g.i.e(n);var t=this.a(n.e());t&&t.q(n,0,!1)},A:function(n,t){var i=this.a(n.e());i&&i.q(n,t,!0)},F:function(n){var t=this.a(n.e());t&&t.L(n.bh.ItemId)},I:function(n){var t=this.a(n);t&&t.cM()},G:function(n){var t=this.a(n);t&&t.cC()},v:function(n){var t=this.a(n);t&&t.p()},k:function(n,t){var i=this.a(n);return i?i.cj(t,!0):[]},n:function(){_js.Trace.logInfo(_a.a.K,"CalendarItemsCache:CheckAndReloadCache");var n=!1;var i=this.b;for(var t in i){var u={key:t,value:i[t]};var r=u.value;n=r.cD()||n}return n},D:function(n){var t=this.a(n);t&&t.bc()},a:function(n){var t=n.a();return this.b[t.Id]},o:function(n){return new(_h.dT.$$(_cc.M))(n)},w:function(n){return new(_h.dT.$$(_cc.bm))(n)},p:function(n){return new(_h.dT.$$(_cc.bS))(n)},q:function(n){return new(_h.dT.$$(_cc.x))(n)},l:function(n){var t=this.a(n);if(!t){var i=n.a();if(_g.C.isInstanceOfType(n))if(this.z(n)){var h=this.w(i);var a=this;t=_h.d.b(h,_h.g.a(),function(n){return new _cc.bm(n)})}else{var s=this.o(i);var l=this;t=_h.d.b(s,_h.g.a(),function(n){return new _cc.M(n)})}else{var u=n;if(u.bh.IsGroupMailboxCalendar){var f=this.p(i);var v=this;t=_h.d.D(f,u.bh.OwnerEmailAddress,function(n,t){return new _cc.bS(n,t)});var e=t;e.k=n}else{var o=this.q(i);var c=this;t=_h.d.b(o,_h.g.a(),function(n){return new _cc.x(n)});var r=t;r.k=n;r.M=this.c}}this.u(t);this.b[i.Id]=t;t.cD()}return t},z:function(n){return this.j.a().A().Enabled&&n.bh.CalendarFolderType===3},C:function(n){var i=n.a().Id;if(this.b[i]){var t=this.b[i];t.p();_h.g.a().l(t);delete this.b[i];t.dispose()}},u:function(n){this.e&&n.bS(this.e);this.d&&n.bQ(this.d);n.bT(this.i);n.bI(this.h);n.S(this.g);n.bC();n.bx(this.f)},x:function(n){var t=this.a(n);this.r(t)},r:function(n){if(n){n.bx(null);n.p();this.e&&n.cA(this.e);this.d&&n.cy(this.d);n.cB(this.i);n.cz(this.h);n.bd(this.g);n.bD()}}};_cc.u=function(n,t,i,r,u){this.D=Function.createDelegate(this,this.bd);this.H=Function.createDelegate(this,this.bh);this.G=Function.createDelegate(this,this.bg);this.E=Function.createDelegate(this,this.be);this.C=Function.createDelegate(this,this.bc);this.t=Function.createDelegate(this,this.bp);this.v=Function.createDelegate(this,this.br);this.u=Function.createDelegate(this,this.bq);this.p=Function.createDelegate(this,this.bi);this.r=Function.createDelegate(this,this.bm);this.q=Function.createDelegate(this,this.bj);this.I=Function.createDelegate(this,this.bo);this.F=Function.createDelegate(this,this.bf);_cc.u.initializeBase(this);_a.b.a(t,"selectedCalendars");this.y=n;this.k=0;this.m=i;this.c=r;this.f=t;this.o=u;this.Z()};_cc.u.prototype={m:null,y:null,o:null,l:null,e:null,c:null,k:0,d:null,f:null,h:!1,j:null,A:null,K:function(n){this.bt("FetchingCalendarsCompleted",n)},R:function(n){this.bJ("FetchingCalendarsCompleted",n)},J:function(n){this.bt("CalendarError",n)},Q:function(n){this.bJ("CalendarError",n)},w:function(n){this.bt("CalendarNotification",n)},z:function(n){this.bJ("CalendarNotification",n)},T:function(n){this.bt("CalendarCacheStaleStatusChanged",n)},bv:function(n){this.bJ("CalendarCacheStaleStatusChanged",n)},n:function(){return this.k},Z:function(){this.d=new _cc.cG;this.e=this.W();this.c.j().c(this.F);this.m&&(this.l=this.m.c(this));this.f.d(this.I);for(var n=0,t=this.f.y.length;n<t;n++)this.d.f(this.f.y[n].a())},bs:function(n,t){this.o&&this.o.a(n,t)},S:function(n,t){this.d.m();this.h=!0;this.j=new Date;for(var i=0,r=this.f.y.length;i<r;i++)this.i(this.f.y[i],n,t)},i:function(n,t,i){_a.b.a(t,"dateRange");this.A=_js.e.s(_a.a.i,517,"RequestItems");this.f.x(n)&&this.d.f(n.a());this.e.m(n,t,i)},a:function(n){for(var i=null,t=0,r=this.f.y.length;t<r;++t){i=this.e.y(this.f.y[t],n);if(i)break}return i},L:function(n){this.e.H(n)},U:function(n){this.e.t(n)},bb:function(n,t){this.e.A(n,t)},bw:function(n){this.e.F(n)},O:function(n){return this.d.c(n)===1},by:function(){for(var n=0,t=this.f.y.length;n<t;++n)this.e.I(this.f.y[n])},bx:function(){for(var n=0,t=this.f.y.length;n<t;++n)this.e.G(this.f.y[n])},x:function(n){this.d.g(n.a());this.e.v(n)},N:function(n,t){var r=_js.e.s(_a.a.i,2,"CacheManager_GetCachedItemsFromCalendar");var i=this.e.k(n,t);_js.e.e(r);return i},M:function(n){for(var u=_js.e.s(_a.a.i,2,"CacheManager_GetCachedItems"),r=[],t=0;t<this.f.y.length;++t){var i=this.f.y[t];this.d.c(i.a())===1&&Array.addRange(r,this.N(i,n))}_js.e.e(u);return r},P:function(n){for(var i=0;i<n.length;++i){var t=n[i];var r=this.c.b(t.bh.ParentFolderId);t.cE()&&r.bh.EffectiveRights.Read&&this.ba(300,t.bh.ItemId,_g.i.a(t))}},X:function(n){n.bx(this.q);n.v(this.r);n.z(this.p)},Y:function(n){n.bx(this.u);n.v(this.v);n.z(this.t)},g:function(n,t,i,r,u,f,e,o){return this.l.g(n,t,e,o,i,r,f,u)},ba:function(n,t,i){return this.l.g(n,t,"HTML","defaultMode",null,null,null,i,1)},V:function(){return this.e.n()},b:function(n){return this.e.a(n)},bd:function(){this.cg("CalendarCacheStaleStatusChanged")},be:function(n,t){_js.Trace.logInfo(_a.a.K,"[CalendarCacheManager] Triggering CalendarDataLoaded. View model: {0}, date range: {1} - {2}, calendar: {3}.",t.f,t.a?t.a.a:null,t.a?t.a.b:null,t.b.Id);_js.e.e(this.A);var i=_js.e.s(_a.a.b,2,"OnCalendarDataLoaded");this.d.j(t.b);this.bP("CalendarDataLoaded",this,t);t.e=this.j;this.j=null;if(this.h||t.d){this.h=!1;this.bP("FetchingCalendarsCompleted",this,t)}else this.bu(t.b,t.a);_js.e.e(i)},bg:function(n,t){this.d.i(t.b);this.bP("CalendarError",this,t);if(this.h){this.h=!1;this.bP("FetchingCalendarsCompleted",this,new _cc.cb(null,t.b,t.a,t.d,t.c,this.j))}},W:function(){return new _cc.cE(this.y,this.c,this.C,this.E,this.G,this.H,this.D)},bj:function(n){var i=n;var t=i.b();if(t.y()!=="RecurringMaster"){t.bG(_g.i.c(t));this.U(t)}},bm:function(n){},bi:function(n){n.bT(this.q);n.M(this.r);n.K(this.p)},bq:function(n){var t=n;t.b.y()==="RecurringMaster"?t.d.di(t.b.bh):this.bb(t.b,0)},br:function(n){this.e.D(n.d.e())},bp:function(n){n.bT(this.u);n.M(this.v);n.K(this.t)},bc:function(){var n=_js.e.s(_a.a.i,2,"OnCachedItemsChanged");++this.k;_js.e.e(n)},bh:function(n,t){this.bP("CalendarNotification",this,t)},bu:function(n,t){var i=this.N(this.c.d(n),t);this.bP("CalendarNotification",this,new _cc.cc(n,new _js.B(0,0,i,null)))},bo:function(n,t){++this.k;var i;switch(t.c){case 0:for(var u=0;u<t.a.length;++u){i=t.a[u];this.d.f(i.a())}break;case 2:for(var r=0;r<t.b.length;++r){i=t.b[r];this.d.g(i.a());this.e.E(i)}break}},bf:function(n,t){this.e.J(n.Id,t);this.d.l(n,t)}};function CalendarsCache(n,t,i,r,u,f,e){this.bd=Function.createDelegate(this,this.bt);this.be=Function.createDelegate(this,this.bu);this.bf=Function.createDelegate(this,this.bv);this.Q=new(_a.eB.$$(Function));CalendarsCache.resolveInheritance();this.e=this.by;this.c=this.r;this.k=this.x;CalendarsCache.initializeBase(this);this.bj=OwaApplication.e();this.T=n;this.X=t;this.bi=i;this.N=r;this.bc=f;this.O=e;this.bg=u.a().c().Enabled;this.bk=u.a().M().Enabled&&!!this.bc.c().bh.DefaultPublicFolderMailbox}CalendarsCache.prototype={bj:null,O:null,X:null,bi:null,N:null,bc:null,bk:!1,T:null,bb:null,P:null,U:null,V:!1,ba:0,W:!1,Z:null,f:function(){return this.X},j:function(){return this.bi},l:function(){return this.W},w:function(n){if(n!==this.W){this.W=n;this.ea("IsWaitingForCalendarAction")}return n},a:function(){return this.U},i:function(){return this.Z},bo:function(n){if(this.Z!==n){this.Z=n;this.ea("BirthdayCalendar")}return n},F:function(){return this.P},m:function(){this.bb||(this.bb=_cc.j.a("Searched Calendars","12B353D3-3078-4E85-875B-F905CCB65E9B"));return this.bb},bh:null,G:function(){return this.bh},bs:function(){return this.bc.c().bh.UserEmailAddress},br:function(){return this.bj},bg:!1,b:function(n){var t=this.N.a(n);return t?t.b():null},o:function(n){var t=this.N.e(n.toLowerCase());return t?t.a():null},d:function(n){var t=this.N.a(n);return t?t.a():null},y:function(n){var t=this.N.a(n);return!!t&&t.c()},n:function(n){return n.i()&&(this.y(n.a())||_g.s.isInstanceOfType(n)&&n.bh.IsGeneralScheduleCalendar)},h:function(n){_js.Trace.logInfo(_a.a.K,"CalendarsCache reload requested.");n&&this.Q.b(n);this.br().a(_h.cc,new _h.cc);this.bm()},g:function(n){if(this.S){n&&n();return!0}n&&this.Q.b(n);this.bm();return!1},t:function(n,t){_a.b.f(n.e(),!0,"AddClientOnlyCalendar is only supporting client-only calendar entries");var i=_g.bS.a(n);this.Y(t,n,i)},I:function(n,t,i){_a.b.f(n.e(),!0,"InsertClientOnlyCalendar is only supporting client-only calendar entries");var r=_g.bS.a(n);this.Y(t,n,r,i)},q:function(n,t){_a.b.f(n.e(),!0,"RemoveClientOnlyCalendar is only supporting client-only calendar entries");return this.K(t,n)},C:function(n,t,i,r,u){this.t(n,u||this.P);this.bn(n,t,i,r)},J:function(n,t,i,r){_a.b.f(n.e(),!0,"unpinnedCalendar.IsClientOnlyCalendar");_a.b.f(this.m().b().x(n),!0,"SearchedCalendars.Contains()");this.m().b().m(n,!0);n.q(this.P.a());this.P.b().a(n);this.bn(n,t,i,r)},p:function(n,t){if(!this.T){_js.Trace.logError(_a.a.K,"Expecting birthday factory to not be null");return}this.w(!0);var i=this;this.T.a(function(r){var u=r.f();u.v(function(){_js.Trace.logInfo(_a.a.K,"EnableBirthdayCalendar failed");t&&t()});n&&u.w(function(){n()});u.z(function(){i.w(!1)});i.O.a(u)})},v:function(n,t){if(!this.T){_js.Trace.logError(_a.a.K,"Expecting birthday factory to not be null");return}this.w(!0);var i=this;this.T.a(function(r){var u=r.e();u.v(function(){_js.Trace.logInfo(_a.a.K,"DisableBirthdayCalendar failed");t&&t()});n&&u.w(function(){n()});u.z(function(){i.w(!1);i.h(function(){u.A.WasSuccessful&&i.bo(null)})});i.O.a(u)})},z:function(n,t,i,r,u){t.q(n.a());var f=_g.bS.a(t);var e=this;this.bp(t.bh.ParentGroupId,t,f,function(){e.Y(n,t,f);t.I(!0);i&&i()},r,u)},L:function(n,t,i,r){var u=new _cc.bM(n,t,this);i&&u.w(i);r&&u.v(r);var f=this;u.z(function(n){f.w(!1)});this.w(!0);this.O.a(u)},u:function(n,t,i,r){var u;if(n.g()){var f;u=(f=new _h.bE,f.b=this.N.a(n.a()).b(),f)}else u=new _cc.bI(n,t,this);i&&u.w(i);r&&u.v(r);var e=this;u.z(function(){e.w(!1)});this.w(!0);this.O.a(u)},A:function(n,t,i,r){var u=new _cc.bH(n);var e=this;u.w(function(n){e.R.a(n.c);t&&t()});if(i){var o=this;u.v(function(n){i(n.b)})}if(r){var f=this;u.z(function(n){f.w(!1);r()})}this.w(!0);this.O.a(u)},Y:function(n,t,i,r){_a.b.a(n,"parentGroup");_a.b.a(t,"calendarEntry");_a.b.a(i,"calendarModel");t.q(n.a());this.N.b(i,t);r===undefined?n.b().a(t):n.b().u(r,t)},K:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"calendar");if(t.i()){this.N.c(t.a().Id);if(_g.s.isInstanceOfType(t)){var i=t;i.bh.IsGeneralScheduleCalendar&&this.N.c(i.bh.OwnerEmailAddress)}}return n.b().m(t,!0)},M:function(n,t,i,r){var u=new _cc.bN(n,t);i&&u.w(i);r&&u.v(r);var f=this;u.z(function(n){f.w(!1)});this.w(!0);this.O.a(u)},D:function(n,t,i){var r=new _cc.bJ(n);t&&r.w(t);i&&r.v(i);var u=this;r.z(function(n){u.w(!1)});this.w(!0);this.O.a(r)},E:function(){if(!this.S)return"CalendarsCache not ready.";var n="CCacheInfo: \r\n";n+="W:"+this.W+",GetCalSent:"+this.V+",PGetCal:"+(this.Q?this.Q.a.length.toString():"<null>")+"\r\n";n+=this.N.d();n+=this.X.f();return n},H:function(n){for(var r=this.R,t=0;t<r.y.length;t++){var i=r.y[t];if(n.bh.ParentGroupId===i.a())return i}return null},bn:function(n,t,i,r){var u=this;this.bp(n.bh.ParentGroupId,n,this.N.a(n.a()).b(),t,function(t,r){_js.Trace.logWarning(_a.a.K,"Error while trying to persist shared calendar with name: {0}. Error:{1} Correlation ID:{2}",n.bh.CalendarName,t,r);i&&i(t,r);u.h(null)},r)},bp:function(n,t,i,r,u,f){var e=new _cc.bG(n,t,i);if(r){var s=this;e.w(function(){r()})}if(u){var h=this;e.v(function(n){u(n.b,e.C())})}var o=this;e.z(function(){o.w(!1);f&&f()});this.w(!0);this.O.a(e)},bm:function(){if(!this.V){this.V=!0;this.bq()}},bq:function(){var n=new _cc.cL(this.bs(),this.bg,this.bk);n.w(this.bf);n.v(this.be);n.z(this.bd);this.O.a(n)},bw:function(n){var s=0;var e=0;var o=0;var u=0;var f=n.i;for(var i in f){var r={key:i,value:f[i]};var h=r.value;var t=n.h[r.key];if(t.D()){this.bo(t);o++}else t.v()?e++:t.g()&&u++;this.N.b(h,t);s++}this.bh=new CalendarsCache.a(s,e,o,u)},bv:function(n){var t=n;this.bw(t);var r=this;_cc.bF.c(this.R,t.e,function(n){return n.l()});this.U?this.U.bh.ItemId.ChangeKey!==t.c.bh.ItemId.ChangeKey&&this.U.J(t.c):this.U=t.c;this.P?t.d&&this.P.d().ChangeKey!==t.d.d().ChangeKey&&this.P.i(t.d):this.P=t.d;this.V=!1;this.bl(!0);for(var i=0;i<this.Q.a.length;i++)this.Q.c(i)();this.Q=new(_a.eB.$$(Function))},bu:function(n){if(this.ba<3){var t=this;_js.g.a().a(_a.a.K,"GetCalendarsActionRetry",function(){t.bq()},2e3);this.ba++}else{this.ba=0;this.V=!1}},bt:function(n){n.N(this.bf);n.M(this.be);n.K(this.bd)}};CalendarsCache.a=function(n,t,i,r){this.f=n;this.g=t;this.e=i;this.h=r};CalendarsCache.a.prototype={f:0,b:function(){return this.f},g:0,c:function(){return this.g},e:0,a:function(){return this.e},h:0,d:function(){return this.h}};_cc.bE=function(){this.i=_a.I.a();this.g=this.dV;this.h=this.dW;_cc.bE.initializeBase(this)};_cc.bE.prototype={a:function(n){return n?this.j(n.Id):null},e:function(n){return n?this.j(n):null},c:function(n){this.i.e(n)},b:function(n,t){var i=this.l(t.a().Id);i.a()&&i.a().bh.ItemId.ChangeKey===t.bh.ItemId.ChangeKey||i.m(n,t);return i},dV:function(){var n=_a.dT.prototype.dV.call(this);this.m(n);return n},dW:function(n){_a.dT.prototype.dW.call(this,n);this.k(n)},f:function(n,t){var i=t.Id;var r=t.ChangeKey;n.b().bh.FolderId.Id=i;n.b().bh.FolderId.ChangeKey=r;n.a().a().Id=i;n.a().a().ChangeKey=r;this.i.b(i,n)},d:function(){var n="ICCacheInf: \r\n";if(this.i){var t=this;this.i.f(function(t,i){n+="'"+t+"'";n+=" => V:"+i.c()+" CnfRtr:"+i.d();if(i){var r=i.a();var u=i.b();u&&(n+=" M:(Id:'"+_cc.n.c(u.bh.FolderId)+"', N: '"+u.bh.DisplayName+"')");if(r){var o=!!u&&!!u.bh.FolderId&&!!r.a()&&u.bh.FolderId.Id===r.a().Id;n+=" E:(Id:'"+_cc.n.e(r.bh.ItemId)+"',";n+=" FId:'"+(o?"<same>":_cc.n.c(r.a()))+"',";n+=" D:"+r.f()+" N:'"+r.bh.CalendarName+"', G:"+r.bh.IsGroupMailboxCalendar;n+=" P:'"+r.bh.ParentGroupId+"'";if(_g.s.isInstanceOfType(r)){var f=r;n+=" Link, O:'"+f.bh.OwnerEmailAddress+"', OV:"+!f.bh.IsOwnerEmailAddressInvalid+", GS:"+f.bh.IsGeneralScheduleCalendar}else{var e=r;n+=" Local, T:"+e.j()}n+=" Clr:"+r.o()+", AClr:"+r.b+", CS:"+r.e()+")"}}else n+=" <null> entry.";n+="\r\n"})}else n+="<null>. \r\n";return n},j:function(n){return this.i.a[n]},l:function(n){var t=this.i.a[n];if(!t){t=new _cc.o;this.i.b(n,t)}return t},m:function(n){var t={};var i=this;this.i.f(function(n,i){t[n]=i.dV()});n.CalendarsCacheDictionary=t},k:function(n){var f=n.CalendarsCacheDictionary;this.i=_a.I.a();var u=f;for(var r in u){var t={key:r,value:u[r]};var i=new _cc.o;i.dW(t.value);this.i.b(t.key,i)}}};_cc.o=function(){_cc.o.initializeBase(this)};_cc.o.prototype={b:function(){return this.ec(_cc.o.c)},j:function(n){this.eb(_cc.o.c,n);return n},a:function(){return this.ec(_cc.o.b)},i:function(n){this.eb(_cc.o.b,n);return n},c:function(){return this.ec(_cc.o.d)},f:function(n){this.eb(_cc.o.d,n);return n},d:function(){return this.ec(_cc.o.a)},e:function(n){this.eb(_cc.o.a,n);return n},h:function(){return this.ec(_cc.o.e)},k:function(n){this.eb(_cc.o.e,n);return n},l:function(n,t){this.k(t);this.g(n.bh.EffectiveRights,n.S());this.e(!0)},n:function(n){this.f(n);this.e(!0)},m:function(n,t){var i=this.b()?this.b().bh.FolderId:null;var u=this.b()?this.b().bh.EffectiveRights:null;var r=this.b()?this.b().S():null;this.i(t);this.j(n);this.f(!!(this.c()&this.a().i()));if(this.d()&&i){this.a().a().Id=i.Id;this.a().a().ChangeKey=i.ChangeKey;this.b().bh.FolderId.Id=i.Id;this.b().bh.FolderId.ChangeKey=i.ChangeKey;this.g(u,r)}},g:function(n,t){this.b().J(n);if(t&&t.b()>0)if(_g.s.isInstanceOfType(this.a())){this.b().bg(t);this.a().n(t.a(0).toLowerCase())}else _js.Trace.logError(_a.a.K,"Expecting no replica list for non-linked calendar. {0}",this.a())}};_cc.cG=function(){this.a={};this.b=new Sys.EventHandlerList};_cc.cG.prototype={a:null,b:null,f:function(n){var t=n.Id;if(!(t in this.a)){this.a[t]=0;this.e(t)}},g:function(n){var t=n.Id;t in this.a&&delete this.a[t]},l:function(n,t){if(t in this.a){var r=n.Id;this.a[r]=this.a[t];delete this.a[t];var i=this.b.getHandler(t);if(i){this.b.addHandler(r,i);this.b.removeHandler(t,i)}}},c:function(n){var t=n.Id;!(t in this.a);return this.a[t]},j:function(n){var t=n.Id;if(t in this.a&&!this.a[t]){this.a[t]=1;this.e(t)}},i:function(n){var t=n.Id;if(t in this.a&&!this.a[t]){this.a[t]=2;this.e(t)}},m:function(){var i=this.a;for(var t in i){var n={key:t,value:i[t]};this.a[n.key]=0;this.e(n.key)}},h:function(n,t){this.b.addHandler(n.Id,t)},k:function(n,t){this.b.removeHandler(n.Id,t)},d:function(){var t=0;var i=0;var n=0;var f=this.a;for(var u in f){var r={key:u,value:f[u]};r.value===1?t++:r.value||i++;n++}return i===n&&n>0?0:t===n?3:t>0&&i>0?1:t>0?2:-1},toString:function(){var i=new Sys.StringBuilder("Calendars in CalendarStateTracker: ");var r=this.a;for(var n in r){var t={key:n,value:r[n]};var u=_js.d.c("Id = '{0}', State = {1}; ",t.key,t.value);i.append(u)}return i.toString()},e:function(n){var t=this.b.getHandler(n);t&&t(this.a[n])}};_cc.cH=function(n,t,i){this.e=t;this.f=i;this.b={};this.c=n};_cc.cH.prototype={e:null,f:null,b:null,c:null,a:null,g:function(n,t,i,r,u,f,e,o,s){var c=this.k(t);var a=c?_cc.bn.b(t,!1,i,r,s,o):_cc.O.a(t,!1,i,r,s,o);var h=new _cc.cC(a,u,f,e);if(this.h(h.a)){try{h.c(this.c.a(t));h.b(!0)}finally{h.dispose()}return null}var l=this.r(h);l||this.u(n,h,c);return h},i:function(n,t){if(this.n(n)&&!this.h(t)){this.s();this.w(n);this.a=t}},v:function(n){var t=this.j(n);n.di(t.bh)},w:function(n){var t=this.c.a(n.bh.ItemId);t&&(_gg.e.isInstanceOfType(n)?t.gt(n.bh):t.di(n.bh))},h:function(n){var t=this.c.a(n.b());return this.m(n)&&!!t||!!this.a&&this.l(n)&&this.a.a()===n.a()&&!!t&&t.bQ()},k:function(n){var t=this.c.a(n);return _gg.e.isInstanceOfType(t)},l:function(n){return!_g.ec.isInstanceOfType(n.b())&&n.e()==="HTML"},n:function(n){return n.y()!=="RecurringMaster"&&!!n.C()&&n.C().a()==="HTML"},m:function(n){return _g.i.f(n.b())},u:function(n,t,i){var r;r=i?new _cc.bn(n,t.a):this.f.a().cP().Enabled?new _cc.cd(n,t.a):new _cc.O(n,t.a);r.I=t.a.g;var e=_js.e.s(_a.a.i,517,"GetFullItem");var o=this;r.w(function(n){var t=n;o.p(t.c(),t.b())});var u=this;r.v(function(n){var t=n;u.o(t.c(),n.t)});var f=this;r.z(function(n){var t=n;f.q(t.c());_js.e.e(e)});this.e.a(r)},d:function(n){var t=this.b[n];t||_js.Trace.logError(_a.a.K,"AsyncResult should not be null for contextId {0}",n);return t},j:function(n){var t=n.dJ();t.ba(null);t.Z(null);t.bb(null);t.cr(null);t.iZ(null);t.bS(0);return t},s:function(){if(this.a){var n=this.c.a(this.a.b());if(!n||n.co()||!n.bQ()){this.a=null;return}this.a.f()||this.v(n);this.a=null}},p:function(n,t){this.i(t,n);for(var r=this.d(n.a()),i=0;i<r.d.length;i++)try{r.d[i].c&&r.d[i].c(t)}catch(u){_js.Trace.logWarning(_a.a.K,"Failed to execute one of the asyncResult.SuceedCallback for contextId {0}. Exception: {1}",n.a(),u)}},o:function(n,t){for(var r=this.d(n.a()),i=0;i<r.d.length;i++)try{r.d[i].d&&r.d[i].d(t)}catch(u){_js.Trace.logWarning(_a.a.K,"Failed to execute one of the asyncResult.FailedCallBack for contextId {0}. Exception: {1}",n.a(),u)}},q:function(n){for(var i=this.d(n.a()),t=0;t<i.d.length;t++)try{i.d[t].b&&i.d[t].b(!1)}catch(r){_js.Trace.logWarning(_a.a.K,"Failed to execute one of the asyncResult.CompletedCallBack for contextId {0}. Exception: {1}",n.a(),r)}this.t(n.a())},t:function(n){for(var i=this.d(n),t=0;t<i.d.length;t++){var r=i.d[t];r.dispose()}delete this.b[n]},r:function(n){var t;if(this.b[n.a.g])t=this.b[n.a.g];else{t=new _ff.d;this.b[n.a.g]=t}t.c(n);return t.d.length>1}};_cc.bK=function(n,t){this.a=n;this.b=t};_cc.bK.prototype={a:null,b:null,c:function(n){return new _cc.cH(n,this.a,this.b)}};_cc.ba=function(n,t,i){this.n=Function.createDelegate(this,this.y);this.m=Function.createDelegate(this,this.x);this.k={};this.l=new(_a.eB.$$(_g.lk));_cc.ba.initializeBase(this);this.p=t;this.t=n;this.q=i;this.h(this.t.a().w())};_cc.ba.$$cctor=function(){var n=new _g.dZ;n.WorkDays=n.WorkHoursEndTimeInMinutes=n.WorkHoursStartTimeInMinutes=0;_cc.ba.a=_cz.a.a(new _g.cd(n))};_cc.ba.prototype={t:null,p:null,q:null,u:null,b:function(n){this.ef("WorkingHoursUpdated",n)},d:function(n){this.eg("WorkingHoursUpdated",n)},o:!1,g:function(n){this.o=n;return n},c:function(n){var t=n;t.z(this.m);t.w(this.n);this.l.b(n)},e:function(n,t){this.v(n)&&this.r(n.bh.OwnerEmailAddress,_cz.a.a(t))},i:function(n,t){this.r(n.bh.OwnerEmailAddress,t)},a:function(n){if(!n)return _cc.ba.a;if(_g.s.isInstanceOfType(n)&&!n.bh.IsGroupMailboxCalendar&&n.j()!==5){var i=n;var u=this.v(i);if(u)return u;if(!this.o){for(var r=!0,t=0;t<this.l.a.length;t++){var f=this.l.c(t);if(f.e().g(i.bh.OwnerEmailAddress)){r=!1;break}}r&&this.w(i)}return _cc.ba.a}return this.u},j:function(n,t){for(var i=0;i<n.a.length;i++)t.c(i)&&this.r(n.c(i),_cz.a.a(t.c(i)))},h:function(n){this.u=_cz.a.a(n)},f:function(){var n="WorkingHours: \r\n";if(this.k){var i=this.k;for(var r in i){var t={key:r,value:i[r]};n+="'"+t.key+"' => ";n+=t.value?_cz.a.h(t.value):"<null>";n+="\r\n"}}else n+="<null>\r\n";return n},w:function(n){if(n.c()){var r=this;this.q.a(function(t){t.a(n,function(t){r.i(n,t)})})}else{var t=new _cc.ch(n,"GetUserAvailabilityInternal_FetchWorkingHours");t.G=n.bh.OwnerEmailAddress;var i=_a.c.a().f();t.R=new _h.k(i,i.r(30));t.T=new _js.f;this.c(t);this.p.a(t)}},y:function(n){var t=n;this.j(t.e(),t.i())},x:function(n){this.l.e(n);n.K(this.m);n.N(this.n)},r:function(n,t){_js.j.a(n,"userSmtpAddress");_js.j.a(t,"workingHours");if(!(n in this.k)||this.k[n]!==t){this.k[n]=t;this.ek("WorkingHoursUpdated",n,null)}},v:function(n){return this.k[n.bh.OwnerEmailAddress]}};_cc.bD=function(n,t,i){this.c=Function.createDelegate(this,this.d);this.a=n;this.b=t;i.b(_a.es,this.c)};_cc.bD.prototype={a:null,b:null,d:function(n){var i=n.a.length;if(i>0){var t=this.a.e();var r=this;t.h(function(){for(var u=0;u<i;u++){var e=n.a[u];var f=t.d(e.bh.FolderId);f?r.b.e().b(f,null,!1):_js.Trace.logWarning(_a.a.b,"[CalendarPublicFolderEventListener] Cannot select calendar '{0}' because it couldn't be found in the list of calendars.",e.bh.FolderId.Id)}})}}};_cc.x=function(n){_cc.x.initializeBase(this,[n,null])};_cc.x.prototype={k:null,M:null,N:null,bC:function(){_js.Trace.logInfo(this.bo(),"Starting refresh timer for shared calendar "+this.d().Id);var n=this;this.N=_js.g.a().e(this.bo(),"SharedCalendarItemQueryTable",function(){_js.Trace.logInfo(n.bo(),"Will issue a periodic refresh for shared calendar "+n.d().Id);n.Z()},3e5)},bD:function(){_js.Trace.logInfo(this.bo(),"Cancelling refresh timer for shared calendar "+this.d().Id);this.N=_js.g.a().b(this.N)},H:function(){_js.Trace.logInfo(this.bo(),"Reloading shared calendar after an action. Folder ID "+this.d().Id);this.bc();this.bD();this.bC()},F:function(){var r=this.M.b(this.k.a());if(!r.bh.EffectiveRights.Read){var n=new _cc.ch(this.k);n.h(this.k.bh.OwnerEmailAddress);this.M.f().c(n);return n}if(this.k.c()){var t=new _cc.cI;t.G=this.k.bh.OwnerEmailAddress;return t}var i=new _cc.P;i.G=this.k.bh.OwnerEmailAddress;return i}};_cc.cB=function(n){this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);this.a={};this.c={};this.d=[];this.h=n.d();this.e=n.m();this.b=new Array(9);for(var t=0;t<9;t++)this.b[t]=0};_cc.cB.prototype={h:null,e:null,b:null,c:null,a:null,d:null,j:function(n){this.n(n);this.o()},n:function(n){var t=n.p();var i=!1;if(t in this.a){this.b[this.e[this.a[t]]]--;delete this.a[t]}if(n.o()===-1)if(t in this.c)n.k(this.c[t]);else{Array.add(this.d,n);i=!0}else{delete this.c[n.p()];n.k(n.o())}if(!i){this.b[this.e[n.b]]++;this.a[t]=n.b}n.apcl("CalendarColor",this.g);n.e()&&!n.bh.IsGroupMailboxCalendar&&n.K(this.f)},i:function(n,t){var i=n.p();if(i in this.a){var r=this.e[this.a[i]];delete this.a[i];delete this.c[i];this.b[r]--}n.rpcl("CalendarColor",this.g);n.e()&&!n.bh.IsGroupMailboxCalendar&&n.G(this.f);t||n.k(n.o())},o:function(){for(var t=0;t<this.d.length;t++){var n=this.d[t];var i=n.p();n.k(this.k());this.b[this.e[n.b]]++;this.c[i]=this.a[i]=n.b}Array.clear(this.d)},m:function(n,t){var i=n;this.i(i,!0);this.j(i)},l:function(n,t){var i=n.p();if(!i){_js.Trace.logError(_a.a.b,"CalendarColorResolver: Received CacheKey change for linked calendar with ItemId=null: {0}",n.bh.CalendarName?n.bh.CalendarName:"");return}if(t in this.a&&i!==t){this.a[i]=this.a[t];delete this.a[t]}else _js.Trace.logError(_a.a.b,"Received CacheKey change event, but could not act on it. CalendarName {0}, InAssignedColorsTable:{1}, OldId:{2}, NewId:{3}",n.bh.CalendarName?n.bh.CalendarName:"",t in this.a,t,i);n.e()||n.bh.IsGroupMailboxCalendar||n.G(this.f)},k:function(){for(var t=this.b[0],i=0,n=1;n<9;n++)if(this.b[n]<t){t=this.b[n];i=this.h.a(n)}return i}};_cc.cb=function(n,t,i,r,u,f,e){this.f=n;this.b=t;this.a=i;this.d=r;this.c=u;this.e=f;this.g=e};_cc.cb.prototype={f:null,b:null,a:null,d:!1,c:null,e:null,g:!1};_cc.j=function(n){_cc.j.initializeBase(this);n&&this.dW(n)};_cc.j.$$cctor=function(){_cc.j.b.b(new(_a.fC.$$(_ff.z.$$(_g.bR)))(_g.bR));_a.i.d(_cc.j,_gg.mG,function(n){return new _cc.j(n)})};_cc.j.g=function(){var n=new _cc.j;n.j(new(_ff.z.$$(_g.bR)));n.k(3);return n};_cc.j.a=function(n,t){var i=new _cc.j;i.j(new(_ff.z.$$(_g.bR)));i.f(n);i.g(t);i.h(new _g.g(t));i.d().ChangeKey="";return i};_cc.j.prototype={d:function(){return this.ec(_cc.j.f)},h:function(n){this.eb(_cc.j.f,n);return n},a:function(){return this.ec(_cc.j.c)},g:function(n){this.eb(_cc.j.c,n);return n},e:function(){return this.ec(_cc.j.d)},f:function(n){this.eb(_cc.j.d,n);return n},b:function(){return this.ec(_cc.j.b)},j:function(n){this.eb(_cc.j.b,n);return n},c:function(){return this.ec(_cc.j.e)},k:function(n){this.eb(_cc.j.e,n);return n},l:function(){return!this.d()||!this.d().ChangeKey},i:function(n){this.j(n.b());this.g(n.a());this.f(n.e());this.k(n.c());this.h(n.d())}};_cc.cc=function(n,t){this.b=n;this.a=t};_cc.cc.prototype={b:null,a:null};_cc.d=function(n){_cc.d.initializeBase(this);n&&this.dW(n)};_cc.d.$$cctor=function(){_cc.d.a.b(new _a.bs(_cc.w));_a.i.d(_cc.d,Object,function(n){return new _cc.d(n)})};_cc.d.prototype={a:function(){return this.ec(_cc.d.c)},t:function(n){this.eb(_cc.d.c,n);return n},g:function(){return this.ec(_cc.d.l)},o:function(){return this.ec(_cc.d.d)},u:function(n){this.eb(_cc.d.d,n);return n},h:function(){return!!this.o()&&!this.r()},b:function(){return this.ec(_cc.d.b)},e:function(n){this.eb(_cc.d.b,n);return n},n:function(){return this.ec(_cc.d.h)},d:function(){return this.ec(_cc.d.f)},w:function(n){this.eb(_cc.d.f,n);return n},m:function(){return this.ec(_cc.d.e)},v:function(n){this.eb(_cc.d.e,n);return n},l:function(){return this.ec(_cc.d.k)},i:function(){return this.ec(_cc.d.g)},j:function(){return this.ec(_cc.d.j)},f:function(){return this.ec(_cc.d.i)},p:function(){return this.ec(_cc.d.m)},q:function(){return this.ec(_cc.d.n)},r:function(){return this.ec(_cc.d.o)},c:function(){return this.ec(_cc.d.a)},k:function(n){this.eb(_cc.d.a,n);return n}};_cc.cF=function(n,t,i,r){this.d=i;this.b=n;this.e=t;var u="CalPrefetch";this.c=!r.b(u)||parseInt(r.a[u],10)>0};_cc.cF.prototype={d:null,b:null,e:null,c:!1,a:function(){if(!this.c){_js.Trace.logInfo(_a.a.b,"Skipping prefetching since prefetching has been disabled via url parameters");return}var r=this.d.a();var n;var t;if(r==="TouchNarrow"){n=0;t=8}else{n=3;t=7}var i=_a.v.a(_a.c.a().f(),n);var u=new _h.k(i[0],i[1]);this.e.a(u,t);r!=="TouchNarrow"&&this.b.g(null)}};function CalendarsConfiguration(n,t,i){CalendarsConfiguration.initializeBase(this);this.g=n;this.i=t;this.h=i}CalendarsConfiguration.prototype={h:null,i:null,g:null,d:function(n){this.ef("EffectiveRightsFetchedForCalendar",n)},f:function(n){this.eg("EffectiveRightsFetchedForCalendar",n)},c:function(n){this.ef("CalendarEntryFolderIdChanged",n)},a:function(n){var t=this.g.a(n);return t?_g.C.isInstanceOfType(t.a())&&!t.a().bh.IsReadOnly?this.i.f():t.h():null},b:function(n,t,i,r){if(!n.i()){_js.Trace.logInfo(_a.a.K,"Trying to load configuration for invalid linked calendar");i&&i(n);r&&r(n);return}var u=this.g.b(this.j(n),n);if(u.d()){u.c()&&t&&t(n);!u.c()&&i&&i(n);r&&r(n)}else this.k(n,t,i,r)},e:function(n,t){var i=this.g.a(n);if(i.d())t(i.b());else{var r=null;var u=this;r=function(n,u){i.rpcl(_cc.o.a.a,r);t(i.b())};i.apcl(_cc.o.a.a,r)}},k:function(n,t,i,r){_js.Trace.logInfo(_a.a.K,"Loading linked calendar effective rights from server for {0} ",n);var f=new _cc.cJ(n);var u=this;f.z(function(f){var e;e=f.t?u.l(f):u.m(f);if(!e){_js.Trace.logInfo(_a.a.K,"Entry not found - request abandoned. Error:'{0}' Id:'{0}'",f.t,n.bh.ItemId);return}var o=e.a();!e.c()&&i?i(o):e.c()&&t&&t(o);r&&r(o)});this.h.a(f)},l:function(n){var i=n;var r=i.c.a();var t=this.g.a(r);if(t){_js.Trace.logInfo(_a.a.K,"Unable to find effective rights from server for linked calendar {0}",t.a());t.n(i.d)}else _js.Trace.logWarning(_a.a.K,"CalendarEntry {0} is not in the cache",r.Id);return t},m:function(n){var r=n;var e=r.e;var s=r.f;var u=r.c.a();var o=e.bh.FolderId;var i=u.Id;var f=o.Id;var t=this.g.a(u);if(!t){_js.Trace.logInfo(_a.a.K,"Could not find a CalendarsCacheEntry with Id:{0}",i);return null}_js.Trace.logInfo(_a.a.K,"Loaded effective rights for the linked calendar {0}",t.a());if(i!==f){this.g.f(t,o);this.ek("CalendarEntryFolderIdChanged",t.a().a(),i)}t.l(e,s);i!==f&&this.ek("EffectiveRightsFetchedForCalendar",this,t.a());return t},j:function(n){var r=new _g.dl;r.FolderId=n.a();var i=new _g.bS(r);i.f(n.bh.CalendarName);var t=new _g.dp;t.CreateAssociated=t.CreateContents=t.CreateHierarchy=t.Read=t.Modify=t.ViewPrivateItems=!1;i.J(t);i.A(n.g());return i}};_cc.dg=function(){_cc.dg.initializeBase(this);this.R=new _js.f};_cc.dg.prototype={R:null,S:!1,bx:function(n){this.ef("NotifyReadyEvent",n)},by:function(){return this.R},r:function(){return this.S},bl:function(n){if(this.S!==n){this.S=n;this.ek("NotifyReadyEvent",null,null)}return n},x:function(n){this.S?n(this):this.bx(n)}};_cc.cK=function(n){this.d=n};_cc.cK.prototype={d:null,c:function(){return this.d},b:function(n){var t=n;return t.unfoldedIndex>0?t.ItemId.Id+"_"+t.unfoldedIndex:t.ItemId.Id}};_cc.bo=function(n){this.a=n};_cc.bo.prototype={a:null};_cc.U=function(n,t,i,r,u,f,e){this.y=Function.createDelegate(this,this.K);this.x=Function.createDelegate(this,this.J);_cc.U.initializeBase(this);this.q=n;this.j=t;this.l=i;this.v=f;this.i=new _js.f;this.w=u;this.p=new _cc.cB(e);this.o=r;this.j.k(this.x);if(this.o){var o=this;this.o.a(function(n){o.k=n;o.k.x(o.y)})}};_cc.U.prototype={j:null,p:null,l:null,o:null,q:0,v:null,w:null,i:null,n:null,k:null,m:!0,r:null,a:function(){return this.i},h:function(){return this.q},d:function(){return this.m},G:function(n){if(this.m!==n){this.m=n;this.ea("CanSelectMoreCalendars")}return n},g:function(n){return this.i.x(n)},b:function(n,t,i){if(this.m&&this.F(n,t)){i||this.l.o(n);this.u();return!0}return!1},t:function(n,t){if(_js.d.a(n)){_js.Trace.logError(_cc.U.a,"smtpAddress is NULL or empty at SelectModernGroupCalendarByOwner");return null}var i=this.j.o(n);if(i)this.b(i,null,t);else{var r=_g.s.a(n,n,!0,!1);t||this.l.d(r)}return i},e:function(n){if(this.i.m(n,!0)){this.p.i(n);this.u();this.l.q(n)}},f:function(){var n=new _js.f;var t=this;this.i.q(function(i){var r=i;t.D(r)&&n.a(r)});return n},c:function(){for(var t=this.i.y.length,n=0;n<t;n++)if(this.D(this.i.y[n]))return!0;return!1},I:function(){for(var i="SelectedCalendars:\r\n",t=0;t<this.i.y.length;t++){var n=this.i.y[t];i+="Id:'"+(n.bh.ItemId?n.bh.ItemId.Id:"<null>")+"', N:'"+n.bh.CalendarName+"', P:'"+n.bh.ParentGroupId+"'\r\n"}return i},D:function(n){var t=this.j.b(n.a());return n.i()&&t.j(n)?!0:!1},E:function(n){var t=this;this.l.n(n,function(n){if(t.i.y.length>=t.q){_js.Trace.logWarning(_a.a.cm,"RestoreCalendarsSelectionFromViewState: We attempted to re-select more than the maximum number of calendars. Was the ViewState corrupted?");t.G(!1);return!1}t.F(n,function(n){_js.Trace.logWarning(_a.a.cm,"Linked configuration failed for calendar while restoring selection. ItemId: {0}",n.bh.ItemId);t.e(n)});return!0})},J:function(n){if(this.j.c()){this.i.g();this.z();var t=this.C(this.j.e().f());this.E(t);this.A()}},K:function(n){if(this.j.c()){this.z();if(this.n){var t=this.C(this.n);this.E(t);this.A()}}},A:function(){if(this.j.c()&&(!this.o||this.k&&this.k.r())){for(var t=new(_a.fJ.$$(String)),n=0,r=this.i.y.length;n<r;n++){var i=this.i.y[n];t.c(i.bh.ItemId.Id)}this.l.k(t);this.u()}},C:function(n){for(var u=new _ff.d,t=0,e=n.length;t<e;t++)for(var r=n[t],i=0,o=r.b().y.length;i<o;i++){var f=r.b().y[i];this.j.y(f.a())&&u.c(f)}return u},z:function(){if(this.j.c()&&this.k&&!this.n){this.n=[this.k.b(),this.k.c(),this.k.d()];this.j.e().n(this.n)}},F:function(n,t){var i=this.i.j(n);if(i>-1){this.v.a(_cc.bo,new _cc.bo(this.i.y[i]));return!1}this.p.j(n);if(_g.s.isInstanceOfType(n)){var r=n;this.j.j().b(r,null,t,null)}this.H(n);return!0},H:function(n){var t=n.bh.CalendarName||"";this.j.b(n.a())&&this.j.n(n)&&this.i.a(n)},u:function(){if(this.j.a()){var i=this.i.y.length;if(!i){var t=this.j.a();if(this.r)_js.Trace.logError(_cc.U.a,"Making attempt to select default calendar twice");else{var n=this;this.r=this.w.a(_cc.U.a,"SelectedCalendarsModel.CalendarPostSelectionCheck",function(){n.r=null;n.p.j(t);n.i.a(t);n.l.d(t)},0)}}this.G(i<this.q)}}};_cc.bO=function(n,t,i,r){this.c=Function.createDelegate(this,this.m);this.e=n;this.g=t;this.b=i;this.f=r;this.a=this.j()};_cc.bO.prototype={b:null,e:0,g:!1,f:null,a:null,j:function(){switch(this.e){case"Mouse":return this.b.b().bF();case"TouchWide":return this.b.b().bH();default:return this.b.b().bG()}},p:function(n){switch(this.e){case"Mouse":this.b.b().bL(n);break;case"TouchWide":this.b.b().bN(n);break;default:this.b.b().bM(n);break}return n},i:function(){this.h(new(_a.fJ.$$(String))(this.a.f()))},k:function(n){var i=this.a?this.a.b():0;var t=n?n.b():0;if(i!==t){this.a=n;this.h(this.a)}},o:function(n){this.a&&!this.a.j(n.bh.ItemId.Id)&&(n.e()&&!n.bh.IsGroupMailboxCalendar?n.apcl("ItemId",this.c):this.d(n))},q:function(n){this.a&&(n.e()&&!n.bh.IsGroupMailboxCalendar?n.rpcl("ItemId",this.c):this.a.p(n.bh.ItemId.Id)&&this.i())},n:function(n,t){this.a=this.j();if(this.a&&this.a.b())for(var i=0,u=this.a.b();i<u;i++){var r=this.l(n,this.a.a(i));if(r>-1&&!t(n.d[r])){_js.Trace.logWarning(_a.a.cm,"RestoreCalendarsSelectionFromViewState loop is terminated");break}}},d:function(n){if(this.a){this.a.c(n.bh.ItemId.Id);this.i()}},h:function(n){this.p(n);this.g||_h.h.b(this.b.b().c(),this.f)},m:function(n,t){var i=n;if(!i.e()){this.d(i);i.rpcl("ItemId",this.c)}},l:function(n,t){for(var i=0,u=n.d.length;i<u;i++){var r=n.d[i];if(r.bh.ItemId.Id===t)return i}return-1}};_cc.bF=function(){};_cc.bF.c=function(n,t,i){var f=_cc.bF.a(n,i);var l=_cc.bF.a(t,null);var b=l;for(var d in b){var k={key:d,value:b[d]};var u=f[k.key];var r=k.value;if(u){if(u.d===r.d)continue;if(u.b){var ut=f[u.b];var s=ut.a;var e=u.a;e.J(r.a);var h=s.b().j(e);if(u.b!==r.b){var rt=f[r.b];var et=rt.a;s.b().z(h,e);et.b().E(r.c,e,e)}else h!==r.c&&s.b().w(h,r.c,e)}else{var c=u.a;c.dW(r.a.dV());var g=n.j(c);var nt=t.j(r.a);g!==nt&&n.w(g,nt,c)}}else if(r.b){var y=f[r.b];var w=r.a;y?y.a.b().u(r.c,w):_js.Trace.logError(_a.a.K,"Group {0} not found for calendar entry Id={1}",r.b,w.bh.ItemId.Id)}else{var ft=r.a;ft.b().q(function(n){delete l[n.bh.ItemId.Id]});n.u(r.c,r.a)}}var a=f;for(var v in a){var p={key:v,value:a[v]};if(!(p.key in l)){var o=p.value;if(o.b){var tt=f[o.b];var it=tt.a;it.b().m(o.a,!0)}else n.m(o.a,!0)}}};_cc.bF.a=function(n,t){for(var f={},u=0,o=n.y.length;u<o;u++){var i=n.y[u];if(!t||!t(i)){var h=i.d()?i.d().ChangeKey:null;f[i.a()]=new _cc.bF.b(null,u,i,h);for(var r=0,s=i.b().y.length;r<s;r++){var e=i.b().y[r];f[e.bh.ItemId.Id]=new _cc.bF.b(i.a(),r,e,e.bh.ItemId.ChangeKey)}}}return f};_cc.bF.b=function(n,t,i,r){this.b=n;this.c=t;this.a=i;this.d=r};_cc.bF.b.prototype={b:null,c:0,a:null,d:null};_cc.dr=function(){};_cc.dr.registerInterface("_cc.dr");var IWeatherLocationProvider=function(){};IWeatherLocationProvider.registerInterface("IWeatherLocationProvider");var IWeatherProvider=function(){};IWeatherProvider.registerInterface("IWeatherProvider");_cc.ds=function(){};_cc.ds.registerInterface("_cc.ds");var ICalendarItemViewModel=function(){};ICalendarItemViewModel.registerInterface("ICalendarItemViewModel");_cc.dv=function(){};_cc.dt=function(){};_cc.dt.registerInterface("_cc.dt");_cc.dw=function(){};_cc.dw.registerInterface("_cc.dw");_cc.du=function(){};_cc.du.registerInterface("_cc.du");var ITimeSuggestionsViewModelFactory=function(){};ITimeSuggestionsViewModelFactory.registerInterface("ITimeSuggestionsViewModelFactory");var IWeatherControllerViewModel=function(){};IWeatherControllerViewModel.registerInterface("IWeatherControllerViewModel");_cc.cS=function(n,t){this.e=Function.createDelegate(this,this.f);this.c=t;this.d=n};_cc.cS.prototype={c:null,d:null,b:function(){return!0},a:function(n,t,i,r){return new _C(this.e,_a.a.W)},f:function(){var n=this;this.c.a(function(t){t.g(n.d.e.cs)})}};_cc.dl=function(n){this.cc=Function.createDelegate(this,this.cS);this.bZ=Function.createDelegate(this,this.cQ);this.ca=Function.createDelegate(this,this.U);this.cd=Function.createDelegate(this,this.V);this.cb=Function.createDelegate(this,this.cR);_cc.dl.initializeBase(this);this.Q=n;this.bw=new _C(this.cb,this.Q);this.T=!0;this.cT()};_cc.dl.prototype={J:!1,I:null,v:null,t:null,r:null,Q:null,bx:function(){return 1},k:!1,H:null,n:function(){this.v||(this.v=new _C(this.cd,this.Q));return this.v},q:function(){this.t||(this.t=new _C(this.ca,this.Q));return this.t},m:function(){this.I||(this.I=new _C(this.bZ,this.Q));return this.I},w:function(){return this.cc},P:function(n){if(this.J!==n){this.J=n;this.ea("IsConfirmDialogShown")}return n},z:null,bS:function(){return this.z},ba:function(n){this.z=n;return n},j:null,p:function(){return this.j},g:function(n){this.j=n;return n},O:function(n){if(this.r!==n){this.r=n;this.ea("CommandBar")}return n},by:function(){return!0},ce:!1,N:function(){return this.ce},M:null,T:!1,bw:null,F:function(){var n=new _fm.o;if(this.T){var i=new _fm.i(this.n(),_u.c.DL,_y.d.h(),0,null,null,!1,!1,!1);n.b(i);var t=new _fm.i(this.q(),_u.c.CH,_y.d.j(),0,null,null,!1,!1,!1);n.b(t)}this.O(n)},cS:function(n,t){if(this.k)return!0;if(this.N()){this.P(!0);return!0}this.M&&this.M();this.dispose();return!1},U:function(){},V:function(){},cT:function(){if(!this.H){this.H=new _js.f;this.H.a(new _ff.f(this.n(),_u.c.DL,null,!0));this.H.a(new _ff.f(this.q(),_u.c.CH));this.H.a(new _ff.f(this.bw,_u.c.Di))}this.P(!1)},cR:function(){this.P(!1)},cQ:function(){this.j()}};_cc.bb=function(n,t,i,r){this.t=Function.createDelegate(this,this.J);this.p=Function.createDelegate(this,this.m);this.o=Function.createDelegate(this,this.x);this.r=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.y);_cc.bb.initializeBase(this);this.n=n;this.e=t;this.a=i;this.l=r;this.f=new _C(this.q,_cc.bb.a);this.d=new _C(this.r,_cc.bb.a,this.a,"CalendarEntry",this.o)};_cc.bb.prototype={f:null,d:null,n:!1,a:null,e:null,l:null,k:null,c:null,h:null,v:function(n){this.ef("CategoriesChanged",n)},w:function(n){this.eg("CategoriesChanged",n)},I:function(n){if(this.c!==n){this.c=n;this.ea("CategoryManagementDialog")}return n},A:function(){return this.a.br()},b:function(){this.k||(this.k=new _y.ck(this.e,this.p,this.f,this.d));return this.k},C:function(){if(this.h)return this.h;this.h=new _ff.d;if(this.e&&this.j()){var t=this.e.e();var r=this.a.br()?this.a.br().f():new Array(0);r.sort(_cc.b.i);for(var e=t.length,f=r.length,n=0,i=0;n<e;n++){var u=!1;if(i<f&&t[n].bh.Name===r[i]){u=!0;i++}this.h.c(this.z(t[n].bh.Name,u))}}return this.h},i:function(){return this.j()?this.b().c():null},j:function(){return!this.a.bA()},g:function(){this.b().a(this.E(),1)},m:function(n,t,i,r){var e=this.a.br();var o=n?n.bh.Name:null;var u=t?t.bh.Name:null;var f=_g.bm.a(e,i,u,o);this.a.dQ(f);this.eh("CategoriesChanged")},J:function(n,t,i){var r=new _h.bT(n,t,i,this.D());var u=this;r.w(function(){var n=r.b;u.e.c(n);u.ea("MasterCategories")});r.v(_cc.h.a);this.l.a(r)},D:function(){return _g.i.a(this.a)},E:function(){var n={};if(this.a.br()&&this.a.br().b()>0){var t=this.a.br().f();n["Compose Form Item Categories"]=t}return n},y:function(){this.m(null,null,!0,null)},x:function(){var n=this.a.e();return this.n&&(_g.C.isInstanceOfType(n)&&!n.bh.IsReadOnly||this.a.bE())?!0:!1},G:function(){this.F();this.c.I()},F:function(){this.c||this.I(new _y.W(this.e,this.t))},z:function(n,t){var f=this;var r=new _y.h("dummy",new _C(function(){},_cc.bb.a));var u=this;var i=new _y.h(n,new _C(function(){u.H(r)},_cc.bb.a));r=i;i.z();i.x(t);return i},H:function(n){var i=null;var t=null;if(n.w()){i=new _g.bp;i.e(n.b)}else{t=new _g.bp;t.e(n.b)}this.m(i,t,!1,null)}};_cc.bg=function(n,t,i){this.d=n;this.a=t;this.b=i};_cc.bg.prototype={d:null,a:null,b:null,c:function(n){if(!this.a.c()){_js.Trace.logError(_a.a.K,"Make sure that calendarcache is loaded before creating CalendarCategoryViewModel");return null}var t=this.a.j().a(n.bh.ParentFolderId);return t?new _cc.bb(this.d.c(),t,n,this.b):null}};_cc.dm=function(n,t){this.c=Function.createDelegate(this,this.x);this.a=n;this.m=t||null;this.g()};_cc.dm.prototype={a:null,m:null,e:null,x:function(n,t){this.f()},f:function(){this.a.e(this.e);this.d()},j:function(n,t){if(_cc.b.e(n)){var u=0;var f=1;var i=new Array(2);i[u]=4600;i[f]=6200;var r=new Array(2);r[u]=1100;r[f]=2200;var e=t?i:r;n.J()?this.a.a(e[f]):this.a.a(e[u])}},t:function(n,t){n.O()&&t&&!n.D()&&this.a.a(1400)},s:function(n){if(n.N()){var i=_u.c.Bg;var t=_u.c.Bg;if(n.K()){t=n.K().a(5);i=n.K().a(0)}this.a.a(1200,t,i)}},q:function(n){n.O()||n.N()||_cc.b.e(n)||(n.Q()==="NoResponseReceived"||n.Q()==="Unknown")&&(n.D()||this.a.a(1300))},r:function(n,t){if(!n.bh.IsOrganizer&&n.fE()){var f=_js.d.b(n.bh.AppointmentReplyName)||t.bh.UserDisplayName===n.bh.AppointmentReplyName;var e=n.fE().a(5);var o=n.fE().a(0);var i=null;i=f?[e,o]:[n.bh.AppointmentReplyName,e,o];var u=this.v(n.Q(),f);if(u!==-1){var r;(r=this.a).a.apply(r,[u].concat(i))}}},u:function(n,t){var r=this;var i=function(){r.w(n)};this.n(t,i,_u.c.Dg)},n:function(n,t,i){this.a.v=!0;if(n.d.length===1){var r=n.d[0];var f=new _cc.bs;var u=f.a(r.a,null);t?this.a.d(6701,[r.b,u],i,t):this.a.a(6701,r.b,u)}else n.d.length>1&&this.a.d(6702,null,i,t)},w:function(n){var t=new _y.O;t.b(n);this.m.a(t)},v:function(n,t){var i=-1;switch(n){case"Accept":i=t?1600:1700;break;case"Tentative":i=t?1800:1900;break;case"Decline":i=t?2e3:2100;break;default:break}return i}};_cc.t=function(){};_cc.t.e=function(n,t){var u=n;var r=t;var i=u.l().b(r.l());return i?i:_cc.t.b(u,r)};_cc.t.a=function(n,t){return _cc.t.b(n,t)};_cc.t.b=function(n,t){var i=t.i()-n.i();if(i)return i;i=_cc.t.c(t)-_cc.t.c(n);if(i)return i;i=n.a().g(t.a());if(i)return i;i=(n.e()&&n.e().f()?0:1)-(t.e()&&t.e().f()?0:1);if(i)return i;i=_cc.t.d(n.k())-_cc.t.d(t.k());if(i)return i;i=t.b().g(n.b());return i?i:_cc.t.f(n,t)};_cc.t.f=function(n,t){return n.m()?t.m()?n.m().localeCompare(t.m()):-1:t.m()?1:0};_cc.t.d=function(n){switch(n){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}};_cc.t.c=function(n){var t=n.b().g(n.a());return t>864e5?Math.ceil(t/864e5):1};_cc.br=function(){};_cc.br.prototype={a:0,c:!1,b:!1,f:function(){this.a=1;return this},g:function(){this.a=2;return this},e:function(){this.c=!0;return this},d:function(){this.b=!0;return this}};_cc.bV=function(n,t,i,r,u,f){_cc.bV.initializeBase(this);this.e=n;this.c=r;this.h=i;this.f=t;this.g=u;this.d=f};_cc.bV.prototype={f:null,h:null,e:null,c:null,g:null,d:null,b:function(){return this.j()||this.k()},j:function(){return this.c.d.k()},n:function(){return this.c.d.k()&&this.l()},k:function(){return this.c.d.bv()},o:function(){return this.c.d.bv()&&this.l()},l:function(){return this.c.c.bA()},a:function(n,t,i,r){var e=null;var f=null;var u=null;r=r||new _cc.br;switch(n){case 1:var s=this;e=function(){s.f.a(function(n){s.r(n,t,i,r.a)})};f="CanOpenItemInRead";var l=this;u=function(){return l.k()};if(t){f="CanOpenSeriesInRead";var a=this;u=function(){return a.o()}}break;case 0:var o=this;e=function(){o.h.a(function(n){o.q(n,t,i,r.c,r.b)})};f="CanOpenItemInCompose";var c=this;u=function(){return c.j()};if(t){f="CanOpenSeriesInCompose";var h=this;u=function(){return h.n()}}break}return new _C(e,_cc.bV.a,this,f,u)},v:function(){this.d.b(null)},t:function(){this.d.d();this.d.b(null)},r:function(n,t,i,r){t?this.d.a(_a.a.i,_cc.v.c("OpenCalendarSeriesItemOnReadingPane"),!0,null):this.d.a(_a.a.i,_cc.v.c("OpenCalendarItemOnReadingPane"),!0,null);var o=this.m(t);var s=this.i();var e=this;var u=function(n){$a(r)||n.f(r);e.v()};var f=n.d(o.a,null,!0,!0,u);this.d.g();this.e.f(f,s,!1);i&&i()},i:function(){if(this.e.c()){var n=this.e.q();return ICalendarItemDetailsViewModel.isInstanceOfType(n.a())||IComposeCalendarItemViewModel.isInstanceOfType(n.a())?1:0}else return 1},q:function(n,t,i,r,u){t?this.d.a(_a.a.i,_cc.v.c("OpenCalendarSeriesItemOnComposeForm"),!0,null):this.d.a(_a.a.i,_cc.v.c("OpenCalendarItemOnComposeForm"),!0,null);var o=this.m(t);var h=this.i();var c=_js.e.s(_a.a.i,2,"Setting ComposeCalendarItemVM");var s=this;var e=function(n){s.t()};var f=n.c(r?this.p():o.a,null,null,e,null);_js.e.e(c);this.d.g();u?f.f():this.e.f(f,h,!1);i&&i()},m:function(n){var i=new _y.O;n?i.p(new _h.R(this.c.c.bh.ItemId)):i.b(this.c.c.bh.ItemId);var t=this.g.d(this.c.c.bh.ParentFolderId);t&&(t.bh.IsGroupMailboxCalendar||t.c())&&i.h(t.bh.OwnerEmailAddress);return i},p:function(){return{ContextCalendarItemViewModel:this.c}}};_cc.bW=function(n,t,i,r,u,f,e){this.f=n;this.e=t;this.b=i;this.a=r;this.g=u;this.c=f;this.d=e};_cc.bW.prototype={g:null,f:null,e:null,b:null,c:null,d:null,a:null,h:function(n){return n.e.cs?new _cc.cS(n,this.a):new _cc.bV(this.g,this.b,_gg.e.isInstanceOfType(n.c)?this.e:this.f,n,this.c,this.d)}};_cc.r=function(n,t,i,r,u,f,e,o,s,h){this.bj=Function.createDelegate(this,this.bN);this.M=Function.createDelegate(this,this.bL);this.bi=Function.createDelegate(this,this.bM);this.A=Function.createDelegate(this,this.bK);this.bk=Function.createDelegate(this,this.bV);this.bh=Function.createDelegate(this,this.bJ);this.bm=Function.createDelegate(this,this.ca);this.bp=Function.createDelegate(this,this.cd);this.bn=Function.createDelegate(this,this.bz);this.bo=Function.createDelegate(this,this.cc);this.bl=Function.createDelegate(this,this.r);this.bg=Function.createDelegate(this,this.bG);this.bf=Function.createDelegate(this,this.bF);this.be=Function.createDelegate(this,this.bE);this.bd=Function.createDelegate(this,this.bD);this.N=Function.createDelegate(this,this.bY);this.ba=Function.createDelegate(this,this.bA);this.bc=Function.createDelegate(this,this.bC);this.bb=Function.createDelegate(this,this.bB);_cc.r.initializeBase(this);this.l=t;this.i=i;this.v=f;this.a=n;this.U=r;this.T=u;this.G=e;this.q=o;this.V=s;this.w=h;this.bX();var d=this;this.P=new _C(this.bb,_cc.r.a,this,"CanAddToMyCalendar",function(){return d.m()});var k=this;this.E=new _C(this.bc,_cc.r.a,this,"CanAddToMyCalendar",function(){return k.m()});var b=this;this.p=new _C(this.ba,_cc.r.a,this,"CanAddToMyCalendar",function(){return b.m()});var g=this;this.c=new _C(this.N,_cc.r.a,this,"CanRemove",function(){return g.g()});var it=this;this.e=new _C(this.bd,_cc.r.a,this,"CanCancel",function(){return it.d()});var tt=this;this.y=new _C(this.be,_cc.r.a,this,"CanCancel",function(){return tt.d()});if(this.a.c.bA()){this.J=this.a.p();var nt=this;this.Q=new _C(this.bf,_cc.r.a,this,"CanCancel",function(){return nt.d()});var a=this;this.W=new _C(this.bg,_cc.r.a,this,"CanCancel",function(){return a.d()})}var l=this;this.z=new _C(this.bl,_cc.r.a,this,"CanSave",function(){return l.bw()});var c=this;this.K=new _C(this.bo,_cc.r.a,this,"CanSend",function(){return c.H()});var v=this;this.Z=new _C(this.bn,_cc.r.a,this,"CanSend",function(){return v.H()});var w=this;this.L=new _C(this.bp,_cc.r.a,this,"CanSend",function(){return w.H()});var p=this;this.Y=new _C(this.bm,_cc.r.a,this,"CanSaveDraft",function(){return p.bS()});var y=this;this.F=new _C(this.N,_cc.r.a,this,"CanDiscardDraft",function(){return y.a.n});this.bI()};_cc.r.prototype={J:null,P:null,E:null,p:null,c:null,e:null,Q:null,y:null,W:null,z:null,K:null,Z:null,L:null,Y:null,F:null,V:null,T:null,a:null,l:null,i:null,U:null,v:null,G:null,q:null,w:!1,f:null,x:null,j:null,t:function(n){this.ef("Executing",n)},bZ:function(n){this.eg("Executing",n)},h:function(n){this.ef("Completed",n)},X:function(n){this.eg("Completed",n)},m:function(){return!this.i.e()&&this.a.e.U()&&!this.a.e.bh.IsCancelled},bQ:function(){return this.m()&&!this.a.e.bh.IsOrganizer},g:function(){return this.bu()&&(this.a.e.bh.IsCancelled||this.a.e.gx()||(_cc.b.d()?this.a.e.bh.IsOrganizer&&!this.a.e.bh.MeetingRequestWasSent:!1))},bR:function(){return this.g()&&!this.a.e.cZ()},d:function(){return this.a.e.eI()&&this.a.e.bz()&&(_cc.b.d()?this.a.e.bh.MeetingRequestWasSent:!0)},bw:function(){return!this.a.l()&&!this.a.c.bh.IsCancelled&&this.a.c.bh.IsOrganizer},H:function(){return this.a.l()&&this.a.c.bh.IsOrganizer},bS:function(){return this.a.c.bh.IsOrganizer},k:function(){return!this.i.e()&&this.a.c.ce()},bu:function(){return!this.i.e()&&this.a.c.cu()},bv:function(){return(!this.i.e()||!_cc.r.b&&!this.a.c.cf())&&this.a.c.cE()},C:0,D:0,b:function(){if(!this.x){this.x=this.V.a();this.x.o(new _C(this.bh,_cc.r.a))}return this.x},bT:function(){return this.T.a()},bB:function(){this.O("AddToMyCalendarFromComposeCommandingBar")},bC:function(){this.O("AddToMyCalendarFromSurfaceContextMenu")},bA:function(){this.O("AddToMyCalendarFromCalendarReadingPaneOrPeekForm")},bY:function(){var i=this.a.e;i.bh.IsSeriesCancelled&&(i=this.a.p().c);var n=_cc.v.g(i.bE());var t=new _cc.cx(i,this.I(this.a.c),_g.i.a(this.a.e));var u=this;t.v(function(t){if(n){var i=t;n.k=i.D();n.l=i.C();_a.d.a(n);n=null}_cc.h.a(t)});var r=this;t.w(function(i){if(n){var u=i;n.l=u.C();_a.d.a(n);n=null}r.n("RemoveCalendarItemAction",t)});this.l.a(t)},bD:function(){this.bq(!1)},bF:function(){this.bq(!0)},bq:function(n){if(_cc.b.c()){var r=this.a.e;this.b().m(n);this.b().d(!0)}else{var i=this.bT();var t=this;this.U.a(function(n){var r=t.bH(n);t.i.c()&&t.n("CancelCalendarItemAction",null);i.a(r)})}},bE:function(){this.br(!1)},bG:function(){this.br(!0)},br:function(n){this.bx(null,n,!0)},r:function(){this.o(!1,!1,0,!1,!1,!1,null,null)},cb:function(n,t,i){this.o(!1,!1,0,!1,!1,i,n,t)},by:function(){this.o(!1,!1,0,!0,!1,!1,null,null)},cc:function(){this.o(!0,!1,3,!1,!1,!1,null,null)},bz:function(){this.o(!0,!1,4,!1,!1,!1,null,null)},cd:function(){this.o(!0,!1,3,!1,!0,!1,null,null)},ca:function(){this.o(!1,!0,0,!1,!1,!1,null,null)},ch:function(){this.a.l()?this.bz():this.r()},bJ:function(){var n=new _cmc.c(!1);this.b().l(n);this.b().n(n.d);this.b().d(!1);this.bx(this.b().k(),this.b().j(),!1)},bU:function(){return new _h.be([this.a.c],this.a.c.bh.ParentFolderId,0)},bH:function(n){var t=n.a(!0,!1);t.f(8);t.j(!0);var r=_g.i.a(this.a.e);t.dn(r);r&&t.du(!0);if(this.a.e.bQ()){var i=this.a.c.bR;i&&i.a();t.O(this.a.e)}else{t.dB(!0);t.cu(this.a.e.bh.ItemId);t.cr(_g.i.d(this.a.e))}return t},O:function(n){this.f=_a.d.b(_cc.r.a,n,!0);var u=new _gg.dS;u.ItemId=_h.R.a(this.a.e);var f=_g.i.a(this.a.e);var r=new _cc.bY(u,f);var t=this;r.v(function(n){if(t.f){var i=n;t.f.k=i.D();t.f.l=i.C();_a.d.a(t.f);t.f=null}_cc.h.a(n)});var i=this;r.w(function(n){i.n("AddCalendarItemToMyCalendarAction",r);if(i.f){var t=n;i.f.l=t.C();_a.d.a(i.f);i.f=null}});this.l.a(r)},bO:function(n){var t=this.a.c;if(n){t=this.a.e;t.be(this.a.c.a().u(1));t.L(this.a.c.b().u(1))}return new _cc.S(t,n)},bI:function(){var n=this.a.c.bA();this.j=_cc.b.c()?this.bs(n,this.e,this.y,this.Q,this.W):this.bs(n,this.e,this.y,n?this.J.d.e:null,n?this.J.d.y:null)},bP:function(n,t){var i=this.a.c;var u=n?2:0;i.bE()&&(u=2);if(t){i=this.a.e;var r=this.a.c;i.bW(r.e());r.bE()&&(u=0);i.be(r.a().u(1));i.L(r.b().u(1))}else{var f=i.bR;f&&f.a()}return new _cc.m(i,u,this.I(i),_g.i.a(i))},o:function(n,t,i,r,u,f,e,o){if(n&&t)throw Error.invalidOperation("Cannot send and save as draft.");var s=new _ff.d;var c=!1;if(this.a.j())if(this.a.c.cY()){var d=this.bO(t);s.c(d)}else{var h=this.bP(n,t);h.bq=this.C;h.br=this.D;s.c(h);this.S(h,c,t,!1)&&this.v.X(h)}else{if(t)throw Error.invalidOperation("Cannot save a draft of an existing calendar item.");var b=this.a.c.bR;b&&b.a();if(this.a.I()||u||this.a.c.fb){this.a.c.e().bh.IsGroupMailboxCalendar&&(i=3);var l=new _cc.G(this.a.e,this.a.c,i,this.a.e.J(),this.I(this.a.c),_g.i.a(this.a.e));l.bb=this.C;l.be=this.D;s.c(l);this.v.Y(l)}if(this.a.J()){c=!0;var tt=this.bU();s.c(tt)}}if(s.d.length>0){for(var a=null,k=s.d,nt=k.length,v=0;v<nt;++v){var y=k[v];this.cf(y,c,t,r);if(a){var g=this;a.w(function(n){g.l.a(y)})}a=y}var w=s.d[0];this.ce(w,c,t,n,f);var p=s.d[s.d.length-1];this.cg(p,c,t,n,f);e&&p.w(e);o&&p.v(o);this.l.a(w)}else{this.n(this.R(f,n),null);e&&e(null)}},ce:function(n,t,i,r,u){if(this.S(n,t,i,!1)){var f=this;n.bx(function(n){f.bW(f.R(u,r),n)})}},cf:function(n,t,i,r){var u=this;n.v(function(f){if(u.S(n,t,i,!0)){_cc.m.isInstanceOfType(n)&&u.v.bw(f.b());var e;(e=u.q).d(e.a+1);u.G.a(_y.eL,new _cc.cT(u.q.a===1,_cc.G.isInstanceOfType(n),u.bk,u.a.c.bh.Subject))}else r||_cc.h.a(f);u.n("PersistActionFailed",f)})},cg:function(n,t,i,r,u){var f=this;n.w(function(n){var e;e=i?"SaveDraftCalendarItemAction":t?"MoveCalendarItemAction":f.R(u,r);f.n(e,n)})},R:function(n,t){return n?t?"SendCalendarItemAction":"SaveCalendarItemWebExtensionAction":t?"SendCalendarItemAction":"SaveCalendarItemAction"},bW:function(n,t){this.ek("Executing",n,t)},n:function(n,t){this.ek("Completed",n,t)},S:function(n,t,i,r){if(t||i||!this.w||this.i.a()!=="Mouse"||!this.i.c())return!1;if(_cc.m.isInstanceOfType(n)){var s=n;var u=s.b();return!!u&&!u.J()&&(!r||u.co())}if(_cc.G.isInstanceOfType(n)){var o=n;var e=o.d;var f=o.b;return!!f&&!f.J()&&!!f.C()&&!!e&&!e.J()}return!1},bV:function(){var t=(new _cc.br).e().d();this.a.h.a(this.a.c.ce()?0:1,!1,null,t).a();var n;(n=this.q).d(n.a-1);this.q.a||this.G.a(_y.fC,null)},bs:function(n,t,i,r,u){var f=new _ff.d;if(n){f.c(new _fm.n(_u.c.Dc));f.c(new _fm.d(_u.c.j,null,t));f.c(new _fm.d(_u.c.Db,null,i));f.c(new _fm.n(_u.c.DR));f.c(new _fm.d(_u.c.j,null,r));f.c(new _fm.d(_u.c.Db,null,u))}else{f.c(new _fm.n(_u.c.Cn));f.c(new _fm.d(_u.c.j,null,t));f.c(new _fm.d(_u.c.Db,null,i))}return new _fm.f(f.h())},bX:function(){this.a.c.bc();this.a.c.apcl("RequiredAttendees",this.A);this.a.c.apcl("OptionalAttendees",this.A);this.a.c.apcl("Resources",this.A);this.a.c.apcl("IsCancelled",this.bi);this.a.c.fe(this.M);this.a.apcl("IsDraft",this.bj)},bK:function(n,t){this.a.c.fe(this.M);this.bt()},bL:function(n,t){this.bt()},bt:function(){this.ee("CanSend","CanSave")},bM:function(n,t){this.ea("CanSave")},bN:function(n,t){this.ea("CanDiscardDraft")},I:function(n){var i;var t=n.e();if(!t)return null;i=t.f()?_g.r.d("calendar"):n.bh.ParentFolderId;var r;r=t&&t.bh.IsGroupMailboxCalendar?new(_h.dT.$$(_cc.bS))(i):_g.s.isInstanceOfType(t)?new(_h.dT.$$(_cc.x))(i):new(_h.dT.$$(_cc.M))(i);return _h.g.a().h(r)},bx:function(n,t,i){var f=this.a.e;t&&(f=this.a.p().c);var r=_cc.v.f(f.bE(),i);var u=new _cc.cr(f,this.I(this.a.c),_g.i.a(f),n);var o=this;u.v(function(n){if(r){var t=n;if(t){r.k=t.D();r.l=t.C()}_a.d.a(r);r=null}_cc.h.a(n)});var e=this;u.w(function(n){if(r){var t=n;t&&(r.l=t.C());_a.d.a(r);r=null}e.n("CancelCalendarItemAction",u)});this.l.a(u)}};_cc.bX=function(n,t,i,r,u,f,e,o,s){this.a=n;this.i=t;this.b=u;this.g=i;this.f=r;this.d=f;this.c=e;this.h=o;this.e=s};_cc.bX.prototype={f:null,a:null,i:null,g:null,b:null,d:null,c:null,h:null,e:!1,k:function(){return this.b},m:function(){return this.d},l:function(){return this.c},n:function(){return this.f.e()},j:function(n){return new _cc.r(n,this.a,this.i,this.g,this.n(),this.k(),this.m(),this.l(),this.h,this.e)}};_cc.b=function(){};_cc.b.m=function(){return _cc.b.g==="Mouse"&&_cc.b.l()};_cc.b.a=function(){return _cc.b.g==="Mouse"&&_cc.b.l()&&_cc.b.b.a().f().Enabled&&_cc.b.b.a().dt().Enabled};_cc.b.o=function(){return $a(_g.a.a().a().bh.IsZenSubscribed)?!1:_g.a.a().a().bh.IsZenSubscribed};_cc.b.v=function(){return!!_cc.b.f&&_cc.b.f.a("15.01.0222.000")};_cc.b.n=function(){return!!_cc.b.b&&_cc.b.b.a().dd().Enabled};_cc.b.c=function(){return!!_cc.b.b&&_cc.b.b.a().cN().Enabled};_cc.b.j=function(){return _cc.b.b.a().b().Enabled};_cc.b.r=function(){return _cc.b.a()&&_cc.b.b.a().cH().Enabled};_cc.b.s=function(){return!!_cc.b.b&&_cc.b.b.a().co().Enabled&&_cc.b.g==="Mouse"};_cc.b.d=function(){return!!_cc.b.b&&_cc.b.b.a().cT().Enabled};_cc.b.u=function(){return _cc.b.l()};_cc.b.l=function(){return _cc.b.b.a().q().Enabled};_cc.b.x=function(n){return n.a().f().Enabled&&n.a().q().Enabled};_cc.b.w=function(n,t,i,r){_cc.b.b=n;_cc.b.g=t;_cc.b.f=i;_cc.b.k=r};_cc.b.h=function(n){return _js.d.a(n)?!!_cc.b.f&&_cc.b.f.a("15.01.0253.000"):_cc.b.k?_cc.b.k.a(n,"EntityNamesMapServerChanges"):!1};_cc.b.e=function(n){var t;var i=n.J()&&!!n.F();t=i?_cc.e.k(n.F()):_cc.b.p(n).b;return!!t&&t.b(_a.c.a())<0};_cc.b.q=function(n){var i=n.q()?n.q().b():0;var t=n.v()?n.v().b():0;return i+t};_cc.b.p=function(n){var i;var t;if(n.n()){var r=n.f().g(n.c());i=n.c().f();t=n.f().D()||!r?n.f().f().c(1):n.f()}else{i=n.c();t=n.f()}return new _h.k(i,t)};_cc.b.t=function(n,t){var u;var r;u=n.b(t.a())>0?n:t.a();var i=n.c(1);r=i.b(t.b())<0?i:t.b();return new _h.k(u,r)};_cc.b.i=function(n,t){var r=n.toLowerCase();var i=t.toLowerCase();return r.localeCompare(i)};_cc.bh=function(n,t,i,r,u,f,e,o,s){this.F=Function.createDelegate(this,this.R);_cc.bh.initializeBase(this);_a.b.b(n,"item");this.C=t;this.D=f;this.t=i;this.y=r;this.x=u;this.A=e;this.w=o;this.E=s;this.P(n)};_cc.bh.prototype={C:null,D:null,t:null,y:null,x:null,A:null,E:null,w:null,n:!1,m:!1,e:null,c:null,g:null,d:null,h:null,o:null,k:null,z:!1,f:null,j:function(){return!this.e.bh.ItemId&&!this.c.bh.ItemId||this.c.co()},l:function(){return this.e.bz()||this.c.bz()},O:function(){return this.e.bz()&&this.c.bz()},T:function(n){if(this.f!==n){this.f=n;this.ea("MeetingResponseViewModel")}return n},a:function(){return this.c},v:function(n){if(this.c!==n){this.c=n;this.L();this.r(this.c.bh.ReminderIsSet?this.c.bh.ReminderMinutesBeforeStart:-1);var t=this;this.S(new _C(this.F,_cc.bh.a,this.c,"CanJoin",function(){return t.c.ct()}));this.ea("CalendarItem")}return n},b:function(){return this.c.bh.ReminderIsSet?this.c.bh.ReminderMinutesBeforeStart:-1},r:function(n){if(this.b()!==n){this.c.cP(n!==-1);this.c.bh.ReminderIsSet&&this.c.bh.ReminderMinutesBeforeStart!==n&&this.c.gm(n);this.ea("ReminderSelectedValue")}return n},S:function(n){if(this.k!==n){this.k=n;this.ea("JoinCommand")}return n},q:function(){if(this.e.bh.ParentFolderId){if(this.J())return!0}else if(!this.c.bh.ParentFolderId||!_g.b.a.doesIdEqualName(this.c.bh.ParentFolderId,"calendar"))return!0;return this.I()},I:function(){return this.e.bh.Subject!==this.c.bh.Subject||this.e.bh.IsAllDayEvent!==this.c.bh.IsAllDayEvent||!_a.c.c(this.e.a(),this.c.a())||!_a.c.c(this.e.b(),this.c.b())||this.e.k()!==this.c.k()||this.e.bh.ReminderIsSet!==this.c.bh.ReminderIsSet||this.e.bh.ReminderMinutesBeforeStart!==this.c.bh.ReminderMinutesBeforeStart||this.e.bF()!==this.c.bF()||this.e.cb()!==this.c.cb()||this.e.bh.IsResponseRequested!==this.c.bh.IsResponseRequested||!_g.br.a(this.e.r(),this.c.r())||!_g.br.a(this.e.F(),this.c.F())||this.H()||_g.t.b(this.e.G(),this.c.G())||_g.bL.a(this.e.bH(),this.c.bH())||_g.h.i(this.e.br(),this.c.br())||this.z?!0:this.c.fI()},H:function(){return _g.t.b(this.e.q(),this.c.q())||_g.t.b(this.e.v(),this.c.v())},U:function(n){if(this.e!==n){this.e=n;this.G()}return n},K:function(n){this.n=n;this.ea("IsDraft");return n},i:function(){return this.c.bh.SuggestionCategory===1||_cc.b.h(_g.i.a(this.c))&&this.c.eR()===1},N:function(){return!!this.c.bh.SuggestionCategory||_cc.b.h(_g.i.a(this.c))&&this.c.eR()>0},J:function(){return!!this.e.bh.ParentFolderId&&!!this.c.bh.ParentFolderId&&!_g.r.b(this.c.bh.ParentFolderId,this.e.bh.ParentFolderId)},V:function(n){this.v(n)},W:function(n){this.v(n);this.X()},p:function(){if(!this.c.bA())throw Error.invalidOperation("Cannot create partial recurring master model from a non-recurring event.");var n=this.w.c(this.e);return this.y.a(n)},X:function(){this.e.di(this.c.bh);this.G()},M:function(){this.v(this.e.dJ())},L:function(){this.Q();this.h=this.x.h(this);this.g=this.C.a(this.c,null,this.A.d,null);this.o=new _cc.co(this.c,new _gg.GT,this.c.a(),this.c.b())},Q:function(){this.d=this.D.j(this)},G:function(){this.f&&this.f.dispose();this.t.a=_g.i.a(this.e);this.T(this.t.k(this.e))},P:function(n){n.bc();this.U(n);this.v(this.e.dJ())},R:function(){this.E.a(this.c.bh.JoinOnlineMeetingUrl,null,null)}};_cc.I=function(n,t,i,r,u,f,e,o){this.e=n;this.f=t;this.b=e;this.i=r;this.g=i;this.c=u;this.d=f;this.h=o};_cc.I.prototype={e:null,f:null,i:null,g:null,b:null,d:null,c:null,h:null,l:function(){return this.g.e()},k:function(){return this.d.e()},j:function(){return this.c.e()},a:function(n){return new _cc.bh(n,this.e,this.f,this,this.j(),this.l(),this.k(),this.b,this.h)}};_cc.by=function(n){if($a(n))this.a={};else{if(!_cc.by.a(n))throw Error.invalidOperation("Cannot construct a ScheduleFollowupParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.a=n}};_cc.by.a=function(n){return!$a(n.FollowupSourceItemId)};_cc.by.prototype={a:null,c:function(){if($a(this.a.FollowupSourceItemId))return null;var n=this.a.FollowupSourceItemId;return _g.g.b(n)},d:function(n){$a(n)?delete this.a.FollowupSourceItemId:this.a.FollowupSourceItemId=n.Id;return n},b:function(){return this.a.ExplicitLogonUser}};_cc.bq=function(n,t){this.d=n;this.c=t};_cc.bq.prototype={d:null,c:null,b:null,a:function(n){this.b=_a.d.b(_a.a.b,_cc.v.c("OpenCalendarItemOnComposeForm"));var t=this;this.c.a(function(i){var r=i.c(n.a,null,null,function(n){if(t.b){_a.d.a(t.b);t.b=null}},null);t.d.f(r,0,!1)})}};_cc.R=function(n,t){_cc.R.initializeBase(this);this.d=n;this.f=t};_cc.R.prototype={d:null,f:null,e:!1,a:function(){return this.f},b:function(){return this.e},c:function(n){if(this.e!==n){this.e=n;this.ea("IsHidden")}return n}};_cc.cW=function(){_cc.cW.initializeBase(this)};_cc.cW.prototype={y:function(){return _a.a.i},H:function(){return _u.W.J}};_cc.bj=function(n){if($a(n))this.a={};else{if(!_cc.bj.a(n))throw Error.invalidOperation("Cannot construct a UpdateCalendarItemParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.a=n}};_cc.bj.a=function(n){return!$a(n.ItemID)&&(!$a(n.Start)||!$a(n.Duration)||!$a(n.IsAllDayEvent))};_cc.bj.prototype={a:null,f:function(){if($a(this.a.ItemID))return null;var n=this.a.ItemID;return _g.g.b(n)},k:function(n){$a(n)?delete this.a.ItemID:this.a.ItemID=n.Id;return n},d:function(){return this.a.ExplicitLogonUser},i:function(n){this.a.ExplicitLogonUser=n;return n},g:function(){return this.a.Start},l:function(n){this.a.Start=n;return n},c:function(){var n=this.a.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},h:function(n){this.a.Duration=n;return n},e:function(){return $a(this.a.IsAllDayEvent)?!1:Boolean.parse(this.a.IsAllDayEvent)},j:function(n){this.a.IsAllDayEvent=n.toString();return n},b:function(n){$a(this.g())||n.be(this.g());$a(this.c())||n.L(n.a().m(this.c()));$a(this.e())||n.H(this.e())}};_cc.cp=function(n){_cc.cp.initializeBase(this,[n])};_cc.cp.a=function(n){return!!n.ExplicitLogonUser&&_cc.bj.a(n)};_cc.cn=function(){this.K=Function.createDelegate(this,this.G);this.c=this.b;this.d=this.a;_cc.cn.initializeBase(this);this.F=new _C(this.K,this.y())};_cc.cn.prototype={F:null,J:null,z:!1,I:null,A:!1,x:null,o:function(n){this.J=n;return n},l:function(n){if(this.x!==n){this.x=n;this.ea("EditorCallContext")}return n},b:function(){return this.z},a:function(n){if(this.z===n)return n;this.z=n;this.ea("IsShown");n&&this.l(new _cmc.p(!1));return n},j:function(){return this.A},m:function(n){if(this.A===n)return n;this.A=n;this.ea("RespondToMasterFromOccurrence");return n},k:function(){return this.I},n:function(n){this.I=n;return n},f:function(){return 450},g:function(){return 370},p:function(){return!0},D:null,L:function(){return this.D},r:function(n){this.D=n;return n},E:null,q:function(){return this.E},e:function(n){this.E=n;return n},v:function(){return!0},G:function(){this.l(new _cmc.g(""));this.a(!1)}};function MessageEditorViewModelFactory(){}MessageEditorViewModelFactory.prototype={a:function(){return new _cc.cW},b:function(){return new MeetingResponseEditorViewModel}};_cc.z=function(){};_cc.z.a=function(n){return!n.a().b().Enabled};_cc.z.b=function(n){var i=new _ff.d;if(n.dK()){var t=n.bh.From.Mailbox;i.c(new _cc.Z(_js.d.a(t.Name)?t.EmailAddress:t.Name,new _cc.q(n.dU(),n.dT())))}return i};_cc.z.c=function(n){var t=new _ff.d;if(n.bh.IsOrganizer&&n.bh.IsMeeting){t.i(_cc.z.d(n.q()).h());t.i(_cc.z.d(n.v()).h())}return t};_cc.z.d=function(n){for(var r=new _ff.d,i=0;i<n.b();i++){var t=n.a(i);t.i()&&r.c(new _cc.Z(_js.d.a(t.bh.Mailbox.Name)?t.bh.Mailbox.EmailAddress:t.bh.Mailbox.Name,new _cc.q(t.f(),t.e())))}return r};_cc.da=function(){};_cc.da.registerInterface("_cc.da");_cc.db=function(){};_cc.db.registerInterface("_cc.db");_cc.bA=function(){};_cc.bA.registerInterface("_cc.bA");var ILocationPanelViewModel=function(){};ILocationPanelViewModel.registerInterface("ILocationPanelViewModel");var ILocationPanelViewModelFactory=function(){};ILocationPanelViewModelFactory.registerInterface("ILocationPanelViewModelFactory");var ILocationWellViewModel=function(){};ILocationWellViewModel.registerInterface("ILocationWellViewModel");var ILocationWellViewModelFactory=function(){};ILocationWellViewModelFactory.registerInterface("ILocationWellViewModelFactory");var IPlacePickerViewModel=function(){};IPlacePickerViewModel.registerInterface("IPlacePickerViewModel");var IPlacePickerViewModelFactory=function(){};IPlacePickerViewModelFactory.registerInterface("IPlacePickerViewModelFactory");var ICalendarSharingPermissionsViewModelFactory=function(){};ICalendarSharingPermissionsViewModelFactory.registerInterface("ICalendarSharingPermissionsViewModelFactory");var ISubscribeCalendarViewModelFactory=function(){};ISubscribeCalendarViewModelFactory.registerInterface("ISubscribeCalendarViewModelFactory");var IBirthdayCalendarFactory=function(){};IBirthdayCalendarFactory.registerInterface("IBirthdayCalendarFactory");var IBookingManagementFactory=function(){};IBookingManagementFactory.registerInterface("IBookingManagementFactory");var IFeedsFactory=function(){};IFeedsFactory.registerInterface("IFeedsFactory");var IHolidaysFactory=function(){};IHolidaysFactory.registerInterface("IHolidaysFactory");var INewBookingCalendarFactory=function(){};INewBookingCalendarFactory.registerInterface("INewBookingCalendarFactory");_cc.dc=function(){};_cc.dc.registerInterface("_cc.dc");_cc.f=function(){};_cc.f.registerInterface("_cc.f");_cc.l=function(n){this.d=n};_cc.l.prototype={d:null,b:1,c:0,a:0,e:function(n){this.c++;this.c===this.b&&n()},f:function(n,t){this.a++;if(this.a<this.b)return!1;t&&t();n&&n();this.d.a(_cc.l.a,new _cc.l.a);this.c=0;this.a=0;return!0}};_cc.l.a=function(){};_cc.n=function(){};_cc.n.d=function(n){_js.c.isInstanceOfType(n)&&_g.iR.isInstanceOfType(n.E())&&(n=n.E());var i="<null>";if(_gg.j.isInstanceOfType(n)){var t=n.e();i=t?t.a().Id:"<null>"}return String.format("\tStart: '{0}', End: '{1}', ItemId: '{2}', Calendar: '{3}', IsModel:{4}",n.a(),n.b(),_cc.n.a(n),i,_gg.nD.isInstanceOfType(n))};_cc.n.a=function(n){var t=n.j();return _cc.n.e(t)};_cc.n.f=function(n,t){if(_cc.n.b){n.val="";t.val="";return}var u=_js.a.Instance;var r=u.a(ICalendars);n.val=r?r.E():"<null>";var i=u.a(_cc.U);t.val=i?i.I():"<null>";_cc.n.b=!0};_cc.n.e=function(n){return!n||!n.Id?"<null>":n.Id};_cc.n.c=function(n){return!n||!n.Id?"<null>":n.Id};_cc.cw=function(n,t,i,r,u,f,e){this.Y=Function.createDelegate(this,this.w);this.Z=Function.createDelegate(this,this.I);this.ba=Function.createDelegate(this,this.bl);this.P=+new Date;this.D=n;this.X=u;this.V=i;this.O=r;this.J=t;this.E=f;this.F=new _a.q;this.G=e};_cc.cw.prototype={V:null,O:null,X:!1,J:null,P:0,F:null,G:null,E:null,L:null,D:null,M:0,H:0,T:!1,N:0,W:0,Q:0,S:0,R:0,U:0,k:function(n){this.L=n;return n},j:function(){return this.O},C:function(n){if(!this.E){_js.Trace.logWarning(this.J,"SetExpectedAnimationCompletedCount was called for a scenario not based on animation.");return}this.E.b=n},z:function(){this.a("A",this.b())},s:function(){this.a("J",this.b())},r:function(){this.a("K",this.b())},q:function(){this.a("B",this.b())},i:function(){this.a("C",this.b())},v:function(n,t,i){if(n){this.a("D",n.getTime()-this.P);this.a("E",this.b());this.a("L",t?1:0);this.a("M",i?1:0)}},f:function(n){this.H&&n&&this.T||(this.H=+new Date);n&&(this.T=!0)},e:function(){this.M=+new Date},x:function(){if(!this.E){_js.Trace.logWarning(this.J,"AddFadeInAnimationStartMarker was called for a scenario not based on animation.");return}this.E.e(this.ba)},w:function(){this.a("I",this.b())},B:function(){if(!this.E){_js.Trace.logWarning(this.J,"MarkAnimationCompleted was called for a scenario not based on animation.");return!1}return this.E.f(this.Z,this.Y)},g:function(){this.a("O",this.b())},d:function(){this.a("P",this.b())},bg:function(){this.a("V",this.b())},bf:function(){this.a("W",this.b())},o:function(){this.a("X",this.b())},be:function(){this.a("Y",this.b())},bd:function(){this.a("Z",this.b())},m:function(){this.a("Q",this.b())},l:function(n){this.a("R",this.b());n&&this.a("S",1)},h:function(){this.a("T",this.b())},p:function(){this.a("U",this.b())},c:function(n,t){this.bb(n,t)},bk:function(n){this.I(n)},K:function(n){this.F.a("SA",n);this.I()},n:function(n,t){t?this.N+=n:this.N=n},y:function(n,t,i,r,u){this.W=n;this.Q=t;this.S=i;this.R=r;this.U=u},u:function(){this.a("N",1)},A:function(){this.a("AD",1)},t:function(){this.a("AC",1)},bj:function(){this.I()},b:function(n){var t=n?n:+new Date;return t-this.P},a:function(n,t){if(this.F.e(n)){this.G&&this.G();return}this.F.a(n,t)},bb:function(n,t){if(this.F.e(n)){this.G&&this.G();return}this.F.c(n,t)},I:function(n){this.bi();var t=this.D?this.D.d():null;if(this.X&&this.D){this.D.k=n;this.D.l=this.L;this.D.j=this.F.toString();_a.d.a(this.D);this.D=null}t&&_a.A.endPT(t)},bl:function(){this.a("H",this.b())},bi:function(){this.bc();this.bh();this.F.b("SCI",this.V)},bh:function(){this.a("AB",this.N);this.a("AA",this.W);this.a("AE",this.Q);this.a("AF",this.S);this.a("AG",this.R);this.a("AH",this.U)},bc:function(){this.H&&this.a("F",this.b(this.H));this.M&&this.a("G",this.b(this.M))}};_cc.bk=function(n){this.F=Function.createDelegate(this,this.J);this.G=Function.createDelegate(this,this.K);this.H=_a.cB.b().a.toString();if(n){this.E=n;this.E.b(_y.bF,this.G);var r=this;this.E.b(_fce.Q,function(n){r.D&&r.D.bg()});var u=this;this.E.b(_fce.P,function(n){u.D&&u.D.bf()});var t=this;this.E.b(_fce.O,function(n){t.D&&t.D.be()});var i=this;this.E.b(_fce.N,function(n){i.D&&i.D.bd()})}};_cc.bk.prototype={E:null,D:null,k:function(n){this.D&&(this.D.L=n);return n},j:function(){return this.D?this.D.O:null},C:function(n){this.D&&this.D.C(n)},n:function(n,t){this.D&&this.D.n(n,t)},y:function(n,t,i,r,u){this.D&&this.D.y(n,t,i,r,u)},z:function(){this.D&&this.D.z()},q:function(){this.D&&this.D.q()},i:function(){this.D&&this.D.i()},v:function(n,t,i){this.D&&this.D.v(n,t,i)},f:function(n){this.D&&this.D.f(n)},e:function(){this.D&&this.D.e()},x:function(){this.D&&this.D.x()},s:function(){this.D&&this.D.s()},r:function(){this.D&&this.D.r()},w:function(){this.D&&this.D.w()},B:function(){if(this.D&&this.D.E&&this.D.B()){this.I(!1,null);this.E.a(_y.dR,new _y.dR)}return!1},g:function(){this.D&&this.D.g()},d:function(){this.D&&this.D.d()},o:function(){this.D&&this.D.o()},m:function(){this.D&&this.D.m()},l:function(n){this.D&&this.D.l(n)},h:function(){this.D&&this.D.h()},p:function(){this.D&&this.D.p()},u:function(){this.D&&this.D.u()},A:function(){this.D&&this.D.A()},t:function(){this.D&&this.D.t()},c:function(n,t){this.D&&this.D.c(n,t)},a:function(n,t,i,r){if(this.D){this.D.K(1);this.D=null}var f=!1;switch(t){case"NavigateToCalendarDay":case"NavigateToCalendarWeek":case"NavigateToCalendarWorkWeek":case"NavigateToCalendarMonth":case"CreateItemByClickNewEventButton":case"CreateItemByClickOrTapOnSurface":f=!0;break;default:break}var u;var e=_a.d.b(n,t,!0,(u=new _a.T,u.b=f,u));this.D=new _cc.cw(e,n,this.H,t,i,r,this.F)},b:function(n){this.I(!0,n)},I:function(n,t){if(this.D){n?t?this.D.bk(t):this.D.bj():!this.D.D||this.D.K(2);this.D=null}},K:function(n){if(n.b.a===1&&n.a.a!==1&&this.D){this.D.K(4);this.D=null}},J:function(){if(this.D){this.D.K(3);this.D=null}}};_cc.PerfTraceCTQCustomKeys=function(){};_cc.PerfTraceCTQCustomKeys.Calendar=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars=function(){};_cc.PerfTraceCTQCustomKeys.Calendar.CalendarFeeds=function(){};_cc.v=function(){};_cc.v.c=function(n){return _cc.b.a()?"UnifiedForms_"+n:n};_cc.v.f=function(n,t){var i="";i=n?"CancelGroupCalendarItem":"CancelCalendarItem";t&&(i="Quick"+i);return _a.d.b(_a.a.b,i)};_cc.v.g=function(n){var t="";t=n?"RemoveGroupCalendarItem":"RemoveCalendarItem";return _a.d.b(_a.a.b,t)};_cc.v.b=function(){};_cc.v.b.d=function(){var n=_a.d.b(_a.a.b,"EditMeetingTimeFromTimeProposal");_a.d.a(n)};_cc.v.b.c=function(n,t,i,r,u,f){var e=new _a.q;t&&e.a("N",1);n&&e.a("K",1);var o=0;if(r.a().q()&&r.a().q().b()>0){o+=r.a().q().b();e.a("RC",r.a().q().b())}if(r.a().v()&&r.a().v().b()>0){o+=r.a().v().b();e.a("OC",r.a().v().b())}o>0&&e.a("TC",o);!$a(r.a().bh.IsAllDayEvent)&&r.a().bh.IsAllDayEvent&&e.a("A",1);r.a().G()&&r.a().G().b()>0&&e.a("R",r.a().G().b());u&&u.e()/6e4!=30&&e.a("DU",u.e()/6e4);r.b()!==15&&e.a("RM",r.b());$a(r.a().k())||r.a().k()==="Busy"||e.b("F",r.a().k());!$a(r.a().cf())&&r.a().cf()&&e.a("P",1);i&&e.b("RP",f.a().a.a.a());!$a(r.a().bh.IsOnlineMeeting)&&r.a().bh.IsOnlineMeeting&&e.a("OM",1);$a(r.a().bh.IsResponseRequested)||r.a().bh.IsResponseRequested||e.a("NR",1);return e.toString()};_cc.v.b.b=function(n,t,i,r,u,f,e,o,s){var h="";h=e?i?r==="Mouse"?u?t?"GroupCalendar_CreateRecurringEventOnPopout":"GroupCalendar_UpdateRecurringEventOnPopout":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":f?t?"GroupCalendar_CreateRecurringEventOnQuickCompose":"GroupCalendar_UpdateRecurringEventOnQuickCompose":t?"GroupCalendar_CreateRecurringEventOnCompose":"GroupCalendar_UpdateRecurringEventOnCompose":r==="Mouse"?u?t?"GroupCalendar_CreateEventOnPopout":"GroupCalendar_UpdateEventOnPopout":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":f?t?"GroupCalendar_CreateEventOnQuickCompose":"GroupCalendar_UpdateEventOnQuickCompose":t?"GroupCalendar_CreateEventOnCompose":"GroupCalendar_UpdateEventOnCompose":n?s?u?t?"SendNonPatternRecurringMeetingOnPopout":"UpdateNonPatternRecurringMeetingOnPopout":t?"SendNonPatternRecurringMeetingOnCompose":"UpdateNonPatternRecurringMeetingOnCompose":i?r==="Mouse"?u?t?"SendRecurringMeetingOnPopout":"UpdateRecurringMeetingOnPopout":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":f?t?"SendRecurringMeetingOnQuickCompose":"UpdateRecurringMeetingOnQuickCompose":t?"SendRecurringMeetingOnCompose":"UpdateRecurringMeetingOnCompose":r==="Mouse"?u?t?"SendMeetingOnPopout":"UpdateMeetingOnPopout":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":f?t?"SendMeetingOnQuickCompose":"UpdateMeetingOnQuickCompose":t?"SendMeetingOnCompose":"UpdateMeetingOnCompose":s?u?t?"SaveNonPatternRecurringAppointmentOnPopout":"UpdateNonPatternRecurringAppointmentOnPopout":t?"SaveNonPatternRecurringAppointmentOnCompose":"UpdateNonPatternRecurringAppointmentOnCompose":i?r==="Mouse"?u?t?"SaveRecurringAppointmentOnPopout":"UpdateRecurringAppointmentOnPopout":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":f?t?"SaveRecurringAppointmentOnQuickCompose":"UpdateRecurringAppointmentOnQuickCompose":t?"SaveRecurringAppointmentOnCompose":"UpdateRecurringAppointmentOnCompose":r==="Mouse"?u?t?"SaveAppointmentOnPopout":"UpdateAppointmentOnPopout":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose":f?t?"SaveAppointmentOnQuickCompose":"UpdateAppointmentOnQuickCompose":t?"SaveAppointmentOnCompose":"UpdateAppointmentOnCompose";o&&(h="UnifiedForms_"+h);return h};_cc.v.b.a=function(n,t,i,r,u){if(n){n.k=t;n.m=i;n.l=r;n.j=u;_a.d.a(n)}};_cc.v.a=function(){};_cc.v.a.e=function(n){var t=n?"OpenSchedulingAssistantFormOnPopout":"OpenSchedulingAssistantForm";_a.l.b(_cc.v.a.b,t);return t};_cc.v.a.c=function(n){var t=n?"ApplySchedulingAssistantChangesOnPopout":"ApplySchedulingAssistantChanges";return _a.d.b(_cc.v.a.b,t)};_cc.v.a.d=function(n){var t=n?"DiscardSchedulingAssistantChangesOnPopout":"DiscardSchedulingAssistantChanges";return _a.d.b(_cc.v.a.b,t)};_cc.v.a.f=function(){return _a.d.b(_cc.v.a.b,"PopoutSchedulingAssistantForm")};_cc.v.a.a=function(n,t,i,r){if(n){n.k=t;n.l=i;n.j=r;_a.d.a(n)}};_cc.v.d=function(){};_cc.v.d.f=function(n){return n?3:0};_cc.v.d.g=function(n){return n?4:1};_cc.v.d.h=function(n){return n?5:2};_cc.v.d.c=function(n,t){var i=_cc.v.d.e(n,t);return i?_a.d.b(_cc.v.d.b,i,!0):null};_cc.v.d.a=function(n,t,i,r,u,f,e){if(n){var o=new _a.q;r?o.a("R",1):o.a("R",0);u?o.a("C",1):o.a("C",0);f?o.a("O",1):o.a("O",0);o.b("S",_cc.v.d.d.toString(e));n.k=t;n.l=i;n.j=o.toString();_a.d.a(n)}};_cc.v.d.e=function(n,t){switch(n){case"Accept":switch(t){case 0:return"AcceptMeetingOnMailReadingPane";case 1:return"AcceptMeetingOnCalendarPeek";case 2:return"AcceptMeetingOnCalendarReadingPane";case 3:return"AcceptMeetingOnCalendarContextMenu"}break;case"Tentative":switch(t){case 0:return"TentativelyAcceptMeetingOnMailReadingPane";case 1:return"TentativelyAcceptMeetingOnCalendarPeek";case 2:return"TentativelyAcceptMeetingOnCalendarReadingPane";case 3:return"TentativelyAcceptMeetingOnCalendarContextMenu"}break;case"Decline":switch(t){case 0:return"DeclineMeetingOnMailReadingPane";case 1:return"DeclineMeetingOnCalendarPeek";case 2:return"DeclineMeetingOnCalendarReadingPane";case 3:return"DeclineMeetingOnCalendarContextMenu"}break}_js.Trace.logError(_cc.v.d.b,"Expected Accept, Tentatively Accept or Decline as valid Meeting Responses. But it is {0}",n);return null};_cc.v.d.d=function(){};_cc.v.d.d.prototype={dontSendResponse:0,editBeforeSendResponse:1,sendResponseDirectly:2,dontSendResponse_MasterFromOccurrence:3,editBeforeSendResponse_MasterFromOccurrence:4,sendResponseDirectly_MasterFromOccurrence:5};_cc.v.d.d.registerEnum("_cc.v.d.d",!1);_cc.v.e=function(){};_cc.v.e.a=function(n){var t=new _a.q;var i=n.b()?n.b().a().y.length:-1;t.a("N",i);t.a("SN",n.i());t.a("D",n.g());_cc.v.e.b(n.h(),t);_cc.v.e.c(n,t);return t.toString()};_cc.v.e.b=function(n,t){var r=n||"";var i=r.match(new RegExp("\\S+","g"));t.a("W",i?i.length:0);t.a("C",r.length)};_cc.v.e.c=function(n,t){var e=-1;if(n.b()&&n.b().a().y.length>0){for(var o=n.b().a(),f=_a.c.W,r=_a.c.m,i,u=0,s=o.y.length;u<s;u++){i=o.y[u];i.a().b(f)<0&&(f=i.a());i.a().b(r)>0&&(r=i.a())}e=Math.floor(r.g(f)/864e5)}t.a("S",e)};_cc.df=function(){};_cc.df.registerInterface("_cc.df");_cc.bY=function(n,t){_cc.bY.initializeBase(this);this.c=new _gg.nW(this.x);this.c.explicitLogonUser=t;this.b=n};_cc.bY.prototype={b:null,c:null,u:function(n){this.d();n.Q(this.b,this.c,this.r,this.q)},cy:function(n,t,i){if(n.WasSuccessful)t();else{_js.Trace.logWarning(_a.a.cY,"AddEventToMyCalendar returned error code: {0}",n.ErrorCode);i(Error.create(String.format("AddEventToMyCalendar returned error: {0}",n.ErrorCode)))}},d:function(){this.b.ItemId=_g.g.a(this.b.ItemId,!1)}};_cc.dd=function(n,t){_cc.dd.initializeBase(this,[t]);this.j=n;this.d=1;this.X=!1};_cc.dd.prototype={j:null,e:null,cz:function(n){this.e=n;return n},bV:function(n){n.Importance=this.e.bx();!$a(this.e.k())&&this.e.k().b()>0&&(n.ToRecipients=_h.p.a(this.e.k()));!$a(this.e.m())&&this.e.m().b()>0&&(n.CcRecipients=_h.p.a(this.e.m()));!$a(this.e.o())&&this.e.o().b()>0&&(n.BccRecipients=_h.p.a(this.e.o()));n.Sensitivity=this.e.bF();n.IsDeliveryReceiptRequested=this.e.bh.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.e.bh.IsReadReceiptRequested}};_cc.de=function(){_cc.de.initializeBase(this,[_h.R.a(originalICalendaringItem),4]);this.g="CreateMeetingResponseAction";this.b=originalICalendaringItem;this.o=responseType;this.d=messageDisposition;this.be=_g.I.isInstanceOfType(originalICalendaringItem);this.bL=originalICalendaringItem.y();this.X=!0;this.bz=proposedNewTime;var t=new(_h.dT.$$(_cc.M))(_g.r.d("calendar"));var i=this;this.c=_h.d.b(t,_h.g.a(),function(n){return new _cc.M(n)});if(this.be){var n=this.b;this.by=n.bh.ConversationId?n.bh.ConversationId.Id:null}};_cc.de.prototype={o:"Unknown",be:!1,bL:"Single",by:null,c:null,bo:null,bp:!1,bW:null,bZ:null,b:null,meetingResponseMessageId:null,bz:null,Z:null,get_meetingResponseMessageId:function(){return this.meetingResponseMessageId},bK:function(){return!$a(this.bz)},h:function(){var n=_h.p.prototype.h.call(this);n.isReferencedItemMeetingRequest=this.be;n.referencedCalendarItemType=this.bL;n.draftsFolderId=_g.b.a.nameToId("drafts");n.outboxFolderId=_g.b.a.nameToId("outbox");n.deletedItemsFolderId=_g.b.a.nameToId("deleteditems");n.calendarFolderId=_g.b.a.nameToId("calendar");n.userDisplayName=_g.a.a().c().bh.UserDisplayName;n.userEmailAddress=_g.a.a().c().bh.UserEmailAddress;return n},l:function(){var t;switch(this.o){case"Tentative":t=new _g.dX;break;case"Accept":t=new _g.dI;break;case"Decline":t=new _g.dM;break;default:return null}$a(this.j)||(t.ReferenceItemId=_g.g.a(this.j));if(this.bK()){t.ProposedStart=_a.c.k(this.bz.c());t.ProposedEnd=_a.c.k(this.bz.f())}var n=new _gg.fl;if(this.b.E()){n.Organizer=new _g.bg;n.Organizer.Mailbox=this.b.E().Mailbox}$a(this.b.c())||(n.Start=_a.c.k(this.b.c()));$a(this.b.f())||(n.End=_a.c.k(this.b.f()));n.Subject=this.b.R();n.IsResponseRequested=this.b.D();var r=this.b.bh.ConversationId;r&&(n.ConversationId=this.b.bh.ConversationId);$a(this.b.F())||(n.Recurrence=_ff.g.a(this.b.F().bh));var i=_g.w.d(this.b.u());if(!i&&this.b.u()){i=new _g.dN;i.DisplayName=this.b.u().bh.DisplayName}n.Location=i;t.AdditionalInfo=n;if(!$a(this.e)){this.bV(t);$a(this.e.C())||(t.Body=new _g.D(this.e.C().a()==="HTML"?"HTML":"Text",this.e.C().bh.Value))}return[t]},k:function(){this.cm();var n=_h.p.prototype.k.call(this);n.Body.GenerateResponseMessageOnFailure=!1;n.Body.GenerateMeetingResponseWithOldLocationIfChanged=!0;n.Body.FailResponseOnImportantUpdate=!0;return n},F:function(){_a.cX.prototype.F.call(this);this.be&&_h.d.l(this.j,this.by);var r=this.cl();if(!r){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because AssociatedCalendarItem was not present.");return}if(!this.c||!this.c.g){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update because query table or range in cache was not present.");return}var n=!1;if(this.bL==="RecurringMaster"){var u=this.b.M();if(!u){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because InstanceKey was not present.");return}if(this.o==="Decline")n=this.c.j(u);else if(this.o==="Accept"||this.o==="Tentative")for(var f=_a.c.a(),t=0;t<this.c.bm.y.length;t++){var i=this.c.bm.y[t];if(i.bh.InstanceKey===u&&i.dK()){this.bN(i,f);n=!0}}}else{this.bo=this.c.bg(_g.i,r);if(!this.bo){_js.Trace.logInfo(_a.a.b,"CalendarItemModel for meeting response not found - ItemId: {0}",r.Id);return}if(this.o==="Accept"||this.o==="Tentative"){this.bN(this.bo);n=!0}else this.o==="Decline"&&(n=this.c.bm.m(this.bo,!0))}this.bp=n},H:function(){_a.cX.prototype.H.call(this);this.bY();if(this.be){_h.d.e(this.j,this.by);return}var n=this.bp;this.bp=!1;n&&this.c.bc()},cp:function(n){this.bY();var i=n.Items;if($a(i)||!i.length)throw Error.invalidOperation("Response Item is expected to be non-null when message is saved to drafts.");for(var f=i,e=f.length,r=0;r<e;++r){var u=f[r];if(!$a(u)){var t=_a.i.b(_g.h,u);if(_g.bs.isInstanceOfType(t))this.meetingResponseMessageId=t.bh.ItemId;else if(_g.i.isInstanceOfType(t)){this.bW=t.bh.ItemId;this.c&&_cc.x.isInstanceOfType(this.c)&&this.c.H()}else _g.I.isInstanceOfType(t)&&(this.bZ=t.bh.ItemId)}}this.d||(this.f=this.meetingResponseMessageId);this.bp=!1;if(this.be){_h.d.e(this.j,this.by);return}},bN:function(n,t){t=t||_a.c.a();n.bK(this.o==="Accept"?"Busy":"Tentative");n.gA(t);n.eK(this.o)},cl:function(){var n;if(this.be){var t=this.b;n=t.bh.AssociatedCalendarItemId;if(!n||!n.Id)return null}else n=this.b.g();return n},cm:function(){this.bK()&&(this.Z=_a.d.b(_a.a.b,"ProposeNewTime"))},bY:function(){if(this.bK()&&this.Z){this.Z.k=this.D();this.Z.m=this.t?this.t.message:null;this.Z.l=this.C();_a.d.a(this.Z);this.Z=null}}};_cc.cx=function(n,t,i){_cc.cx.initializeBase(this,[[_h.R.a(n)],n.cZ()?"SoftDelete":"MoveToDeletedItems",1]);this.m=n.J();this.Q=i;this.l=t;this.n=n;this.r=!0;this.A=n.cZ()?0:2};_cc.cx.prototype={m:!1,Q:null,l:null,n:null,T:function(){var n=_h.bd.prototype.T.call(this);n.isReferencedItemRecurringMaster=this.m;n.explicitLogonUser=this.Q;n.actionName="DeleteCalendarItemAction";return n},F:function(){_h.bd.prototype.F.call(this);var n=this.l;n&&(this.m?n.j(this.n.bh.InstanceKey):n.L(this.n.bh.ItemId))},H:function(){_h.bd.prototype.H.call(this);var n=this.l;n&&(_cc.x.isInstanceOfType(n)?n.H():n.Z())}};_cc.cy=function(n){_cc.cy.initializeBase(this,[n.g(),5]);this.d=1;this.c=n.y();this.X=!0;this.i=n.P();var t=n;this.b=t.bh.ConversationId?t.bh.ConversationId.Id:null;this.g="RemoveItemFromCalendarAction"};_cc.cy.prototype={c:"Single",b:null,h:function(){var n=_h.p.prototype.h.call(this);n.referencedCalendarItemType=this.c;return n},l:function(){var n=new _g.dW;this.j&&(n.ReferenceItemId=_g.g.a(this.j));return[n]},cp:function(n){_h.d.e(this.j,this.b)},F:function(){_a.cX.prototype.F.call(this);_h.d.l(this.j,this.b)},H:function(){_h.d.e(this.j,this.b)}};_cc.cz=function(n,t,i,r,u,f){_cc.cz.initializeBase(this);this.g=n;this.k=_h.R.a(this.g);this.b=t;this.o=r||"";this.p=i===1;this.h=_g.I.isInstanceOfType(n);this.A=n.y();this.i=u;f&&_g.i.isInstanceOfType(this.g)&&(this.d=f.b(this.g.e()));if(this.h){var e=this.g;this.n=e.bh.ConversationId?e.bh.ConversationId.Id:null}};_cc.cz.prototype={p:!1,b:"Unknown",h:!1,A:"Single",n:null,d:null,g:null,k:null,i:null,r:null,o:null,j:null,l:null,q:!1,c:function(){return!0},m:function(){return!$a(this.i)},u:function(n){this.Y();this.h?this.X(n):this.U(n)},F:function(){_a.cX.prototype.F.call(this);this.h&&_h.d.l(this.k,this.n);var r=this.T();if(!r){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because AssociatedCalendarItem was not present.");return}if(!this.d||!this.d.g){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update because query table or range in cache was not present.");return}var n=!1;if(this.A==="RecurringMaster"){var u=this.g.M();if(!u){_js.Trace.logInfo(_a.a.b,"Unable to provide instant surface update on submission of meeting response because InstanceKey was not present.");return}if(this.b==="Decline")n=this.d.j(u);else if(this.b==="Accept"||this.b==="Tentative")for(var f=_a.c.a(),t=0;t<this.d.bm.y.length;t++){var i=this.d.bm.y[t];if(i.bh.InstanceKey===u&&i.dK()){this.Q(i,f);n=!0}}}else{this.l=this.d.bg(_g.i,r);if(!this.l){_js.Trace.logInfo(_a.a.b,"CalendarItemModel for meeting response not found - ItemId: {0}",r.Id);return}if(this.b==="Accept"||this.b==="Tentative"){this.Q(this.l);n=!0}else this.b==="Decline"&&(n=this.d.bm.m(this.l,!0))}this.q=n},H:function(){_a.cX.prototype.H.call(this);this.R();if(this.h){_h.d.e(this.k,this.n);return}var n=this.q;this.q=!1;n&&this.d.bc()},Q:function(n,t){t=t||_a.c.a();n.bK(this.b==="Accept"?"Busy":"Tentative");n.gA(t);n.eK(this.b)},T:function(){var n;if(this.h){var t=this.g;n=t.bh.AssociatedCalendarItemId;if(!n||!n.Id)return null}else n=this.g.g();return n},Y:function(){this.m()&&(this.j=_a.d.b(_a.a.b,"ProposeNewTime"))},R:function(){if(this.m()){this.j.k=this.D();this.j.m=this.t?this.t.message:null;this.j.l=this.C();_a.d.a(this.j);this.j=null}},U:function(n){var i=new _gg.BH(this.x);i.shouldPrecedeOfflineSyncActions=!0;i.explicitLogonUser=this.r;var t=new _gg.fJ;t.CalendarId=new _g.Q(_g.r.a(this.g.P()));t.EventId=_g.g.a(this.k);t.Response=this.b;t.Notes=new _g.D("HTML",this.o);t.SendResponse=this.p;if(this.m()){t.ProposedStartTime=this.i.c().j();t.ProposedEndTime=this.i.f().j()}var r=new _gg.kO(this.y());r.Body=t;n.H(r,i,this.f,this.e)},X:function(n){var i=new _gg.BK(this.x);i.shouldPrecedeOfflineSyncActions=!0;i.explicitLogonUser=this.r;var t=new _gg.fK;t.MeetingMessageId=_g.g.a(this.k);t.Response=this.b;t.Notes=new _g.D("HTML",this.o);t.SendResponse=this.p;if(this.m()){t.ProposedStartTime=this.i.c().j();t.ProposedEndTime=this.i.f().j()}var r=new _gg.kP(this.y());r.Body=t;n.I(r,i,this.f,this.e)}};_cc.bZ=function(n,t){_cc.bZ.initializeBase(this,[n,[t.bh.ItemId],null,"None",0,!1]);this.b=t;this.d=_cc.bZ.a(this.b)};_cc.bZ.a=function(n){var t;t=n.J()?9:6;var r=new _g.bE("IdOnly");var i=[];t&1&&Array.add(i,new _g.e("ConflictingMeetingCount"));t&2&&Array.add(i,new _g.e("ConflictingMeetings"));t&4&&Array.add(i,new _g.e("AdjacentMeetings"));t&8&&Array.add(i,new _g.e("AdjacentMeetingCount"));r.AdditionalProperties=i;return r};_cc.bZ.prototype={b:null,cp:function(n){var t=_g.h.b(n.Items[0]);this.b.fb(t.bh.ConflictingMeetingCount);this.b.eZ(t.bh.AdjacentMeetingCount);this.b.fc(t.bh.ConflictingMeetings);this.b.fa(t.bh.AdjacentMeetings)}};_cc.bz=function(n,t,i){_cc.bz.resolveInheritance();this.c=this.cz;this.b=this.cA;_cc.bz.initializeBase(this,[n,0]);this.d=t;this.g="CancelCalendarItemAction";this.o=i};_cc.bz.prototype={o:null,Z:null,be:null,h:function(){var n=_h.p.prototype.h.call(this);n.explicitLogonUser=this.o;return n},l:function(){var n=new _g.fa;n.ReferenceItemId=_g.g.a(this.j);if(!$a(this.e)){this.bV(n);$a(this.e.C())||(n.NewBodyContent=new _g.D(this.e.C().a()==="HTML"?"HTML":"Text",this.e.C().bh.Value))}return[n]},cp:function(n){var i=n.Items;if($a(i)||!i.length)throw Error.invalidOperation("Response Item is expected to be non-null when message is saved to drafts.");for(var f=i,e=f.length,r=0;r<e;++r){var u=f[r];if(!$a(u)){var t=_a.i.b(_g.h,u);_g.Y.isInstanceOfType(t)?this.be=t.bh.ItemId:_g.i.isInstanceOfType(t)&&(this.Z=t.bh.ItemId)}}}};_cc.cs=function(){};_cc.cs.prototype={a:function(n,t,i){return new _cc.bz(n,t,i)}};_cc.ct=function(){};_cc.ct.prototype={b:function(n,t){return new _cc.O(n,t)},a:function(n,t){return _cc.O.a(n,t)}};_cc.bR=function(n){this.g=n};_cc.bR.a=function(n,t){t.bV&&t.Z()};_cc.bR.prototype={g:null,b:null,a:function(){var n=new _g.bc;n.NotificationType="CalendarItemNotification";n.FolderId=this.g;return n},d:function(){return _a.a.da},e:function(){return"AgendaNotificationStrategy"},c:function(){return 1},f:function(n,t){this.b||(this.b=this.h(n,t))},h:function(n,t){var i=this;return _js.g.a().a(t.bo(),"AgendaNotificationStrategy",function(){_cc.bR.a(n,t);i.b=null},1500)}};_cc.bS=function(n,t){_cc.bS.initializeBase(this,[n,new _cc.bT(n.b().Id,t)])};_cc.bS.prototype={k:null,v:function(n,t,i,r){_cc.bC.prototype.v.call(this,n,t,i,r);n.h(this.k.bh.OwnerEmailAddress)}};_cc.cQ=function(n){_cc.cQ.initializeBase(this,[n])};_cc.cQ.prototype={o:function(n,t){t.bV&&t.d().Id===n.FolderId&&t.bc()}};_cc.cP=function(n){this.h={};this.g=new _ff.d;this.l={};this.j=new _g.bc;this.j.NotificationType="CalendarItemNotification";this.j.FolderId=n};_cc.cP.prototype={j:null,m:!0,i:null,a:function(){return this.j},d:function(){return _a.a.bI},e:function(){return"CalendarNotificationStrategy"},c:function(){return 1},A:function(){this.k();this.m=!1},z:function(n){this.m=!0;this.n(n)},f:function(n,t){var i=n;var u=n;if(u.clientGenerated)this.o(i,t);else{this.s(i,t);if(this.m){this.i&&this.k();var r=this;this.i=_js.g.a().a(_a.a.bI,"CalendarNotificationStrategy",function(){r.n(t)},1500)}}},o:function(n,t){if(t.bV&&t.d().Id===n.FolderId){n.Item&&!n.Item.__type&&(n.Item.__type="CalendarItem:#Exchange");this.r(n)?t.Z():n.EventType==="RowDeleted"?this.u(t,n):n.Item.CalendarItemType==="RecurringMaster"?this.t(t,n):this.v(t,n)}},s:function(n,t){if(this.r(n)){this.g.f();this.g.c(n);this.k();this.n(t)}else{for(var r=this.g.d.length-1;r>=0;r--){var e=this.g.d[r].Item;var f;var u;if(n.Item.InstanceKey){u=n.Item.InstanceKey;f=e.InstanceKey}else{u=n.Item.ItemId.Id;f=e.ItemId.Id}if(u===f){this.g.j(r);break}}var s=!1;if(n.Item.InstanceKey)if(n.EventType==="RowModified"&&n.Item.CalendarItemType==="RecurringMaster")n.Item.UID&&(this.l[n.Item.InstanceKey]=n.Item.UID);else if(n.EventType==="RowDeleted"){var o=this.l[n.Item.InstanceKey];delete this.l[n.Item.InstanceKey];if(o)for(var i=this.g.d.length-1;i>=0;i--){var h=this.g.d[i].Item.UID;if(this.g.d[i].EventType==="RowAdded"&&h===o){this.g.d[i].a=n.Item.InstanceKey;s=!0;break}}}s||this.g.c(n)}},k:function(){this.i=_js.g.a().b(this.i)},r:function(n){return n.EventType==="Reload"||n.Reload},n:function(n){for(var r=this.g.d.length,t=0;t<r;t++){var i=this.g.d[t];this.o(i,n)}this.g.f();this.k()},u:function(n,t){var i=n.bu(t.Item);var o=String.format("Will handle a RowDeleted notification for instance key {0}",i.bh.InstanceKey);i.bh.InstanceKey in this.h&&delete this.h[i.bh.InstanceKey];if(i.bh.ItemId&&i.bh.ItemId.Id)if(i.y()!=="RecurringMaster"){var e=n.L(i.bh.ItemId);e!==-1}else i.bh.InstanceKey?n.j(i.bh.InstanceKey,null):n.Z();else for(var r=n.bm.y.length-1;r>=0;r--){var u=n.bm.y[r];var f=u.bh.InstanceKey;if(!f){n.Z();return}if(f===i.bh.InstanceKey){n.bm.o(r);if(!$a(u.y())&&u.y()==="Single")return}}},t:function(n,t){var r=t.Item;if(n.g)if(r.UID){var o=new _g.g(r.ItemId.Id);var u=new _h.R(o);u.a=n.g;var i=new _cc.J(300,u,r.InstanceKey,null);var s=this;i.w(function(i){s.y(i,n,t.a)});var f=this;i.v(function(i){f.x(i,n,t.a)});var e=this;i.z(function(n){e.w(n)});r.InstanceKey in this.h;this.h[r.InstanceKey]=i;OwaApplication.a.a(i)}else n.Z()},p:function(n){return n.d in this.h&&this.h[n.d]===n},w:function(n){this.p(n)&&delete this.h[n.d]},y:function(n,t,i){if(this.p(n)&&t.bm){var e=n.c();if(!e.a.g(t.g)){t.Z();return}i;t.j(n.d,i);var f=0;if(n.b())for(var r=0;r<n.b().y.length;r++){var u=n.b().y[r];f=t.Q(u);if(f===-1){_js.Trace.logWarning(_a.a.bI,"Couldn't find index to insert instance of series. Id={0}. UID={1}. Reloading",u.bh.ItemId.Id,u.bh.UID);t.Z();break}}}},x:function(n,t,i){if(this.p(n)){var r=n.t.responseCode;if(r==="ErrorItemNotFound"){_js.Trace.logWarning(_a.a.bI,"Action [{0}] to expand recurring series failed with item not found. Since the item isn't on the server, we will remove the series. Error: {1}",n.L,n.t);i;t.j(n.d,i)}else{_js.Trace.logWarning(_a.a.bI,"Action [{0}] to expand recurring series failed. Will reload the table. Error: {1}",n.L,n.t);t.Z()}}},v:function(n,t){var i=n.bu(t.Item);i.a()||_js.Trace.logError(_a.a.bI,"Start value should not be null for a calendar notification item. CalendarItemNotification.id={0}, Subject={1}",t.id,i.bh.Subject);switch(t.EventType){case"RowAdded":n.q(i,0,!1);break;case"RowDeleted":_js.Trace.logError(_a.a.bI,"RowDeleted notifications should have been handled by the HandleRowDeletedNotification method.");break;case"RowModified":var r=!t.Item.InstanceKey||i.bA()?0:1;n.q(i,r,!1);break;default:_js.Trace.logWarning(_a.a.bI,"Unsupported notification type");break}}};_cc.bT=function(n,t){_cc.bT.initializeBase(this,[n]);this.q=t};_cc.bT.prototype={q:null,b:function(){return this.q}};_cc.cA=function(){var n=_g.r.d("calendar");this.b=new(_h.dT.$$(_cc.M))(n)};_cc.cA.prototype={b:null,a:function(n,t){var r=this;var i=_h.d.b(this.b,_h.g.a(),function(n){return new _cc.M(n)});i.bj||i.J(n,t)}};_cc.dk=function(){};_cc.dk.registerInterface("_cc.dk");_cc.bp=function(n){this.r=n.R();this.p=new _cc.q(n.c(),n.f(),n.n());this.m=n.q()||new(_a.fK.$$(_g.t,_g.O));this.l=n.v()||new(_a.fK.$$(_g.t,_g.O));this.n=n.G()||new(_a.fK.$$(_g.t,_g.O))};_cc.bp.prototype={p:null,r:null,m:null,l:null,n:null,o:null,q:null,s:null,d:function(){return this.r},a:function(){return this.p},f:function(){return this.m},e:function(){return this.l},g:function(){return this.n},b:function(){return this.o},j:function(n){this.o=n;return n},h:function(){return this.q},k:function(n){this.q=n;return n},c:function(){return this.s},i:function(n){this.s=n;return n},t:function(n){for(var t=this.m.b()+this.l.b()+this.n.b();t>n;){if(this.l.b())this.l.k(0);else if(this.n.b())this.n.k(0);else if(this.m.b())this.m.k(0);else break;t--}}};_cc.q=function(n,t,i){_cc.q.initializeBase(this);this.be(n);this.L(t);this.H(i)};_cc.q.$$cctor=function(){_a.i.d(_cc.q,Object,function(n){var t=new _cc.q;t.dW(n);return t})};_cc.q.prototype={c:function(){return this.ec(_cc.q.c)},be:function(n){this.eb(_cc.q.c,n);return n},f:function(){return this.ec(_cc.q.a)},L:function(n){this.eb(_cc.q.a,n);return n},n:function(){return this.ec(_cc.q.b)},H:function(n){this.eb(_cc.q.b,n);return n}};_cc.Z=function(n,t){_cc.Z.initializeBase(this);this.b=n;this.a=t};_cc.Z.prototype={b:null,a:null};_cc.ci=function(){};_cc.ci.registerInterface("_cc.ci");var ICalendarPickerGroupNodeViewModel=function(){};ICalendarPickerGroupNodeViewModel.registerInterface("ICalendarPickerGroupNodeViewModel");var ICalendarPickerModernGroupsProvider=function(){};ICalendarPickerModernGroupsProvider.registerInterface("ICalendarPickerModernGroupsProvider");var ICalendarPickerModernGroupsViewModel=function(){};ICalendarPickerModernGroupsViewModel.registerInterface("ICalendarPickerModernGroupsViewModel");_cc.cj=function(){};_cc.cj.registerInterface("_cc.cj");var ICalendarPickerViewModel=function(){};ICalendarPickerViewModel.registerInterface("ICalendarPickerViewModel");_cc.ck=function(n,t,i){_cc.ck.initializeBase(this,[_u.c.BB,null,n,t,i]);this.W(!1);this.o=!1;this.Q("CalendarCharmPickerTemplates.CharmGridMenuItemTemplate")};_cc.W=function(n){this.c=Function.createDelegate(this,this.e);_cc.W.initializeBase(this);_a.b.b(n,"Need calendar item model for calendar item we are managing the charm for.");this.a=n;this.d()};_cc.W.prototype={a:null,b:null,d:function(){for(var t=new Array(0),i=new _cc.Y,n=0;n<_cc.W.a.length;n++)t[n]=new _cc.N(n.toString(),i.a(_cc.W.a[n],null),_cc.W.a[n],"CalendarCharmPickerTemplates.CharmMenuItemTemplate");if(this.a.fF()!=="None"){t[0].b="CalendarCharmPickerTemplates.UseCalendarCharmMenuItemTemplate";t[0].e=i.a(this.a.fF(),null)}else t[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate";this.b=new _cc.ck(this.c,t,t[Array.indexOf(_cc.W.a,this.a.cb())])},e:function(n){var t=_a.d.b(_a.a.i,"SetCalendarItemCharm");this.a.ff(n);_a.d.a(t)}};_cc.V=function(n,t,i){this.i=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.p);this.k=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.n);_cc.V.initializeBase(this);_a.b.b(n,"Need calendar model for calendar we are managing the charm for.");_a.b.b(i,"Error message handler must be specified.");this.b=n;this.f=t;this.e=this.m();this.d=i};_cc.V.prototype={b:null,f:!1,e:null,d:null,g:null,c:!1,a:null,l:function(n){if(this.c!==n){this.c=n;this.ea("IsActionPending")}return n},m:function(){for(var t=new Array(_cc.V.a.length),i=new _cc.Y,n=0;n<_cc.V.a.length;n++)t[n]=new _cc.N(n.toString(),i.a(_cc.V.a[n],null),_cc.V.a[n],"CalendarCharmPickerTemplates.CharmMenuItemTemplate");t[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate";this.g=new _cc.ck(this.h,t,t[Array.indexOf(_cc.V.a,this.b.y())]);return t},n:function(n){if(!this.c){var i=n;this.a=_a.d.b(_a.a.b,"SetCalendarCharm");var t=new _cc.cN(this.b,i);t.w(this.k);t.v(this.j);t.z(this.i);this.l(!0);OwaApplication.a.a(t)}},p:function(n){var t=n;this.e[Array.indexOf(_cc.V.a,this.b.y())].g();if(this.a){this.a.k=t.D();this.a.m=t.t?t.t.message:null;this.a.l=t.C();_a.d.a(this.a);this.a=null}this.d(t.t.message)},q:function(n){var t;if(this.f){var r=new(_h.dT.$$(_cc.bm))(this.b.bh.FolderId);var f=this;t=_h.d.b(r,_h.g.a(),function(n){return new _cc.bm(n)})}else{var i=new(_h.dT.$$(_cc.M))(this.b.bh.FolderId);var u=this;t=_h.d.b(i,_h.g.a(),function(n){return new _cc.M(n)})}t&&t.bV&&t.bc()},o:function(n){this.l(!1);if(this.a){this.a.l=n.C();_a.d.a(this.a);this.a=null}}};var IComposeNonPatternOccurrenceViewModelFactory=function(){};IComposeNonPatternOccurrenceViewModelFactory.registerInterface("IComposeNonPatternOccurrenceViewModelFactory");_cc.dp=function(){};_cc.dp.registerInterface("_cc.dp");var IComposeNonPatternRecurrenceViewModelFactory=function(){};IComposeNonPatternRecurrenceViewModelFactory.registerInterface("IComposeNonPatternRecurrenceViewModelFactory");var IScheduleFollowupViewModelFactory=function(){};IScheduleFollowupViewModelFactory.registerInterface("IScheduleFollowupViewModelFactory");_cc.dn=function(){};_cc.dn.registerInterface("_cc.dn");_cc.dq=function(){};_cc.dq.registerInterface("_cc.dq");_cc.cU=function(n,t,i,r){this.g=Function.createDelegate(this,this.j);_cc.cU.initializeBase(this);this.d=n;this.b=r;this.c=t;this.e=i;this.f=new _C(this.g,_a.a.cx)};_cc.cU.prototype={d:null,b:null,f:null,c:null,e:null,a:null,j:function(){this.a=_a.d.b(_a.a.cx,"ScheduleFollowup",!1);this.a.j=String.format("FollowupSource:{0}",this.b.bh.IsRecurring?"Recurring":"Single");var n=new _cc.cM(this.b);var r=this;n.v(function(n){_js.Trace.logWarning(_a.a.cx,"Error occurred in ScheduleFollowup.");_cc.h.a(n)});var i=this;n.w(function(n){i.h(n)});var t=this;n.z(function(n){_a.d.a(t.a);t.a=null});this.c.a(n)},i:function(n){var t=new _cc.by;t.d(n);var i=this;this.d.a(function(n){var r=n.b(t.a,null,null);i.e.d(r)})},h:function(n){var t=n;this.i(t.c)}};function ScheduleFollowupViewModelFactory(n,t,i){this.c=n;this.b=t;this.d=i}ScheduleFollowupViewModelFactory.prototype={c:null,b:null,d:null,a:function(n){return new _cc.cU(this.c,this.b,this.d,n)}};_cc.cl=function(){};_cc.cl.prototype={a:function(n,t){switch(n){case 0:return _u.c.Cu;case 1:return _u.c.r;case 3:return _u.c.CE;case 2:return _u.c.P;case 4:return _u.c.O;case 5:return _u.c.DG;default:return""}},b:function(n,t){throw Error.notImplemented();}};_cc.Y=function(){};_cc.Y.$$cctor=function(){_cc.Y.a=new _cc.Y};_cc.Y.prototype={a:function(n,t){var i=t||!1;switch(n){case"Cat":return i?_cc.c.m():_cc.c.l();case"Dog":return i?_cc.c.w():_cc.c.v();case"Plane":return i?_cc.c.S():_cc.c.R();case"Document1":return i?_cc.c.u():_cc.c.t();case"FirstAid":return i?_cc.c.y():_cc.c.x();case"Trophy":return i?_cc.c.bc():_cc.c.bb();case"Home":return i?_cc.c.G():_cc.c.F();case"Pill":return i?_cc.c.Q():_cc.c.P();case"Luggage":return i?_cc.c.I():_cc.c.H();case"Cup":return i?_cc.c.q():_cc.c.p();case"Group":return i?_cc.c.C():_cc.c.B();case"Timer":return i?_cc.c.ba():_cc.c.Z();case"Music":return i?_cc.c.M():_cc.c.L();case"Shopping":return i?_cc.c.U():_cc.c.T();case"Car":return i?_cc.c.k():_cc.c.j();case"Star":return i?_cc.c.Y():_cc.c.X();case"Document2":return i?_cc.c.s():_cc.c.r();case"Person":return i?_cc.c.O():_cc.c.N();case"Balloon":return i?_cc.c.e():_cc.c.d();case"ForkKnife":return i?_cc.c.A():_cc.c.z();case"Heart":return i?_cc.c.E():_cc.c.D();case"Soccer":return i?_cc.c.W():_cc.c.V();case"Movie":return i?_cc.c.K():_cc.c.J();case"Chart":return i?_cc.c.o():_cc.c.n();case"Books":return i?_cc.c.g():_cc.c.f();case"Cake":return i?_cc.c.i():_cc.c.h()}return null},b:function(n,t){throw Error.notImplemented();}};_cc.bc=function(){};_cc.bc.a=function(n,t){switch(_cc.bc.b(n)){case"RecurringMaster":switch(t){case 1:return _u.c.By;case 3:return _u.c.DE;default:return _u.c.DP}case"Occurrence":case"Exception":switch(t){case 1:return _u.c.Z;case 3:return _u.c.Bu;default:return _u.c.Ci}default:switch(t){case 1:return _u.c.N;case 3:return _u.c.Cj;default:return _u.c.BF}}};_cc.bc.b=function(n){if(_g.i.isInstanceOfType(n)){var t=n;return t.bh.IsSeriesCancelled?"RecurringMaster":t.y()}else return n.y()};_cc.bc.prototype={a:function(n,t){if(!n)return"";var r=n;var i=$a(t)?2:t;return _cc.bc.a(r,i)},b:function(n,t){throw Error.notImplemented();}};_cc.bs=function(){};_cc.bs.prototype={a:function(n,t){if(!n)return"";if(!_g.dC.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.dC,"Value must be an ICalendarTimeBlock");var i=n;return i.n()?_cc.Q.b(i.c(),i.f()):_cc.Q.a(i.c(),i.f())},b:function(n,t){throw Error.notImplemented();}};_cc.bt=function(){};_cc.bt.prototype={c:null,d:function(){this.c||(this.c=new _cc.cV);return this.c},a:function(n,t){if(!n)return"";if(!_g.ICalendarTimePeriod.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_g.ICalendarTimePeriod,"Value must be an ICalendarTimePeriod");var i=n;return i.cB()?this.d().a(_cc.X.a(i.dX(),i.bU(),i.bT()),t):_g.dC.isInstanceOfType(n)&&n.n()?_cc.Q.b(i.bU(),i.bT()):_cc.Q.a(i.bU(),i.bT())},b:function(n,t){throw Error.notImplemented();}};_cc.bd=function(){};_cc.bd.prototype={a:function(n,t){var i=_js.y.a(Number,n);if(i===-1)return _u.c.BX;var r=i*60;return _a.c.O(r,!1)},b:function(n,t){throw Error.notImplemented();}};_cc.cm=function(){};_cc.cm.prototype={a:function(n,t){if($a(n))return"calendarFree";var i=n;switch(i){case"NoData":case"Free":return"calendarFree";case"Busy":return"calendarBusy";case"Tentative":return"calendarTentative";case"WorkingElsewhere":return"calendarOutside";case"OOF":return!$a(t)&&t?"calendarAwayEmphasis":"calendarAway";default:return"calendarFree"}},b:function(n,t){throw Error.notImplemented();}};_cc.bi=function(){};_cc.bi.prototype={a:function(n,t){var i=n;switch(i){case"Free":return _u.c.G;case"Busy":return _u.c.Y;case"Tentative":return _u.c.DS;case"WorkingElsewhere":return _u.c.m;case"OOF":return _u.c.CS;case"NoData":return _u.c.l;default:return""}},b:function(n,t){throw Error.notImplemented();}};_cc.Q=function(){};_cc.Q.a=function(n,t){var r="";if(!n||!t)return r;var i=_cc.b.m()?18:0;r=n.f().w(t.f())?String.format(_cc.b.m()?_u.c.I:_u.c.BL,n.a(5),n.a(i),t.a(i)):String.format(_u.c.Cq,n.a(5),n.a(i),t.a(5),t.a(i));return r};_cc.Q.b=function(n,t){if(!n||!t)return"";var r=t.g(n);if(r<=864e5)return String.format(_u.c.W,n.a(5));var i=t.c(-1).a(5);return String.format(_u.c.CC,n.a(5),i)};_cc.Q.c=function(n,t,i,r){if(!n.k(t))return String.format(_u.c.Cr,n.a(3),n.a(0),t.a(0));if(i&&r&&t.b(n)===864e5)return n.a(3);if(i&&r){var u=t.m(-1).a(3);return String.format(_u.c.Bj,n.a(3),u)}return String.format(_u.c.b,n.a(3),n.a(0),t.a(3),t.a(0))};_cc.cV=function(){};_cc.cV.prototype={a:function(n,t){var r=n;var i="";r&&(i=r.o());return i},b:function(n,t){throw Error.notImplemented();}};_cc.cT=function(n,t,i,r){this.g=n;this.f=t;this.d=i;this.e=r};_cc.cT.prototype={g:!1,f:!1,d:null,e:null,c:function(){return this.f},a:function(){return this.d},b:function(){return this.e}};_cc.cu=function(){};_cc.cu.prototype={a:function(){return new _cc.bt}};_cc.be=function(){};_cc.be.registerInterface("_cc.be");var ICalendarItemPeekViewModelFactory=function(){};ICalendarItemPeekViewModelFactory.registerInterface("ICalendarItemPeekViewModelFactory");_cc.K=function(n,t,i,r,u,f){this.f=Function.createDelegate(this,this.i);_cc.K.initializeBase(this);this.a=n;this.c=t;this.e=f;if(this.d()){var e=_pc.a.f(n);this.b=_cc.K.a(e,i,r);if(u&&this.a.a().a()==="Resource"){_js.Trace.logInfo(_a.a.y,"Creating ReadCard for LocationViewModel.");this.b.bp(this.f)}}};_cc.K.a=function(n,t,i,r,u,f){if(!n.fR())throw Error.invalidOperation("Cannot create persona view model for a persona that does not have a valid location identifier");var e=t.b(n,4,!1,2,!1,null,!1);var s=i.a()!=="Mouse";switch(r){case 0:e.g(!0);e.G(!0);e.b(!1);e.v(!1);break;case 1:e.g(!0);e.G(!0);e.b(!1);e.v(!s);break;case 2:default:e.g(!0);e.G(!0);e.b(!0);e.v(!s);break}if(u&&u.length>0){for(var h=new Array(u.length),o=0;o<u.length;o++)h[o]=u[o].e();_cc.K.c(e,h,f)}e.bz(0,_cc.K.b,null,2);return e};_cc.K.c=function(n,t,i){var r=[];Array.addRange(r,t);n.n()&&i&&Array.addRange(r,n.n());n.Q(r)};_cc.K.prototype={e:!1,c:null,b:null,a:null,g:function(n){this.ef("OnLocationUpdated",n)},d:function(){return!this.e&&!!this.a&&this.a.k()&&(this.a.e()||this.a.a().a()==="Resource")},h:function(){return this.a===this.c},i:function(n){var t=n;if(t.y()){this.a.a().t(t.y().bh.Latitude);this.a.a().u(t.y().bh.Longitude);this.a.a().D(t.y().bh.Altitude);this.eh("OnLocationUpdated")}}};_cc.bu=function(){};_cc.bu.a=function(n){var t=new _js.f;t.a(-1);t.a(0);t.a(5);t.a(10);t.a(15);t.a(30);t.a(60);t.a(120);t.a(180);t.a(240);t.a(480);t.a(720);t.a(1440);t.a(2880);t.a(4320);t.a(10080);t.a(20160);if(n>t.y[t.y.length-1])t.a(n);else for(var i=0;i<t.y.length;i++){if(n===t.y[i])break;if(n<t.y[i]){t.u(i,n);break}}return t};var IProposeNewTimeManager=function(){};IProposeNewTimeManager.registerInterface("IProposeNewTimeManager");_cc.cX=function(n,t){_cc.cX.initializeBase(this);this.h=n;this.c=t};_cc.cX.prototype={h:null,c:null,e:null,a:function(n){_js.g.a().i(_a.a.a,_y.n.toString(n.a()));this.b=!1;if(this.c.c()){n.l()===1&&n.o(0);this.c.g(IMailComposeViewModelFactory,null,null,_bc.c.a(),n,!0)}else if(this.e){var i=this.e.a(n,null,null);this.c.f(i,1,!0)}else{var t=this;this.h.a(function(i){t.e=i;var r=t.e.a(n,null,null);t.c.f(r,1,!0)})}}};_cc.bv=function(n,t){this.d=Function.createDelegate(this,this.a);this.b=n;this.c=t};_cc.bv.prototype={b:null,c:null,a:function(n,t){return n&&t===1?n:new _cc.cX(this.b,this.c)}};function MeetingResponseEditorViewModel(){MeetingResponseEditorViewModel.resolveInheritance();this.c=this.b;this.d=this.a;MeetingResponseEditorViewModel.initializeBase(this)}MeetingResponseEditorViewModel.prototype={t:"Unknown",C:null,w:null,y:function(){return _a.a.cv},h:function(){return this.t},i:function(n){if(this.t===n)return n;this.t=n;this.ee("ResponseType","LabelText");return n},L:function(){return this.C},r:function(n){this.C=n;return n},q:function(){return this.w},e:function(n){if(this.w===n)return n;this.w=n;this.el("ProposedNewTime","HideTimeProposal","LabelText");return n},H:function(){var n;switch(this.t){case"Accept":n=this.v()?_u.W.BV:_u.W.k;break;case"Tentative":n=this.v()?_u.W.p:_u.W.D;break;case"Decline":n=this.v()?_u.W.W:_u.W.f;break;default:_js.Trace.logError(this.y(),"BUGBUG: You shouldn't see this.  ResponseType: "+this.t);n="";break}return n},v:function(){return!this.q()},G:function(){this.e(null);_cc.cn.prototype.G.call(this)}};_cc.g=function(n,t,i,r,u,f,e,o,s,h,c){this.Z=Function.createDelegate(this,this.cR);this.X=Function.createDelegate(this,this.cq);this.A=Function.createDelegate(this,this.cQ);this.Y=Function.createDelegate(this,this.cJ);this.bC=Function.createDelegate(this,this.cj);this.bS=Function.createDelegate(this,this.cU);this.bx=Function.createDelegate(this,this.cb);this.bR=Function.createDelegate(this,this.cz);this.bA=Function.createDelegate(this,this.cf);this.bB=Function.createDelegate(this,this.ci);this.bT=Function.createDelegate(this,this.cV);this.bw=Function.createDelegate(this,this.ca);this.bE=Function.createDelegate(this,this.cl);this.bO=Function.createDelegate(this,this.cw);this.bV=Function.createDelegate(this,this.cX);this.bQ=Function.createDelegate(this,this.cy);this.bz=Function.createDelegate(this,this.cd);this.bM=Function.createDelegate(this,this.cu);this.bI=Function.createDelegate(this,this.cp);this.bK=Function.createDelegate(this,this.cs);this.bG=Function.createDelegate(this,this.cn);this.bD=Function.createDelegate(this,this.ck);this.bN=Function.createDelegate(this,this.cv);this.bU=Function.createDelegate(this,this.cW);this.bP=Function.createDelegate(this,this.cx);this.by=Function.createDelegate(this,this.cc);this.bL=Function.createDelegate(this,this.ct);this.bH=Function.createDelegate(this,this.co);this.bJ=Function.createDelegate(this,this.cr);this.bF=Function.createDelegate(this,this.cm);_cc.g.initializeBase(this);_a.b.a(n,"item");this.a=n;this.c=t;this.t=i;this.U=r;this.be=u;this.bv=f;this.F=e;this.bq=o;this.bn=s;this.bd=c;this.k=0;this.p=!0;var tt=this;this.n=new _C(this.bF,_cc.g.a,this,"CanAccept",function(){return tt.h()});var it=this;this.o=new _C(this.bJ,_cc.g.a,this,"CanTentativelyAccept",function(){return it.i()});var g=this;this.d=new _C(this.bH,_cc.g.a,this,"CanDecline",function(){return g.g()});if(this.j()){var nt=this;this.P=new _C(this.bL,_cc.g.a,this,"CanAccept",function(){return nt.h()});var rt=this;this.I=new _C(this.by,_cc.g.a,this,"CanAccept",function(){return rt.h()});var et=this;this.R=new _C(this.bP,_cc.g.a,this,"CanTentativelyAccept",function(){return et.i()});var ot=this;this.W=new _C(this.bU,_cc.g.a,this,"CanTentativelyAccept",function(){return ot.i()});var ut=this;this.z=new _C(this.bN,_cc.g.a,this,"CanDecline",function(){return ut.g()});var ft=this;this.w=new _C(this.bD,_cc.g.a,this,"CanDecline",function(){return ft.g()})}if(_g.i.isInstanceOfType(this.a)&&this.a.bA()){var v=this;this.N=new _C(this.bG,_cc.g.a,this,"CanAccept",function(){return v.h()});var y=this;this.O=new _C(this.bK,_cc.g.a,this,"CanTentativelyAccept",function(){return y.i()});var l=this;this.y=new _C(this.bI,_cc.g.a,this,"CanDecline",function(){return l.g()});if(this.j()){var a=this;this.bh=new _C(this.bM,_cc.g.a,this,"CanAccept",function(){return a.h()});var p=this;this.ba=new _C(this.bz,_cc.g.a,this,"CanAccept",function(){return p.h()});var k=this;this.bl=new _C(this.bQ,_cc.g.a,this,"CanTentativelyAccept",function(){return k.i()});var d=this;this.bu=new _C(this.bV,_cc.g.a,this,"CanTentativelyAccept",function(){return d.i()});var w=this;this.Q=new _C(this.bO,_cc.g.a,this,"CanDecline",function(){return w.g()});var b=this;this.M=new _C(this.bE,_cc.g.a,this,"CanDecline",function(){return b.g()})}}this.H=new _C(this.bw,_cc.g.a);this.V=new _C(this.bT,_cc.g.a);this.C=new _C(this.bB,_cc.g.a);this.bc=new _C(this.bA,_cc.g.a);this.cg();this.r=1;this.b=h.b();this.b.o(new _C(this.bR,_cc.g.a))};_cc.g.prototype={c:null,t:null,a:null,bc:null,H:null,V:null,C:null,I:null,ba:null,W:null,bu:null,w:null,M:null,P:null,bh:null,R:null,bl:null,z:null,Q:null,n:null,N:null,o:null,O:null,d:null,y:null,U:null,be:null,bv:null,bq:!1,bn:null,b:null,bd:null,F:null,l:null,q:null,m:null,x:null,E:null,p:!1,T:!1,r:0,k:0,e:null,f:null,bb:function(n){this.ef("ActionSubmitted",n)},bZ:function(n){this.eg("ActionSubmitted",n)},bW:function(n){this.ef("ResponseEditorShown",n)},cP:function(n){this.eg("ResponseEditorShown",n)},ce:function(n){this.ef("ProposeNewTimeStarted",n)},cO:function(n){this.eg("ProposeNewTimeStarted",n)},cB:function(){return this.p?_u.W.i:""},cD:function(){return this.p?_u.W.j:""},cI:function(){return this.p?_u.W.X:""},D:function(){return this.h()||this.g()||this.i()},cC:function(){return this.a.U()},h:function(){return this.a.T()},g:function(){return this.a.V()},i:function(){return this.a.X()},cT:function(n){if(this.p!==n){this.p=n;this.ei(["TentativelyAcceptLabel","AcceptLabel","DeclineLabel"])}return n},cG:function(){return this.bv.f().d()},cF:function(){return this.U.a()!=="Mouse"},cS:function(n){if(n!==this.T){this.T=n;this.ea("HasEventAddedToCalendar")}return n},cE:function(){return this.U.a()==="TouchNarrow"?_u.W.BS:_u.W.BB},S:function(){return this.bq&&this.a.W()&&this.j()},j:function(){return this.a.D()},cH:function(){return!this.j()&&(_g.bh.isInstanceOfType(this.a)||_g.i.isInstanceOfType(this.a)&&!this.a.bA())},bo:function(){return _g.i.isInstanceOfType(this.a)&&this.a.bA()},bY:function(){this.ek("ActionSubmitted",this,null)},cK:function(){this.ek("ActionSucceeded",this,null)},cN:function(){this.ek("ResponseEditorShown",this,null)},cM:function(){this.ek("ResponseEditorHidden",this,null)},cL:function(){this.ek("ProposeNewTimeStarted",this,null)},bj:function(n){this.b.e(null);this.bi(n,!1)},bk:function(n){this.b.e(null);this.bi(n,!0)},cA:function(n,t,i,r,u){return new _cc.cz(n,t,i,r,u,this.bd)},cg:function(){this.S()&&(this.E=this.ch());if(this.j())if(_g.i.isInstanceOfType(this.a)&&this.a.bA()){this.l=this.K(_u.W.g,_u.W.z,this.P,this.I,this.n,this.bh,this.ba,this.N);this.q=this.K(_u.W.BP,_u.W.BX,this.R,this.W,this.o,this.bl,this.bu,this.O);this.m=this.K(_u.W.n,_u.W.BY,this.z,this.w,this.d,this.Q,this.M,this.y);this.x=this.K(_u.W.t,_u.W.BL,this.z,this.w,this.d,this.Q,this.M,this.y)}else{this.l=this.J(_u.W.y,this.P,this.I,this.n);this.q=this.J(_u.W.w,this.R,this.W,this.o);this.m=this.J(_u.W.m,this.z,this.w,this.d);this.x=this.J(_u.W.Y,this.z,this.w,this.d)}else if(_g.i.isInstanceOfType(this.a)&&this.a.bA()){this.l=this.L(_u.W.y,this.n,this.N);this.q=this.L(_u.W.w,this.o,this.O);this.m=this.L(_u.W.m,this.d,this.y);this.x=this.L(_u.W.Y,this.d,this.y)}},J:function(n,t,i,r){var u=new _ff.d;u.c(new _fm.n(n));u.c(new _fm.d(_u.W.T,null,t));u.c(new _fm.d(_u.W.x,null,i));u.c(new _fm.d(_u.W.l,null,r));return new _fm.f(u.d)},ch:function(){var t=new _C(this.bx,_cc.g.a);var r=new _C(this.bS,_cc.g.a);var i=new _C(this.bC,_cc.g.a);var n=new _ff.d;n.c(new _fm.n(_u.W.BD));n.c(new _fm.d(_u.W.L,null,t));n.c(new _fm.d(_u.W.u,null,r));n.c(new _fm.d(_u.W.BU,null,i));return new _fm.f(n.d)},cb:function(){this.br("Accept")},cU:function(){this.br("Tentative")},cj:function(){this.br("Decline")},br:function(n){this.b.i(n);this.b.r(this.a);this.F.e().a(this.Y);this.F.e().c(this.a,n);this.cL()},cJ:function(n){this.F.e().b(this.Y);this.b.e(n);this.bi(this.b.h(),!1)},K:function(n,t,i,r,u,f,e,o){var s=new _ff.d;s.c(new _fm.n(n));s.c(this.v(n,_u.W.T,i));s.c(this.v(n,_u.W.x,r));s.c(this.v(n,_u.W.l,u));s.c(new _fm.n(t));s.c(this.v(t,_u.W.T,f));s.c(this.v(t,_u.W.x,e));s.c(this.v(t,_u.W.l,o));return new _fm.f(s.d)},v:function(n,t,i){return new _fm.d(t,null,i,!1,null,String.format("{0} {1}",n,t))},L:function(n,t,i){var r=new _ff.d;r.c(new _fm.n(n));r.c(new _fm.d(_u.W.U,null,t));r.c(new _fm.d(_u.W.a,null,i));return new _fm.f(r.d)},cf:function(){this.f=_a.d.b(_cc.g.a,"AddToMyCalendarFromGroupInvite");var r=_a.d.b(_cc.g.a,"AddToMyCalendarFromGroupInviteE2E",!0);var i=new _gg.dS;i.ItemId=this.a.g();var t=new _cc.bY(i,this.bn);t.v(this.A);var n=this;t.w(function(t){n.cS(!0);if(n.f){var i=t;n.f.l=i.C();_a.d.a(n.f);n.f=null}});var u=this;t.z(function(n){_a.d.a(r)});this.t.a(t)},ct:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bj("Accept")},cc:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bs("Accept")},cm:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bf("Accept")},cu:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bk("Accept")},cd:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bt("Accept")},cn:function(){var n=this.a.g();this.c.a("Inference.AcceptedMeetingRequest",n,null);this.bg("Accept")},cx:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bj("Tentative")},cW:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bs("Tentative")},cr:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bf("Tentative")},cy:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bk("Tentative")},cX:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bt("Tentative")},cs:function(){var n=this.a.g();this.c.a("Inference.TentativeMeetingRequest",n,null);this.bg("Tentative")},cv:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bj("Decline")},ck:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bs("Decline")},co:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bf("Decline")},cw:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bk("Decline")},cl:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bt("Decline")},cp:function(){var n=this.a.g();this.c.a("Inference.DeclinedMeetingRequest",n,null);this.bg("Decline")},bi:function(n,t){this.k=_cc.v.d.g(t);this.e=_cc.v.d.c(n,this.r);_a.k.b("VM.MeetResponse.EditResponseForTouchWideAndMouseStart");this.b.i(n);this.b.m(t);this.b.d(!0);this.cN();_cc.v.d.a(this.e,"",null,this.a.D(),_g.i.isInstanceOfType(this.a),this.bo(),this.k);this.e=null},cz:function(){var n=new _cmc.c(!1);this.b.l(n);this.b.n(n.d);this.cM();this.b.d(!1);this.G(this.b.h(),this.b.j(),this.b.k(),this.b.q())},bf:function(n){this.bX(n,!1)},bg:function(n){this.bX(n,!0)},bp:function(n,t,i,r,u){var f=this.a;_g.i.isInstanceOfType(f)&&n&&(f=this.be.c(f));return this.cA(f,t,i,r,u)},bX:function(n,t){this.k=_cc.v.d.f(t);this.e=_cc.v.d.c(n,this.r);var i=this.bp(t,n,0);i.w(this.X);i.v(this.A);this.t.a(i);this.bY()},cq:function(n){var i=n;i.K(this.X);if(i.meetingResponseMessageId){var t=new _h.bd([i.meetingResponseMessageId],"HardDelete",2);t.v(this.A);t.w(this.Z);this.t.a(t)}},bs:function(n){this.G(n,!1)},bt:function(n){this.G(n,!0)},G:function(n,t,i,r){this.k=_cc.v.d.h(t);this.e=_cc.v.d.c(n,this.r);var u=this.bp(t,n,1,i,r);u.v(this.A);u.w(this.Z);this.t.a(u);this.bY();_a.k.b("VM.MeetResponse.MeetingResponseEnd")},cQ:function(n){var i=n;var t=i.D();var r=i.C();_js.Trace.logWarning(_cc.g.a,"MeetingResponse message failed with error: "+t);if(this.e){_cc.v.d.a(this.e,t,r,this.j(),_g.i.isInstanceOfType(this.a),this.bo(),this.k);this.e=null}if(this.f){this.f.l=r;this.f.k=t;_a.d.a(this.f);this.f=null}_cc.h.a(i)},cR:function(n){if(this.e){var t=n;_cc.v.d.a(this.e,null,t.C(),this.j(),_g.i.isInstanceOfType(this.a),this.bo(),this.k);this.e=null}this.cK()},ca:function(){this.bm("Accept")},cV:function(){this.bm("Tentative")},ci:function(){this.bm("Decline")},bm:function(n){if(this.cH())switch(n){case"Accept":this.n.a();break;case"Tentative":this.o.a();break;case"Decline":this.d.a();break;default:throw Error.argument("Invalid meeting response argument");}}};_cc.bw=function(n,t,i,r,u,f,e,o,s){this.b=t;this.e=n;this.i=i;this.d=r;this.j=u;this.h=f;this.f=e;this.g=o;this.c=s};_cc.bw.prototype={b:null,e:null,i:null,d:null,j:null,h:null,f:!1,c:null,g:null,a:null,k:function(n){return this.l(n,this.a)},l:function(n,t){return new _cc.g(n,this.e,this.b,this.i,this.d,this.j,this.h,this.f,t,this.g,this.c)}};_cc.bU=function(){};_cc.bU.a=function(n){for(var i=new Array(n.a.length),t=0;t<n.a.length;t++)i[t]=n.c(t);return i.join(";")};_cc.B=function(){};_cc.B.registerInterface("_cc.B");_cc.A=function(n){this.h=n};_cc.A.prototype={h:0,c:function(){return _u.c.CT},d:function(n){return _cc.A.isInstanceOfType(n)&&n.h===this.h},a:function(){var n=[_u.c.V,_u.c.CQ,_u.c.Bm];return this.i(n)},e:function(){var n=[_u.c.Da,_u.c.CO,_u.c.BM];return this.i(n)},b:function(){return this.h<=0?4:0},g:function(){var n=new _g.cG(new _g.dL(this.h));n.c(this.h);return n},f:function(){return new _cc.A(this.h)},i:function(n){_a.b.f(n.length,3,"Expected three daily recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=String.format(n[2],this.h);break}return t}};_cc.C=function(n,t){this.i=n;this.h=t};_cc.C.prototype={h:0,i:0,c:function(){return _u.c.DW},a:function(){var n=[_u.c.Df,_u.c.BY,_u.c.Ch];return this.j(n)},e:function(){var n=[_u.c.A,_u.c.Be,_u.c.X];return this.j(n)},d:function(n){return _cc.C.isInstanceOfType(n)&&n.i===this.i&&n.h===this.h},b:function(){var n=0;this.i<=0?n|=4:(this.h>31||this.h<=0)&&(n|=1);return n},g:function(){return new _g.cE(new _g.dG(this.i,this.h))},f:function(){return new _cc.C(this.i,this.h)},j:function(n){_a.b.f(n.length,3,"Expected three month-by-day pattern strings");var t="";switch(this.i){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,this.h,this.i)}};_cc.D=function(n,t,i){this.h=n;this.j=t;this.i=i};_cc.D.prototype={j:"None",i:0,h:0,c:function(){return _u.c.Cm},a:function(){var n=[_u.c.T,_u.c.BD,_u.c.Dh];return this.k(n)},e:function(){var n=[_u.c.De,_u.c.CG,_u.c.Bx];return this.k(n)},d:function(n){return _cc.D.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i&&n.j===this.j},b:function(){var n=0;this.h<=0&&(n|=4);this.i||(n|=2);this.j==="None"&&(n|=16);return n},g:function(){var n=new _g.cL;n.c(this.h);n.k(this.i);n.i(this.j);return n},f:function(){return new _cc.D(this.h,this.j,this.i)},k:function(n){_a.b.f(n.length,3,"Expected three monthly-by-week recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,_cc.e.i(this.j),_cc.e.d(this.i),this.h)}};_cc.p=function(){};_cc.p.prototype={c:function(){return _u.c.BC},a:function(){return _u.c.BC},e:function(){return _u.c.BC},d:function(n){return _cc.p.isInstanceOfType(n)},b:function(){return 0},g:function(){return null},f:function(){return new _cc.p}};_cc.E=function(){};_cc.E.prototype={c:function(){return _u.c.Bv},a:function(){return _u.c.Bv},e:function(){return _u.c.Bv},d:function(n){return _cc.E.isInstanceOfType(n)},b:function(){return 0},g:function(){return null},f:function(){return new _cc.E}};_cc.X=function(){};_cc.X.b=function(n,t,i,r){var u=new _js.f;var f=_cc.e.h(n.q());var e=n.d();u.a(new _cc.p);u.a(new _cc.A(1));u.a(new _cc.y(1,f));t&&u.a(new _cc.y(1,t,t));u.a(new _cc.C(1,n.i()));u.a(new _cc.D(1,_cc.e.e(n),f));u.a(new _cc.F(n.i(),e));if(i.a()!=="TouchNarrow"){r&&u.a(new _cc.E);u.a(_u.c.BK)}return u};_cc.X.d=function(n,t){t.e(n.a.g());t.f(n.n());t.g(n.h)};_cc.X.a=function(n,t,i){if(!n)return null;var r=new _cc.bx;r.i(_cc.X.c(n.a()));r.f(n.b().c());r.g(_cc.e.g(n.b(),r.a));r.k(t);r.j(i);r.l(n.c());return r};_cc.X.c=function(n){var t=new _cc.p;n&&(_g.cG.isInstanceOfType(n)?t=new _cc.A(n.a()):_g.cP.isInstanceOfType(n)?t=new _cc.y(n.a(),n.f()):_g.cE.isInstanceOfType(n)?t=new _cc.C(n.a(),n.f()):_g.cL.isInstanceOfType(n)?t=new _cc.D(n.a(),n.g(),n.f()):_g.cF.isInstanceOfType(n)?t=new _cc.F(n.a(),_js.l.a(_a.eM,n.bh.Month)):_g.dE.isInstanceOfType(n)&&(t=new _cc.H(n.b(),n.a(),_js.l.a(_a.eM,n.bh.Month))));return t};_cc.bx=function(n,t,i,r,u,f){_cc.bx.initializeBase(this);this.f(t||null);this.g(i||null);this.k(r||null);this.j(u||null);this.l($a(f)?null:f);this.i($a(n)?null:n)};_cc.bx.a=function(n){var t=null;n?(n&64)==64?t=_u.c.CP:(n&1)==1?t=_u.c.x:(n&2)==2?t=_u.c.Cb:(n&4)==4?t=_u.c.Cl:(n&32)==32?t=_u.c.i:(n&16)==16?t=_u.c.S:(n&8)==8&&(t=_u.c.BP):t=null;return t};_cc.bx.prototype={b:null,c:null,d:null,e:null,a:null,h:null,i:function(n){if(this.a!==n){this.a=n;this.bk("RecurrencePattern")}return n},f:function(n){if(this.b!==n){this.b=n;this.bk("StartDate")}return n},g:function(n){if(this.c!==n){!$a(n)&&n.b(this.b)<0&&(n=this.b);this.c=n;this.bk("EndDate")}return n},k:function(n){if(this.d!==n){this.d=n;this.bk("StartTime")}return n},j:function(n){if(this.e!==n){!$a(n)&&n.b(this.d)<0&&(n=this.d);this.e=n;this.bk("EndTime")}return n},l:function(n){if(this.h!==n){this.h=n;this.bk("TimeZoneId")}return n},o:function(){return _cc.p.isInstanceOfType(this.a)?this.a.a():String.format(_u.c.BV,this.a.e(),this.m())},m:function(){var n="";var t="";this.d&&this.e&&(t=String.format(_u.c.CL,this.d.a(0),this.e.a(0)));n=this.c?String.format(_u.c.Ck,this.b.a(5),this.c.a(5)):String.format(_u.c.Cg,this.b.a(5));return String.format(_u.c.Dk,t,n)},p:function(){return this.a.b()|this.q()},n:function(){var t;if(this.c){var n=new _g.cH;n.g(this.b);n.i(this.c);t=n}else{var i=new _g.eR;i.g(this.b);t=i}return t},q:function(){var n=0;$a(this.b)?n=8:!$a(this.c)&&this.b.b(this.c)>=0&&(n=64);return n}};_cc.e=function(){};_cc.e.e=function(n){for(var i=n.i(),t=0;i>0;){i-=7;++t}switch(t){case 0:return"None";case 1:return"First";case 2:return"Second";case 3:return"Third";case 4:return"Fourth";default:return"Last"}};_cc.e.h=function(n){var t;switch(n){case 0:t=1;break;case 1:t=2;break;case 2:t=4;break;case 3:t=8;break;case 4:t=16;break;case 5:t=32;break;case 6:t=64;break;default:t=0;break}return t};_cc.e.b=function(n){var t=[];n&1&&Array.add(t,0);n&2&&Array.add(t,1);n&4&&Array.add(t,2);n&8&&Array.add(t,3);n&16&&Array.add(t,4);n&32&&Array.add(t,5);n&64&&Array.add(t,6);return t};_cc.e.k=function(n){var r=_cc.X.c(n.a());var i=n.b();return _cc.e.g(i,r)};_cc.e.g=function(n,t){if(_g.cH.isInstanceOfType(n))return n.f();if(!_gg.cH.isInstanceOfType(n)||_cc.p.isInstanceOfType(t))return null;var r=n.a();var i=n.c();if(_cc.A.isInstanceOfType(t)){var nt=t.h*(r-1);return i.c(nt)}else if(_cc.y.isInstanceOfType(t)){var f=t.i;var v=t.h;if(!Array.contains(_cc.e.b(f),i.q())){var p=_cc.e.j(i.q(),f,0);i=i.c(_cc.e.c(i.q(),p))}var y=_cc.e.l(f);var tt=Math.floor((r-1)/y);var a=(r-1)%y;var u=v*7*tt;if(a>0){var e=_cc.e.j(i.q(),f,a);if(e<=i.q()){u+=v*7;u-=_cc.e.c(e,i.q())}else u+=_cc.e.c(i.q(),e)}return i.c(u)}else if(_cc.D.isInstanceOfType(t)){var g=t.j;var b=t.h;var d=_cc.e.b(t.i)[0];(_cc.e.e(i)>g||i.q()>d)&&(i=i.n(b));return _cc.e.f(i.n((r-1)*t.h),_cc.e.b(t.i)[0],t.j)}else if(_cc.C.isInstanceOfType(t)){var h=t.h;var l=t.i;if(i.i()>h){i=i.n(l);i=new _a.c(i.e(),i.d(),h)}return i.n((r-1)*l)}else if(_cc.H.isInstanceOfType(t)){var k=t.i;var c=t.j;var w=_cc.e.b(t.h)[0];(i.d()>c||_cc.e.e(i)>k||i.q()>w)&&(i=new _a.c(i.e()+1,c,1));return _cc.e.f(i.u(r-1),_cc.e.b(t.h)[0],t.i)}else if(_cc.F.isInstanceOfType(t)){var s=t.h;var o=t.i;(i.d()>o||i.i()>s)&&(i=new _a.c(i.e()+1,o,s));return i.u(r-1)}return null};_cc.e.j=function(n,t,i){for(var u=_cc.e.b(t),f=0,r=0;r<u.length;r++)if(n<=u[r]){f=r;if(n===u[r])break}return u[(i+f)%u.length]};_cc.e.c=function(n,t){var i=t-n;return i<0?i+7:i};_cc.e.l=function(n){for(var i=0,t=n;t;){(t&1)>0&&i++;t=t>>1}return i};_cc.e.a=function(n){switch(n){case 0:return _u.c.BJ;case 1:return _u.c.DT;case 2:return _u.c.DI;case 3:return _u.c.J;case 4:return _u.c.Bp;case 5:return _u.c.Bt;case 6:return _u.c.DH;default:return""}};_cc.e.d=function(n,t){if(!$a(t)&&n===t)return _u.c.BN;if(n===62)return _u.c.DK;if(n===65)return _u.c.t;if(n===127)return _u.c.Bo;var i=_cc.e.b(n);switch(i.length){case 0:return"";case 1:return String.format(_u.c.q,_cc.e.a(i[0]));case 2:return String.format(_u.c.z,_cc.e.a(i[0]),_cc.e.a(i[1]));case 3:return String.format(_u.c.CA,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]));case 4:return String.format(_u.c.Co,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]));case 5:return String.format(_u.c.BQ,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]));case 6:return String.format(_u.c.C,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]),_cc.e.a(i[5]));case 7:return String.format(_u.c.DZ,_cc.e.a(i[0]),_cc.e.a(i[1]),_cc.e.a(i[2]),_cc.e.a(i[3]),_cc.e.a(i[4]),_cc.e.a(i[5]),_cc.e.a(i[6]));default:return""}};_cc.e.i=function(n){switch(n){case"First":return _u.c.CM;case"Second":return _u.c.DN;case"Third":return _u.c.BA;case"Fourth":return _u.c.Cy;case"Last":return _u.c.Bq;case"None":default:return""}};_cc.e.f=function(n,t,i){if(i!=="Last"){n=new _a.c(n.e(),n.d(),1);var u=_cc.e.c(n.q(),t);var r=0;switch(i){case"First":r=1;break;case"Second":r=2;break;case"Third":r=3;break;case"Fourth":r=4;break}u+=7*(r-1);return n.c(u)}else{n=new _a.c(n.e(),n.d(),_a.c.p(n.d(),n.e()));return n.c(_cc.e.c(t,n.q())*-1)}};_cc.co=function(n,t,i,r){this.c=Function.createDelegate(this,this.j);_cc.co.initializeBase(this);this.d=n;this.e=t;this.b()&&this.b().a()?this.h(_cc.X.a(this.b(),i,r)):this.h(new _cc.bx(new _cc.p,i,null,i,r,""));this.apcl("RecurrenceDataObject",this.c);this.a.apcl("StartDate",this.c);this.a.apcl("EndDate",this.c);this.a.apcl("RecurrencePattern",this.c);this.a.apcl("TimeZoneId",this.c)};_cc.co.prototype={d:null,e:null,a:null,h:function(n){if(this.a!==n){this.a=n;this.ea("RecurrenceDataObject")}return n},f:function(n){if(this.a.a!==n){this.a.i(n);this.ee("RecurrencePattern","RecurrenceDataObject")}return n},b:function(){return this.d.A()},g:function(n){if(this.d.A()!==n){this.d.bg(n);this.ea("Model")}return n},i:function(){return _cc.bx.a(this.a.p())},j:function(n,t){if(_cc.p.isInstanceOfType(this.a.a)||_cc.E.isInstanceOfType(this.a.a))this.g(null);else{var i=this.e.a();_cc.X.d(this.a,i);this.g(i)}}};_cc.y=function(n,t,i){this.h=n;this.i=t;this.j=i};_cc.y.prototype={j:0,i:0,h:0,c:function(){return _u.c.BO},a:function(){var n=[_u.c.Ct,_u.c.DO,_u.c.y];return this.k(n)},e:function(){var n=[_u.c.Bc,_u.c.p,_u.c.Bz];return this.k(n)},d:function(n){return _cc.y.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i},b:function(){var n=0;this.h<=0?n|=4:this.i||(n|=2);return n},g:function(){var n=new _g.cP;n.c(this.h);n.j(this.i);n.i(_a.bK.toString(_a.c.P()));return n},f:function(){return new _cc.y(this.h,this.i)},k:function(n){_a.b.f(n.length,3,"Expected three weekly recurrence pattern strings");var t="";switch(this.h){case 0:throw Error.argument("Interval cannot be zero.");case 1:t=n[0];break;case 2:t=n[1];break;default:t=n[2];break}return String.format(t,_cc.e.d(this.i,this.j),this.h)}};_cc.F=function(n,t){this.h=n;this.i=t;this.j=new _ca.h};_cc.F.prototype={j:null,i:0,h:0,c:function(){return _u.c.DB},a:function(){return this.k(_u.c.CW)},e:function(){return this.k(_u.c.DX)},d:function(n){return _cc.F.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i},b:function(){var n=0;(0>=this.h||this.h>31)&&(n|=1);return n},g:function(){return new _g.cF(new _g.dH(this.h,this.j.a(this.i,!1)))},f:function(){return new _cc.F(this.h,this.i)},k:function(n){return String.format(n,this.j.a(this.i,!0),this.h)}};_cc.H=function(n,t,i){this.i=n;this.h=t;this.j=i;this.k=new _ca.h};_cc.H.prototype={k:null,j:0,i:"None",h:0,c:function(){return _u.c.Cd},a:function(){return this.l(_u.c.Bn)},e:function(){return this.l(_u.c.K)},d:function(n){return _cc.H.isInstanceOfType(n)&&n.h===this.h&&n.i===this.i&&n.j===this.j},b:function(){var n=0;this.h||(n|=2);this.i==="None"&&(n|=16);return n},g:function(){var n=new _g.dE;n.g(this.k.a(this.j,!1));n.i(this.h);n.c(this.i);return n},f:function(){return new _cc.H(this.i,this.h,this.j)},l:function(n){return String.format(n,_cc.e.i(this.i),_cc.e.d(this.h),this.k.a(this.j,!0))}};var ISchedulingContext=function(){};ISchedulingContext.registerInterface("ISchedulingContext");var ISchedulingViewModel=function(){};ISchedulingViewModel.registerInterface("ISchedulingViewModel");var ISchedulingViewModelFactory=function(){};ISchedulingViewModelFactory.registerInterface("ISchedulingViewModelFactory");_cc.cY=function(){};_cc.cY.a=function(n){if(_js.d.a(n.EmailAddress)){n=_ff.g.a(n,!0,!0);n.EmailAddress=n.ItemId&&!_js.d.a(n.ItemId.Id)?"@"+n.ItemId.Id:String.format("{0}{1}{2}","@",n.Name,n.MailboxType)}return n};var ICalendarPickerNodeView=function(){};ICalendarPickerNodeView.registerInterface("ICalendarPickerNodeView");var IWeatherController=function(){};IWeatherController.registerInterface("IWeatherController");_cc.dx=function(){};_cc.dx.prototype={UltraDark:0,Dark:1,Normal:2,Medium:3,Light:4,UltraLight:5};_cc.dx.registerEnum("_cc.dx",!1);_cc.c=function(){};_cc.c.l=function(){return _cc.c.a(_fm.a.bX,"ms-fcl-ns-b")};_cc.c.v=function(){return _cc.c.a(_fm.a.cg,"ms-fcl-ns-b")};_cc.c.R=function(){return _cc.c.a(_fm.a.bI,"ms-fcl-ns-b")};_cc.c.t=function(){return _cc.c.a(_fm.a.cy,"ms-fcl-ns-b")};_cc.c.x=function(){return _cc.c.a(_fm.a.cj,"ms-fcl-ns-b")};_cc.c.bb=function(){return _cc.c.a(_fm.a.cK,"ms-fcl-ns-b")};_cc.c.F=function(){return _cc.c.a(_fm.a.cm,"ms-fcl-ns-b")};_cc.c.P=function(){return _cc.c.a(_fm.a.cA,"ms-fcl-ns-b")};_cc.c.H=function(){return _cc.c.a(_fm.a.bw,"ms-fcl-ns-b")};_cc.c.p=function(){return _cc.c.a(_fm.a.cd,"ms-fcl-ns-b")};_cc.c.B=function(){return _cc.c.a(_fm.a.bn,"ms-fcl-ns-b")};_cc.c.Z=function(){return _cc.c.a(_fm.a.cH,"ms-fcl-ns-b")};_cc.c.L=function(){return _cc.c.a(_fm.a.cs,"ms-fcl-ns-b")};_cc.c.T=function(){return _cc.c.a(_fm.a.bP,"ms-fcl-ns-b")};_cc.c.j=function(){return _cc.c.a(_fm.a.bW,"ms-fcl-ns-b")};_cc.c.X=function(){return _cc.c.a(_fm.a.bN,"ms-fcl-ns-b")};_cc.c.r=function(){return _cc.c.a(_fm.a.ce,"ms-fcl-ns-b")};_cc.c.N=function(){return _cc.c.a(_fm.a.j,"ms-fcl-ns-b")};_cc.c.d=function(){return _cc.c.a(_fm.a.bQ,"ms-fcl-ns-b")};_cc.c.z=function(){return _cc.c.a(_fm.a.cp,"ms-fcl-ns-b")};_cc.c.D=function(){return _cc.c.a(_fm.a.cl,"ms-fcl-ns-b")};_cc.c.V=function(){return _cc.c.a(_fm.a.cF,"ms-fcl-ns-b")};_cc.c.J=function(){return _cc.c.a(_fm.a.bu,"ms-fcl-ns-b")};_cc.c.n=function(){return _cc.c.a(_fm.a.bY,"ms-fcl-ns-b")};_cc.c.f=function(){return _cc.c.a(_fm.a.bR,"ms-fcl-ns-b")};_cc.c.h=function(){return _cc.c.a(_fm.a.N,"ms-fcl-ns-b")};_cc.c.m=function(){return _cc.c.a(_fm.a.bX,"ms-fcl-w-b")};_cc.c.w=function(){return _cc.c.a(_fm.a.cg,"ms-fcl-w-b")};_cc.c.S=function(){return _cc.c.a(_fm.a.bI,"ms-fcl-w-b")};_cc.c.u=function(){return _cc.c.a(_fm.a.cy,"ms-fcl-w-b")};_cc.c.y=function(){return _cc.c.a(_fm.a.cj,"ms-fcl-w-b")};_cc.c.bc=function(){return _cc.c.a(_fm.a.cK,"ms-fcl-w-b")};_cc.c.G=function(){return _cc.c.a(_fm.a.cm,"ms-fcl-w-b")};_cc.c.Q=function(){return _cc.c.a(_fm.a.cA,"ms-fcl-w-b")};_cc.c.I=function(){return _cc.c.a(_fm.a.bw,"ms-fcl-w-b")};_cc.c.q=function(){return _cc.c.a(_fm.a.cd,"ms-fcl-w-b")};_cc.c.C=function(){return _cc.c.a(_fm.a.bn,"ms-fcl-w-b")};_cc.c.ba=function(){return _cc.c.a(_fm.a.cH,"ms-fcl-w-b")};_cc.c.M=function(){return _cc.c.a(_fm.a.cs,"ms-fcl-w-b")};_cc.c.U=function(){return _cc.c.a(_fm.a.bP,"ms-fcl-w-b")};_cc.c.k=function(){return _cc.c.a(_fm.a.bW,"ms-fcl-w-b")};_cc.c.Y=function(){return _cc.c.a(_fm.a.bN,"ms-fcl-w-b")};_cc.c.s=function(){return _cc.c.a(_fm.a.ce,"ms-fcl-w-b")};_cc.c.O=function(){return _cc.c.a(_fm.a.j,"ms-fcl-w-b")};_cc.c.e=function(){return _cc.c.a(_fm.a.bQ,"ms-fcl-w-b")};_cc.c.A=function(){return _cc.c.a(_fm.a.cp,"ms-fcl-w-b")};_cc.c.E=function(){return _cc.c.a(_fm.a.cl,"ms-fcl-w-b")};_cc.c.W=function(){return _cc.c.a(_fm.a.cF,"ms-fcl-w-b")};_cc.c.K=function(){return _cc.c.a(_fm.a.bu,"ms-fcl-w-b")};_cc.c.o=function(){return _cc.c.a(_fm.a.bY,"ms-fcl-w-b")};_cc.c.g=function(){return _cc.c.a(_fm.a.bR,"ms-fcl-w-b")};_cc.c.i=function(){return _cc.c.a(_fm.a.N,"ms-fcl-w-b")};_cc.c.c=function(){return _fm.b.a(_fm.a.di,"ms-fcl-tp-b",_fm.WebfontSizes.a.e)};_cc.c.b=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_cc.c.a=function(n,t){return _fm.b.a(n,t,_fm.WebfontSizes.a.a)};_cc.a=function(n,t){this.j=[["#030507","#71C2EB","#C0E9FF","#D2EFFA","#E2F5FD","#EAF8FD"],["#176002","#29CE6B","#D4FCA7","#E3F8CD","#EAF8D1","#EFFADD"],["#AF4802","#FF9D3B","#FFDEC7","#FFE7DA","#FFEDE1","#FFF3EB"],["#484848","#A3A3A3","#E2E2E2","#EBEBEB","#EEEFEF","#F4F4F4"],["#6D5803","#D1C426","#FCFAA7","#FEF9C6","#FFFBDE","#FFFDE9"],["#026350","#13CEAA","#BDF9EA","#D3FBF0","#DFFDFF","#E7FDFF"],["#960269","#ED5DBA","#FFD7F7","#FDE5F9","#FBECF8","#FCF3FA"],["#633502","#A88D7B","#F1E2C8","#F5EADA","#F6ECDE","#F9F4ED"],["#6D011D","#F25561","#FCD2D2","#FCE0E0","#FFECEB","#FFF3F3"]];this.k=[["#0D5BC3","#0D5BC3","#0078D7","#4295DD","#DDF3FE","#ECF8FE"],["#246C2B","#246C2B","#298835","#589F61","#DCF1DE","#F1F9F2"],["#BA2402","#BA2402","#D83B01","#DE6346","#FDE5D3","#FEF4ED"],["#081C5D","#081C5D","#1E3698","#3557A0","#EFEAF6","#F4F6FB"],["#F59D09","#F59D09","#FFB900","#FDC655","#FBF4CF","#FDFAE7"],["#29655E","#29655E","#0B857D","#469D97","#D4F5F2","#ECFAF9"],["#B70480","#B70480","#E40089","#E744A1","#FBE4F1","#FDF3F9"],["#760009","#760009","#A80000","#B8383E","#FADFE3","#FDF2F4"],["#88027D","#88027D","#B4009E","#C145B0","#F4E4F4","#FAF2FB"]];this.l=[["#A6D1F5","#A6D1F5","#C1E9FE","#CAECFE","#DDF3FE","#ECF8FE"],["#87D28E","#87D28E","#B3E5B8","#C3E9C7","#DCF1DE","#F1F9F2"],["#FCAB73","#FCAB73","#FDC99D","#FDD4B3","#FDE5D3","#FEF4ED"],["#C0C0C0","#C0C0C0","#D7D7D7","#DFDFDF","#EEEEEE","#F7F7F7"],["#F4D07A","#F4D07A","#F8EA92","#F9EDAC","#FBF4CF","#FDFAE7"],["#4ADACC","#4ADACC","#9FEBE3","#B5EFE9","#D4F5F2","#ECFAF9"],["#F08CC0","#F08CC0","#F6B7DA","#F7C6E1","#FBE4F1","#FDF3F9"],["#CBA287","#CBA287","#DBBBA4","#E1C9B7","#EEE2D8","#F8F4F0"],["#F88C9B","#F88C9B","#F9A7B3","#F9B9C3","#FADFE3","#FDF2F4"]];this.g=n;this.i=t;this.c=this.g.a().q().Enabled};_cc.a.prototype={g:null,i:null,c:!1,e:function(){return this.i.a().bh.UseBrightCalendarColorThemeInOwa},a:function(n,t,i,r){n.css(t,this.b(i,r))},f:function(n,t,i,r){n.css("color",this.h(t,i,r))},b:function(n,t){var i=this.j;this.g.a().q().Enabled&&(i=this.e()?this.k:this.l);return n!==-1?i[n][t]:i[_cc.a.a][t]},h:function(n,t,i){return this.c?this.i.a().bh.UseBrightCalendarColorThemeInOwa?n===4?i?"#666666":"#212121":"#FFFFFF":i?"#666666":"#212121":this.b(n,t)},d:function(){var n=new(_a.fJ.$$(_g.dJ));if(this.c){n.c(0);n.c(5);n.c(1);n.c(3);n.c(8);n.c(6);n.c(7);n.c(2);n.c(4)}else for(var t=0;t<9;t++){var i=t;n.c(t)}return n},m:function(){var t=new Array(9);if(this.c)for(var n=0;n<9;n++){t[n++]=0;t[n++]=2;t[n++]=7;t[n++]=3;t[n++]=8;t[n++]=1;t[n++]=5;t[n++]=6;t[n++]=4}else for(var i=0;i<9;i++)t[i]=i;return t}};_cc.i=function(n,t,i,r){_cc.i.initializeBase(this,[n]);this.p=t;this.n=i;this.o=r};_cc.i.$$cctor=function(){_cc.i.a=new _cc.cm};_cc.i.prototype={p:null,n:null,o:null,i:null,f:null,j:0,h:null,k:null,a:"NoData",m:0,g:null,e:!1,b:function(n){if(this.j!==n){this.j=n;this.d();this.bk("CalendarColor")}return n},q:function(n){if(this.k!==n){this.k=n;this.d();this.bk("Category")}return n},r:function(n){if(this.e!==n){this.e=n;this.d()}return n},c:function(n){if(this.a!==n){this.a=n;this.bk("FreeBusy");this.E()&&!this.bF&&this.d()}return n},l:function(n){if(this.g!==n){this.g=n;this.h=this.g?this.p.a(this.g):null}return n},t:function(n,t,i,r,u,f){this.j=n;this.g=t;this.k=i;this.a=r;this.m=u;this.e=f;this.d()},J:function(){this.d();_js.c.prototype.J.call(this)},Q:function(){_js.c.prototype.Q.call(this);this.E()?this.d():this.h=null},d:function(){if(this.P()){this.i&&this.y.removeClass(this.i);if(this.a!=="NoData"){this.i=_cc.i.a.a(this.a,!this.e);this.y.addClass(this.i)}this.f&&this.y.css(this.f,"");this.m&&(this.y[0].style.height=this.m.toString()+"%");if(this.a!=="OOF"){this.f=this.a==="Free"?"border-color":"background-color";var n;var i,t;this.h&&(t=_h.c.b(this.k,this.h,i={val:n}),n=i.val,t)?this.o.d(this.y,this.f,n,this.e?2:1):this.n.a(this.y,this.f,this.j,this.e?2:1)}}}};_cc.cq=function(n,t){_cc.cq.initializeBase(this,[n]);this.b=t};_cc.cq.prototype={b:null,a:-1,c:function(n){if(this.a!==n){this.a=n;this.bk("CalendarColor");$a(n)||this.d()}return n},d:function(){if(this.a===-1){this.y.css("background-color","");return}this.b.a(this.y,"background-color",this.a,1)}};_cc.cr.registerClass("_cc.cr",_h.fL);_cc.N.registerClass("_cc.N");_cc.cv.registerClass("_cc.cv",_fm.k);_cc.L.registerClass("_cc.L",_js.u);CalendarCoreComponent.registerClass("CalendarCoreComponent",null,_a.ih);_cc.bB.registerClass("_cc.bB");_cc.h.registerClass("_cc.h");_cc.bG.registerClass("_cc.bG",_cc.ca.$$(_gg.pc));_cc.S.registerClass("_cc.S",_h.fL);_cc.bf.registerClass("_cc.bf",_h.dj.$$(_gg.ty,_gg.tz),_cc.dj);_cc.m.registerClass("_cc.m",_h.fp);_cc.bH.registerClass("_cc.bH",_cc.ca.$$(_gg.pd));_cc.bI.registerClass("_cc.bI",_cc.ca.$$(_g.eZ));_cc.bJ.registerClass("_cc.bJ",_cc.ca.$$(_g.eZ));_cc.bn.registerClass("_cc.bn",_h.cB,_h.fe);_cc.cI.registerClass("_cc.cI",_cc.cf.$$(_g.fl,_g.gP));_cc.cd.registerClass("_cc.cd",_h.dj.$$(_gg.ip,_g.es),_h.fe);_cc.cJ.registerClass("_cc.cJ",_cc.ca.$$(_g.jN));_cc.O.registerClass("_cc.O",_h.cB,_h.fe);_cc.P.registerClass("_cc.P",_cc.cf.$$(_g.fl,_g.gP));_cc.cL.registerClass("_cc.cL",_cc.ca.$$(_g.gS));_cc.cg.registerClass("_cc.cg",_cc.ca.$$(_gg.tV));_cc.J.registerClass("_cc.J",_h.dj.$$(_g.fr,_g.es));_cc.ch.registerClass("_cc.ch",_cc.cf.$$(_gg.xt,_gg.xu),_g.lk);_cc.bM.registerClass("_cc.bM",_cc.ca.$$(_gg.pc));_cc.bN.registerClass("_cc.bN",_cc.ca.$$(_gg.pd));_cc.cM.registerClass("_cc.cM",_h.dj.$$(_gg.BZ,_gg.Ca));_cc.bP.registerClass("_cc.bP",_cc.ca.$$(_gg.pe));_cc.cN.registerClass("_cc.cN",_h.dj.$$(_g.kY,_g.gQ));_cc.bQ.registerClass("_cc.bQ",_cc.ca.$$(_gg.CD));_cc.G.registerClass("_cc.G",_h.dh);_cc.cR.registerClass("_cc.cR",_cc.G);_cc.bl.registerClass("_cc.bl",_h.s);_cc.cC.registerClass("_cc.cC",null,Sys.IDisposable);_cc.bC.registerClass("_cc.bC",_h.s);_cc.bm.registerClass("_cc.bm",_cc.bC);_cc.M.registerClass("_cc.M",_cc.bC);_cc.cD.registerClass("_cc.cD",null,Sys.IDisposable);_cc.cE.registerClass("_cc.cE",_js.u);_cc.u.registerClass("_cc.u",_js.u,_cc.di,_cc.dh);_cc.dg.registerClass("_cc.dg",_a.iX,_g.lQ,_js.z);CalendarsCache.registerClass("CalendarsCache",_cc.dg,ICalendars,_g.lO,_js.z);_cc.bE.registerClass("_cc.bE",_a.iX,_cc.T,_h.ew);_cc.o.registerClass("_cc.o",_a.iX);_cc.bK.registerClass("_cc.bK");_cc.ba.registerClass("_cc.ba",_a.iX,_g.gb);_cc.bD.registerClass("_cc.bD");_cc.x.registerClass("_cc.x",_cc.bC);_cc.cb.registerClass("_cc.cb");_cc.j.registerClass("_cc.j",_a.bP,_g.lN);_cc.cc.registerClass("_cc.cc");_cc.d.registerClass("_cc.d",_a.bP);CalendarsConfiguration.registerClass("CalendarsConfiguration",_a.iX,ICalendarsConfiguration,_js.z,IMasterCategoryListProvider);_cc.bo.registerClass("_cc.bo");_cc.U.registerClass("_cc.U",_a.iX,_cc.s,_js.z);_cc.bO.registerClass("_cc.bO");_cc.bF.b.registerClass("_cc.bF.b");_cc.dl.registerClass("_cc.dl",_a.bx,_bc.j,_bc.p,_bc.u,_a.iT,_js.z,Sys.IDisposable);_cc.bb.registerClass("_cc.bb",_a.bx);_cc.bg.registerClass("_cc.bg");_cc.dm.registerClass("_cc.dm");_cc.bV.registerClass("_cc.bV",_a.bx,_cc.ds);_cc.bW.registerClass("_cc.bW");_cc.r.registerClass("_cc.r",_a.bx);_cc.bX.registerClass("_cc.bX");_cc.bh.registerClass("_cc.bh",_a.bx,ICalendarItemViewModel);_cc.I.registerClass("_cc.I");_cc.by.registerClass("_cc.by");_cc.bq.registerClass("_cc.bq",null,_cc.dr);_cc.R.registerClass("_cc.R",_a.bx,_fm.l);_cc.cn.registerClass("_cc.cn",_a.bx,_y.fA,_a.iT,_js.z,Sys.IDisposable,_cc.db);_cc.cW.registerClass("_cc.cW",_cc.cn);_cc.bj.registerClass("_cc.bj");_cc.cp.registerClass("_cc.cp",_cc.bj);MessageEditorViewModelFactory.registerClass("MessageEditorViewModelFactory",null,_cc.bA);_cc.l.registerClass("_cc.l");_cc.l.a.registerClass("_cc.l.a");_cc.cw.registerClass("_cc.cw",null,_cc.dc);_cc.bk.registerClass("_cc.bk",null,_cc.f,_cc.dc);_cc.PerfTraceCTQCustomKeys.registerClass("_cc.PerfTraceCTQCustomKeys");_cc.PerfTraceCTQCustomKeys.Calendar.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar");_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.BirthdayCalendar");_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.ComposeCalendarItemViewModel");_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.MeetingResponseViewModel");_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.MeetingFormsPerfMarkers");_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSurface");_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.CalendarSearch");_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.HolidayCalendars");_cc.PerfTraceCTQCustomKeys.Calendar.CalendarFeeds.registerClass("_cc.PerfTraceCTQCustomKeys.Calendar.CalendarFeeds");_cc.bY.registerClass("_cc.bY",_h.dX.$$(_g.eZ));_cc.dd.registerClass("_cc.dd",_h.p);_cc.de.registerClass("_cc.de",_cc.dd);_cc.cx.registerClass("_cc.cx",_h.bd);_cc.cy.registerClass("_cc.cy",_cc.dd);_cc.cz.registerClass("_cc.cz",_h.fL);_cc.bZ.registerClass("_cc.bZ",_h.cB);_cc.bz.registerClass("_cc.bz",_cc.dd,_h.fd);_cc.bR.registerClass("_cc.bR",null,_h.eU);_cc.bS.registerClass("_cc.bS",_cc.M);_cc.cP.registerClass("_cc.cP",null,_h.eU);_cc.cQ.registerClass("_cc.cQ",_cc.cP);_cc.bT.registerClass("_cc.bT",_cc.cP,_h.dP,_h.eU);_cc.q.registerClass("_cc.q",_a.dT,_g.dC);_cc.Z.registerClass("_cc.Z",_a.bP);_cc.ck.registerClass("_cc.ck",_cc.cv);_cc.W.registerClass("_cc.W",_a.bx);_cc.V.registerClass("_cc.V",_a.bx);_cc.cU.registerClass("_cc.cU",_a.bx);ScheduleFollowupViewModelFactory.registerClass("ScheduleFollowupViewModelFactory",null,IScheduleFollowupViewModelFactory);_cc.cl.registerClass("_cc.cl",null,_js.T);_cc.bc.registerClass("_cc.bc",null,_js.T);_cc.bs.registerClass("_cc.bs",null,_js.T);_cc.bt.registerClass("_cc.bt",null,_js.T);_cc.bd.registerClass("_cc.bd",null,_js.T);_cc.bi.registerClass("_cc.bi",null,_js.T);_cc.K.registerClass("_cc.K",_a.bx,ILocationViewModel);_cc.cX.registerClass("_cc.cX",_y.bs);_cc.bv.registerClass("_cc.bv",null,ICalendarMailComposeConductorFactory);MeetingResponseEditorViewModel.registerClass("MeetingResponseEditorViewModel",_cc.cn,_cc.da,_cc.db,_js.z);_cc.g.registerClass("_cc.g",_a.bx,IMeetingResponseViewModel);_cc.bw.registerClass("_cc.bw",null,IMeetingResponseViewModelFactory);_cc.A.registerClass("_cc.A",null,_cc.B,_y.fB);_cc.C.registerClass("_cc.C",null,_cc.B,_y.fB);_cc.D.registerClass("_cc.D",null,_cc.B,_y.fB);_cc.p.registerClass("_cc.p",null,_cc.B,_y.fB);_cc.E.registerClass("_cc.E",null,_cc.B,_y.fB);_cc.bx.registerClass("_cc.bx",_js.u);_cc.co.registerClass("_cc.co",_a.bx);_cc.y.registerClass("_cc.y",null,_cc.B,_y.fB);_cc.F.registerClass("_cc.F",null,_cc.B,_y.fB);_cc.H.registerClass("_cc.H",null,_cc.B,_y.fB);_cc.a.registerClass("_cc.a");_cc.i.registerClass("_cc.i",_js.c);_cc.cq.registerClass("_cc.cq",_js.c);_cc.L.a=_a.a.w;CalendarCoreComponent.$$cctor();_cc.h.b=_a.a.dB;_cc.h.f="ErrorCode";_cc.h.g="__type";_cc.h.e="responseCode";_cc.S.a=new _H("Item",_g.i,_cc.S);_cc.m.b=new _H("Item",_g.i,_cc.m);_cc.m.c=new _H("SendMeetingInvitations",_h.bs,_cc.m);_cc.m.d=_cc.m.g();_cc.bn.a="HTML";_cc.O.b="HTML";_cc.P.a=null;_cc.P.$$cctor();_cc.J.a=new _H("Id",_h.R,_cc.J);_cc.J.b=new _H("CalendarItemCollection",_js.f,_cc.J);_cc.o.b=new _H("CalendarEntryModel",_g.bR,_cc.o);_cc.o.c=new _H("CalendarModel",_g.bS,_cc.o);_cc.o.e=new _H("MasterCategoryList",_g.bm,_cc.o);_cc.o.a=new _H("IsCalendarFolderConfigurationRetrieved",Boolean,_cc.o);_cc.o.d=new _H("IsValid",Boolean,_cc.o,!0);_cc.ba.a=null;_cc.ba.$$cctor();_cc.j.f=new _H("ItemId",_g.g,_cc.j);_cc.j.c=new _H("GroupId",String,_cc.j);_cc.j.d=new _H("GroupName",String,_cc.j);_cc.j.e=new _H("GroupType",_g.jc,_cc.j);_cc.j.b=new _H("Calendars",_ff.z.$$(_g.bR),_cc.j);_cc.j.$$cctor();_cc.d.p=new _H("Active",Boolean,_cc.d);_cc.d.g=new _H("BrowseUrl",String,_cc.d);_cc.d.j=new _H("ICalUrl",String,_cc.d);_cc.d.h=new _H("DisplayName",String,_cc.d);_cc.d.c=new _H("EmailAddress",_g.d,_cc.d);_cc.d.l=new _H("IsInsideOrganization",Boolean,_cc.d);_cc.d.b=new _H("CurrentDetailLevel",_cc.w,_cc.d,0);_cc.d.a=new _H("AllowedDetailLevels",_js.f,_cc.d);_cc.d.d=new _H("HandlerType",_cc.cO,_cc.d,0);_cc.d.k=new _H("ID",String,_cc.d);_cc.d.e=new _H("Id",String,_cc.d);_cc.d.i=new _H("FromPermissionsTable",Boolean,_cc.d);_cc.d.n=new _H("PermissionLevel",String,_cc.d,"FreeBusy");_cc.d.o=new _H("ReadOnly",Boolean,_cc.d);_cc.d.f=new _H("ViewPrivateAppointments",Boolean,_cc.d);_cc.d.m=new _H("IsSharingWithThisRecipientDisabled",Boolean,_cc.d);_cc.d.$$cctor();_cc.U.a=_a.a.cm;_cc.bb.a=_a.a.b;_cc.bV.a=_a.a.i;_cc.r.a=_a.a.i;_cc.r.b=!1;_cc.b.b=null;_cc.b.g=0;_cc.b.f=null;_cc.b.k=null;_cc.bh.a=_a.a.b;this.b=!1;_cc.v.a.b=_a.a.o;_cc.v.d.b=_a.a.cv;_cc.bz.a=new _H("Item",_g.ICalendaring,_cc.bz);_cc.q.c=new _H("Start",_a.c,_cc.q);_cc.q.a=new _H("End",_a.c,_cc.q);_cc.q.b=new _H("IsAllDayEvent",Boolean,_cc.q);_cc.q.$$cctor();_cc.W.a=Object.keys(_g.ij.prototype);_cc.V.a=Object.keys(_g.ij.prototype);this.a=null;_cc.Y.$$cctor();_cc.K.b=[7,0];_cc.g.a=_a.a.cv;_cc.a.a=0;_cc.i.a=null;_cc.i.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.core.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.core.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
