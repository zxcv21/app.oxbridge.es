try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.controls.richtexteditor.js'] = (new Date()).getTime();
Type.registerNamespace("_zy");_zy.f=function(n){this.a=n};_zy.f.prototype={a:null,b:function(){var i=$.cookie("AppcacheVer");var n=null;var t=!1;if(i&&(n=i.split(":")).length===2&&this.a!==n[0]){this.a=n[0];t=!0}_js.Trace.logWarning(_a.a.I,"Current RTE script version: {0}",this.a);return t}};_zy.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.oN=Function.createDelegate(this,this.sH);this.oO=Function.createDelegate(this,this.sI);this.oP=Function.createDelegate(this,this.sL);this.od=Function.createDelegate(this,this.sx);this.oe=Function.createDelegate(this,this.sy);this.of=Function.createDelegate(this,this.sA);this.og=Function.createDelegate(this,this.sB);this.oQ=Function.createDelegate(this,this.sM);this.oR=Function.createDelegate(this,this.ps);this.oU=Function.createDelegate(this,this.tp);this.nY=Function.createDelegate(this,this.sd);this.oc=Function.createDelegate(this,this.po);this.nX=Function.createDelegate(this,this.pb);this.ob=Function.createDelegate(this,this.sv);this.nW=Function.createDelegate(this,this.qB);this.lu=Function.createDelegate(this,this.sE);this.lw=Function.createDelegate(this,this.sG);this.lv=Function.createDelegate(this,this.sF);this.lt=Function.createDelegate(this,this.sD);this.ls=Function.createDelegate(this,this.sC);this.lr=Function.createDelegate(this,this.sz);this.lx=Function.createDelegate(this,this.sK);this.ln=Function.createDelegate(this,this.oX);this.nZ=Function.createDelegate(this,this.pi);this.lo=Function.createDelegate(this,this.oY);this.lq=Function.createDelegate(this,this.pk);this.lp=Function.createDelegate(this,this.lB);this.oa=Function.createDelegate(this,this.pl);this.qx=Function.createDelegate(this,this.pR);this.oT=Function.createDelegate(this,this.tk);this.oS=Function.createDelegate(this,this.tj);this.iW=-1;_zy.a.initializeBase(this,[n,o,e,s,y,p,w,l,b]);this.mx=i.a();this.co=t;this.mk=r;this.oV=u;this.mh=f;this.hQ=-1;this.hX=h;this.fn=c;this.gE=t.p()&&a.a();this.iM=v;this.nE(o,p,w,l,e,s);this.cH(!0)};_zy.a.b=function(n){if(n){var i=n.rangeCount;if(i===1)return n.getRangeAt(0)}return null};_zy.a.prototype={hq:0,gH:null,gh:null,gi:null,gG:null,gg:null,gD:null,hr:null,bT:null,gJ:"3",gI:"3",gk:"",hx:"",jd:"",kb:!0,mu:!1,hy:null,iL:null,jQ:null,kB:null,iN:null,jT:null,jb:null,iS:null,iR:null,iI:null,iH:null,iJ:null,kh:null,kg:null,kf:null,jR:null,jW:null,kA:null,jV:null,jS:null,iK:null,kC:null,kd:null,iT:null,kl:null,kk:null,kj:null,km:null,kn:null,ki:null,ku:null,kv:null,kw:null,kx:null,ks:null,kt:null,kq:null,iV:null,kr:null,ky:null,kz:null,ko:null,kp:null,cq:null,dl:null,jU:null,ez:null,eH:null,hW:null,bC:null,cS:null,hR:null,lE:null,lF:null,lG:null,mw:null,lD:null,gy:!1,mv:!1,jj:!1,kc:!1,gA:!1,gC:!1,jh:!1,jl:!1,jf:!1,je:!1,jg:!1,jp:!1,jo:!1,jn:!1,jk:!1,jm:!1,fo:!1,iU:!1,iQ:!1,ja:!1,iP:!1,mt:!1,gB:!1,iO:!1,ji:!1,cw:0,dw:null,hT:null,jX:null,dz:null,mx:null,hV:null,dB:null,mk:null,oV:null,mh:null,co:null,hQ:0,hU:null,ey:null,hA:!1,gF:null,hB:null,hP:null,hX:null,hS:!1,fn:null,eI:null,gE:!1,iM:null,jc:!1,gz:!1,qQ:function(){this.iL||(this.iL=new _C(this.iv,this.G()));return this.iL},qZ:function(){this.jQ||(this.jQ=new _C(this.iw,this.G()));return this.jQ},rR:function(){this.kB||(this.kB=new _C(this.ix,this.G()));return this.kB},qR:function(){this.iN||(this.iN=new _C(this.hf,this.G()));return this.iN},rs:function(){this.jT||(this.jT=new _C(this.hh,this.G()));return this.jT},qY:function(){this.jb||(this.jb=new _C(this.fI,this.G()));return this.jb},qT:function(){this.iS||(this.iS=new _C(this.hg,this.G()));return this.iS},qS:function(){this.iR||(this.iR=new _C(this.mT,this.G()));return this.iR},qN:function(){this.iI||(this.iI=new _C(this.it,this.G()));return this.iI},qM:function(){this.iH||(this.iH=new _C(this.is,this.G()));return this.iH},qO:function(){this.iJ||(this.iJ=new _C(this.iu,this.G()));return this.iJ},ry:function(){this.kh||(this.kh=new _C(this.nf,this.G()));return this.kh},rx:function(){this.kg||(this.kg=new _C(this.ne,this.G()));return this.kg},rw:function(){this.kf||(this.kf=new _C(this.nd,this.G()));return this.kf},ra:function(){this.jR||(this.jR=new _C(this.mV,this.G()));return this.jR},ru:function(){this.jW||(this.jW=new _C(this.mX,this.G()));return this.jW},rS:function(){if(!this.kA){var n=this;this.kA=new _C(function(){n.cN()},this.G())}return this.kA},rt:function(){if(!this.jV){var n=this;this.jV=new _C(function(){n.da()},this.G())}return this.jV},rb:function(){this.jS||(this.jS=new _C(this.kZ,this.G()));return this.jS},qP:function(){this.iK||(this.iK=new _C(this.oS,this.G()));return this.iK},rT:function(){this.kC||(this.kC=new _C(this.ny,this.G()));return this.kC},rv:function(){this.kd||(this.kd=new _C(this.oT,this.G()));return this.kd},rJ:function(){this.ks||(this.ks=new _C(this.nq,this.G()));return this.ks},rK:function(){this.kt||(this.kt=new _C(this.nr,this.G()));return this.kt},rH:function(){this.kq||(this.kq=new _C(this.no,this.G()));return this.kq},rI:function(){this.kr||(this.kr=new _C(this.np,this.G()));return this.kr},rP:function(){this.ky||(this.ky=new _C(this.nw,this.G()));return this.ky},rQ:function(){this.kz||(this.kz=new _C(this.nx,this.G()));return this.kz},rF:function(){this.ko||(this.ko=new _C(this.nm,this.G()));return this.ko},rG:function(){this.kp||(this.kp=new _C(this.nn,this.G()));return this.kp},qV:function(){this.iT||(this.iT=new _C(this.mU,this.G()));return this.iT},rL:function(){this.ku||(this.ku=new _C(this.ns,this.G()));return this.ku},rM:function(){this.kv||(this.kv=new _C(this.nt,this.G()));return this.kv},rN:function(){this.kw||(this.kw=new _C(this.nu,this.G()));return this.kw},rO:function(){this.kx||(this.kx=new _C(this.nv,this.G()));return this.kx},rC:function(){this.kl||(this.kl=new _C(this.nj,this.G()));return this.kl},rB:function(){this.kk||(this.kk=new _C(this.ni,this.G()));return this.kk},rD:function(){this.km||(this.km=new _C(this.nk,this.G()));return this.km},rA:function(){this.kj||(this.kj=new _C(this.nh,this.G()));return this.kj},rE:function(){this.kn||(this.kn=new _C(this.nl,this.G()));return this.kn},rz:function(){this.ki||(this.ki=new _C(this.ng,this.G()));return this.ki},pw:function(n){if(this.iW!==n){this.iW=n;this.bk("FormatBarTabIndex")}return n},ht:function(){return this.ec(_zy.a.f)},sY:function(n){this.eb(_zy.a.f,n);return n},hs:function(){return this.ec(_zy.a.c)},sR:function(n){this.eb(_zy.a.c,n);return n},hv:function(){return this.ec(_zy.a.j)},td:function(n){this.eb(_zy.a.j,n);return n},pM:function(n){if(!this.Z)return n;n&&this.bh(!1);this.jX=n;if(null!==this.z()){_js.Trace.logInfo(this.G(),"SelectedBackColor: Set background color");var t=this;this.bb(function(){t.z().SetColor(!0,t.jX,!1)},"BackColor",!0)}return n},mp:function(n){if(!this.Z)return n;n&&this.bh(!1);this.hT=n;if(null!==this.z()){_js.Trace.logInfo(this.G(),"SelectedForeColor: Set foreground color");this.fp();var t=this;this.bb(function(){t.z().SetColor(!1,t.hT,!1)},"ForeColor",!0);this.bk("SelectedForeColor");this.fq()}return n},sW:function(n){if(this.cw!==n){this.cw=n;this.bn("EditorMode","IsFontPreview")}return n},ml:function(n){if(!this.Z)return n;this.dw&&this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"FontName: Set font name");this.fp();var t=this;this.bb(function(){t.z().SetFontFamily(t.rV(n),!1)},"FontFamily",!0);this.fq()}if(this.dw!==n){this.dw=n;this.bk("FontName")}this.bI(!1);return n},mm:function(n){if(!this.Z)return n;this.dz&&this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"FontSize: Set font size");this.fp();var t=this;this.bb(function(){t.z().SetFontSizeStyleValue(n+"pt")},"FontSize",!0);this.fq()}if(this.dz!==n){this.dz=n;this.bk("FontSize")}this.bI(!1);return n},qX:function(){if(!this.bT){this.bT=new _js.f;this.bT.a("8");this.bT.a("9");this.bT.a("10");this.bT.a("11");this.bT.a("12");this.bT.a("14");this.bT.a("16");this.bT.a("18");this.bT.a("20");this.bT.a("22");this.bT.a("24");this.bT.a("26");this.bT.a("28");this.bT.a("36");this.bT.a("48");this.bT.a("72")}return this.bT},qW:function(){if(!this.hr){this.hr=new _js.f;for(var n=0;n<_cmc.a.a.length;++n)this.hr.a(_cmc.a.a[n][0])}return this.hr},hu:function(){if(!this.hR){var n=this.bO();try{this.hR=n?n.contentWindow:null}catch(t){_js.Trace.logError(this.G(),"RTEWindow: Got exception - {0}",t.message)}}return this.hR},qU:function(){return(this.gy?1:0)|(this.gA?2:0)|(this.gC?4:0)},sV:function(n){this.hq=n;var t;this.ce(t={val:this.gH}),this.gH=t.val;var i=this;this.gH=_js.g.a().a(this.G(),"RichTextEditor.DefaultFontFlags setter.",function(){i.te()},800);return n},te:function(){(this.hq&1)>0!==this.gy&&this.eo();(this.hq&2)>0!==this.gA&&this.es();(this.hq&4)>0!==this.gC&&this.ex();this.bk("DefaultFontFlags")},pB:function(n){if(n!==this.gy){this.gy=n;this.bn("IsBoldApplied","DefaultFontFlags")}return n},pN:function(n){if(n!==this.mv){this.mv=n;this.bk("ShowBusy")}return n},pD:function(n){if(n!==this.jj){this.jj=n;this.bk("IsFormatBarHidden")}return n},pE:function(n){if(n!==this.gA){this.gA=n;this.bn("IsItalicApplied","DefaultFontFlags")}return n},pL:function(n){if(n!==this.gC){this.gC=n;this.bn("IsUnderlineApplied","DefaultFontFlags")}return n},pC:function(n){if(n!==this.jh){this.jh=n;this.bk("IsBulletApplied")}return n},pG:function(n){if(n!==this.jl){this.jl=n;this.bk("IsNumberApplied")}return n},pz:function(n){if(n!==this.jf){this.jf=n;this.bk("IsAlignLeftApplied")}return n},py:function(n){if(n!==this.je){this.je=n;this.bk("IsAlignCenterApplied")}return n},pA:function(n){if(n!==this.jg){this.jg=n;this.bk("IsAlignRightApplied")}return n},pK:function(n){if(n!==this.jp){this.jp=n;this.bk("IsSuperscriptApplied")}return n},pJ:function(n){if(n!==this.jo){this.jo=n;this.bk("IsSubscriptApplied")}return n},pI:function(n){if(n!==this.jn){this.jn=n;this.bk("IsStrikeThroughApplied")}return n},pF:function(n){if(n!==this.jk){this.jk=n;this.bk("IsLeftToRightApplied")}return n},pH:function(n){if(n!==this.jm){this.jm=n;this.bk("IsRightToLeftApplied")}return n},pu:function(n){if(n!==this.fo){this.fo=n;this.bk("EnableBreakLink")}return n},pv:function(n){if(n!==this.iU){this.iU=n;this.bk("EnableCreateLink")}return n},sU:function(n){if(n!==this.iQ){this.iQ=n;this.bk("CanUndo")}return n},jZ:function(n){if(n!==this.ja){this.ja=n;this.bk("ImageSelected")}return n},sT:function(n){if(n!==this.iP){this.iP=n;this.bk("CanRedo")}return n},bI:function(n){if(this.gB!==n){this.gB=n;this.gB||this.bh(!1);this.bk("IsMoreButtonsPopUpShown")}return n},tc:function(n){if(this.ji!==n){this.ji=n;this.bk("IsCultureRtl")}return n},sS:function(n){if(this.iO!==n){this.iO=n;this.bk("CanEditTable");this.bo?this.bo.i().j(n):this.iY().j(n);if(n){var t;this.ce(t={val:this.gh}),this.gh=t.val;var i=this;this.gh=_js.g.a().a(this.G(),"RichTextEditor.CanEditTable",function(){i.bh(!1)},100)}}return n},mr:function(n){if(this.gJ!==n){this.gJ=n;this.bk("TableRowCount")}return n},mq:function(n){if(this.gI!==n){this.gI=n;this.bk("TableColumnCount")}return n},mn:function(n){if(this.gk!==n){this.gk=n;this.bk("InsertLinkDialogUrl")}return n},ka:function(n){if(this.hx!==n){this.hx=n;this.bk("InsertAltTextDialogText")}return n},px:function(n){if(this.jd!==n){this.jd=n;this.bk("InsertTableDialogErrorMessage")}return n},iY:function(){return this.ec(_zy.a.e)},sX:function(n){this.eb(_zy.a.e,n);return n},cT:function(){return this.ec(_zy.a.i)},tb:function(n){this.eb(_zy.a.i,n);return n},dd:function(){return this.ec(_zy.a.h)},ta:function(n){this.eb(_zy.a.h,n);return n},dm:function(){return this.ec(_zy.a.g)},sZ:function(n){this.eb(_zy.a.g,n);return n},pd:function(){var i="";if(this.dA()){_js.Trace.logInfo(this.G(),"RteHtml: Get html");var o=_js.e.s(this.G(),2,"SRTE.Get_RteHtml");var h=this.bO();var e=this.hu().document.body;var f=new _cmc.s(this,e);this.ij(f);var s=this.bm().find("span[id^='OWAZWSPSpan']");s.contents().unwrap();this.gO()&&this.sP();var n="";if(this.lH()){n=this.z().GetEditableRegionHtml(this.bm().get(0),!1);_js.Trace.logInfo(this.G(),"Get RteHtml: get HTML from the engine. ")}else{n=this.bm()[0].innerHTML;_js.Trace.logInfo(this.G(),"Get RteHtml: fall back to get mail content directly. ")}this.bd.l()&&(n=n.replace(_zz.h.b,"$1$4"));var u=!1;var r=this.bm()[0];if(!!(!!r.children&r.children.length>0)){var t=r.children[0];t.tagName&&t.tagName.toLowerCase()==="div"&&t.id&&t.id.toLowerCase()==="divtagdefaultwrapper"&&(u=!0)}u||(n=String.format('<div id="{0}" style="{1}">{2}</div>',"divtagdefaultwrapper",this.iX().e(),n));i=String.format('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">{0}</head><body {1}>{2}</body></html>','<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>',this.pc(),n);this.kP(f);this.gO()&&this.oW();h=null;_js.e.e(o)}_js.Trace.logInfo(this.G(),"RteHtml: Get html, length of html = {0}",i.length);return i},mo:function(n){if(this.dA()){var c=_js.e.s(this.G(),2,"SRTE.Set_RteHtml");_js.Trace.logInfo(this.G(),"RteHtml: Set html, length = {0}",n?n.length:0);var l=this.iZ();var r=this.bm();var h=this.bN();var t;var o;this.pq(n,o={val:t}),t=o.val;r.empty();if(t){var f=t.contents();if(f&&f.length>0){var i=t.attr("style");var u=t.attr("dir");var s=r.attr("style");if(($a(u)||_js.d.b(u))&&($a(i)||_js.d.b(i))||u===h.attr("dir")&&this.pm(i,s))r.append(f);else{_js.Trace.logInfo(this.G(),"Set RteHtml: add body container to carry assigned content style and direction");var e=$("<div />");u&&e.attr("dir",u);i&&e.attr("style",i);e.append(f);r.append(e)}}}else{_js.Trace.logInfo(this.G(),"AppendContent: Append whole content since cannot extract body section from the content");r.append(n)}this.gY(new _cmc.r(this,this.by()));_js.e.e(c)}return n},iX:function(){this.hy||(this.hy=new _cmc.n(null));return this.hy},gP:function(){this.dH();var n=new _zz.N;n.b=1;n.f=this.bW();return n},rq:function(){return this.eH.y.offset().left},rr:function(){return this.eH.y.offset().top+this.eH.y.outerHeight()+1},ig:function(){return this.mk},nK:function(){if(this.dA()){var n=this.bm();return n[0]}else return null},pc:function(){var n="ltr";this.co.g()&&(n="rtl");return'dir="'+n+'"'},bm:function(){if(this.cU()){var i=this.bO();var t=$(i.contentWindow.document.body);return t.children("#MicrosoftOWAEditorRegion")}else return null},cU:function(){var t=!1;try{var n=this.bO();n&&n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.body&&n.contentWindow.document.documentElement&&(t=!0)}catch(i){_js.Trace.logWarning(this.G(),"Error accessing iframe: {0}, Callstack: {1}",i.message,i.stack)}return t},dA:function(){var n=this.bm();return!!n&&n.length===1},lz:!1,gO:function(){return this.lz},kW:function(n){this.lz=n;return n},ly:!1,fC:function(){return this.ly},gx:function(n){this.ly=n;return n},dq:function(){return!1},dj:function(n){return n},bg:function(){return"SRTE"},nz:function(){this.dn()},nB:function(n){this.mj(n)},nQ:function(n){var t=this.z();if(null!==t){t.MoveCursorMarkersToNode(n);this.dn()}},ih:function(n){if(this.bd.a()){var t=this.hu();if(t)return t.clipboardData;else{_js.Trace.logException(this.G(),Error.format("GetClipboardData: Null iframe window instance"),"Iframe window instance should not be null in GetClipboardData");return null}}else return _zz.l.prototype.ih.call(this,n)},bR:function(){return _zz.l.prototype.bR.call(this)},ca:function(n){if(this.bR()!==n){_zz.l.prototype.ca.call(this,n);this.Z&&this.eT()}return n},bh:function(n){_js.Trace.logInfo(this.G(),"Focus: Focus in RTE");if(this.bQ()){this.qK(n);this.pw(-1)}},cy:function(){},lb:function(n,t){var u=0;var f=0;var i=this.bO();if(i){var r=i.getBoundingClientRect();u=r.top;f=r.left}n.val=u;t.val=f},qE:function(){this.cf.d();var u;this.ce(u={val:this.gH}),this.gH=u.val;var f;this.ce(f={val:this.gh}),this.gh=f.val;var e;this.ce(e={val:this.gi}),this.gi=e.val;var r;this.ce(r={val:this.gG}),this.gG=r.val;var t;this.ce(t={val:this.gg}),this.gg=t.val;var i;this.ce(i={val:this.gD}),this.gD=i.val;this.nC();this.to();this.tn();this.qD();var n=this.bO();if(n){$a(this.iY())||this.iY().j(!1);try{null!==n.contentWindow&&(n.contentWindow.onerror=null);n.src="about:blank"}catch(o){}}this.hR=null;this.oZ();this.bC&&this.bC.M(!0)},tm:function(){_js.Trace.logInfo(this.G(),"Initialize: load SRTE.");this.cr&&this.cr.e||(this.cO=_a.d.b(this.G(),"MailComposeRTEInit"));this.cf.i("SRTE");this.bC.M(!1);this.ps();this.sf();this.sh();this.si()},eN:function(n){_js.Trace.logInfo(this.G(),"ExecuteCall: CallContext type = {0}",Object.getType(n).toString());if(_cmc.m.isInstanceOfType(n))this.nH(n);else if(_cmc.h.isInstanceOfType(n)){var t=n;t.a?t.a(this.st()):this.tl()}else if(_y.cG.isInstanceOfType(n)){var i=n;this.mo(i.a())}else _zz.h.prototype.eN.call(this,n)},gS:function(n){var u=this.pg();if(n.b==="text"){var t;var r,i;i=_a.u.a(u,r={val:t}),t=r.val,i;n.a=t}else n.a=u},gQ:function(n){var u=this.pd();if(n.b==="text"){var t;var r,i;i=_a.u.a(u,r={val:t}),t=r.val,i;n.a=t}else n.a=u},eo:function(){if(this.Z){this.ke();this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"BoldContent: Bold content");this.fp();var n=this;this.bb(function(){n.z().Bold()},"Bold",!0);this.fq()}this.bI(!1)}},es:function(){if(this.Z){this.ke();this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"ItalicContent: Italic content");this.fp();var n=this;this.bb(function(){n.z().Italic()},"Italic",!0);this.fq()}this.bI(!1)}},ex:function(){if(this.Z){this.ke();this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"UnderlineContent: Underline content");this.pN(!0);this.fp();var n=this;this.bb(function(){n.z().Underline()},"Underline",!0);this.fq();this.pN(!1)}this.bI(!1)}},ep:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"BulletContent: Bullet content");var n=this;this.bb(function(){n.z().BulletedList()},"Bullets",!1)}this.bI(!1)}},et:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"NumberContent: Numbering content");var n=this;this.bb(function(){n.z().NumberedList()},"Numbering",!1)}this.bI(!1)}},dk:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"IncreaseIndent: Increase indent");var n=this;this.bb(function(){n.z().IncreaseIndent()},"Indent",!1)}this.bI(!1)}},dc:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"DecreaseIndent: Decrease indent");var n=this;this.bb(function(){n.z().DecreaseIndent()},"Outdent",!1)}this.bI(!1)}},eW:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"ClearFormat: Clear format");var n=this;this.bb(function(){n.z().ClearFormatting()},"ClearFormat",!1)}this.bI(!1)}},em:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"AlignLeft: Align left");var n=this;this.bb(function(){n.z().Align(0)},"AlignLeft",!1)}this.bI(!1)}},ek:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"AlignCenter: Align center");var n=this;this.bb(function(){n.z().Align(2)},"AlignCenter",!1)}this.bI(!1)}},en:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"AlignRight: Align right");var n=this;this.bb(function(){n.z().Align(1)},"AlignRight",!1)}this.bI(!1)}},fl:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"Superscript: Super script");var n=this;this.bb(function(){n.z().Superscript()},"Superscript",!0)}this.bI(!1)}},fk:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"Subscript: Sub script");var n=this;this.bb(function(){n.z().Subscript()},"Subscript",!0)}this.bI(!1)}},fj:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"StrikeThrough: StrikeThrough text");var n=this;this.bb(function(){n.z().StrikeThrough()},"StrikeThrough",!0)}this.bI(!1)}},fL:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"LeftToRight: Set left to right");var n=this;this.bb(function(){n.z().SetDirection(!0)},"LeftToRight",!1)}this.bI(!1)}},fN:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"RightToLeft: Set right to left");var n=this;this.bb(function(){n.z().SetDirection(!1)},"RightToLeft",!1)}this.bI(!1)}},cN:function(){var n=!1;if(this.Z&&null!==this.z()){_js.Trace.logInfo(this.G(),"Undo: Undo text");this.bh(!1);n=_zz.l.prototype.cN.call(this);if(n){this.bd.a()&&this.tr();this.bp(1);this.bS();this.cf.a("Undo");this.z().HidePasteFlyout()}}this.bI(!1);return n},da:function(){var n=!1;if(this.Z&&null!==this.z()){_js.Trace.logInfo(this.G(),"Redo: Redo text");this.bh(!1);n=_zz.l.prototype.da.call(this);if(n){this.bp(1);this.cf.a("Redo")}}this.bI(!1);return n},pk:function(){if(this.Z){this.bh(!1);if(null!==this.z()&&!_js.d.a(this.gk)){var t=this.nA(this.gk);var n=this.pg();_js.Trace.logInfo(this.G(),"InsertLink: Insert link");var r=this.z().CreateLinkOptions(t,_js.d.b(n)?t:n);var i=this;this.bb(function(){i.z().InsertOrUpdateLink(r)},"ManualLink",!1)}this.oY();this.bI(!1)}},eX:function(n){if(this.z()&&!this.fo&&!_js.d.b(n)){this.mn(n);this.pk()}},pi:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"InsertAltText: Insert image alt text");var n=this;this.bb(function(){n.z().SetImageAlt(n.hx)},"AddImageAltText",!1)}this.oX();this.bI(!1)}},iD:function(n){if(this.lA()&&this.z()&&this.z().get_IsImageSelected()){this.ka(n);this.pi()}},fm:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"UnLink: Remove link");var n=this;this.bb(function(){n.z().RemoveLink()},"RemoveLink",!1)}this.bI(!1)}},tk:function(){this.bn("MoreButtonsPopupXPosition","MoreButtonsPopupYPosition");this.bI(!0);this.ez.V()},ga:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableMergeAbove: Table merge above");var n=this;this.bb(function(){n.z().MergeAbove()},"TableMergeAbove",!1)}}},gb:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableMergeBelow: Table merge below");var n=this;this.bb(function(){n.z().MergeBellow()},"TableMergeBelow",!1)}}},gc:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableMergeLeft: Table merge left");var n=this;this.bb(function(){n.z().MergeLeft()},"TableMergeLeft",!1)}}},gd:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableMergeRight: Table merge right");var n=this;this.bb(function(){n.z().MergeRight()},"TableMergeRight",!1)}}},fY:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableInsertLeft: Table insert left");var n=this;this.bb(function(){n.z().InsertColumnLeft()},"TableInsertLeft",!1)}}},fZ:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableInsertRight: Table insert right");var n=this;this.bb(function(){n.z().InsertColumnRight()},"TableInsertRight",!1)}}},fW:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableInsertAbove: Table insert above");var n=this;this.bb(function(){n.z().InsertRowAbove()},"TableInsertAbove",!1)}}},fX:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableInsertBelow: Table insert below");var n=this;this.bb(function(){n.z().InsertRowBelow()},"TableInsertBelow",!1)}}},ge:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableSplitHorizontal: Table split horizontally");var n=this;this.bb(function(){n.z().SplitHorizontal()},"TableSplitHorizontally",!1)}}},gf:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableSplitVertical: Table split vertically");var n=this;this.bb(function(){n.z().SplitVertical()},"TableSplitVertically",!1)}}},fV:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableDeleteRow: Table delete row");var n=this;this.bb(function(){n.z().DeleteRow()},"TableDeleteRow",!1)}}},fU:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableDeleteColumn: Table delete column");var n=this;this.bb(function(){n.z().DeleteColumn()},"TableDeleteColumn",!1)}}},fR:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableApplyLightLines: Table apply light lines");var n=this;this.bb(function(){n.z().SetTableStyle("lightlines",!0)},"TableStyleLightLines",!1)}}},fQ:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableApplyLightBands: Table apply light bands");var n=this;this.bb(function(){n.z().SetTableStyle("lightbands",!0)},"TableStyleLightBands",!1)}}},fP:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableApplyGridStyle: Table apply grid style");var n=this;this.bb(function(){n.z().SetTableStyle("grid",!0)},"TableStyleGrid",!1)}}},fT:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableClearStyle: Table clear style");var n=this;this.bb(function(){n.z().SetTableStyle("clear",!0)},"TableStyleClear",!1)}}},fS:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableApplyTwoTones: Table apply two tones");var n=this;this.bb(function(){n.z().SetTableStyle("twotones",!0)},"TableStyleTwoTones",!1)}}},fO:function(){if(this.Z){this.bh(!1);if(null!==this.z()){_js.Trace.logInfo(this.G(),"TableApplyDefaultStyle: Table apply defualt style");var n=this;this.bb(function(){n.z().SetTableStyle("default",!0)},"TableStyleDefault",!1)}}},pR:function(){_js.Trace.logInfo(this.G(),"ShowInsertTableDialog: Show insert table dialog");var n=new _bc.i;_y.E.isInstanceOfType(this.E())&&n.w(this.E().c());this.tb(n);this.cT().k(_nbs.a.dS);this.mr("3");this.mq("3");this.cT().h.a(new _ff.f(new _C(this.oa,this.G()),_u.P.T,null,!0));this.cT().h.a(new _ff.f(new _C(this.lp,this.G()),_u.R.ho,null));this.cT().t(new _C(this.lp,this.G()));this.cT().m(this);this.cT().g(!0)},lm:function(){_js.Trace.logInfo(this.G(),"ShowInsertLinkDialog: Show insert link dialog");var n=new _bc.i;_y.E.isInstanceOfType(this.E())&&n.w(this.E().c());this.ta(n);this.dd().k(_nbs.a.kq);this.mn("");this.dd().h.a(new _ff.f(new _C(this.lq,this.G()),_u.P.T,null,!0));this.dd().h.a(new _ff.f(new _C(this.lo,this.G()),_u.R.ho,null));this.dd().t(new _C(this.lo,this.G()));this.dd().bi(new _C(this.lq,this.G()));this.dd().m(this);this.dd().g(!0)},tj:function(){_js.Trace.logInfo(this.G(),"ShowInsertAltTextDialog: Show insert image alt text dialog");var n=new _bc.i;_y.E.isInstanceOfType(this.E())&&n.w(this.E().c());this.sZ(n);this.dm().k(_nbs.a.kt);null!==this.z()?this.ka(this.z().QueryImageAltText()):this.ka("");this.dm().h.a(new _ff.f(new _C(this.nZ,this.G()),_u.P.T,null,!0));this.dm().h.a(new _ff.f(new _C(this.ln,this.G()),_u.R.ho,null));this.dm().t(new _C(this.ln,this.G()));this.dm().m(this);this.dm().g(!0)},fJ:function(){if(this.Z&&null!==this.z()){_js.Trace.logInfo(this.G(),"DeleteTable: Delete table");var n=this;this.bb(function(){n.z().DeleteTable()},"TableDeleteTable",!1)}},fi:function(n){this.mp(n)},dv:function(n){this.pM(n)},ev:function(n){this.ml(n)},ew:function(n){this.mm(n)},nT:function(){return this.z()&&this.z().get_IsImageSelected()?this.z().QueryImageAltText():null},hn:function(n,t,i){if(this.Z&&this.z()){this.bh(!1);var r=this;this.bb(function(){r.z().InsertTable(n,t)},i,!1)}},pl:function(){if(this.Z){var i=parseInt(this.gJ);var t=parseInt(this.gI);var n;if(this.cT()&&this.cT().i){if(!(i>0&&t>0)||i!==Number.parseInvariant(this.gJ)||t!==Number.parseInvariant(this.gI)){this.px(_nbs.a.KP);return}n="TableInsertWithDialog"}else n="TableQuickInsert";this.lB();this.hn(i,t,n)}},lB:function(){if(this.cT()&&this.cT().i){this.cT().g(!1);this.px("")}},oY:function(){this.dd()&&this.dd().i&&this.dd().g(!1)},oX:function(){this.dm()&&this.dm().i&&this.dm().g(!1)},bB:function(){var t=new _ff.d;if(!this.bd.j()){var u=this;t.c(this.cz(4,"A",new _C(function(){u.pt()},this.G())))}var r=this;t.c(this.cz(4,"K",new _C(function(){r.qJ()},this.G())));var n=new _fc.g;n.a(t.h());var i=_zz.h.prototype.bB.call(this);return i?i.concat(n):[n]},qy:function(){var n=this.bO();if(this.cU()){this.dB=new _zy.a.q(n.contentWindow.document.documentElement);this.dB.H(this.bB());this.dB.el(this.bC);this.dB.br()}},fM:function(){_zz.h.prototype.fM.call(this);var t=this.z();if(t&&t.get_PasteInProgress()){var n;this.ce(n={val:this.gD}),this.gD=n.val;var i=this;this.gD=_js.g.a().a(this.G(),"Editor.OnLinkPasted",function(){i.fM()},500)}else this.iA()},qz:function(){var n=this.gj();this.cu&&n?this.cu.c(n.documentElement):_js.Trace.logWarning(this.G(),"Editor - BindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible or no droppable behavior attached.")},tn:function(){var n=this.gj();this.cu&&n?this.cu.q(n.documentElement):_js.Trace.logWarning(this.G(),"Editor - UnbindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible or no droppable behavior attached.")},sE:function(n){var t=new _a.Q(n);!t.g()||n.which!==39&&n.which!==37||t.n()||t.k()||this.qF()},sC:function(n){if(null!==this.z()&&!this.he(n)){var i=new _a.Q(n);var t=i.a();var o=t===(this.bd.e()?0:229);var e=!1;if(!this.gz&&_zz.f.b(this.cI())&&(t===46||t===8||o)){this.bx(!0);e=!0}this.gz=o||this.gz&&(i.g()||i.k());(t===46||t===8||o&&this.gz)&&(e=!0);e&&this.mE(0);if(t===9){_js.Trace.logInfo(this.G(),"OnKeyDownOnContentEditableArea: handling TAB");if(this.z().get_IsCursorValid()){var r=this.z().GetCursorParentElement();var h=!0;if(this.hz(r,"LI"))return;else if(this.hz(r,"BLOCKQUOTE")||this.hz(r,"OL")||this.hz(r,"UL"))i.g()?this.dc():this.dk();else if(i.g()){var s=new _cmc.A(this,!0);this.im(s);h=s.c}else{var l=$("<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>");this.dn();this.z().InsertNodeBeforeCursor(l.get(0).firstChild);this.dn()}h&&this.cG(n)}}else if(t===8){_js.Trace.logInfo(this.G(),"OnKeyDownOnContentEditableArea: handling BACKSPACE");if(this.z().get_IsCursorValid()){this.ms(i.a());var f=this.z().GetCursorParentElement();if(this.hz(f,"BLOCKQUOTE")&&this.z().get_IsSelectionEmpty())for(var u=0;u<f.childNodes.length;u++){var c=f.childNodes[u];if(this.su(c))continue;else if(c.id==="ms-rterangecursor-start"){this.dc();this.cG(n);break}else break}}}else if(t===46){_js.Trace.logInfo(this.G(),"OnKeyDownOnContentEditableArea: handling DELETE");this.z().get_IsCursorValid()&&this.ms(i.a())}else if(t===_ff.k.a||t===_ff.k.b||t===38||t===40){_js.Trace.logInfo(this.G(),"OnKeyDownOnContentEditableArea: handling Arrow (LEFT, RIGHT, UP, DOWN)");this.bd.a()&&this.z().get_IsCursorValid()&&this.ms(i.a())}else if(t===32||t===13){_js.Trace.logInfo(this.G(),"OnKeyDownOnContentEditableArea: handling SPACE and ENTER");this.iA()}}},sD:function(n){if(null!==this.z()){this.ph();var i=new _a.Q(n);var t=i.a();if(_zz.f.e(n)){(_zz.f.b(this.cI())||t===13||t===32&&!_js.d.a(this.iB().a))&&this.bx(!0);this.bp(0)}}},sF:function(n){if(!this.he(n)){this.gz=!1;var t=n.target;t.tagName==="A"&&new _a.Q(n).k()&&this.nN(n);_zz.d.a(t)&&new _a.Q(n).k()&&this.nM(n)}},sG:function(n){var t=n.target;this.nD();t.tagName==="A"&&this.nO(n)},qF:function(){var n=this.cl();var t=!1;if(n.focusOffset>n.anchorOffset){if(n.focusOffset-n.anchorOffset==1&&n.anchorNode.hasChildNodes()&&n.anchorNode.childNodes.length>n.anchorOffset&&n.anchorNode.childNodes[n.anchorOffset].nodeName==="IMG"){n.anchorNode.childNodes[n.anchorOffset].click();t=!0}}else if(n.anchorOffset>n.focusOffset&&n.anchorOffset-n.focusOffset==1&&n.focusNode.hasChildNodes()&&n.focusNode.childNodes.length>n.focusOffset&&n.focusNode.childNodes[n.focusOffset].nodeName==="IMG"){n.focusNode.childNodes[n.focusOffset].click();t=!0}!t&&this.bd.a()&&(!n.focusNode.hasChildNodes()&&n.focusNode.nextSibling&&n.focusNode.nextSibling.nodeName==="IMG"?n.focusNode.nextSibling.click():!n.anchorNode.hasChildNodes()&&n.anchorNode.nextSibling&&n.anchorNode.nextSibling.nodeName==="IMG"?n.anchorNode.nextSibling.click():n.anchorNode.hasChildNodes()&&n.anchorNode.childNodes.length>n.anchorOffset&&n.anchorNode.childNodes[n.anchorOffset].nodeName==="IMG"?n.anchorNode.childNodes[n.anchorOffset].click():n.focusNode.hasChildNodes()&&n.focusNode.childNodes.length>n.focusOffset&&n.focusNode.childNodes[n.focusOffset].nodeName==="IMG"&&n.focusNode.childNodes[n.focusOffset].click())},qA:function(){_js.Trace.logInfo(this.G(),"BindRichTextEditorEvents: BindRichTextEditorEvents.");var n=this.bN();if(n){_a.bl.d(n);n.bind("keyup",this.lx);n.attr("aria-label",this.cm)}if(this.dA())if(this.cw===1){this.bm().bind("mousedown",this.cx);this.bm().bind("mouseup",this.cx)}else{this.bm().bind("focus",this.lr);this.bm().bind("keydown",this.ls);this.bm().bind("keypress",this.lt);this.bm().bind("mousedown",this.lv);this.bm().bind("paste",this.fr);this.bm().bind("mouseup",this.lw);this.bm().bind("keyup",this.lu);this.bm().delegate('div[id=^"OWATemporaryImageDivContainer"]',"click",this.hj);this.cb.bj(this.bm());if(this.fC()){this.bm().bind("copy",this.cx);this.bm().bind("cut",this.cx);this.bm().bind("dragstart",this.cx)}else this.bm().bind("cut",this.hi)}},to:function(){_js.Trace.logInfo(this.G(),"UnbindRichTextEditorEvents: UnbindEditorBodyEventHandlers.");var n=this.bN();if(n){n.unbind("keyup",this.lx);$a(_a.bl.a)||_a.bl.a.i(n)}if(this.dA())if(this.cw===1){this.bm().unbind("mousedown",this.cx);this.bm().unbind("mousedown",this.cx)}else{this.bm().unbind("focus",this.lr);this.bm().unbind("keydown",this.ls);this.bm().unbind("keypress",this.lt);this.bm().unbind("mousedown",this.lv);this.bm().unbind("paste",this.fr);this.bm().unbind("keyup",this.lu);this.bm().unbind("mouseover",this.lw);this.bm().undelegate('div[id=^"OWATemporaryImageDivContainer"]',"click",this.hj);this.cb.bw(this.bm());if(this.fC()){this.bm().unbind("copy",this.cx);this.bm().unbind("cut",this.cx);this.bm().unbind("dragstart",this.cx)}else this.bm().unbind("cut",this.hi)}},sK:function(n){var i=new _a.Q(n);var t=i.a();t===46||t===8?this.sc(n):(t===_ff.k.a||t===_ff.k.b||t===38||t===40)&&this.sb(n);this.ph()},bN:function(){var n=this.mg();return n?$(n):null},mg:function(){if(this.cU()){var n=this.bO();return n.contentWindow.document.body}else return null},by:function(){var n=this.bm();return n&&n.length>0?n.get(0):null},g:function(){this.z().ForceUpdateCursorMarkersToCurrentSelection();return new _zz.X(this.by().innerHTML)},h:function(n){this.by().innerHTML=n.b;this.pS()},cl:function(){var n=null;var t=this.gj();t&&(n=t.getSelection());if(!n&&this.hu()){_js.Trace.logWarning(this.G(),"GetSelection: executing fallback path to get selection from window.");n=this.hu().getSelection();n||_js.Trace.logWarning(this.G(),"GetSelection: fallback path to get selection from window is not successful.")}return n},hp:function(n){var t=this.cl();if(t&&this.z()){t.removeAllRanges();t.addRange(n);this.z().ForceUpdateCursorMarkersToCurrentSelection()}},gj:function(){if(this.cU()){var n=this.bO();return n.contentWindow.document}else{_js.Trace.logWarning(this.G(),"GetDocument: IFrameElement is null");return null}},pj:function(n,t){for(var e=this.gj(),f=t.get(),o=f.length,i=0;i<o;++i){var u=f[i];n.collapse(!1);if($a(n.insertNode))$a(n.pasteHTML)||n.pasteHTML(u.innerHTML);else{var r=e.importNode(u,!0);n.insertNode(r);n.setStartAfter(r)}}},mj:function(n){null!==this.z()&&this.z().MoveCursorMarkersBeforeNode(n)},dn:function(){null!==this.z()&&this.z().UpdateCursorMarkersToCurrentSelection()},pS:function(){var r=this.bO();var u=r.contentDocument.getElementById("ms-rterangecursor-start");var i=r.contentDocument.getElementById("ms-rterangecursor-end");if(u&&i){var n=this.ds();n.setEndBefore(i);n.setStartAfter(u);var t=this.cl();t.removeAllRanges();t.addRange(n);this.z().ForceUpdateCursorMarkersToCurrentSelection()}},K:function(){_js.Trace.logInfo(this.G(),"OnApplyTemplate: OnApplyTemplate");_js.b.prototype.K.call(this);if(!$a(this.F)){this.iV=this.F.a("FontNameOptions");if($a(this.iV))throw Error.invalidOperation("A control bar with ID FontNameOptions is required for the editor to work.");this.cq=this.F.a("EditorFormatBar");if($a(this.cq))throw Error.invalidOperation("A format bar with ID EditorFormatBar is required for the editor to work.");var t=this;this.cq.y.keydown(function(n){var r=!1;$a(n.altKey)||(r=n.altKey);var i=!1;$a(n.ctrlKey)||(i=n.ctrlKey);r&&!i&&n.which===75&&t.bh(!1)});this.jU=this.F.a("PasteModeMenuStyleElement");if(!this.jU)throw Error.invalidOperation("A object with ID PasteModeMenuStyleElement is required for the editor to work.");this.dl=this.F.a("ClickableArea");if(!this.dl)throw Error.invalidOperation("A clickable area with ID ClickableArea is required for the editor to work.");var i=this;this.dl.y.focus(function(){i.dp(!1)});this.dl.bf(32);this.eH=this.F.a("MoreDropDownButton");if(!this.eH)throw Error.invalidOperation("A button with ID MoreDropDownButton is required for the editor to work.");this.hW=this.F.a("TableButton");if(!this.hW)throw Error.invalidOperation("A button with ID TableButton is required for the editor to work.");this.ez=this.F.a("MoreButtonsPopup");if(!this.ez)throw Error.invalidOperation("A popup with ID MoreButtonsPopup is required for the editor to work.");this.bC=this.F.a("EditorBody");if($a(this.bC))throw Error.invalidOperation("A body with ID EditorBody is required for the editor to work.");this.bC.cd(2);var n=this;this.bC.y.blur(function(){n.bd.a()&&(n.kb=!0);n.ke()});this.bC.bf(524288);this.bd.a()&&this.bC.y.bind("focusin",this.nW);this.bC.y.load(this.ob);this.cS=this.F.a("EditorWrapper");if($a(this.cS))throw Error.invalidOperation("A body with ID EditorWrapper is required for the editor to work.");this.cq.y[0].id="EditorFormatBar";this.bO().id="EditorBody";this.ez.y[0].id="MoreButtonsPopup"}},O:function(){_js.Trace.logInfo(this.G(),"OnDeactivate: Deactivation");this.qE();_js.b.prototype.O.call(this);this.db(!1)},T:function(){_js.b.prototype.T.call(this);this.w("RichTextEditorView")},dH:function(){this.Z&&this.cB(this.pd())},J:function(){_js.b.prototype.J.call(this);this.tm()},bM:function(){this.P()&&this.bz();_js.b.prototype.bM.call(this)},bl:function(){_js.Trace.logInfo(this.G(),"InternalDispose: InternalDispose");if(this.bC){this.bC.y.unbind("focusin");this.bC.y.unbind("load");this.bC.y.unbind("blur");this.bC.ck(524288);this.oZ();this.bC=null}if(this.cq){this.cq.y.unbind("keydown");this.cq=null}if(this.dl){this.dl.y.unbind("focus");this.dl=null}_zz.l.prototype.bl.call(this)},pb:function(){_js.Trace.logInfo(this.G(),"FinalizeRichTextEditorInitialization: FinalizeRichTextEditorInitialization.");var u=!1;this.hS&&this.dA()&&this.lH()&&(u=!0);if(u){var f=_js.e.s(this.G(),2,"SRTE.FinalizeRichTextEditorInitialization");this.jc=!0;this.se();this.th();this.tc(this.co.g());this.ti();if(this.gO()){_js.Trace.logInfo(this.G(),"ApplyPrintRestriction: Applied printing restriction with no print stylesheet.");this.oW()}this.cm&&this.bC.W(this.cm);this.bC.y.attr("aria-role","textbox");var n=this.cr;var r=null;if(n)if(n.b===2){_js.Trace.logInfo(this.G(),"Content transitioned through CED (from Water)");r=n.m}else{_js.Trace.logInfo(this.G(),"Content transitioned through string (PlainTextEditor)");this.mo(n.n())}else if(this.bW()){_js.Trace.logInfo(this.G(),"Loading content from Content.");this.mo(this.bW())}else _js.Trace.logInfo(this.G(),"No Content. Editor starts with empty content.");this.bZ()||this.kY(new _zz.Q(this,r));var e=this.bO();this.gY(new _cmc.r(this,this.by()));this.qA();this.qy();this.qz();this.pQ();this.bW()||n||this.sN();n?n.l(null):this.so();if(this.cO){_a.d.a(this.cO);this.cO=null}n&&n.b===2&&n.g&&this.pS();this.cw!==1&&this.cb.C(this.mg(),!0);var i=this.gj();this.bd.a()&&i&&i.execCommand("AutoUrlDetect",!1,!1);this.db(!0);if(n){n.k?n.k():this.bZ().a();n=null}this.cr=null;_js.e.e(f)}else{var t;this.ce(t={val:this.gi}),this.gi=t.val;this.gi=this.hX.a(this.G(),"RichTextEditor.FinalizeRichTextEditorInitialization",this.nX,100)}},qD:function(){try{var n=this.z();if(n){n.RemoveEventHandlers();n.set_TableApplyStyleToElementCallback(null);n.RemoveAsIsPasteMode();n.RemoveCleanPasteMode();n.RemovePlainTextPasteMode();n.set_DefaultPasteModeResolver(null)}}catch(t){}this.eI&&this.cU()&&this.eI.Dispose();this.eI=null;this.ey&&this.cU()&&this.ey.Dispose();this.ey=null},oZ:function(){try{if(this.dB){this.dB.H(null);this.dB.dispose();this.dB=null}this.hS=!1}catch(n){_js.Trace.logInfo(this.G(),"DisposeiframeDocUIObject: Exception in disposing iframe - {0}",n.message)}},se:function(){_js.Trace.logInfo(this.G(),"HookUpEditorEngine: Hook up editor engine");try{if(this.cU()){var f=this.bO();var u=f.contentWindow;this.eI=null;var n=null;n=new u.RTE.RichTextEditorEngineFacade;n.Load();this.eI=n;_js.Trace.logInfo(this.G(),"HookUpEditorEngine: Engine is hooked up")}else throw Error.format("Iframe is not accessible in HookUpEditorEngine!");}catch(e){_js.Trace.logException(this.G(),e,"HookUpEditorEngine: Exception in hooking up engine "+e.message)}var i=this.z();this.sg();var t=this.hw(_zy.b.B());t.className+=" ms-owa-paste-option-icon";var r=this.hw(_b.d.a());r.className+=" ms-owa-paste-option-icon";this.ey=i.CreateEditorUIServices(_nbs.a.kS,t,r);this.ey.set_LogErrorCallBackFunction(this.oc);this.ey.set_PasteCompletionCallBackFunction(this.nY);this.ey.set_OnUpdateFormatBar(this.oU);i.set_TableApplyStyleToElementCallback(_zy.a.a.c)},pa:function(n){if(this.cO){var i=this.cO;var t;_zz.a.e(t={val:i},n),i=t.val;this.cO=null}else if(this.cr&&this.cr.e){this.cr.l(n);this.cr=null}},qB:function(n){if(this.kb){this.kb=!1;var t;this.ce(t={val:this.gg}),this.gg=t.val;var i=this;this.gg=_js.g.a().a(this.G(),"RichTextEditor.CallFocusForIE",function(){i.dp(!1)},50)}},qL:function(){if(this.cU()){var n=this.bO().contentWindow;n&&n.focus()}},qK:function(n){_js.Trace.logInfo(this.G(),"FocusOnRte: FocusOnRte");var t=this.z();if(null!==t){this.qL();this.pr();if(this.jc){t.SetInitialFocus();this.jc=!1}(this.bd.g()||this.bd.j())&&!this.bd.p()&&t.ForceUpdateCursorMarkersToCurrentSelection();this.dn()}},sQ:function(n){if($a(n))return n;else{_js.Trace.logInfo(this.G(),"RemovePStyles: RemovePStyles");return n.replace(_zy.a.l,"$1").replace(_zy.a.m,"")}},pq:function(n,t){_js.Trace.logInfo(this.G(),"ProcessContent: Process content to extract head and body from html fragment");n=this.sQ(n);t.val=_zz.o.a(n);if(t.val){var i=t.val.find('div[id^="Signature"]');i&&i.length>0&&this.lg(t.val)}},pg:function(){var n=null;if(!this.cP())return null;if(null!==this.z()){var t=this.z().GetCurrentStateNode();t&&(n=this.bd.a()&&Number.parseInvariant($.browser.version)<=8?t.nodeValue:this.z().get_SelectedHtml())}return n},sq:function(){return this.bd.a()&&document.documentMode===11},sr:function(){return this.bd.a()&&Number.parseInvariant($.browser.version)<=8},tl:function(){_js.Trace.logInfo(this.G(),"StoreSelectionAndSelectionStartForInsertApis: StoreSelectionAndSelectionStartForInsertApis");var t=this.cl();var n=_zy.a.b(t);n&&(this.hV=n.cloneRange())},st:function(){_js.Trace.logInfo(this.G(),"IsRangeChangedAfterInsertApis: IsRangeChangedAfterInsertApis");var r=this.cl();var n=_zy.a.b(r);if(n&&this.hV){var i=n.compareBoundaryPoints(0,this.hV);var t=n.compareBoundaryPoints(2,this.hV);return!!i||!!t}else return!1},ke:function(){try{var t=this.cl();var n=_zy.a.b(t);n&&(this.hU=n.cloneRange())}catch(i){_js.Trace.logError(this.G(),"StoreSelection: Got exception - {0}",i.message)}},pr:function(){try{if(this.hU){var n=this.cl();n.removeAllRanges();n.addRange(this.hU);this.hU=null}}catch(t){_js.Trace.logError(this.G(),"StoreSelection: Got exception - {0}",t.message)}},pQ:function(){if(this.cU()){var n=this.bO();var i=this.bQ()&&!_js.d.a(this.cv)?this.cv:"-1";var t=parseInt(i);n.tabIndex=t;if(t!==-1&&this.bd.a()){n.tabIndex=1e4;n.contentWindow.document.documentElement.tabIndex=-1;n.contentWindow.document.body.tabIndex=t;n.contentWindow.document.body.style.outline="none"}}},cI:function(){var n=this.cl();return n&&n.rangeCount>0?n.getRangeAt(0):null},fK:function(){var t=_zz.h.prototype.fK.call(this);var n=this.rW();if(t&&n){var r=new _zz.M(t.b.a+n.top,t.b.b+n.top,t.b.c+n.left);var i=new _zz.M(t.a.a+n.top,t.a.b+n.top,t.a.c+n.left);return new _zz.P(r,i)}return null},ds:function(){var t=this.gj();var n=null;if(t){_js.Trace.logInfo(this.G(),"CreateRange: Creating range from editor document");n=t.createRange()}else{_js.Trace.logWarning(this.G(),"CreateRange: iframe document is null, creating range from current document");n=document.createRange()}return n},iG:function(n,t){var i=t.href;var u;var f="%2C/";this.bx(!0);if(!_js.d.a(i)&&i.endsWith(f)){u=i.substr(i.length-4,4);i=i.substr(0,i.length-4);i=i+"/";t.href=i}n.deleteContents();this.pj(n,$(t));n.collapse(!1);var r=this.cl();r.removeAllRanges();r.addRange(n);this.dn();this.bp(2)},ph:function(){this.hA=!1;this.hB=null;this.gF=null;this.hP=null},ms:function(n){if(!this.de){_js.Trace.logInfo(this.G(),"RTE: Skipping SetEventVariablesOnContentEditableAreaKeyDown because previews are disabled");return}if(null===this.z()){_js.Trace.logInfo(this.G(),"RTE: Skipping SetEventVariablesOnContentEditableAreaKeyDown because engine is inaccessible.");return}this.hA=this.z().get_StartMarker().nextSibling===this.z().get_EndMarker();this.z().get_EndMarker().nextSibling&&_b.i.a(this.z().get_EndMarker().nextSibling.id,"LPBorder")?this.gF=this.z().get_EndMarker().nextSibling:this.z().get_StartMarker().previousSibling&&_b.i.a(this.z().get_StartMarker().previousSibling.id,"LPBorder")&&(this.hB=this.z().get_StartMarker().previousSibling);n===8&&(this.hP=this.qH(this.z().get_StartMarker()))},qH:function(n){var r=null;if(null!==this.z())for(var e=this.bd.g(),u=this.z().CreateDOMTreePosition(n,0),f=0;f<5;f++){if(!u.MoveToPreviousElement())break;var t=u.GetCurrentNode();if(!t||!t.tagName)break;var i=t.tagName.toUpperCase();if(i!=="P"&&i!=="BR"){if(_b.i.a(t.id,"LPBorder")){r=t;break}if(i!=="DIV"||!e)break}}return r},sc:function(n){if(!this.de){_js.Trace.logInfo(this.G(),"RTE: Skipping HandleDeleteBackspaceOnKeyUpForPreview because previews are disabled");return}if(this.bd){var t=this.qI();if(t)if(this.hA&&!this.gF)this.qG(t,n);else{var i=!!this.hP&&this.hP===t;this.pp(t,i)}}},sb:function(n){if(!this.de){_js.Trace.logInfo(this.G(),"RTE: Skipping HandleArrowKeyOnKeyUpForPreview because previews are disabled");return}if(null===this.z()){_js.Trace.logInfo(this.G(),"RTE: Skipping HandleArrowKeyOnKeyUpForPreview because engine is inaccessible");return}if(this.bd&&this.bd.a()){var t=null;var f=new _a.Q(n);var r=f.a();var u=this.me();u&&(t=_b.i.b(u));if(t){t.parentNode&&t.parentNode.nodeName.toUpperCase()==="P"&&t.parentNode.children.length===1&&(t=t.parentNode);var e=r===40;this.pp(t,e)}if(!this.hA)return;var i=null;r===_ff.k.b&&this.gF?i=this.gF:r===_ff.k.a&&this.hB&&(i=this.hB);if(i&&this.cP()){this.z().MoveCursorMarkersToNode(i);this.dn();this.dE.a(_a.bE,new _a.bE(_nbs.a.Bm+i.innerText.replace(_nbs.a.WX,"")))}}},qI:function(){var n=this.me();return n?_b.i.b(n):null},qG:function(n,t){if(null!==this.z()){this.cG(t);var r=this.z().CreateDOMTreePosition(n,0);r.MoveToPreviousElement();var i=r.GetCurrentNode();this.nF(n);if(i){this.z().MoveCursorMarkersAfterNode(i);this.dn()}}},pp:function(n,t){t?null!==this.z()&&this.z().MoveCursorMarkersAfterNode(n):this.mj(n);this.dn()},tr:function(){if(!this.de){_js.Trace.logInfo(this.G(),"RTE: Skipping link preview bind because previews are disabled");return}this.tq(this.bm().find("[id^='LPBorder']"))},tq:function(n){for(var i=0;n&&i<n.length;++i){var t=n[i];t.previousSibling.tagName==="P"&&$(t.previousSibling).remove();var r=t.parentNode;r&&r.tagName!=="P"&&$(t).wrap("<p></p>")}},su:function(n){return n.nodeValue&&n.nodeValue.length===1&&n.nodeValue.charAt(0)==="​"?!0:!1},pm:function(n,t){if($a(n)||_js.d.b(n))return!0;for(var s=this.pe(n),a=this.pe(t),e=s,l=e.length,i=0;i<l;++i){for(var c=e[i],u=!1,f=a,o=f.length,r=0;r<o;++r){var h=f[r];if(c===h){u=!0;break}}if(!u)return!1}return!0},pe:function(n){var t=null;if(!$a(n)){t=n.split(";");for(var i=0;i<t.length;++i)t[i]=t[i].trim()}return t},sN:function(){_js.Trace.logInfo(this.G(),"PreserveParagraph: Preserve and add P tag to workaround invisible text bug in IE");var i="<P><BR></P>";var t=this.bm();if(!this.cr){var n=this.mf(t,_zy.a.d);if(n&&(!n.children().length||n.children()[0].tagName!=="P")){_js.Trace.logInfo(this.G(),"PreserveParagraph: inserting P under default style span.");this.eP(i,!0,!1)}else if(!n&&(!t.children().length||t.children()[0].tagName!=="P")){_js.Trace.logInfo(this.G(),"PreserveParagraph: inserting P under content editable div.");this.eP(i,!0,!1)}}},hz:function(n,t){while(n&&n.tagName!==t&&n.tagName!=="BODY")n=n.parentNode;return!!n&&n.tagName===t},tf:function(n){if(this.dw!==n){this.dw=n;this.bk("FontName")}},tg:function(n){if(this.dz!==n){this.dz=n;this.bk("FontSize")}},sp:function(){var t=_js.e.s(this.G(),2,"SRTE.InternalInitializeHtmlEditorAreaStep1");_js.Trace.logInfo(this.G(),"InternalInitializeHtmlEditorAreaStep1: InternalInitializeHtmlEditorAreaStep1.");this.eI=null;this.sw(this.mx);this.tf(this.iX().a);this.tg(this.iX().b);var n=this.bO();this.gE?this.pn(n,!0):this.bd.e()?this.pP(n):this.mi();_js.e.e(t)},pP:function(n){n.src="about:blank";var t=this;$(n).one("load",function(){t.mi()})},pn:function(n,t){var r=_js.e.s(this.G(),2,"SRTE.LoadRTEFrameFromAppcache");var u=this.co.u(this.fn.a)+"/"+"blank.html";n.src=u;var i=this;$(n).one("load",function(){try{i.sJ(t)}catch(r){_js.Trace.logWarning(i.G(),"Rte frame failed to load, Exception: {0}",r.message);i.pP(n)}});_js.e.e(r)},sJ:function(n){var t=this.bO();var i=t.contentWindow;n&&$a(i.rteFrameLoadedFromAppcache)&&this.fn.b()?this.pn(t,!1):this.mi()},ps:function(){if(this.cU())this.sp();else{var n;this.ce(n={val:this.gG}),this.gG=n.val;this.gG=_js.g.a().a(this.G(),"RichTextEditor.RetryInitializeHtmlEditorArea",this.oR,100)}},mi:function(){var v=_js.e.s(this.G(),2,"SRTE.InternalInitializeHtmlEditorAreaStep2");_js.Trace.logInfo(this.G(),"InternalInitializeHtmlEditorAreaStep2: InternalInitializeHtmlEditorAreaStep2.");this.hS=!1;var a=this.bO();var n=a.contentWindow;var c=this.bd;var b=c.a();var r=this.jU.y;var p=r.css("border-top-color");var y=r.css("font-family");var h=r.css("color");var o=r.css("background-color");var f="11pt";this.bd.a()?f="12pt":this.bd.e()&&(f="10pt");n.document.open();n.document.writeln('<!DOCTYPE html PUBLIC " -//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');n.document.writeln('<html style="height:94%" xmlns="http://www.w3.org/1999/xhtml">');n.document.writeln("<head>");n.document.writeln('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">');n.document.writeln('<meta http-equiv="X-UA-Compatible" content="IE=10">');n.document.writeln('<meta name="referrer" content="never" />');n.document.writeln('<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>');n.document.writeln('<style type="text/css" title="OWADoNotSendStyle" style="display:none;">'+(this.cw===1?"::selection { background: transparent;} ::-moz-selection { background: transparent;}":"")+".ms-cui-menu {background-color:#ffffff;border:1px "+p+" solid;font-family:"+y+";font-size:"+f+";color:"+h+";z-index: 1000;} "+".ms-cui-menusection-title {display:none;} "+".ms-cui-ctl {vertical-align:text-top;text-decoration:none;color:"+h+";} "+".ms-cui-ctl-on {background-color:"+o+";opacity: 0.8;} "+".ms-cui-img-cont-float {display:inline-block;margin-top:2px} "+".ms-cui-smenu-inner {padding-top:0px;} "+"."+"ms-owa-paste-option-icon"+" {margin: 0px 6px 0px 6px;vertical-align:middle!important;padding-bottom: 2px;display:inline-block;} "+".ms-rtePasteFlyout-option:hover {background-color:"+o+" !important;opacity:1 !important;} "+".ms-rtePasteFlyout-option {padding:8px 4px 8px 4px;outline:none;} .ms-cui-menusection {float:left; width:85px;height:24px;overflow:hidden}"+this.sa(this.pf())+_b.i.l()+this.rZ(this.pf())+".wf-size-x20 {font-size: 20px!important;}"+"#OwaReferenceAttachments {display: none;}"+"</style>");n.document.writeln(this.rY());n.document.writeln("</head>");n.document.writeln('<body spellcheck="false" style="height:100%;margin:0px 0px 0px 0px;" '+this.pc()+' class="'+_b.i.k(this.sr())+'">');n.document.writeln("</body>");n.document.writeln("</html>");n.document.close();this.iM&&(n.onerror=this.iM.f);var i=this.cr;if(i&&i.b===2){var u=i.g.clone();u.css("overflow","");u.css("display","");u.css("height","100%");var e=u[0];e.id="MicrosoftOWAEditorRegion";e.className="ms-rtestate-write";n.document.body.appendChild(e);if(this.bR()===1&&i.j>0){this.cS.y.height(i.j);this.bC.y.height(i.j)}}else{var w=$('<div spellcheck="true" aria-label="'+_nbs.a.Nd+'" id="'+"MicrosoftOWAEditorRegion"+'" class="ms-rtestate-write" useinlinestyle="true" contenteditable="'+!(this.cw===1)+'" role="textbox" style="'+(this.cw===1?"text-align:center;":"")+"height:100%;border-style:hidden; outline:none;"+this.iX().e()+'" rtedirty="false"></div>');n.document.body.appendChild(w.get(0))}this.cW()&&this.bC.bG(this.cW());this.bC.y.css("box-sizing","border-box");var l=new _zy.m(this.co.n(),this.co.D(),this.co.E(),this.dE,this.bd,this.hX,!1,n,this.co,this.fn,this.gE);l.b(_zy.a.n,null);var s=new _zy.l(this.co,this.hX,this.bd.f(),n,this.fn,this.gE);var t=this;s.b(_zy.a.k,function(){var n=t.bO();if(n&&n.contentWindow===s.i){t.hS=!0;t.pb()}else if(t.P()){t.pa("IframeInaccessibleOnScriptLoadCallback");_js.Trace.logException(t.G(),Error.create("Iframe inaccessible after script loader callback"),"InternalInitializeHtmlEditorAreaStep2: Iframe should be accessible after callback from RTE script loader.")}else t.pa("EditorDeactivatedOnScriptLoadCallback")});_js.e.e(v)},rY:function(){var r="";var n=this.bO();if(n&&n.ownerDocument){var u=n.ownerDocument.getElementsByTagName("head");if(u.length>0)for(var f=u[0],i=f.getElementsByTagName("style"),t=0;t<i.length;t++)r+='<style title="OWADoNotSendStyle">'+i[t].innerHTML+"</style>"}return r},rZ:function(n){return".notIE8 .wf-owa-triangle-down-small:before {content:'\\e052';}.ie8 .wf-owa-triangle-down-small:before { content:'\\e052';}.ie8 .wf-owa-triangle-down-small {color:#666666/*$WFGreyColor*/;}"},sa:function(n){return"@font-face {  font-family: 'Office365Icons';  src: url('"+n+"/styles/fonts/fabricicons.eot?#iefix') format('embedded-opentype'),"+"  url('"+n+"/styles/fonts/fabricicons.woff') format('woff'),"+"  url('"+n+"/styles/fonts/fabricicons.ttf') format('truetype'),"+"  url('"+n+"/styles/fonts/fabricicons.svg#Office365Icons') format('svg'); "+"  font-weight: normal;"+"  font-style: normal;"+"}"+"[class^='ms-Icon--']:before, [class*=' ms-Icon--']:before {"+"  font-family: 'Office365Icons';"+"  font-style: normal;"+"  font-weight: normal;"+"  speak: none;"+"  display: inline-block;"+"  text-decoration: inherit;"+"  text-align: center;"+"  font-variant: normal;"+"  text-transform: none;"+"  line-height: 1;"+"}"+"[class^='ms-Icon--'], [class*=' ms-Icon--'] {"+"  display: inline-block;"+"  line-height: 1;"+"}"},pf:function(){return this.gE?this.co.t(this.fn.a):this.co.o()},mf:function(n,t){if(!n)return null;for(var i=null,f=t,o=f.length,r=0;r<o;++r){var s=f[r];var u=n.children("#"+s);if(u&&u.length>0){i=u;break}}var e=this.mf(i,t);e&&(i=e);return i},gW:function(n,t){t||(n=$("<div/>").text(n).html());this.bm().html($("<div>"+n+"</div>").html());var i=this;this.bm().each(function(n,t){i.eR(new _cmc.k(i,t))})},eP:function(n,t,i){var u=this.mf(this.bm(),_zy.a.d);t||(n=$("<div/>").text(n).html());var r=$("<div>"+n+"</div>").contents();u?u.prepend(r):this.bm().prepend(r);this.eR(new _cmc.k(this,r.get(0)));this.bp(0)},eQ:function(n,t,i,r,u){_js.Trace.logInfo(this.G(),"InsertContentAtSelection: InsertContentAtSelection");t||(n=$("<div/>").text(n).html());var e=$("<div>"+n+"</div>").contents();var l=e.find('div[id^="Signature"]');l&&l.length>0&&this.lg(e);this.bh(!1);if(this.bd.a()&&Number.parseInvariant($.browser.version)<=8){if(this.cP()){_js.Trace.logInfo(this.G(),"InsertElementAtSelection: Insert content at selection for IE8 and below");if(null!==this.z())for(var c=e.get(),v=c.length,s=0;s<v;++s){var a=c[s];this.z().InsertNodeAtCursor(a)}}}else{var f=this.cI();if(f){!f.collapsed&&r&&f.deleteContents();var y=f.cloneRange();this.pj(f,e);var o=this.cl();if(o){o.removeAllRanges();if(u){f.collapse(!1);o.addRange(f)}else o.addRange(y)}this.z().ForceUpdateCursorMarkersToCurrentSelection();var h=this;e.each(function(n,t){h.eR(new _cmc.k(h,t))})}}this.bp(0)},gT:function(n,t,i,r){var b=this.iZ();var h=this.bm();var p=this.bN();var f;var y;this.pq(n,y={val:f}),f=y.val;if(f){var e=f.contents();if(e&&e.length>0){var o=f.attr("style");var s=f.attr("dir");var w=h.attr("style");if(!i&&(($a(s)||_js.d.b(s))&&($a(o)||_js.d.b(o))||s===p.attr("dir")&&this.pm(o,w))){h.append(e);var v=this;e.each(function(n,t){v.eR(new _cmc.k(v,t))})}else{_js.Trace.logInfo(this.G(),"InsertContentAtEnd: Append content to body section");var u=$("<div />");s&&u.attr("dir",s);o&&u.attr("style",o);if(i){_js.Trace.logInfo(this.G(),"InsertContentAtEnd: Apply color since keepOriginalFormat is true");var l=!1;if(this.cS){var c=this.cS.y.get(0);if(c){u.css("color",$(c).css("color"));l=!0}}l||_js.Trace.logError(this.G(),"InsertContentAtEnd: $ItemTextColor isn't applied to original message.")}u.append(e);h.append(u);this.cb.C(this.mg(),!1);this.eR(new _cmc.k(this,u.get(0)))}}}else{_js.Trace.logInfo(this.G(),"InsertContentAtEnd: Append whole content since cannot extract body section from the content");h.append(n);var a=this;h.each(function(n,t){a.eR(new _cmc.k(a,t))})}this.bp(0)},so:function(){_js.Trace.logInfo(this.G(),"InsertCursorMarkersToTopMostFocusableNode: InsertCursorMarkersToTopMostFocusableNode.");var t=this.z();if(null!==t&&this.dA()){this.sO();t.ClearCanvasRange();var n=this.nI();n&&(n.hasChildNodes()?this.mj(n.firstChild):t.MoveCursorMarkersToChildren(n));if(this.cw===1){var r=this.bm().find("P");r.contents().unwrap()}if(this.sq()){var i=this.bm().find("#ms-rterangecursor-start");i.before('<span id="OWAZWSPSpan">&#8203;</span>')}}},sO:function(){if(this.dA()){var n=this.bm().find("#ms-rterangecursor-start");n.contents().unwrap();n=this.bm().find("#ms-rterangecursor-end");n.contents().unwrap()}},sw:function(n){this.hy=new _cmc.n(n)},si:function(){_js.Trace.logInfo(this.G(),"InitializeTableContextMenu: InitializeTableContextMenu.");if("Mouse"===_y.c.a.a()){this.sk();this.sj();this.sl();this.sm();this.sn();var t=[];var n;n=new _zy.g(_nbs.a.Kh,_zy.b.b(),this.lE);Array.add(t,n);n=new _zy.g(_nbs.a.lP,_zy.b.a(),this.lD);Array.add(t,n);n=new _zy.g(_nbs.a.GY,_zy.b.c(),this.lF);Array.add(t,n);n=new _zy.g(_nbs.a.HX,_zy.b.d(),this.lG);Array.add(t,n);n=new _zy.g(_nbs.a.YH,_zy.b.K(),this.mw);Array.add(t,n);this.sX(new _fm.f(t))}},sk:function(){_js.Trace.logInfo(this.G(),"InitializeTableInsertOptionsMenu: InitializeTableInsertOptionsMenu.");var t=[];var n;n=new _fm.d(_nbs.a.QW,_zy.b.r(),this.rH());Array.add(t,n);n=new _fm.d(_nbs.a.oA,_zy.b.b(),this.rI());Array.add(t,n);n=new _fm.d(_nbs.a.nt,_zy.b.o(),this.rJ());Array.add(t,n);n=new _fm.d(_nbs.a.My,_zy.b.p(),this.rK());Array.add(t,n);this.lE=new _fm.f(t)},sj:function(){_js.Trace.logInfo(this.G(),"InitializeTableDeleteOptionsMenu: InitializeTableDeleteOptionsMenu.");var t=[];var n;n=new _fm.d(_nbs.a.lX,_zy.b.a(),this.qV());Array.add(t,n);n=new _fm.d(_nbs.a.WP,_zy.b.j(),this.rF());Array.add(t,n);n=new _fm.d(_nbs.a.DE,_zy.b.k(),this.rG());Array.add(t,n);this.lD=new _fm.f(t)},sl:function(){_js.Trace.logInfo(this.G(),"InitializeTableMergeOptionsMenu: InitializeTableMergeOptionsMenu.");var t=[];var n;n=new _fm.d(_nbs.a.aw,_zy.b.v(),this.rL());Array.add(t,n);n=new _fm.d(_nbs.a.GJ,_zy.b.c(),this.rM());Array.add(t,n);n=new _fm.d(_nbs.a.Wf,_zy.b.w(),this.rN());Array.add(t,n);n=new _fm.d(_nbs.a.VS,_zy.b.x(),this.rO());Array.add(t,n);this.lF=new _fm.f(t)},sm:function(){_js.Trace.logInfo(this.G(),"InitializeTableSplitOptionsMenu: InitializeTableSplitOptionsMenu.");var t=[];var n;n=new _fm.d(_nbs.a.KC,_zy.b.d(),this.rP());Array.add(t,n);n=new _fm.d(_nbs.a.ZB,_zy.b.F(),this.rQ());Array.add(t,n);this.lG=new _fm.f(t)},sn:function(){_js.Trace.logInfo(this.G(),"InitializeTableStylesMenu: InitializeTableStylesMenu.");var t=[];var n;n=new _fm.d(_nbs.a.Ig,null,this.rz());Array.add(t,n);n=new _fm.d(_nbs.a.iJ,null,this.rA());Array.add(t,n);n=new _fm.d(_nbs.a.On,null,this.rC());Array.add(t,n);n=new _fm.d(_nbs.a.RC,null,this.rD());Array.add(t,n);n=new _fm.d(_nbs.a.GI,null,this.rB());Array.add(t,n);n=new _fm.d(_nbs.a.Vf,null,this.rE());Array.add(t,n);this.mw=new _fm.f(t)},hw:function(n){var t=new _fc.d(document.createElement("span"),this.eV,this.hk);t.a(n);return t.y[0]},sM:function(n){if(n.getElementsByTagName("o:p").length>0){_js.Trace.logInfo(this.G(),"PasteModeResolver: Resolved to PasteClean (since seeing 'o:p')");return"PasteClean"}if(n.querySelectorAll)for(var r=n.querySelectorAll("p, h1, h2, h3, b, i, u, table"),t=0;t<r.length;t++){var u=r[t];var i=u.getAttribute("style");if(!$a(i)&&i.indexOf("mso-")>-1){_js.Trace.logInfo(this.G(),"PasteModeResolver: Resolved to PasteClean (since seeing 'mso-')");return"PasteClean"}}_js.Trace.logInfo(this.G(),"PasteModeResolver: Resolved to PasteAsIs (as default fallback)");return"PasteAsIs"},sg:function(){var n=this.z();if(null!==n){_js.Trace.logInfo(this.G(),"InitializePasteManger: InitializePasteManger.");n.CreateAsIsPasteMode(this.hw(_zy.b.z()),_nbs.a.gy);n.CreateCleanPasteMode(this.hw(_zy.b.A()),_nbs.a.ir);n.CreatePlainTextPasteMode(this.hw(_zy.b.C()),_nbs.a.RT);n.set_DefaultPasteModeResolver(this.oQ)}},sf:function(){_js.Trace.logInfo(this.G(),"InitializeColorPickers: InitializeColorPickers.");if(!this.ht()){this.sY(new _b.U(_zy.c.d,_zy.c.c,"RichTextEditorView.ColorMenuItemTemplate",this.og));this.ht().apcl("IsShown",this.of)}if(!this.hs()){this.sR(new _b.U(_zy.c.a,_zy.c.b,"RichTextEditorView.ColorMenuItemTemplate",this.oe));this.hs().apcl("IsShown",this.od)}},sh:function(){_js.Trace.logInfo(this.G(),"InitializeQuickInsertControl: InitializeQuickInsertControl.");if(!this.hv()){this.td(new _zy.e(10,10,this.co.g(),this.oP,this.oO));this.hv().apcl("IsShown",this.oN)}},jY:function(n){var i=this.F.a(n);if(!$a(i)){var r=i.y.get(0);var t=$(r);if(r.nodeName.toLowerCase()==="button"){t.focus();t.click()}else{t=t.find("button").first();t.focus();t.click()}}},lj:function(){this.bo?this.bo.eS():this.jY("FontNameOptions")},li:function(){this.bo?this.bo.eR():this.jY("ForeColorOptions")},lk:function(){this.bo?this.bo.eT():this.jY("FontSizeOptions")},ll:function(){this.bo?this.bo.eU():this.jY("HighLightColorOptions")},la:function(){this.dv(_zy.c.a[0])},lh:function(){this.eO()&&this.bo&&this.bo.eQ()},sA:function(n,t){this.ht().i&&this.ht().a(this.hT)},sB:function(n,t){var i=n;this.mp(i.n.toString())},sx:function(n,t){this.hs().i&&this.hs().a(this.jX)},sy:function(n,t){var i=n;this.pM(i.n.toString())},sH:function(n,t){this.hv().i&&this.hv().g()},sI:function(n,t){var r=n;var i=r.n;this.mr(i.b);this.mq(i.a);this.pl();this.cf.a("TableQuickInsert")},sL:function(n,t){this.lB();this.pR()},po:function(n){_js.Trace.logException(this.G(),n,"Editor engine exception: "+n.message+". Stack is "+n.stack)},tp:function(){if(this.Z){this.fp();try{if(!this.cq.bv()&&null!==this.z()&&this.bQ()){_js.Trace.logInfo(this.G(),"UpdateFormatBar: Update format bar.");var i=this.z().GetFontFamily();i.startsWith("'")&&i.endsWith("'")&&(i=i.substring(1,i.length-1));this.dw=_cmc.a.f(i);this.bk("FontName");var t=this.z().GetFontSize();if(!(this.cw===1)){var r=this.cl();if(r){var f=r.rangeCount;if(f===1){var u=r.getRangeAt(0);if(!$a(u.commonAncestorContainer)){var n=u.commonAncestorContainer;if(t.endsWith("em")){do{n.currentStyle&&(t=n.currentStyle.fontSize);n=n.parentNode}while(t.endsWith("em")&&n)}else{try{while(n){if(n.tagName==="SUP"||n.tagName==="SUB"){t="";break}n=n.parentNode}}catch(o){t=""}r.isCollapsed||(t=this.qC(this.lC(t)))}}}}}this.dz=this.lC(t);this.bk("FontSize");this.pB(this.z().get_IsBoldApplied());this.pE(this.z().get_IsItalicApplied());this.pL(this.z().get_IsUnderlineApplied());this.pC(this.z().get_IsBulletApplied());this.pG(this.z().get_IsNumberApplied());this.pz(this.z().QueryAlign(0));this.py(this.z().QueryAlign(2));this.pA(this.z().QueryAlign(1));this.pK(this.z().get_IsSuperscripApplied());this.pJ(this.z().get_IsSubscriptApplied());this.pI(this.z().get_IsStrikeThroughApplied());this.pF(this.z().QueryDirection(!0));this.pH(this.z().QueryDirection(!1));this.pu(this.z().get_IsLinkable());this.pv(!this.fo);if(this.bZ()){this.sU(this.bZ().c());this.sT(this.bZ().b())}this.jZ(!0);this.jZ(this.lA());this.pO()}else if(this.bo&&this.z()){this.pu(this.z().get_IsLinkable());this.pv(!this.fo);this.jZ(!0);this.jZ(this.lA());this.pO()}}catch(e){}this.fq()}},lC:function(n){if(n.endsWith("px")){n=n.substring(0,n.length-2);if(this.hQ===-1){var t=document.createElement("SPAN");t.style.height="100pt";t.style.position="absolute";document.body.appendChild(t);this.hQ=t.offsetHeight/100;t.parentNode.removeChild(t)}return Math.round(Number.parseInvariant(n)/this.hQ).toString()}else if(n.endsWith("pt")){var i=n.substring(0,n.length-2);return Math.round(Number.parseInvariant(i)).toString()}return n},qC:function(n){for(var t=this.bO().contentDocument.getElementById("ms-rterangecursor-start"),i;t&&t.id!=="MicrosoftOWAEditorRegion";){if(t.style&&t.tagName!=="SUP"&&t.tagName!=="SUB"){i=this.rU(t,"font-size");if(i&&i!==""&&n!==this.lC(i))return""}if(t.id==="ms-rterangecursor-end")return n;if(t.hasChildNodes())t=t.firstChild;else if(t.nextSibling)t=t.nextSibling;else{do t=t.parentNode;while(!t.nextSibling);t=t.nextSibling}}return n},lA:function(){if(!this.z())return!1;this.bd.a()&&this.pr();var t=this.z().get_IsImageSelected();var n=!1;var i=this.cl();if(t&&i){var r=$(i.focusNode);var u=this;r.children().each(function(i,r){var f=$(r);var u=f.attr("id");u==="ms-rterangecursor-start"?n=!0:u==="ms-rterangecursor-end"&&(n=!1);n&&f.hasClass("EmojiInsert")&&(t=!1)})}return t},sd:function(n){this.bZ().a();this.cf.a(n)},pO:function(){var t=null;if(this.de){var n=this.me();n&&(t=_b.i.b(n))}this.sS(!t&&null!==this.z()&&this.z().get_IsEditingTable())},me:function(){return this.cP()?this.z().GetCursorParentElement():null},cP:function(){try{if(null===this.z()||$a(this.z().CurrentEditableRegion())||!this.z().get_IsCursorValid())return!1}catch(n){this.po(n);return!1}return!0},dg:function(){var t=!1;var n=this.hu();n&&(t=this.ss(n.document.activeElement));return t},ss:function(n){var t=!1;var u=$(n);var i=this.bm();if(i){var r=u.closest(i);t=!!r.length}_js.Trace.logInfo(this.G(),"[RichTextEditor: IsElementInsideContentEditableDiv] - Element {0} inside CED",t?"is":"is not");return t},th:function(){var t=this.bO();var n=t?t.contentWindow:null;if(n){var i=n;i.InlineImageLoader=window.self.InlineImageLoader}},rU:function(n,t){return window.self.getComputedStyle!==undefined?window.getComputedStyle(n)[t]:n.currentStyle[t]?n.currentStyle[t]:""},ti:function(){if(this.bo){this.kc=!1;this.dl.M(!0);this.cq.M(!0);this.hW.M(!0);this.eH.M(!0);this.bo.M(!1);this.bo.i()&&this.bo.i().j(!1)}else{this.kc=!0;this.dl.M(!1);this.mu=!(this.cw===1);this.mt=!0}},sv:function(n){_js.Trace.logInfo(this.G(),"LoadInlineImages: LoadInlineImages");var t=n.target;if(!this.dA()){_js.Trace.logWarning(this.G(),"LoadInlineImages: LoadInlineImages is invoked with a null document");return}_js.Trace.logInfo(this.G(),"LoadInlineImages: LoadInlineImages loads contents");this.mh.r($(t).contents())},sz:function(n){_js.Trace.logInfo(this.G(),"OnFocusOnRte: OnFocusOnRte");this.gZ(new _cmc.t(this))},pt:function(){_js.Trace.logInfo(this.G(),"SelectAll: SelectAll");if(null!==this.z()){this.z().SelectAll();this.dn()}},fp:function(){this.cw===1&&this.pt()},fq:function(){if(this.cw===1&&this.bd.e()){var t=this.cl();if(null!==t){var n=_zy.a.b(t);if(null!==n){n.collapse(!0);null!==this.z()&&this.z().ForceUpdateCursorMarkersToCurrentSelection()}}}},qJ:function(){_js.Trace.logInfo(this.G(),"FocusOnFormatBar: FocusOnFormatBar");if(this.bo)this.bo.eH();else{var n=this.iV.y.find(":button");n.focus();this.pw(0)}},bO:function(){return this.bC&&this.bC.y?this.bC.y.get(0):null},lH:function(){var t=!1;try{if(this.cU()){var n=this.bO();n.contentWindow&&n.contentWindow.RTE&&n.contentWindow.RTE.RichTextEditorEngineFacade&&n.contentWindow.RTE.DomHelper&&(t=!0)}}catch(i){}return t},z:function(){return this.lH()?this.eI:null},iZ:function(){try{if(this.cU()){var t=this.bO();var n=t.contentWindow.document.getElementsByTagName("Head");if(n&&n.length>0)return $(n[0])}}catch(i){return null}return null},rX:function(){var t=null;var n=this.iZ();n.length>0&&(t=n.find("#owaPrintStyle"));return t},oW:function(){_js.Trace.logInfo(this.G(),"AddNoPrintStyle: AddNoPrintStyle");var t=this.iZ();if(t.length>0){var n=t.find("#owaPrintStyle");if(!n.length){n=$('<style type="text/css" media="print" id="owaPrintStyle" style="display:none;">BODY {display:none;visibility:hidden;}</style>');n.appendTo(t)}}},sP:function(){var n=this.rX();n.length>0&&n.remove()},rV:function(n){for(var t=0;t<_cmc.a.a.length;++t)if(_cmc.a.a[t][0]===n)return _cmc.a.a[t][1];return n},bQ:function(){return _zz.l.prototype.bQ.call(this)},cH:function(n){if(_zz.l.prototype.bQ.call(this)!==n){_zz.l.prototype.cH.call(this,n);this.Z&&this.pQ()}return n},ib:function(){var t=this.cS?this.cS.y:null;var n=t?t.get(0):null;return!!n&&!!n.offsetParent},iq:function(){_js.Trace.logInfo(this.G(),"ResizeEditorDomElement: ResizeEditorDomElement");var f=this.cS?this.cS.y:null;var y=f?f.get(0):null;var tt=_js.e.s(this.G(),2,"SRTE.ResizeEditorDomElement");if(this.kc){var e=this.bN();if(e&&e.length===1&&e[0].offsetWidth>0){this.pD(!0);this.cq.M(!1);var p=this.ez.y.children();var t=this.cq.y.children();if(this.co.g())for(var v=0;v<t.length;++v){var rt=t[v];var g=$(rt);g.css("float","left");g.css("clear","none")}if(p.length>0){for(var w=0;w<p.length;++w){var it=p[w];var b=$(it);b.css("float","left");b.css("clear","none");this.cq.y.append(b)}this.ez.y.empty()}var a=!1;t=this.cq.y.children();if(t.length>0){var s=!1;var u=-1;this.co.g()&&this.cq.y.css("float","left");for(var h=0;h<t.length;++h){var i=t[h];var c=$(i);u===-1&&(u=i.offsetTop);!s&&Math.abs(u-i.offsetTop)>10&&(s=!0);if(i.offsetLeft+i.offsetWidth>e[0].offsetWidth-50||s){c.css("float","none");c.css("clear","both");this.ez.y.append(c);a=!0}u=i.offsetTop}this.co.g()&&this.cq.y.css("float","right");t=this.cq.y.children();if(this.co.g())for(var l=0;l<t.length;++l){var nt=t[l];var k=$(nt);k.css("float","right");k.css("clear","none")}}this.pD(!1);this.hW.M(!this.mu);this.eH.M(!(this.mt&&a));this.bn("MoreButtonsPopupXPosition","MoreButtonsPopupYPosition");this.gB&&this.bI(a)}}var n=-1;var ut=_b.E.a(this.cS.y.css("height"));var d=!1;if(this.bR()){n=f.offsetParent().height()+_b.E.a(f.offsetParent().css("padding-top"))-y.offsetTop;for(var r=y.parentNode;r&&r!==y.offsetParent;){var o=$(r);n=n-_b.E.a(o.css("padding-bottom"))-_b.E.a(o.css("margin-bottom"))-_b.E.a(o.css("border-bottom-width"));r=r.parentNode}}else n=this.dD;n=Math.max(this.cV,n);if(n>0&&n!==ut){this.cS.y.height(n);d=!0;this.bd.a()&&this.eV.a()==="TouchWide"?this.bC.y.height(n-4):this.bC.y.height(n)}d&&this.il(new _cmc.z(this));_js.e.e(tt)},rW:function(){var n=this.bO();return n?n.getBoundingClientRect():null}};_zy.a.a=function(){};_zy.a.a.c=function(n,t){_js.Trace.logInfo(_a.a.I,"OWAApplyStyleToElement: OWAApplyStyleToElement.");var r=_zy.a.a.b(t);if(r){var i="";n.getAttributeNode("style")&&n.getAttributeNode("style").specified&&(i+=n.getAttributeNode("style").value);var u=i+r;n.setAttribute("style",u)}};_zy.a.a.b=function(n){if(!_zy.a.a.a){var i=_zy.a.a.a={};var t="border-collapse:collapse; border: 1px solid rgb(198, 198, 198);";var r="background-color: rgba(255, 255, 255, 0.85);";i["ms-rteTable-default"]=t;i["ms-rteTableOddRow-default"]=t+r;i["ms-rteTableEvenRow-default"]=t+r;i["ms-rteTableOddCol-default"]=t;i["ms-rteTableEvenCol-default"]=t;t="border-collapse:collapse; border: 1px solid rgb(171, 171, 171);";var f="background-color: rgb(216, 216, 216);";i["ms-rteTable-grid"]=t;i["ms-rteTableOddRow-grid"]=t+f;i["ms-rteTableEvenRow-grid"]=t+r;i["ms-rteTableOddCol-grid"]=t;i["ms-rteTableEvenCol-grid"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-lightlines"]=t;i["ms-rteTableOddRow-lightlines"]=t+r;i["ms-rteTableEvenRow-lightlines"]=t+r;t="border-collapse:collapse; border-top-color: transparent; border-bottom-color: rgb(146, 192, 224); border-left-color: transparent; border-right-color: transparent; border-top-width: 1px; border-bottom-width: 1px; border-top-style: solid; border-bottom-style: solid;";i["ms-rteTableOddCol-lightlines"]=t;i["ms-rteTableEvenCol-lightlines"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-twotones"]=t;i["ms-rteTableOddRow-twotones"]=t+"background-color: rgb(192, 228, 255);";i["ms-rteTableEvenRow-twotones"]=t+r;i["ms-rteTableOddCol-twotones"]=t;i["ms-rteTableEvenCol-twotones"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-lightbands"]=t;i["ms-rteTableOddRow-lightbands"]=t+f;i["ms-rteTableEvenRow-lightbands"]=t+r;i["ms-rteTableOddCol-lightbands"]=t;i["ms-rteTableEvenCol-lightbands"]=t;t="border-collapse:collapse; border: 1px solid transparent;";i["ms-rteTable-clear"]=t;i["ms-rteTableOddRow-clear"]=t+r;i["ms-rteTableEvenRow-clear"]=t+r;i["ms-rteTableOddCol-clear"]=t;i["ms-rteTableEvenCol-clear"]=t}var u=_zy.a.a.a[n];return u?u.toString():null};_zy.a.q=function(n){_zy.a.q.initializeBase(this,[n])};_zy.a.q.prototype={gn:function(){return!0}};_zy.k=function(n,t,i,r,u){_zy.k.initializeBase(this,[n,t,i,r,u])};_zy.k.prototype={q:function(){return _zz.r.prototype.q.call(this)},bT:function(n){_zz.r.prototype.bT.call(this,n);var t=window.top.document.getElementById("EditorBody");this.v=$(t);return n},n:function(n,t){this.f&&this.f.bx(!0);_zz.r.prototype.n.call(this,n,t)},bL:function(n,t){var u="<span id=medina-mark>​</span>";this.z(u);var i=this.a().find("#medina-mark");var r=i.position();n.val=r.left;t.val=r.top;i.remove()}};_zy.c=function(){};_zy.l=function(n,t,i,r,u,f){_zy.l.initializeBase(this,[n,t,i,r]);this.o=n;this.n=u;this.p=f};_zy.l.prototype={o:null,p:!1,n:null,m:function(n){return this.p?this.o.u(this.n.a)+"/"+n:this.f+n}};_zy.m=function(n,t,i,r,u,f,e,o,s,h,c){_zy.m.initializeBase(this,[n,t,i,u,f,e,o]);this.n=s;this.s=h;this.t=c};_zy.m.prototype={n:null,t:!1,s:null,h:function(n){var t;t=n.type==="Sprite"||n.type==="HighResolution"?"/images/0/"+n.name:"/styles/0/"+n.name;return this.t?this.n.t(this.s.a)+t:this.n.o()+t}};_zy.i=function(n,t,i,r,u){_zy.i.initializeBase(this,[n,t,i,r,u])};_zy.i.prototype={cP:function(){var t=_fce.R.prototype.cP.call(this);var n=t.n;n.b=0;n.c=1;n.l=-1;t.b(n);t.f=!0;return t}};_zy.g=function(n,t,i){_zy.g.initializeBase(this,[n,t,i])};_zy.g.prototype={c:function(){return"TableEditContextMenuView.SubMenuContextMenuItem"}};_zy.h=function(n){this.a=Function.createDelegate(this,this.b);_zy.h.initializeBase(this,[n]);this.gw(new _C(this.a,_a.a.a));_zy.h.a(this.y,"#DDDDDD")};_zy.h.a=function(n,t){n.css("border-color",t);n.css("border-style","solid");n.css("border-width","1px")};_zy.h.prototype={b:function(){var r=this.y.parents();var n=null;var i=null;var t=!1;var f=this;r.each(function(r,u){if(u.parentNode.id===_zy.d.b||u.parentNode.id===_zy.d.a){u.parentNode.id===_zy.d.a&&(t=!0);var f=$(u);n=f.position();i=$(u).siblings()}});_zy.h.a(this.y,"#F25000");var u=this;i.each(function(i,r){var f=$(r);var u=f.position();var o=u.left;var e=n.left;if(t){o=n.left;e=u.left}u.top<=n.top&&o<=e?_zy.h.a(f.find("div:not(:has(*))"),"#F25000"):_zy.h.a(f.find("div:not(:has(*))"),"#DDDDDD")})}};_zy.e=function(n,t,i,r,u){this.f=Function.createDelegate(this,this.C);_zy.e.initializeBase(this,[[]]);this.d=u;this.q=_zy.e.a;this.c=n;this.b=t;this.e=i;this.p();this.t();this.r(r)};_zy.e.prototype={a:null,d:null,c:0,b:0,e:!1,g:function(){this.a&&this.a.m(_nbs.a.dS)},bl:function(){if(!$a(this.h))for(var n=0;n<this.h.y.length;++n){var t=this.h.y[n];t.rpcl("IsChecked",this.d)}_js.u.prototype.bl.call(this)},r:function(n){var i=this;var t=new _fm.h(_nbs.a.Du,null,new _C(function(){},_a.a.F),!1,!0,null,"RichTextEditorView.InsertTableItemTemplate",null);t.apcl("IsChecked",n);this.h.a(t)},p:function(){var n=this;this.a=new _fm.h(_nbs.a.dS,null,new _C(function(){},_a.a.F),!1,!0,null,"RichTextEditorView.QuickInsertInfoItemTemplate",null);this.h.a(this.a)},C:function(n,t){var i=n;this.a.m(i.j)},t:function(){for(var u=this.c*this.b,r=0;r<this.c;r++)for(var i=0;i<this.b;i++){var t=new _zy.j((r+1).toString(),(i+1).toString());var f=this;var n=new _fm.h(String.format(_nbs.a.Rv,t.a,t.b),null,new _C(function(){},_a.a.F),!1,!0,null,"RichTextEditorView.QuickInsertMenuItemTemplate",t);n.apcl("IsChecked",this.d);n.apcl("IsMouseOverMenuItem",this.f);this.h.a(n)}}};_zy.j=function(n,t){this.b=n;this.a=t};_zy.j.prototype={b:null,a:null};_zy.d=function(n){_zy.d.initializeBase(this,[n]);this.y.attr("id",_zy.d.b);var r=this;var u=function(n){r.u(n)};var t=this;var i=function(n){t.v(n)};this.y.mouseleave(u);this.y.mouseover(i)};_zy.d.prototype={q:function(n,t){var i=this.b*this.g;var r=this.f?i:i-1;if(t<=this.g*this.b){_b.cy.prototype.q.call(this,n,t);return}else{n.y.css("position","absolute");n.y.css("width","100%");n.y.css("top",(this.c+this.h).toString()+"px");n.y.css("height",this.c.toString()+"px")}},u:function(n){this.y.find("div:not(:has(*))").css("border-color","#DDDDDD")},v:function(n){this.p&&this.y.attr("id",_zy.d.a)}};function RichTextEditorComponent(){}RichTextEditorComponent.$$cctor=function(){_a.r.a().a(RichTextEditorComponent)};RichTextEditorComponent.prototype={a:function(n,t,i){var r=this;n.b(_zy.f,function(){return new _zy.f(i.i())}).a()},b:function(){return null}};_zy.b=function(){};_zy.b.h=function(){return _fm.e.a("insertunorderedlist.png")};_zy.b.i=function(){return _fm.e.a("createlink.png")};_zy.b.l=function(){return _fm.e.a("forecolor.png")};_zy.b.E=function(){return _fm.e.a("removeformat.png")};_zy.b.e=function(){return _fm.e.a("backcolor.png")};_zy.b.n=function(){return _fm.e.a("indent.png")};_zy.b.q=function(){return _fm.e.a("insertorderedlist.png")};_zy.b.D=function(){return _fm.e.a("redo.png")};_zy.b.L=function(){return _fm.e.a("undo.png")};_zy.b.G=function(){return _fm.e.a("strikethrough.png")};_zy.b.m=function(){return _fm.e.a("alttext.png")};_zy.b.I=function(){return _fm.e.a("superscript.png")};_zy.b.H=function(){return _fm.e.a("subscript.png")};_zy.b.y=function(){return _fm.e.a("outdent.png")};_zy.b.f=function(){return _fm.e.a("blockdirltr.png")};_zy.b.g=function(){return _fm.e.a("blockdirrtl.png")};_zy.b.M=function(){return _fm.e.a("unlink.png")};_zy.b.s=function(){return _fm.e.a("justifycenter.png")};_zy.b.t=function(){return _fm.e.a("justifyleft.png")};_zy.b.u=function(){return _fm.e.a("justifyright.png")};_zy.b.J=function(){return _fm.e.a("table_icon.png")};_zy.b.k=function(){return _fm.e.a("table_deleterow.png")};_zy.b.j=function(){return _fm.e.a("table_deletecolumn.png")};_zy.b.F=function(){return _fm.e.a("table_splitvertical.png")};_zy.b.d=function(){return _fm.e.a("table_splithorizontal.png")};_zy.b.x=function(){return _fm.e.a("table_mergeright.png")};_zy.b.w=function(){return _fm.e.a("table_mergeleft.png")};_zy.b.v=function(){return _fm.e.a("table_mergeabove.png")};_zy.b.c=function(){return _fm.e.a("table_mergebelow.png")};_zy.b.p=function(){return _fm.e.a("table_insertright.png")};_zy.b.o=function(){return _fm.e.a("table_insertleft.png")};_zy.b.r=function(){return _fm.e.a("table_insertabove.png")};_zy.b.b=function(){return _fm.e.a("table_insertbelow.png")};_zy.b.a=function(){return _fm.e.a("delete_table.png")};_zy.b.K=function(){return _fm.e.a("table_style.png")};_zy.b.z=function(){return _fm.e.a("pasteasis_20x20x32.png")};_zy.b.C=function(){return _fm.e.a("pasteplaintext_20x20x32.png")};_zy.b.A=function(){return _fm.e.a("pasteclean_20x20x32.png")};_zy.b.B=function(){return _fm.e.a("pasteoptions_16x16x4.png")};_zy._TI=function(){};_zy._TI.$$cctor=function(){var b="RichTextEditorView.FontNameTemplate";new _A(b,function(){_zy._TI.a[b]===undefined&&(_zy._TI.a[b]=[[[-1,1,["DataContext"],[_zy._TI.bC],null,"Html",null,_zy._TI.cs,1,_zy._TI.bN(),'<span style="font-family:{0};">{0}</span>',null]]]);var n=_zy._TI._hf.childNodes[0].cloneNode(!0);var t=new _b.o(n.children[0],_js.a.Instance.a(_a.f));return new _B(n,[t])},String,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var k="RichTextEditorView.FontSizeTemplate";new _A(k,function(){_zy._TI.a[k]===undefined&&(_zy._TI.a[k]=[[[-1,1,["DataContext"],[_zy._TI.bC],null,"Text",null,_zy._TI.o,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},String,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var d="RichTextEditorView.InsertLinkDialogTemplate";new _A(d,function(){_zy._TI.a[d]===undefined&&(_zy._TI.a[d]=[[[-1,4,null,null,null,"Text",null,_zy._TI.o,0,null,null,null,_nbs.a.PZ]],[[-1,0,["InsertLinkDialogUrl"],[_zy._TI.cN],_zy._TI.dw,"Text",_zy._TI.O,_zy._TI.P,2,null,null,null]]]);var n=_zy._TI._hf.childNodes[2].cloneNode(!0);var t=new _fc.h(_B.a(n,[0,0,1]));t.f=!0;var i=new _fc.a(_B.a(n,[0,0,0]));return new _B(n,[i,t])},_zy.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var y="RichTextEditorView.InsertAltTextDialogTemplate";new _A(y,function(){_zy._TI.a[y]===undefined&&(_zy._TI.a[y]=[[[-1,0,["InsertAltTextDialogText"],[_zy._TI.cM],_zy._TI.dv,"Text",_zy._TI.O,_zy._TI.P,2,null,null,null]]]);var t=_zy._TI._hf.childNodes[3].cloneNode(!0);var n=new _fc.h(_B.a(t,[0,0,0]));n.f=!0;return new _B(t,[n])},_zy.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var p="RichTextEditorView.InsertTableDialogTemplate";new _A(p,function(){_zy._TI.a[p]===undefined&&(_zy._TI.a[p]=[[[-1,4,null,null,null,"Text",null,_zy._TI.o,0,null,null,null,_nbs.a.IH],[-1,4,null,null,null,"AriaLabel",null,_zy._TI.bo,0,null,null,null,_nbs.a.IH]],[[-1,0,["TableColumnCount"],[_zy._TI.bJ],null,"Text",null,_zy._TI.o,1,null,null,null]],[[-1,0,["TableColumnCount"],[_zy._TI.bJ],_zy._TI.dL,"Text",_zy._TI.O,_zy._TI.P,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_zy._TI.o,0,null,null,null,_nbs.a.Cf],[-1,4,null,null,null,"AriaLabel",null,_zy._TI.bo,0,null,null,null,_nbs.a.Cf]],[[-1,0,["TableRowCount"],[_zy._TI.bL],null,"Text",null,_zy._TI.o,1,null,null,null]],[[-1,0,["TableRowCount"],[_zy._TI.bL],_zy._TI.dM,"Text",_zy._TI.O,_zy._TI.P,2,null,null,null]],[[-1,0,["InsertTableDialogErrorMessage"],[_zy._TI.cO],null,"Text",null,_zy._TI.o,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[4].cloneNode(!0);var o=new _fc.a(_B.a(n,[0,2,0]));var i=new _fc.h(_B.a(n,[0,1,2]));i.Y("TableRowText");i.C(0);i.a(2);var f=new _fc.a(_B.a(n,[0,1,1]));f.M(!0);var e=new _fc.a(_B.a(n,[0,1,0]));e.S("TableRowText");var t=new _fc.h(_B.a(n,[0,0,2]));t.Y("TableColumnText");t.C(0);t.a(2);var u=new _fc.a(_B.a(n,[0,0,1]));u.M(!0);var r=new _fc.a(_B.a(n,[0,0,0]));r.S("TableColumnText");return new _B(n,[r,u,t,e,f,i,o])},_zy.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var w="RichTextEditorView.ColorGridMenuItemTemplate._tid5";new _A(w,function(){_zy._TI.a[w]===undefined&&(_zy._TI.a[w]=[null]);var t=_zy._TI._hf.childNodes[5].cloneNode(!0);var n=new _b.bb(t.children[0]);n.b=2;n.g=5;n.k=66;n.h=166;n.f=!1;n.c=0;return new _B(t,[n]).R({ListPanel:n})},_fm.f,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_zy._TI.a);var g="RichTextEditorView.ColorGridMenuItemTemplate";new _A(g,function(){_zy._TI.a[g]===undefined&&(_zy._TI.a[g]=[null,[[-1,0,["SelectedItem"],[_zy._TI.R],_zy._TI.T,"SelectedItem",_zy._TI.J,_zy._TI.L,2,null,null,null],[-1,0,["ContextMenuItems"],[_zy._TI.Q],null,"DataSource",null,_zy._TI.K,1,null,null,null]]]);var u=_zy._TI._hf.childNodes[6].cloneNode(!0);var n=new _fce.a(_B.a(u,[0,0]),_js.a.Instance.a(_ff.a));n.v("ContextMenuView.GenericContextMenuItem");n.bh("div");var o=new _fc.g;var f=new _fc.c;f.D(_E.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));f.i("DOWNARROW");var t=new _fc.c;t.D(_E.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));t.i("UPARROW");var i=new _fc.c;i.D(_E.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));i.i("RIGHTARROW");var r=new _fc.c;r.D(_E.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));r.i("LEFTARROW");o.a([f,t,i,r]);n.H([o]);n.w("RichTextEditorView.ColorGridMenuItemTemplate._tid5");var e=new _js.c(u.children[0]);return new _B(u,[e,n]).R({PopupContent:e,MenuListView:n})},_fm.f,_fce.l,function(n){return new _fce.l(n,_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b),_js.a.Instance.a(String))},!1,!1,!1,0,_zy._TI.a);var rt="RichTextEditorView.ColorMenuItemTemplate._tid6";new _A(rt,function(){_zy._TI.a[rt]===undefined&&(_zy._TI.a[rt]=[[[-1,0,["Value"],[_zy._TI.cd],null,"ItemColor",null,_zy._TI.cl,0,null,null,null],[-1,5,["IsHovered"],[_zy._TI.q],null,"ms-border-color-themeSecondary",null,null,1,null,null,null],[-1,5,["IsChecked"],[_zy._TI.U],null,"colorSquareSelected",null,null,0,null,null,null]]]);var n=_zy._TI._hf.childNodes[7].cloneNode(!0);var t=new _b.br(n.children[0]);return new _B(n,[t])},_fm.h,_fce.o,function(n){return new _fce.o(n,_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_zy._TI.a);var ut="RichTextEditorView.ColorMenuItemTemplate";new _A(ut,function(){_zy._TI.a[ut]===undefined&&(_zy._TI.a[ut]=[[[-1,0,["Text"],[_zy._TI.bn],null,"Title",null,_zy._TI.c,1,null,null,null],[-1,0,["IsChecked"],[_zy._TI.U],_zy._TI.bm,"IsChecked",_zy._TI.bj,_zy._TI.bk,2,null,null,!1],[-1,0,["Command"],[_zy._TI.A],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0]]]);var t=_zy._TI._hf.childNodes[8].cloneNode(!0);var n=new _fce.o(t.children[0],_js.a.Instance.a(_ff.c));n.m=!0;n.w("RichTextEditorView.ColorMenuItemTemplate._tid6");return new _B(t,[n])},_fm.h,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var ft="RichTextEditorView.QuickInsertGridTemplate._tid7";new _A(ft,function(){_zy._TI.a[ft]===undefined&&(_zy._TI.a[ft]=[[[-1,0,["ColumnCount"],[_zy._TI.dN],null,"Columns",null,_zy._TI.cp,0,null,null,0],[-1,0,["RowCount"],[_zy._TI.dP],null,"Rows",null,_zy._TI.cr,0,null,null,0],[-1,0,["IsCultureRtl"],[_zy._TI.dO],null,"IsUserCultureRtl",null,_zy._TI.cq,0,null,null,!1]]]);var t=_zy._TI._hf.childNodes[9].cloneNode(!0);var n=new _zy.d(t.children[0]);n.k=160;n.h=160;n.f=!0;n.c=0;return new _B(t,[n]).R({ListPanel:n})},_zy.e,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_zy._TI.a);var nt="RichTextEditorView.QuickInsertGridTemplate";new _A(nt,function(){_zy._TI.a[nt]===undefined&&(_zy._TI.a[nt]=[null,[[-1,1,["IsHovered"],[_zy._TI.q],_zy._TI.D,"IsHovered",_zy._TI.q,_zy._TI.D,2,null,null,!1],[-1,0,["SelectedItem"],[_zy._TI.R],_zy._TI.T,"SelectedItem",_zy._TI.J,_zy._TI.L,2,null,null,null],[-1,0,["ContextMenuItems"],[_zy._TI.Q],null,"DataSource",null,_zy._TI.K,1,null,null,null]]]);var t=_zy._TI._hf.childNodes[10].cloneNode(!0);var n=new _fce.a(_B.a(t,[0,0]),_js.a.Instance.a(_ff.a));n.v("ContextMenuView.GenericContextMenuItem");n.bh("div");n.w("RichTextEditorView.QuickInsertGridTemplate._tid7");var i=new _js.c(t.children[0]);return new _B(t,[i,n]).R({PopupContent:i,MenuListView:n})},_zy.e,_fce.l,function(n){return new _fce.l(n,_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b),_js.a.Instance.a(String))},!1,!1,!1,0,_zy._TI.a);var tt="RichTextEditorView.QuickInsertMenuItemTemplate._tid8";new _A(tt,function(){_zy._TI.a[tt]===undefined&&(_zy._TI.a[tt]=[[[-1,1,["IsHovered"],[_zy._TI.q],_zy._TI.D,"IsHovered",_zy._TI.q,_zy._TI.D,2,null,null,!1]]]);var n=_zy._TI._hf.childNodes[11].cloneNode(!0);var t=new _zy.h(n.children[0]);return new _B(n,[t])},_fm.h,_fce.o,function(n){return new _fce.o(n,_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_zy._TI.a);var it="RichTextEditorView.QuickInsertMenuItemTemplate";new _A(it,function(){_zy._TI.a[it]===undefined&&(_zy._TI.a[it]=[[[-1,0,["IsChecked"],[_zy._TI.U],_zy._TI.bm,"IsChecked",_zy._TI.bj,_zy._TI.bk,2,null,null,!1],[-1,0,["Command"],[_zy._TI.A],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,0,["IsMouseOverMenuItem"],[_zy._TI.cc],_zy._TI.ce,"IsHovered",_zy._TI.q,_zy._TI.D,2,null,null,!1],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0]]]);var t=_zy._TI._hf.childNodes[12].cloneNode(!0);var n=new _fce.o(t.children[0],_js.a.Instance.a(_ff.c));n.m=!0;n.w("RichTextEditorView.QuickInsertMenuItemTemplate._tid8");return new _B(t,[n])},_fm.h,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var v="RichTextEditorView.InsertTableItemTemplate._tid9";new _A(v,function(){_zy._TI.a[v]===undefined&&(_zy._TI.a[v]=[[[-1,0,["Text"],[_zy._TI.bn],null,"Text",null,_zy._TI.o,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[13].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_fm.h,_fce.o,function(n){return new _fce.o(n,_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_zy._TI.a);var r="RichTextEditorView.InsertTableItemTemplate";new _A(r,function(){_zy._TI.a[r]===undefined&&(_zy._TI.a[r]=[[[-1,0,["IsChecked"],[_zy._TI.U],_zy._TI.bm,"IsChecked",_zy._TI.bj,_zy._TI.bk,2,null,null,!1],[-1,0,["Command"],[_zy._TI.A],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0],[-1,5,["IsHovered"],[_zy._TI.q],null,"ms-bg-color-themeLighter",null,null,1,null,null,null]]]);var t=_zy._TI._hf.childNodes[14].cloneNode(!0);var n=new _fce.o(t.children[0],_js.a.Instance.a(_ff.c));n.m=!0;n.w("RichTextEditorView.InsertTableItemTemplate._tid9");return new _B(t,[n])},_fm.h,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var u="RichTextEditorView.QuickInsertInfoItemTemplate._tida";new _A(u,function(){_zy._TI.a[u]===undefined&&(_zy._TI.a[u]=[[[-1,0,["Text"],[_zy._TI.bn],null,"Text",null,_zy._TI.o,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[13].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_fm.h,_fce.o,function(n){return new _fce.o(n,_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_zy._TI.a);var f="RichTextEditorView.QuickInsertInfoItemTemplate";new _A(f,function(){_zy._TI.a[f]===undefined&&(_zy._TI.a[f]=[[[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0]]]);var t=_zy._TI._hf.childNodes[15].cloneNode(!0);var n=new _fce.o(t.children[0],_js.a.Instance.a(_ff.c));n.bp(!1);n.m=!1;n.w("RichTextEditorView.QuickInsertInfoItemTemplate._tida");return new _B(t,[n])},_fm.h,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var n="RichTextEditorView";new _A(n,function(){_zy._TI.a[n]===undefined&&(_zy._TI.a[n]=[[[-1,5,["UserAgent","IsIOS"],[_zy._TI.bM,_zy._TI.bD],null,"_zy_r",null,null,1,null,null,null],[-1,5,["IsFormatBarHidden"],[_zy._TI.bp],null,"_zy_q",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_nbs.a.da],[-1,1,["FontNameOptions"],[_zy._TI.cH],null,"Options",null,_zy._TI.bv,1,null,null,null],[-1,1,["FontName"],[_zy._TI.cG],_zy._TI.dt,"SelectedValue",_zy._TI.bt,_zy._TI.bw,2,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.bu,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_nbs.a.UP],[-1,1,["FontSizeOptions"],[_zy._TI.cJ],null,"Options",null,_zy._TI.bv,1,null,null,null],[-1,1,["FontSize"],[_zy._TI.cI],_zy._TI.du,"SelectedValue",_zy._TI.bt,_zy._TI.bw,2,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.bu,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.BY],[-1,4,null,null,null,"Text",null,_zy._TI.be,0,null,null,null,_u.R.Cx],[-1,1,["BoldCommand"],[_zy._TI.cx],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsBoldApplied"],[_zy._TI.cS],_zy._TI.dA,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.dh],[-1,4,null,null,null,"Text",null,_zy._TI.be,0,null,null,null,_u.R.OC],[-1,1,["ItalicCommand"],[_zy._TI.dd],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsItalicApplied"],[_zy._TI.cU],_zy._TI.dC,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.KY],[-1,4,null,null,null,"Text",null,_zy._TI.be,0,null,null,null,_u.R.Ez],[-1,1,["UnderlineCommand"],[_zy._TI.dq],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsUnderlineApplied"],[_zy._TI.dc],_zy._TI.dK,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Gi],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.h()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["BulletCommand"],[_zy._TI.cy],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsBulletApplied"],[_zy._TI.cT],_zy._TI.dB,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.PL],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.q()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["NumberCommand"],[_zy._TI.di],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsNumberApplied"],[_zy._TI.cX],_zy._TI.dF,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Tz],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.y()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["DecreaseIndentCommand"],[_zy._TI.cD],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0],[-1,5,["IsCultureRtl"],[_zy._TI.bI],null,"rtl",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.jF],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.n()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["IncreaseIndentCommand"],[_zy._TI.cL],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0],[-1,5,["IsCultureRtl"],[_zy._TI.bI],null,"rtl",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.gT],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.e()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.iS],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.l()],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Ru],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.E()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["ClearFormatCommand"],[_zy._TI.cC],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Zm],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.t()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["AlignLeftCommand"],[_zy._TI.cu],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsAlignLeftApplied"],[_zy._TI.cQ],_zy._TI.dy,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.fm],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.s()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["AlignCenterCommand"],[_zy._TI.ct],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsAlignCenterApplied"],[_zy._TI.cP],_zy._TI.dx,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.JH],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.u()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["AlignRightCommand"],[_zy._TI.cv],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsAlignRightApplied"],[_zy._TI.cR],_zy._TI.dz,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Yl],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.i()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["EnableCreateLink"],[_zy._TI.cF],null,"IsEnabled",null,_zy._TI.B,1,null,null,!1],[-1,1,["LinkCommand"],[_zy._TI.df],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.bt],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.M()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["EnableBreakLink"],[_zy._TI.cE],null,"IsEnabled",null,_zy._TI.B,1,null,null,!1],[-1,1,["UnLinkCommand"],[_zy._TI.ds],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Hb],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.I()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["SuperscriptCommand"],[_zy._TI.dp],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsSuperscriptApplied"],[_zy._TI.db],_zy._TI.dJ,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.EN],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.H()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["SubscriptCommand"],[_zy._TI.dn],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsSubscriptApplied"],[_zy._TI.da],_zy._TI.dI,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.XG],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.G()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["StrikeThroughCommand"],[_zy._TI.dm],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsStrikeThroughApplied"],[_zy._TI.cZ],_zy._TI.dH,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_nbs.a.Pi],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.m()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["AltTextCommand"],[_zy._TI.cw],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["ImageSelected"],[_zy._TI.cK],null,"IsEnabled",null,_zy._TI.B,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.Ly],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.f()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["LeftToRightCommand"],[_zy._TI.de],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsLeftToRightApplied"],[_zy._TI.cV],_zy._TI.dD,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.jE],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.g()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["RightToLeftCommand"],[_zy._TI.dk],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["IsRightToLeftApplied"],[_zy._TI.cY],_zy._TI.dG,"IsChecked",_zy._TI.k,_zy._TI.l,2,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.EZ],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.L()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["UndoCommand"],[_zy._TI.dr],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["CanUndo"],[_zy._TI.cB],null,"IsEnabled",null,_zy._TI.B,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_u.R.RL],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.D()],[-1,1,["IsFontPreview"],[_zy._TI.i],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,1,["RedoCommand"],[_zy._TI.dj],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["CanRedo"],[_zy._TI.cA],null,"IsEnabled",null,_zy._TI.B,1,null,null,!1],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_nbs.a.Ey],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_zy.b.J()],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0],[-1,5,["CanEditTable"],[_zy._TI.cz],null,"ms-bg-color-themeLighter",null,null,1,null,null,null],[-1,5,["UserAgent","IsIOS"],[_zy._TI.bM,_zy._TI.bD],null,"_zy_r",null,null,1,null,null,null],[-1,5,["IsFormatBarHidden"],[_zy._TI.bp],null,"_zy_q",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_zy._TI.c,0,null,null,null,_nbs.a.Qj],[-1,4,null,null,null,"ImageId",null,_zy._TI.g,0,null,null,null,_b.d.b()],[-1,1,["ShowMoreButtonsCommand"],[_zy._TI.dl],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,1,["FormatBarTabIndex"],[_zy._TI.e],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0],[-1,5,["IsFormatBarHidden"],[_zy._TI.bp],null,"_zy_q",null,null,1,null,null,null]],[[-1,1,["IsMoreButtonsPopUpShown"],[_zy._TI.cW],_zy._TI.dE,"IsShown",_zy._TI.M,_zy._TI.N,2,null,null,!1]],[[-1,1,["EditorTabIndex"],[_zy._TI.cm],null,"AriaTabIndex",null,_zy._TI.f,1,null,null,0]],null,null,null,[[-1,1,["InsertLinkDialog"],[_zy._TI.p],null,"DataContext",null,_zy._TI.C,1,null,null,null],[0,1,["InsertLinkDialog","IsShown"],[_zy._TI.p,_zy._TI.ba],_zy._TI.bd,"IsShown",_zy._TI.M,_zy._TI.N,2,null,null,!1],[0,1,["InsertLinkDialog","Title"],[_zy._TI.p,_zy._TI.bc],null,"DialogTitle",null,_zy._TI.bh,1,null,null,null],[0,1,["InsertLinkDialog","CloseCommand"],[_zy._TI.p,_zy._TI.X],null,"CloseCommand",null,_zy._TI.bl,1,null,null,null],[0,1,["InsertLinkDialog","ConfirmCommand"],[_zy._TI.p,_zy._TI.bP],null,"ConfirmCommand",null,_zy._TI.bT,1,null,null,null],[0,1,["InsertLinkDialog","ContentDataContext"],[_zy._TI.p,_zy._TI.Y],null,"ContentDataContext",null,_zy._TI.bg,1,null,null,null],[0,1,["InsertLinkDialog","FooterButtons"],[_zy._TI.p,_zy._TI.Z],null,"ButtonDataList",null,_zy._TI.bf,1,null,null,null],[0,1,["InsertLinkDialog","ParentProjectionWindow"],[_zy._TI.p,_zy._TI.bb],null,"ParentProjectionWindow",null,_zy._TI.bi,1,null,null,null]],[[-1,1,["InsertAltTextDialog"],[_zy._TI.r],null,"DataContext",null,_zy._TI.C,1,null,null,null],[0,1,["InsertAltTextDialog","IsShown"],[_zy._TI.r,_zy._TI.ba],_zy._TI.bd,"IsShown",_zy._TI.M,_zy._TI.N,2,null,null,!1],[0,1,["InsertAltTextDialog","Title"],[_zy._TI.r,_zy._TI.bc],null,"DialogTitle",null,_zy._TI.bh,1,null,null,null],[0,1,["InsertAltTextDialog","CloseCommand"],[_zy._TI.r,_zy._TI.X],null,"CloseCommand",null,_zy._TI.bl,1,null,null,null],[0,1,["InsertAltTextDialog","ContentDataContext"],[_zy._TI.r,_zy._TI.Y],null,"ContentDataContext",null,_zy._TI.bg,1,null,null,null],[0,1,["InsertAltTextDialog","FooterButtons"],[_zy._TI.r,_zy._TI.Z],null,"ButtonDataList",null,_zy._TI.bf,1,null,null,null],[0,1,["InsertAltTextDialog","ParentProjectionWindow"],[_zy._TI.r,_zy._TI.bb],null,"ParentProjectionWindow",null,_zy._TI.bi,1,null,null,null]],[[-1,1,["InsertTableDialog"],[_zy._TI.s],null,"DataContext",null,_zy._TI.C,1,null,null,null],[0,1,["InsertTableDialog","IsShown"],[_zy._TI.s,_zy._TI.ba],_zy._TI.bd,"IsShown",_zy._TI.M,_zy._TI.N,2,null,null,!1],[0,1,["InsertTableDialog","Title"],[_zy._TI.s,_zy._TI.bc],null,"DialogTitle",null,_zy._TI.bh,1,null,null,null],[0,1,["InsertTableDialog","CloseCommand"],[_zy._TI.s,_zy._TI.X],null,"CloseCommand",null,_zy._TI.bl,1,null,null,null],[0,1,["InsertTableDialog","ContentDataContext"],[_zy._TI.s,_zy._TI.Y],null,"ContentDataContext",null,_zy._TI.bg,1,null,null,null],[0,1,["InsertTableDialog","ParentProjectionWindow"],[_zy._TI.s,_zy._TI.bb],null,"ParentProjectionWindow",null,_zy._TI.bi,1,null,null,null],[0,1,["InsertTableDialog","FooterButtons"],[_zy._TI.s,_zy._TI.Z],null,"ButtonDataList",null,_zy._TI.bf,1,null,null,null]]]);var t=_zy._TI._hf.childNodes[16].cloneNode(!0);var ni=new _fce.m(t.children[9],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));ni.d("RichTextEditorView.InsertTableDialogTemplate");var kt=new _fce.m(t.children[8],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));kt.d("RichTextEditorView.InsertAltTextDialogTemplate");var dt=new _fce.m(t.children[7],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));dt.d("RichTextEditorView.InsertLinkDialogTemplate");var ht=new _b.L(_B.a(t,[6,0]));ht.M(!0);var bt=new _js.c(t.children[6]);var rt=new _js.c(t.children[5]);rt.C(-1);rt.M(!0);var wt=new _js.c(t.children[4]);wt.M(!0);var f=new _fce.k(t.children[3],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));f.f=!0;f.bS(!0);var gt=new _fce.E(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.b));gt.D(_E.a(["TemplatedParent","MoreButtonsPopupXPosition"],[_zy._TI.n,_zy._TI.dg],null,"X",null,_zy._TI.bU,1,null,null,0)).D(_E.a(["TemplatedParent","MoreButtonsPopupYPosition"],[_zy._TI.n,_zy._TI.dh],null,"Y",null,_zy._TI.bV,1,null,null,0));f.b(gt);var it=new _fc.b(t.children[2]);it.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");it.M(!0);var r=new _fc.b(t.children[1]);r.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");r.a("ms-border-color-themeSecondary");r.M(!0);var e=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));e.D(_E.a(["TemplatedParent","TableQuickInsertMenu"],[_zy._TI.n,_zy._TI.bK],null,"MenuDataContext",null,_zy._TI.I,1)).D(_E.a(["TemplatedParent","TableQuickInsertMenu","IsShown"],[_zy._TI.n,_zy._TI.bK,_zy._TI.z],_zy._TI.S,"IsShown",_zy._TI.G,_zy._TI.H,2,null,null,!1));e.k("RichTextEditorView.QuickInsertGridTemplate");e.a=3;e.b=1;var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.D(_E.a(["TemplatedParent","EditTableContextMenu"],[_zy._TI.n,_zy._TI.bG],null,"MenuDataContext",null,_zy._TI.I,1)).D(_E.a(["TemplatedParent","EditTableContextMenu","IsShown"],[_zy._TI.n,_zy._TI.bG,_zy._TI.z],_zy._TI.S,"IsShown",_zy._TI.G,_zy._TI.H,2,null,null,!1));i.O=!1;i.j=!0;i.S=!1;i.k("TableEditContextMenuView");i.b=5;r.H([e,i]);var pt=new _fc.b(_B.a(t,[0,12,1]));pt.a("ms-border-color-themeSecondary");pt.e("_zy_l");var vt=new _fc.b(_B.a(t,[0,12,0]));vt.a("btnHovered ms-border-color-themeSecondary");vt.e("_zy_l");var tt=new _fc.j(_B.a(t,[0,11,1]));tt.bd("ms-bg-color-themeLighter");tt.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");tt.a("btnHovered ms-border-color-themeSecondary");var et=new _fc.j(_B.a(t,[0,11,0]));et.bd("ms-bg-color-themeLighter");et.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");et.a("btnHovered ms-border-color-themeSecondary");var ft=new _fc.b(_B.a(t,[0,10,1]));ft.a("ms-border-color-themeSecondary");ft.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");ft.e("_zy_l");var ut=new _fc.j(_B.a(t,[0,10,0]));ut.bd("ms-bg-color-themeLighter");ut.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");ut.a("btnHovered ms-border-color-themeSecondary");var nt=new _fc.j(_B.a(t,[0,9,1]));nt.bd("ms-bg-color-themeLighter");nt.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");nt.a("btnHovered ms-border-color-themeSecondary");var v=new _fc.j(_B.a(t,[0,9,0]));v.bd("ms-bg-color-themeLighter");v.bp("ms-bg-color-themeLighter ms-border-color-themeSecondary");v.a("ms-border-color-themeSecondary");var y=new _fc.b(_B.a(t,[0,8,1]));y.a("ms-border-color-themeSecondary");y.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");y.e("_zy_l");var a=new _fc.b(_B.a(t,[0,8,0]));a.a("ms-border-color-themeSecondary");a.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");a.e("_zy_l");var c=new _fc.j(_B.a(t,[0,7,2]));c.bd("ms-bg-color-themeLighter");c.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");c.a("btnHovered ms-border-color-themeSecondary");var l=new _fc.j(_B.a(t,[0,7,1]));l.bd("ms-bg-color-themeLighter");l.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");l.a("btnHovered ms-border-color-themeSecondary");var p=new _fc.j(_B.a(t,[0,7,0]));p.bd("ms-bg-color-themeLighter");p.bp("ms-bg-color-themeLighter ms-border-color-themeSecondary");p.a("ms-border-color-themeSecondary");var yt=new _fc.b(_B.a(t,[0,6,0]));yt.a("ms-border-color-themeSecondary");yt.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");var o=new _fc.b(_B.a(t,[0,5,1]));o.a("ms-border-color-themeSecondary");o.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");var u=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));u.D(_E.a(["TemplatedParent","ForeColorPicker"],[_zy._TI.n,_zy._TI.bH],null,"MenuDataContext",null,_zy._TI.I,1)).D(_E.a(["TemplatedParent","ForeColorPicker","IsShown"],[_zy._TI.n,_zy._TI.bH,_zy._TI.z],_zy._TI.S,"IsShown",_zy._TI.G,_zy._TI.H,2,null,null,!1));u.k("RichTextEditorView.ColorGridMenuItemTemplate");u.a=3;u.b=1;o.H([u]);var s=new _fc.b(_B.a(t,[0,5,0]));s.a("ms-border-color-themeSecondary");s.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");var h=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));h.D(_E.a(["TemplatedParent","BackColorPicker"],[_zy._TI.n,_zy._TI.bF],null,"MenuDataContext",null,_zy._TI.I,1)).D(_E.a(["TemplatedParent","BackColorPicker","IsShown"],[_zy._TI.n,_zy._TI.bF,_zy._TI.z],_zy._TI.S,"IsShown",_zy._TI.G,_zy._TI.H,2,null,null,!1));h.k("RichTextEditorView.ColorGridMenuItemTemplate");h.a=3;h.b=1;s.H([h]);var at=new _fc.b(_B.a(t,[0,4,1]));at.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");at.a("btnHovered ms-border-color-themeSecondary");var ot=new _fc.b(_B.a(t,[0,4,0]));ot.b("ms-bg-color-themeLighter ms-border-color-themeSecondary");ot.a("btnHovered ms-border-color-themeSecondary");var b=new _fc.j(_B.a(t,[0,3,1]));b.bd("ms-bg-color-themeLighter");b.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");b.a("btnHovered ms-border-color-themeSecondary");var w=new _fc.j(_B.a(t,[0,3,0]));w.bd("ms-bg-color-themeLighter");w.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");w.a("btnHovered ms-border-color-themeSecondary");var k=new _fc.j(_B.a(t,[0,2,2]));k.bd("ms-bg-color-themeLighter");k.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");k.a("btnHovered ms-border-color-themeSecondary");var g=new _fc.j(_B.a(t,[0,2,1]));g.bd("ms-bg-color-themeLighter");g.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");g.a("btnHovered ms-border-color-themeSecondary");var d=new _fc.j(_B.a(t,[0,2,0]));d.bd("ms-bg-color-themeLighter");d.bp("btnHoveredChecked ms-bg-color-themeLighter ms-border-color-themeSecondary");d.a("btnHovered ms-border-color-themeSecondary");var st=new _fce.j(_B.a(t,[0,1,0]));st.a("RichTextEditorView.FontSizeTemplate");var lt=new _fce.j(_B.a(t,[0,0,0]));lt.a("RichTextEditorView.FontNameTemplate");var ct=new _js.c(t.children[0]);ct.M(!0);return new _B(t,[ct,lt,st,d,g,k,w,b,ot,at,s,o,yt,p,l,c,a,y,v,nt,ut,ft,et,tt,vt,pt,r,it,f,wt,rt,bt,ht,dt,kt,ni]).R({EditorFormatBar:ct,FontNameOptions:lt,FontSizeOptions:st,HighLightColorOptions:s,ForeColorOptions:o,TableButton:r,MoreDropDownButton:it,MoreButtonsPopup:f,ClickableArea:wt,PasteModeMenuStyleElement:rt,EditorWrapper:bt,EditorBody:ht})},_zy.a,_zy.a,function(n){return new _zy.a(n,_js.a.Instance.a(_a.z),_js.a.Instance.a(_g.a),_js.a.Instance.a(_b.h),_js.a.Instance.a(_a.bl),_js.a.Instance.a(InlineImageLoader),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.e),_js.a.Instance.a(_y.a),_js.a.Instance.a(_js.k),_js.a.Instance.a(_zy.f),_js.a.Instance.a(_a.f),_js.a.Instance.a(_h.o),_js.a.Instance.a(_y.cj),_js.a.Instance.a(_zz.v),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b),_js.a.Instance.a(_b.e))},!1,!1,!1,0,_zy._TI.a);var t="TableEditContextMenuView._tidb";new _A(t,function(){_zy._TI.a[t]===undefined&&(_zy._TI.a[t]=[null]);var i=_zy._TI._hf.childNodes[17].cloneNode(!0);var n=new _fce.x(i.children[0]);return new _B(i,[n]).R({ListPanel:n})},_fm.f,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_zy._TI.a);var i="TableEditContextMenuView.ContextMenuList._tidc";new _A(i,function(){_zy._TI.a[i]===undefined&&(_zy._TI.a[i]=[null]);var t=_zy._TI._hf.childNodes[17].cloneNode(!0);var n=new _fce.x(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_fm.f,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_zy._TI.a);var e="TableEditContextMenuView.ContextMenuList";new _A(e,function(){_zy._TI.a[e]===undefined&&(_zy._TI.a[e]=[[[-1,0,["ContextMenuItems"],[_zy._TI.Q],null,"DataSource",null,_zy._TI.K,1,null,null,null],[-1,0,["SelectedItem"],[_zy._TI.R],_zy._TI.T,"SelectedItem",_zy._TI.J,_zy._TI.L,2,null,null,null]]]);var s=_zy._TI._hf.childNodes[19].cloneNode(!0);var n=new _fce.a(s.children[0],_js.a.Instance.a(_ff.a));n.bg=!0;n.bh("div");n.bo("_zy_t");n.cJ=!0;var h=new _fc.g;var o=new _fc.c;o.D(_E.a(["ContextParent","ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));o.i("RIGHTARROW");var f=new _fc.c;f.D(_E.a(["ContextParent","ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));f.i("TAB");var i=new _fc.c;i.D(_E.a(["ContextParent","ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));i.i("LEFTARROW");var t=new _fc.c;t.D(_E.a(["ContextParent","ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));t.i("TAB");t.j=1;var r=new _fc.c;r.D(_E.a(["ContextParent","ContextParent","ContextParent","HomeCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.bs],null,"Command",null,_zy._TI.j,1));r.i("HOME");var u=new _fc.c;u.D(_E.a(["ContextParent","ContextParent","ContextParent","EndCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.b,_zy._TI.br],null,"Command",null,_zy._TI.j,1));u.i("END");h.a([o,f,i,t,r,u]);n.H([h]);n.bb(function(){var t=_zy._TI._hf.childNodes[18].cloneNode(!0).childNodes[0];var n=new _fce.n(t);n.A(_E.a(["MenuItemTemplateId"],[_zy._TI.bx],null,"TemplateId",null,_zy._TI.W,1));return n});n.w("TableEditContextMenuView.ContextMenuList._tidc");return new _B(s,[n])},_fm.f,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_zy._TI.a);var c="TableEditContextMenuView.ContextMenuItem._tidd";new _A(c,function(){_zy._TI.a[c]===undefined&&(_zy._TI.a[c]=[[[-1,0,["LabelDataContext"],[_zy._TI.bz],null,"DataContext",null,_zy._TI.C,1,null,null,null],[0,0,["LabelTemplateId"],[_zy._TI.bA],null,"TemplateId",null,_zy._TI.W,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[20].cloneNode(!0);var t=new _js.b(n.children[0]);return new _B(n,[t])},_fm.d,_fce.w,function(n){return new _fce.w(n,_js.a.Instance.a(_ff.c))},!1,!0,!1,0,_zy._TI.a);var l="TableEditContextMenuView.ContextMenuItem";new _A(l,function(){_zy._TI.a[l]===undefined&&(_zy._TI.a[l]=[[[-1,0,["Command"],[_zy._TI.A],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0],[-1,0,["IsHidden"],[_zy._TI.V],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,0,["IsHidden"],[_zy._TI.V],null,"AriaHiddenState",null,_zy._TI.bE,1,null,null,!1],[-1,5,["Command","CanExecute"],[_zy._TI.A,_zy._TI.ck],null,"ms-font-color-neutralPrimary:ms-font-color-neutralTertiary",null,null,0,null,null,null],[-1,5,["IsSelected"],[_zy._TI.by],null,"ms-bg-color-themeLight",null,null,0,null,null,null]]]);var t=_zy._TI._hf.childNodes[21].cloneNode(!0);var n=new _fce.w(t.children[0],_js.a.Instance.a(_ff.c));n.b("ms-bg-color-themeLight");n.w("TableEditContextMenuView.ContextMenuItem._tidd");return new _B(t,[n]).R({FocusControl:n})},_fm.d,_fce.n,function(n){return new _fce.n(n)},!1,!1,!1,0,_zy._TI.a);var a="TableEditContextMenuView.SubMenuContextMenuItem._tide";new _A(a,function(){_zy._TI.a[a]===undefined&&(_zy._TI.a[a]=[[[-1,0,["LabelDataContext"],[_zy._TI.bz],null,"DataContext",null,_zy._TI.C,1,null,null,null],[0,0,["LabelTemplateId"],[_zy._TI.bA],null,"TemplateId",null,_zy._TI.W,1,null,null,null]]]);var n=_zy._TI._hf.childNodes[20].cloneNode(!0);var t=new _js.b(n.children[0]);return new _B(n,[t])},_fm.k,_zy.i,function(n){return new _zy.i(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b))},!1,!0,!1,0,_zy._TI.a);var o="TableEditContextMenuView.SubMenuContextMenuItem";new _A(o,function(){_zy._TI.a[o]===undefined&&(_zy._TI.a[o]=[[[-1,0,["SubMenuTemplateId"],[_zy._TI.ci],null,"SubMenuTemplateId",null,_zy._TI.cb,0,null,null,null],[-1,0,["Command"],[_zy._TI.A],null,"ClickCommand",null,_zy._TI.d,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupCloseCommand"],[_zy._TI.m,_zy._TI.x],null,"CloseMenuCommand",null,_zy._TI.t,1,null,null,null],[-1,0,["ParentContextMenu","ContextMenuPopupId"],[_zy._TI.m,_zy._TI.y],null,"ContextMenuPopupId",null,_zy._TI.u,1,null,null,0],[-1,0,["IsEnabled"],[_zy._TI.bB],null,"SubMenuIsEnabled",null,_zy._TI.ca,1,null,null,!1],[-1,0,["SubMenuIsHovered"],[_zy._TI.ch],_zy._TI.cj,"IsSubMenuHovered",_zy._TI.bW,_zy._TI.bX,2,null,null,!1],[-1,0,["IsHidden"],[_zy._TI.V],null,"IsHidden",null,_zy._TI.h,1,null,null,!0],[-1,0,["IsHidden"],[_zy._TI.V],null,"AriaHiddenState",null,_zy._TI.bE,1,null,null,!1],[-1,0,["SubMenu"],[_zy._TI.cg],null,"SubMenu",null,_zy._TI.bZ,1,null,null,null],[-1,0,["ParentContextMenu","IsShown"],[_zy._TI.m,_zy._TI.z],null,"ParentMenuIsShown",null,_zy._TI.bY,1,null,null,!1],[-1,5,["IsEnabled"],[_zy._TI.bB],null,"ms-font-color-neutralPrimary:ms-font-color-neutralTertiary",null,null,0,null,null,null],[-1,5,["IsSelected"],[_zy._TI.by],null,"ms-bg-color-themeLight",null,null,0,null,null,null]]]);var t=_zy._TI._hf.childNodes[22].cloneNode(!0);var n=new _zy.i(t.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_b.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));n.b("ms-bg-color-themeLight");n.w("TableEditContextMenuView.SubMenuContextMenuItem._tide");return new _B(t,[n]).R({FocusControl:n})},_fm.k,_fce.n,function(n){return new _fce.n(n)},!1,!1,!1,0,_zy._TI.a);var s="TableEditContextMenuView";new _A(s,function(){_zy._TI.a[s]===undefined&&(_zy._TI.a[s]=[null,[[-1,4,null,null,null,"AriaLabel",null,_zy._TI.bo,0,null,null,null,_u.R.cJ],[-1,1,["IsTouch"],[_zy._TI.bQ],null,"SelectItemOnHover",null,_zy._TI.bS,0,_zy._TI.bq(),null,!1],[-1,0,["ContextMenuItems"],[_zy._TI.Q],null,"DataSource",null,_zy._TI.K,1,null,null,null],[-1,0,["SelectedItem"],[_zy._TI.R],_zy._TI.T,"SelectedItem",_zy._TI.J,_zy._TI.L,2,null,null,null]]]);var f=_zy._TI._hf.childNodes[23].cloneNode(!0);var n=new _fce.a(_B.a(f,[0,0,0]),_js.a.Instance.a(_ff.a));n.bh("div");n.bo("_zy_t");n.bg=!0;var c=new _fc.g;var e=new _fc.c;e.D(_E.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));e.i("RIGHTARROW");var o=new _fc.c;o.D(_E.a(["ContextParent","ContextParent","DownArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.v],null,"Command",null,_zy._TI.j,1));o.i("TAB");var i=new _fc.c;i.D(_E.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));i.i("LEFTARROW");var t=new _fc.c;t.D(_E.a(["ContextParent","ContextParent","UpArrowCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.w],null,"Command",null,_zy._TI.j,1));t.i("TAB");t.j=1;var u=new _fc.c;u.D(_E.a(["ContextParent","ContextParent","HomeCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.bs],null,"Command",null,_zy._TI.j,1));u.i("HOME");var r=new _fc.c;r.D(_E.a(["ContextParent","ContextParent","EndCommand"],[_zy._TI.b,_zy._TI.b,_zy._TI.br],null,"Command",null,_zy._TI.j,1));r.i("END");c.a([e,o,i,t,u,r]);n.H([c]);n.bb(function(){var t=_zy._TI._hf.childNodes[18].cloneNode(!0).childNodes[0];var n=new _fce.n(t);n.A(_E.a(["MenuItemTemplateId"],[_zy._TI.bx],null,"TemplateId",null,_zy._TI.W,1)).A(_E.a(["ParentContextMenu","IsShown"],[_zy._TI.cf,_zy._TI.z],null,"PassFocusOnSelection",null,_zy._TI.bR,1,null,null,!1));return n});n.w("TableEditContextMenuView._tidb");var h=new _fce.f(_B.a(f,[0,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));return new _B(f,[h,n]).R({PopupContent:h,MenuListView:n})},_fm.f,_fce.l,function(n){return new _fce.l(n,_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b),_js.a.Instance.a(String))},!1,!1,!1,0,_zy._TI.a);var h="RTEWrapperView";new _A(h,function(){_zy._TI.a[h]===undefined&&(_zy._TI.a[h]=[null,[[-1,1,["InnerEditor"],[_zy._TI.cn],null,"TextEditor",null,_zy._TI.dQ,1,null,null,null],[-1,1,["IsEntitySuggesterEnabled"],[_zy._TI.co],null,"IsHidden",null,_zy._TI.h,1,_zy._TI.bq(),null,!0]]]);var t=_zy._TI._hf.childNodes[24].cloneNode(!0);var i=new _zy.k(t.children[1],_js.a.Instance.a(_a.id.$$(IEntitySuggestionManager)),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.id.$$(IFindRecipientMailComposeViewModelFactory)),_js.a.Instance.a(_a.f));var n=new _zy.a(t.children[0],_js.a.Instance.a(_a.z),_js.a.Instance.a(_g.a),_js.a.Instance.a(_b.h),_js.a.Instance.a(_a.bl),_js.a.Instance.a(InlineImageLoader),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.e),_js.a.Instance.a(_y.a),_js.a.Instance.a(_js.k),_js.a.Instance.a(_zy.f),_js.a.Instance.a(_a.f),_js.a.Instance.a(_h.o),_js.a.Instance.a(_y.cj),_js.a.Instance.a(_zz.v),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b),_js.a.Instance.a(_b.e));n.M(!0);return new _B(t,[n,i]).R({Editor:n})},_zz.H,_zz.H,function(n){return new _zz.H(n,_js.a.Instance.a(_a.f))},!1,!1,!1,0,_zy._TI.a)};_zy._TI.bO=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span autoid=\"_zy_h\"></span> </div><div> <span autoid=\"_zy_i\"></span> </div><div> <ul class='_zy_m'> <li class='ms-font-m'> <span></span> <input autoid=\"_zy_k\" class='_zy_o'/> </li> </ul> </div><div> <ul class='_zy_m'> <li class='ms-font-m'> <input autoid=\"_zy_m\" class='_zy_p'/> </li> </ul> </div><div> <ul class='_zy_m'> <li class='ms-font-m'> <span></span> <span></span> <input autoid=\"_zy_o\" class='_zy_n'/> </li> <li class='ms-font-m'> <span></span> <span></span> <input autoid=\"_zy_p\" class='_zy_n'/> </li> <li class='ms-font-m'> <span class='owa-color-neutral-red'></span> </li> </ul> </div><div>  <div></div> </div><div> <div> <div autoid=\"_zy_q\" class='_zy_7 ms-bg-color-white'></div> </div> </div><div> <div class='_zy_8 border-color-transparent'></div> </div><div> <button autoid=\"_zy_r\" type='button'></button> </div><div> <div autoid=\"_zy_t\" class='_zy_3'></div> </div><div> <div> <div autoid=\"_zy_s\" class='_zy_2 ms-bg-color-white'></div> </div> </div><div> <div autoid=\"_zy_v\" class='_zy_4'></div> </div><div> <button autoid=\"_zy_u\" type='button'></button> </div><div> <span></span> </div><div> <button autoid=\"_zy_w\" type='button' class='_zy_9 _zy_5 ms-fwt-r ms-font-color-neutralPrimary ms-border-color-neutralLight'></button> </div><div> <button type='button' class='_zy_9 _zy_6 ms-fwt-sb ms-font-color-black'></button> </div><div> <div autoid=\"_zy_0\" class='_zy_b'> <div class='_zy_i'> <div autoid=\"_zy_1\" class='_zy_j'></div> </div> <div class='_zy_i'> <div autoid=\"_zy_2\" class='_zy_k'></div> </div> <div class='_zy_i'> <button autoid=\"_zy_3\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary _zy_d'></button> <button autoid=\"_zy_4\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary _zy_e'></button> <button autoid=\"_zy_5\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary _zy_f'></button> </div> <div class='_zy_i'> <button autoid=\"_zy_6\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_7\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button autoid=\"_zy_8\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_9\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button autoid=\"_zy_a\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button autoid=\"_zy_b\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button autoid=\"_zy_c\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> <div class='_zy_i'> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> <button type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary'></button> </div> </div> <button autoid=\"_zy_d\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary _zy_i'></button> <button autoid=\"_zy_e\" type='button' class='_zy_c border-color-transparent ms-font-color-neutralSecondary _zy_g'></button> <div class='_zy_h ms-bg-color-white'></div> <div autoid=\"_zy_f\" class='_zy_a'></div> <div class='ms-font-weight-regular ms-font-color-neutralPrimary ms-bg-color-themeLight ms-border-color-neutralTertiary'></div> <div autoid=\"_zy_g\"> <iframe></iframe> </div>   <div autoid=\"_zy_j\"></div>  <div autoid=\"_zy_l\"></div>  <div autoid=\"_zy_n\"></div>        </div><div>   <div></div> </div><div><div></div></div><div> <div class='listView'></div> </div><div> <div class='_zy_w _zy_x'></div> </div><div> <button autoid=\"_zy_y\" type='button' class='_zy_u ms-font-weight-regular'></button> </div><div> <div autoid=\"_zy_z\" class='_zy_u ms-font-weight-regular'></div> </div><div> <div class='_zy_z ms-font-weight-regular ms-bg-color-white'> <div class='_zy_A _zy_s'> <div role='menu' autoid=\"_zy_x\" class='listView'></div> </div> </div>    </div><div> <div></div> <div></div> </div>";_js.c.a().appendChild(n);return n};_zy._TI.bC=function(n){return n.E()};_zy._TI.cN=function(n){return n.gk};_zy._TI.O=function(n){return n.b};_zy._TI.cM=function(n){return n.hx};_zy._TI.bJ=function(n){return n.gI};_zy._TI.bL=function(n){return n.gJ};_zy._TI.cO=function(n){return n.jd};_zy._TI.R=function(n){return n.l};_zy._TI.J=function(n){return n.Z()};_zy._TI.Q=function(n){return n.h};_zy._TI.b=function(n){return n.L};_zy._TI.v=function(n){return _fce.l.isInstanceOfType(n)?n.k:null};_zy._TI.w=function(n){return _fce.l.isInstanceOfType(n)?n.bb:null};_zy._TI.cd=function(n){return n.n};_zy._TI.q=function(n){return n.bK()};_zy._TI.U=function(n){return n.o()};_zy._TI.bn=function(n){return n.j};_zy._TI.bj=function(n){return n.bg};_zy._TI.A=function(n){return n.k};_zy._TI.m=function(n){return n.f()};_zy._TI.x=function(n){return n.m};_zy._TI.y=function(n){return n.o};_zy._TI.dN=function(n){return n.b};_zy._TI.dP=function(n){return n.c};_zy._TI.dO=function(n){return n.e};_zy._TI.cc=function(n){return n.y};_zy._TI.bM=function(n){return n.bd};_zy._TI.bD=function(n){return n.b()};_zy._TI.bp=function(n){return n.jj};_zy._TI.cH=function(n){return n.qW()};_zy._TI.cG=function(n){return n.dw};_zy._TI.bt=function(n){return n.b()};_zy._TI.e=function(n){return n.iW};_zy._TI.cJ=function(n){return n.qX()};_zy._TI.cI=function(n){return n.dz};_zy._TI.cx=function(n){return n.qQ()};_zy._TI.cS=function(n){return n.gy};_zy._TI.k=function(n){return n.n()};_zy._TI.dd=function(n){return n.qZ()};_zy._TI.cU=function(n){return n.gA};_zy._TI.dq=function(n){return n.rR()};_zy._TI.dc=function(n){return n.gC};_zy._TI.i=function(n){return n.cw===1};_zy._TI.cy=function(n){return n.qR()};_zy._TI.cT=function(n){return n.jh};_zy._TI.di=function(n){return n.rs()};_zy._TI.cX=function(n){return n.jl};_zy._TI.cD=function(n){return n.qT()};_zy._TI.bI=function(n){return n.ji};_zy._TI.cL=function(n){return n.qY()};_zy._TI.n=function(n){return n.L};_zy._TI.bF=function(n){return _zy.a.isInstanceOfType(n)?n.hs():null};_zy._TI.z=function(n){return n.i};_zy._TI.G=function(n){return n.c()};_zy._TI.bH=function(n){return _zy.a.isInstanceOfType(n)?n.ht():null};_zy._TI.cC=function(n){return n.qS()};_zy._TI.cu=function(n){return n.qN()};_zy._TI.cQ=function(n){return n.jf};_zy._TI.ct=function(n){return n.qM()};_zy._TI.cP=function(n){return n.je};_zy._TI.cv=function(n){return n.qO()};_zy._TI.cR=function(n){return n.jg};_zy._TI.cF=function(n){return n.iU};_zy._TI.df=function(n){return n.rb()};_zy._TI.cE=function(n){return n.fo};_zy._TI.ds=function(n){return n.rT()};_zy._TI.dp=function(n){return n.ry()};_zy._TI.db=function(n){return n.jp};_zy._TI.dn=function(n){return n.rx()};_zy._TI.da=function(n){return n.jo};_zy._TI.dm=function(n){return n.rw()};_zy._TI.cZ=function(n){return n.jn};_zy._TI.cw=function(n){return n.qP()};_zy._TI.cK=function(n){return n.ja};_zy._TI.de=function(n){return n.ra()};_zy._TI.cV=function(n){return n.jk};_zy._TI.dk=function(n){return n.ru()};_zy._TI.cY=function(n){return n.jm};_zy._TI.dr=function(n){return n.rS()};_zy._TI.cB=function(n){return n.iQ};_zy._TI.dj=function(n){return n.rt()};_zy._TI.cA=function(n){return n.iP};_zy._TI.cz=function(n){return n.iO};_zy._TI.bK=function(n){return _zy.a.isInstanceOfType(n)?n.hv():null};_zy._TI.bG=function(n){return _zy.a.isInstanceOfType(n)?n.iY():null};_zy._TI.dl=function(n){return n.rv()};_zy._TI.cW=function(n){return n.gB};_zy._TI.M=function(n){return n.c()};_zy._TI.dg=function(n){return _zy.a.isInstanceOfType(n)?n.rq():null};_zy._TI.dh=function(n){return _zy.a.isInstanceOfType(n)?n.rr():null};_zy._TI.cm=function(n){return n.cv};_zy._TI.p=function(n){return n.dd()};_zy._TI.ba=function(n){return n.i};_zy._TI.bc=function(n){return n.p};_zy._TI.X=function(n){return n.j};_zy._TI.bP=function(n){return n.K};_zy._TI.Y=function(n){return n.q};_zy._TI.Z=function(n){return n.h};_zy._TI.bb=function(n){return n.v};_zy._TI.r=function(n){return n.dm()};_zy._TI.s=function(n){return n.cT()};_zy._TI.bs=function(n){return _fce.l.isInstanceOfType(n)?n.Z:null};_zy._TI.br=function(n){return _fce.l.isInstanceOfType(n)?n.o:null};_zy._TI.bx=function(n){return n.c()};_zy._TI.bz=function(n){return n.t()};_zy._TI.bA=function(n){return _fm.d.isInstanceOfType(n)?n.K():null};_zy._TI.V=function(n){return n.r};_zy._TI.ck=function(n){return n.b};_zy._TI.by=function(n){return n.p()};_zy._TI.ci=function(n){return n.F};_zy._TI.bB=function(n){return n.A};_zy._TI.ch=function(n){return n.E};_zy._TI.bW=function(n){return n.cv};_zy._TI.cg=function(n){return n.i};_zy._TI.bQ=function(n){return n.bx()};_zy._TI.cf=function(n){return n.f()};_zy._TI.cn=function(n){return n.a};_zy._TI.co=function(n){return n.e()};_zy._TI.cs=function(n,t){n.a(t)};_zy._TI.o=function(n,t){n.a(t)};_zy._TI.dw=function(n,t){n.mn(t)};_zy._TI.P=function(n,t){n.c(t)};_zy._TI.dv=function(n,t){n.ka(t)};_zy._TI.bo=function(n,t){n.W(t)};_zy._TI.dL=function(n,t){n.mq(t)};_zy._TI.dM=function(n,t){n.mr(t)};_zy._TI.T=function(n,t){n.k(t)};_zy._TI.L=function(n,t){n.bd(t)};_zy._TI.K=function(n,t){n.bm(t)};_zy._TI.j=function(n,t){n.k=t};_zy._TI.cl=function(n,t){n.b(t)};_zy._TI.c=function(n,t){n.bw(t)};_zy._TI.bm=function(n,t){n.i(t)};_zy._TI.bk=function(n,t){n.bp(t)};_zy._TI.d=function(n,t){n.ba(t)};_zy._TI.t=function(n,t){n.by(t)};_zy._TI.u=function(n,t){n.v=t};_zy._TI.cp=function(n,t){n.b=t};_zy._TI.cr=function(n,t){n.g=t};_zy._TI.cq=function(n,t){n.p=t};_zy._TI.D=function(n,t){n.cR(t)};_zy._TI.ce=function(n,t){n.V(t)};_zy._TI.bv=function(n,t){n.c(t)};_zy._TI.dt=function(n,t){n.ml(t)};_zy._TI.bw=function(n,t){n.d(t)};_zy._TI.bu=function(n,t){n.C(t)};_zy._TI.du=function(n,t){n.mm(t)};_zy._TI.be=function(n,t){n.h(t)};_zy._TI.dA=function(n,t){n.pB(t)};_zy._TI.l=function(n,t){n.m(t)};_zy._TI.f=function(n,t){n.C(t)};_zy._TI.dC=function(n,t){n.pE(t)};_zy._TI.dK=function(n,t){n.pL(t)};_zy._TI.g=function(n,t){n.i(t)};_zy._TI.h=function(n,t){n.M(t)};_zy._TI.dB=function(n,t){n.pC(t)};_zy._TI.dF=function(n,t){n.pG(t)};_zy._TI.I=function(n,t){n.d(t)};_zy._TI.S=function(n,t){n.j(t)};_zy._TI.H=function(n,t){n.e(t)};_zy._TI.dy=function(n,t){n.pz(t)};_zy._TI.dx=function(n,t){n.py(t)};_zy._TI.dz=function(n,t){n.pA(t)};_zy._TI.B=function(n,t){n.o(t)};_zy._TI.dJ=function(n,t){n.pK(t)};_zy._TI.dI=function(n,t){n.pJ(t)};_zy._TI.dH=function(n,t){n.pI(t)};_zy._TI.dD=function(n,t){n.pF(t)};_zy._TI.dG=function(n,t){n.pH(t)};_zy._TI.dE=function(n,t){n.bI(t)};_zy._TI.N=function(n,t){n.a(t)};_zy._TI.bU=function(n,t){n.a(t)};_zy._TI.bV=function(n,t){n.b(t)};_zy._TI.C=function(n,t){n.X(t)};_zy._TI.bd=function(n,t){n.g(t)};_zy._TI.bh=function(n,t){n.k(t)};_zy._TI.bl=function(n,t){n.i(t)};_zy._TI.bT=function(n,t){n.dM(t)};_zy._TI.bg=function(n,t){n.o(t)};_zy._TI.bf=function(n,t){n.j(t)};_zy._TI.bi=function(n,t){n.by(t)};_zy._TI.W=function(n,t){n.w(t)};_zy._TI.bE=function(n,t){n.N(t)};_zy._TI.cb=function(n,t){n.dC(t)};_zy._TI.ca=function(n,t){n.dB(t)};_zy._TI.cj=function(n,t){n.ba(t)};_zy._TI.bX=function(n,t){n.dj(t)};_zy._TI.bZ=function(n,t){n.dA(t)};_zy._TI.bY=function(n,t){n.dk(t)};_zy._TI.bS=function(n,t){n.cJ=t};_zy._TI.bR=function(n,t){n.b(t)};_zy._TI.dQ=function(n,t){n.cS(t)};_zy._TI.bN=function(){_zy._TI.F||(_zy._TI.F=new _b.bW);return _zy._TI.F};_zy._TI.bq=function(){_zy._TI.E||(_zy._TI.E=new _fc.k);return _zy._TI.E};_zy.f.registerClass("_zy.f");_zy.a.registerClass("_zy.a",_zz.h,_zz.bv);_zy.a.q.registerClass("_zy.a.q",_js.c);_zy.k.registerClass("_zy.k",_zz.r);_zy.l.registerClass("_zy.l",_a.dv);_zy.m.registerClass("_zy.m",_a.db);_zy.i.registerClass("_zy.i",_fce.R);_zy.g.registerClass("_zy.g",_fm.k);_zy.h.registerClass("_zy.h",_js.c);_zy.e.registerClass("_zy.e",_fm.f);_zy.j.registerClass("_zy.j");_zy.d.registerClass("_zy.d",_b.bb);RichTextEditorComponent.registerClass("RichTextEditorComponent",null,_a.ih);_zy._TI.registerClass("_zy._TI");_zy.a.l=new RegExp("(<style[^>]*>)[\\s]*p[\\s]*{[^}]*}","i");_zy.a.m=new RegExp("}[\\s]*p[\\s]*{[^}]*","gi");_zy.a.p=new RegExp("^\\s*<!--\\s*","i");_zy.a.o=new RegExp("\\s*-->\\s*$","i");_zy.a.f=new _H("ForeColorPicker",_b.U,_zy.a);_zy.a.c=new _H("BackColorPicker",_b.U,_zy.a);_zy.a.j=new _H("TableQuickInsertMenu",_zy.e,_zy.a);_zy.a.d=["OWAUnderLineID","OWAItalicID","OWAStrongID"];_zy.a.e=new _H("EditTableContextMenu",_fm.f,_zy.a);_zy.a.i=new _H("InsertTableDialog",_bc.i,_zy.a);_zy.a.h=new _H("InsertLinkDialog",_bc.i,_zy.a);_zy.a.g=new _H("InsertAltTextDialog",_bc.i,_zy.a);_zy.a.n=[new StyleFileRecord("nbsprite1.mouse.css","Sprite"),new StyleFileRecord("sprite1.mouse.css","Sprite"),new StyleFileRecord("microsoft.owa.core.controls.editorbase.mouse.css","Standard"),new StyleFileRecord("microsoft.fabric.controls.extended.mouse.css","Standard")];_zy.a.k=["microsoftajax.js","ms.rte.js","rteinit.js"];_zy.a.a.a=null;_zy.c.d=["#757b80","#bd1398","#7232ad","#006fc9","#4ba524","#e2c501","#d05c12","#FF0000","#FFFFFF","#000000"];_zy.c.c=[_nbs.a.Ve,_nbs.a.Tp,_nbs.a.nF,_nbs.a.RQ,_nbs.a.Fg,_nbs.a.DD,_nbs.a.SF,_nbs.a.C,_nbs.a.fE,_nbs.a.bP];_zy.c.a=["#ffff00","#00ff00","#00ffff","#ff00ff","#0000ff","#ff0000","#bebebe","#666666","#FFFFFF","#000000"];_zy.c.b=[_nbs.a.DD,_nbs.a.Fg,_nbs.a.Em,_nbs.a.nF,_nbs.a.RQ,_nbs.a.C,_nbs.a.Ve,_nbs.a.mZ,_nbs.a.fE,_nbs.a.bP];_zy.e.a=100;_zy.d.b="QuickInsertLayoutPanel";_zy.d.a="RtlQuickInsertLayoutPanel";RichTextEditorComponent.$$cctor();_zy._TI._hf=_zy._TI.bO();_zy._TI.F=null;_zy._TI.E=null;_zy._TI.a={};_zy._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.controls.richtexteditor.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.controls.richtexteditor.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
