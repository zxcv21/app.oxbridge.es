try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.shellplusg2.o365.js'] = (new Date()).getTime();
Type.registerNamespace("_sp2");_sp2.v=function(n){this.g=Function.createDelegate(this,this.i);this.h=Function.createDelegate(this,this.j);this.f=n;this.d=new _js.f;this.e=new _js.f;this.f.l().d(this.h);this.f.k().d(this.g)};_sp2.v.prototype={f:null,d:null,e:null,b:function(){return this.d},a:function(n,t){this.f.i(n.f)},c:function(n){this.f.p(n.f)},j:function(n,t){if(t.c===2||t.c===3)for(var u=0;u<t.b.length;u++)for(var r=0;r<this.d.y.length;r++){var e=t.b[u];var f=this.d.y[r];e===f.f&&this.d.m(f,!0)}if(!t.c||t.c===3)for(var i=0;i<t.a.length;i++)this.d.a(new _sp2.u(t.a[i]))},i:function(n,t){if(t.c===2||t.c===3)for(var u=0;u<t.b.length;u++)for(var r=0;r<this.e.y.length;r++){var e=t.b[u];var f=this.e.y[r];e===f.e&&this.e.m(f,!0)}if(!t.c||t.c===3)for(var i=0;i<t.a.length;i++)this.e.a(new _sp2.p(t.a[i]))}};_sp2.u=function(n){this.f=n};_sp2.u.prototype={f:null,d:function(){return this.f.r},e:function(){return new _sp2.p(this.f.j)},a:function(){try{return Microsoft.O365.SuiteApi.SkypeIntegration.c.d(this.f.D)}catch(n){return"Unknown"}},b:function(){return this.f.x},c:function(){return this.f.A}};_sp2.p=function(n){_sp2.p.initializeBase(this);this.e=n;var r=this;this.e.apcl("DisplayName",function(n,t){r.bk("DisplayName")});var u=this;this.e.apcl("Presence",function(n,t){u.bk("Presence")});var t=this;this.e.apcl("AvatarUrl",function(n,i){t.bk("AvatarUrl")});var i=this;this.e.apcl("Title",function(n,t){i.bk("Title")})};_sp2.p.prototype={e:null,b:function(){return this.e.c()},c:function(){return this.e.ds},a:function(){return this.e.cM()},d:function(){return this.e.dq()}};function O365ShellPlusG2Component(){}O365ShellPlusG2Component.$$cctor=function(){_a.r.a().a(O365ShellPlusG2Component)};O365ShellPlusG2Component.prototype={a:function(n,t,i){var r=!1;if(!window.O365SuiteServiceProxy){r=!0;_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place1 O365ShellPlusG2ComponentConfigStart is null")}_o365sa.a.g(n);_o365sg2p.a.b=n.a(_o365sg2c.s);if(!r&&!window.O365SuiteServiceProxy){r=!0;_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place2 O365ShellPlusG2ComponentAfterCalendarAdapterInitialize is null")}if(i.a()==="Mouse"){var b=this;n.b(IChangeThemeMenuItemClickHandler,function(){return new _sp2.w(n.a(IUserThemesHandler))});var k=this;n.b(_sp2.s,function(){if(!r&&!window.O365SuiteServiceProxy){r=!0;_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place3 RegisterAppsManager is null")}return new _sp2.s(n.a(_ff.c))}).b(IGlobalAppsManager).a();var p=this;n.b(_sp2.m,function(){return new _sp2.m(n.a(_a.dZ),n.a(_ff.c))});var w=this;n.b(IUserThemesHandler,function(){return new _sp2.A(n.a(_ff.c),n.a(_a.s),n.a(_g.a),n.a(_sp2.m))}).a();var d=this;n.b(_sp2.a,function(){if(!r&&!window.O365SuiteServiceProxy){r=!0;_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place4 RegisterFlexPanePanelViewModel is null")}try{var t=n.a(_y.a);return new _sp2.a(_o365sg2p.l.a(),n.a(_o365sg2c.s),n.a(_y.q),n.d(IUserThemesHandler),n.a(_a.cs),n.a(_ff.c),n.a(_js.k),n.d(INFDContentProvider),n.c(IChatManagerFactory),t.D||(t.D=Function.createDelegate(t,t.L)),n.a(_g.bd).bh.IsBposUser,n.a(_y.L),n.c(IOptionsLoader))}catch(i){n?n.a(_y.q)?_js.Trace.logError(_a.a.f,"The FlexPaneShim class reference is null within the FlexPanePanelViewModel container resolve."):_js.Trace.logError(_a.a.f,"The PrimaryViewModel resolve is null within the FlexPanePanelViewModel container resolve."):_js.Trace.logError(_a.a.f,"The container is null within the FlexPanePanelViewModel container resolve.");throw i;}}).b(IFlexPanePanelViewModel).a();var f=i.e().a().t().Enabled;var u=i.e().a().bd().Enabled;if(f||u){var tt=this;n.b(_sp2.r,function(){return new _sp2.r(n.a(_g.a),n.a(_y.a),_a.k.a,n.a(_sp2.b),n.a(_sp2.i),n.a(_sp2.k),n.a(_sp2.d),n.a(_sp2.g),n.a(_sp2.l),n.a(_sp2.f),n.a(_sp2.c),n.a(_sp2.e),n.a(_sp2.j),n.a(_sp2.h))}).b(INFDContentProvider).a();var it=this;n.b(_sp2.b,function(){return new _sp2.b(n.a(_a.bb),n.a(_a.z).c())});var g=this;n.b(_sp2.i,function(){return new _sp2.i(n.a(_a.bb),n.a(_a.z).c())});var nt=this;n.b(_sp2.k,function(){return new _sp2.k(n.a(_a.f),_o365sg2p.l.a(),n.a(_a.z).c())});var e=this;n.b(_sp2.d,function(){return new _sp2.d(n.a(_y.bT).d())});var s=this;n.b(_sp2.g,function(){return new _sp2.g(n.a(_y.bT).e())});var h=this;n.b(_sp2.l,function(){return new _sp2.l(n.a(_y.bT).c())});var o=this;n.b(_sp2.f,function(){return new _sp2.f(n.a(_y.q),n.a(_a.z).c())});var v=this;n.b(_sp2.c,function(){return new _sp2.c(n.a(_a.bb),n.c(IOptionsPathGenerator))});var y=this;n.b(_sp2.e,function(){return new _sp2.e(!!n.a(_g.a).c().bh.UserVoiceId,!0,n.a(_g.bd).bh.UserVoiceUrl,n.a(_y.bT).f())});var a=this;n.b(_sp2.j,function(){return new _sp2.j(n.a(_a.z).c())});var c=this;n.b(_sp2.h,function(){return new _sp2.h(n.a(_y.q),n.a(_a.bp))})}}else{var l=this;n.b(IGlobalMiniaturesPlusViewModel,function(){return new _sp2.C(n.d(ICalendarMiniatureNextAppointmentManager),i.a(),t.a(),n.a(_a.f),n.d(IModernGroupsNavigationFactory),n.a(IGlobalMiniaturesViewModel))}).a()}},b:function(){return null}};_sp2.A=function(n,t,i,r){this.e=t;this.h=n;this.g=i;this.f=r};_sp2.A.prototype={h:null,e:null,g:null,f:null,b:null,c:null,d:null,OverrideGetUserThemeId:function(){return!0},OverrideChangeTheme:function(){return!0},OverrideLoadUserThemesData:function(){return!0},OverrideSaveTheme:function(){return!0},GetUserThemeId:function(n){var t=this.i();n(t)},ChangeTheme:function(n){var t=n.Id;var r=[];var i=[];if(this.d){r=this.d[t].ColorNames;i=this.d[t].ColorValues}this.f.j(t,r,i)},SaveTheme:function(n,t,i){this.c=_a.d.b(_a.a.f,"SaveTheme");var r=new _c.bw(n);if(r){var f=this;r.w(function(n){if(f.c){var i=new _a.q;i.b("T",r.b);f.c.l=r.C();f.c.j=i.toString();_a.d.a(f.c);f.c=null}t()});var u=this;r.v(function(n){if(u.c){u.c.k=r.D();u.c.l=r.C();_a.d.a(u.c);u.c=null}i(n.t)});this.e.a(r)}else{if(this.c){_a.d.a(this.c);this.c=null}t()}},LoadUserThemesData:function(n,t){this.b=_a.d.b(_a.a.f,"LoadUserThemesData");var f=[];var r=new _c.bp;var i=this;r.w(function(u){var y=r.b;var l=y.Themes;var p=y.ThemePath;if(!l){var v="FailedToLoadTheme";if(i.b){i.b.k=v;i.b.l=r.C();_a.d.a(i.b);i.b=null}t(Error.create(v))}i.d={};for(var c=0;c<l.length;c++){var s={};var e=l[c];var h=e.FolderName;s.Id=h;s.Name=i.f.h(e.DisplayName);s.ThumbnailUrl=String.format(p,h)+"images/0/themepreview.png";if(h&&h.toLowerCase()==="base"&&e.ColorNames){var a=Array.indexOf(e.ColorNames,"topnavBG");if(a>-1){var o=e.ColorValues[a];o.startsWith("#")&&(o=o.substring(1,o.length));s.ThemeColors=[o]}}i.d[h]=e;Array.add(f,s)}if(i.b){i.b.l=r.C();_a.d.a(i.b);i.b=null}n(f)});var u=this;r.v(function(n){if(u.b){u.b.k=n.D();u.b.l=r.C();_a.d.a(u.b);u.b=null}t(n.t)});this.e.a(r)},i:function(){var t=this.g.bh.PolicySettings.DefaultTheme;_js.d.b(t)&&(t="base");var n=this.g.a().bh.ThemeStorageId;_js.d.b(n)&&(n=t);return n}};_sp2.w=function(n){this.b=n};_sp2.w.prototype={b:null,a:function(){return!0}};_sp2.m=function(n,t){this.c=new RegExp("themes\\/\\w+\\/images","g");this.e=n;this.b=t};_sp2.m.prototype={a:null,e:null,b:null,h:function(n){var t=n;switch(n){case"__base__":t=_nbs.a.SG;break;case"__black__":t=_nbs.a.hV;break;case"__blueprint__":t=_nbs.a.ic;break;case"__cats__":t=_nbs.a.Kr;break;case"__circuit__":t=_nbs.a.mm;break;case"__contrast__":t=_nbs.a.jG;break;case"__cordovan__":t=_nbs.a.GM;break;case"__cubism__":t=_nbs.a.L;break;case"__darkcordovan__":t=_nbs.a.G;break;case"__darkorange__":t=_nbs.a.EM;break;case"__lightblue__":t=_nbs.a.Pu;break;case"__lightgreen__":t=_nbs.a.TU;break;case"__lite__":t=_nbs.a.Us;break;case"__blueberry__":t=_nbs.a.SX;break;case"__grape__":t=_nbs.a.UT;break;case"__orange__":t=_nbs.a.cT;break;case"__mediumdarkblue__":t=_nbs.a.TD;break;case"__pink__":t=_nbs.a.nv;break;case"__pomegranate__":t=_nbs.a.NJ;break;case"__raspberry__":t=_nbs.a.nb;break;case"__teal__":t=_nbs.a.Vi;break;case"__watermelon__":t=_nbs.a.BN;break;case"__minimal__":t=_nbs.a.ni;break;case"__modern__":t=_nbs.a.Tx;break;case"__paint__":t=_nbs.a.lV;break;case"__primary__":t=_nbs.a.Tf;break;case"__super__":t=_nbs.a.Uv;break;case"__teagarden__":t=_nbs.a.Xg;break;case"__whimsical__":t=_nbs.a.Fj;break;case"__wntrld__":t=_nbs.a.iK;break;case"__wrld__":t=_nbs.a.lu;break;case"__bricks__":t=_nbs.a.fv;break;case"__pixel__":t=_nbs.a.my;break;case"__simple__":t=_nbs.a.ap;break;case"__spectrum__":t=_nbs.a.lJ;break;case"__jelly__":t=_nbs.a.gR;break;case"__mountain__":t=_nbs.a.iZ;break;case"__diamonds__":t=_nbs.a.Kq;break;case"__whale__":t=_nbs.a.nH;break;case"__far__":t=_nbs.a.kf;break;case"__chevron__":t=_nbs.a.Fy;break;case"__polka__":t=_nbs.a.Tc;break;case"__beach__":t=_nbs.a.QP;break;case"__comic__":t=_nbs.a.Mh;break;case"__crayon__":t=_nbs.a.ny;break;case"__robot__":t=_nbs.a.YB;break;case"__angular__":t=_nbs.a.cA;break;case"__cubes__":t=_nbs.a.iw;break;case"__balloons__":t=_nbs.a.fK;break;case"__strawberry__":t=_nbs.a.DO;break;default:break}return t},j:function(n,t,i){this.k();_js.j.f(t,"colorNames");_js.j.f(i,"colorValues");var u=this.f(t,i);var f=this.d(".ms-bg-color-themeDark, .ms-bgc-td, .ms-bg-color-themeDark-hover:hover, .ms-bg-color-themeDark-before:before, .ms-bgc-td-h:hover, .ms-bgc-td-b:before { background-color: @color-themeDark; }.ms-bg-color-themeDarkAlt, .ms-bgc-tda, .ms-bg-color-themeDarkAlt-hover:hover, .ms-bg-color-themeDarkAlt-before:before, .ms-bgc-tda-h:hover, .ms-bgc-tda-b:before { background-color: @color-themeDarkAlt; }.ms-bg-color-themeDarker, .ms-bgc-tdr, .ms-bg-color-themeDarker-hover:hover, .ms-bg-color-themeDarker-before:before, .ms-bgc-tdr-h:hover, .ms-bgc-tdr-b:before { background-color: @color-themeDarker; }.ms-bg-color-themePrimary, .ms-bgc-tp, .ms-bg-color-themePrimary-hover:hover, .ms-bg-color-themePrimary-before:before, .ms-bgc-tp-h:hover, .ms-bgc-tp-b:before { background-color: @color-themePrimary; }.ms-bg-color-themeSecondary, .ms-bgc-ts, .ms-bg-color-themeSecondary-hover:hover, .ms-bg-color-themeSecondary-before:before, .ms-bgc-ts-h:hover, .ms-bgc-ts-b:before { background-color: @color-themeSecondary; }.ms-bg-color-themeTertiary, .ms-bgc-tt, .ms-bg-color-themeTertiary-hover:hover, .ms-bg-color-themeTertiary-before:before, .ms-bgc-tt-h:hover, .ms-bgc-tt-b:before { background-color: @color-themeTertiary; }.ms-bg-color-themeLight, .ms-bgc-tl, .ms-bg-color-themeLight-hover:hover, .ms-bg-color-themeLight-before:before, .ms-bgc-tl-h:hover, .ms-bgc-tl-b:before { background-color: @color-themeLight; }.ms-bg-color-themeLighter, .ms-bgc-tlr, .ms-bg-color-themeLighter-hover:hover, .ms-bg-color-themeLighter-before:before, .ms-bgc-tlr-h:hover, .ms-bgc-tlr-b:before { background-color: @color-themeLighter; }.ms-bg-color-themeLighterAlt, .ms-bgc-tla, .ms-bg-color-themeLighterAlt-hover:hover, .ms-bg-color-themeLighterAlt-before:before, .ms-bgc-tla-h:hover, .ms-bgc-tla-b:before { background-color: @color-themeLighterAlt; }.ms-border-color-themeDark, .ms-bcl-td, .ms-border-color-themeDark-hover:hover, .ms-border-color-themeDark-before:before, .ms-bcl-td-h:hover, .ms-bcl-td-b:before { border-color: @color-themeDark; }.ms-border-color-themeDarkAlt, .ms-bcl-tda, .ms-border-color-themeDarkAlt-hover:hover, .ms-border-color-themeDarkAlt-before:before, .ms-bcl-tda-h:hover, .ms-bcl-tda-b:before { border-color: @color-themeDarkAlt; }.ms-border-color-themeDarker, .ms-bcl-tdr, .ms-border-color-themeDarker-hover:hover, .ms-border-color-themeDarker-before:before, .ms-bcl-tdr-h:hover, .ms-bcl-tdr-b:before { border-color: @color-themeDarker; }.ms-border-color-themePrimary, .ms-bcl-tp, .ms-border-color-themePrimary-hover:hover, .ms-border-color-themePrimary-before:before, .ms-bcl-tp-h:hover, .ms-bcl-tp-b:before { border-color: @color-themePrimary; }.ms-border-color-themeSecondary, .ms-bcl-ts, .ms-border-color-themeSecondary-hover:hover, .ms-border-color-themeSecondary-before:before, .ms-bcl-ts-h:hover, .ms-bcl-ts-b:before { border-color: @color-themeSecondary; }.ms-border-color-themeTertiary, .ms-bcl-tt, .ms-border-color-themeTertiary-hover:hover, .ms-border-color-themeTertiary-before:before, .ms-bcl-tt-h:hover, .ms-bcl-tt-b:before { border-color: @color-themeTertiary; }.ms-border-color-themeLight, .ms-bcl-tl, .ms-border-color-themeLight-hover:hover, .ms-border-color-themeLight-before:before, .ms-bcl-tl-h:hover, .ms-bcl-tl-b:before { border-color: @color-themeLight; }.ms-border-color-themeLighter, .ms-bcl-tlr, .ms-border-color-themeLighter-hover:hover, .ms-border-color-themeLighter-before:before, .ms-bcl-tlr-h:hover, .ms-bcl-tlr-b:before { border-color: @color-themeLighter; }.ms-border-color-themeLighterAlt, .ms-bcl-tla, .ms-border-color-themeLighterAlt-hover:hover, .ms-border-color-themeLighterAlt-before:before, .ms-bcl-tla-h:hover, .ms-bcl-tla-b:before { border-color: @color-themeLighterAlt; }.ms-border-color-top-themePrimary, .ms-bcl-t-tp, .ms-border-color-top-themePrimary-hover:hover, .ms-border-color-top-themePrimary-before:before, .ms-bcl-t-tp-h:hover, .ms-bcl-t-tp-b:before { border-top-color: @color-themePrimary; }.ms-font-color-themeDark, .ms-fcl-td, .ms-font-color-themeDark-hover:hover, .ms-font-color-themeDark-before:before, .ms-fcl-td-h:hover, .ms-fcl-td-b:before { color: @color-themeDark; }.ms-font-color-themeDarkAlt, .ms-fcl-ta, .ms-font-color-themeDarkAlt-hover:hover, .ms-font-color-themeDarkAlt-before:before, .ms-fcl-ta-h:hover, .ms-fcl-tda-b:before { color: @color-themeDarkAlt; }.ms-font-color-themeDarker, .ms-fcl-tdr, .ms-font-color-themeDarker-hover:hover, .ms-font-color-themeDarker-before:before, .ms-fcl-tdr-h:hover, .ms-fcl-tdr-b:before { color: @color-themeDarker; }.ms-font-color-themePrimary, .ms-fcl-tp, .ms-font-color-themePrimary-hover:hover, .ms-font-color-themePrimary-before:before, .ms-fcl-tp-h:hover, .ms-fcl-tp-b:before { color: @color-themePrimary; }.ms-font-color-themeSecondary, .ms-fcl-ts, .ms-font-color-themeSecondary-hover:hover, .ms-font-color-themeSecondary-before:before, .ms-fcl-ts-h:hover, .ms-fcl-ts-b:before { color: @color-themeSecondary; }.ms-font-color-themeTertiary, .ms-fcl-tt, .ms-font-color-themeTertiary-hover:hover, .ms-font-color-themeTertiary-before:before, .ms-fcl-tt-h:hover, .ms-fcl-tt-b:before { color: @color-themeTertiary; }.ms-font-color-themeLight, .ms-fcl-tl, .ms-font-color-themeLight-hover:hover, .ms-font-color-themeLight-before:before, .ms-fcl-tl-h:hover, .ms-fcl-tl-b:before { color: @color-themeLight; }.ms-font-color-themeLighter, .ms-fcl-tlr, .ms-font-color-themeLighter-hover:hover, .ms-font-color-themeLighter-before:before, .ms-fcl-tlr-h:hover, .ms-fcl-tlr-b:before { color: @color-themeLighter; }.ms-font-color-themeLighterAlt, .ms-fcl-tla, .ms-font-color-themeLighterAlt-hover:hover, .ms-font-color-themeLighterAlt-before:before, .ms-fcl-tla-h:hover, .ms-fcl-tla-b:before { color: @color-themeLighterAlt; }",u);var o=this.d(".o365cs-base.o365cst .o365cs-topnavLinkBackground-2{background-color:@topnavLinkBG;background-color:@topnavLinkBGrgb;}.o365cs-base.o365cst .o365cs-topnavText,.o365cs-base.o365cst .o365cs-topnavText:hover{color:@topnavText;}.o365cs-base.o365cst .o365cs-navMenuButton{color:@navmenu;}.o365cs-base.o365cst.o365cs-topnavBGColor-2{background-color:@topnavBG;}.o365cs-base.o365cst.o365cs-appLauncherBackground{background-color:@appLauncherBG}",u);var e=window.self.document.getElementsByTagName("head")[0];var r=window.document.createElement("style");r.id=String.format("previewTheme{0}_{1}",n,"ThemeColorStyle");r.innerHTML=f+o;e.appendChild(r);this.a=n;this.i(n)},k:function(){_js.d.a(this.a)||this.g(this.a,"ThemeColorStyle").remove()},g:function(n,t){var i=String.format("previewTheme{0}_{1}",n,t);return $("#"+i)},i:function(n){var i=$get("O365_NavHeader");i&&(i.style.backgroundImage="none");this.b.a(_a.dG,new _a.dG(n));if(!_js.d.b(n)&&n!=="base"){var f=$get("HeaderImages");if(f){var t=f.innerHTML;var u="background:";var r=t.indexOf(u);var o=t.substring(r+u.length,t.indexOf(";",r));var e=o.replace(this.c,String.format("themes/{0}/images",n));i.style.backgroundImage=e}}},f:function(n,t){for(var r={},i=0;i<n.length;i++)r["@"+n[i]]=t[i];return r},d:function(n,t){for(var s=new RegExp("@([^;}\\/\\\\]+)","g"),o=new RegExp("(^(#)?[0-9A-F]{6}$)|(^(#)?[0-9A-F]{3}$)","i"),u,f=n.match(s),r=0;r<f.length;r++){var e=t[f[r]];if(e){var i=e.toString();u=o.test(i)?i.startsWith("#")?i:"#"+i:i;n=n.replace(f[r],u)}}return n}};_sp2.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.r=Function.createDelegate(this,this.Y);this.I=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.S);this.H=Function.createDelegate(this,this.U);this.K=Function.createDelegate(this,this.Z);this.J=Function.createDelegate(this,this.X);this.q=Function.createDelegate(this,this.W);_sp2.a.initializeBase(this);this.e=n;this.o=t;this.p=r;this.h=u;this.f=f;this.z=o;this.D=i;this.v=i.a();this.F=e;this.y=!!this.h.a().d()&&this.h.a().d().Enabled;this.t=s;this.n=h;this.x=c;this.C=l;this.A=a};_sp2.a.prototype={C:null,e:null,l:!1,g:null,o:null,p:null,h:null,f:null,z:null,k:null,v:null,F:null,j:null,i:null,E:!1,y:!1,t:null,n:null,x:!1,D:null,A:null,c:function(){return this.l},ba:function(n){if(this.l!==n){this.l=n;this.ea("ShowFlexPane");var t=0;this.l&&(t=this.D.M);this.f.a(_a.ee,new _a.ee(t));if(this.y){this.f.a(_a.bV,new _a.bV(!this.l,"NotLoadedByFlexPane"));if(!this.l){var i=this.Q();this.f.a(_a.bo,new _a.bo(i))}}}return n},V:function(n){this.ba(n)},O:function(){return(this.h.a().t()?this.h.a().t().Enabled:!1)||(this.h.a().bd()?this.h.a().bd().Enabled:!1)},P:function(){return!!this.h.a().K()&&this.h.a().K().Enabled},a:function(n){_a.b.b(n,"sharedHeaderViewModel");_a.b.d(_o365sg2c.e.isInstanceOfType(n),"sharedHeaderViewModel type not match.");window.O365SuiteServiceProxy||_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place7 FlexPanePanelViewModelInitialize is null");this.g=n;_o365sg2c.b.e=this.P();this.e.Q(this.g);if(_o365sg2c.b.a&&!this.e.a.v){var s=new _o365sg2p.bo;var c=this;this.e.a.E=function(n,t,i){c.f.a(_mgn.n,new _mgn.n(n,t,i))};var f=this;this.e.a.t=function(){f.f.a(_y.v,new _y.v(2,function(){f.f.a(_y.ci,new _y.ci)},!0,!0,!0,!1,!0))};var h=this;this.e.a.u=function(){h.C.a(1055,1)};this.e.a.Q(!1,s);this.g.b.O(this.e.a.i);this.f.b(_y.bF,this.q);this.f.b(ISendFailedO365Event,this.J);this.f.b(ISendFailureRemoveO365Event,this.K);this.f.b(_y.eL,this.H);this.f.b(_y.bF,this.q);this.M(this.v);var i=this;this.t.a(function(n){i.T(n.a(),i.e.a)});var r=this.e.a.e;var u=this.e.a.l;var t=this.e.a.c;r&&r.be(this.n("email_notify.mp3"));u&&u.m(this.n("calendar_notify.mp3"));if(t&&!this.x){t.bc(this.n("calendar_notify.mp3"));var e=new _C(this.G,_a.a.d);var o={PasswordExpiryAlert:e};t.v=o}}this.O()&&this.R();this.e.bb(!1);this.e.y(!0);this.e.L(this.I)},R:function(){if(this.e.j){var n=this;this.z.a(function(t){n.e.j.bs(t.a())})}},b:function(){if(this.k)this.e.n("ThemePanelViewTemplateID");else{var n=this;this.p.a(function(t){n.k=t;n.L(n.k,!0);n.e.n("ThemePanelViewTemplateID")})}},d:function(n){var i=this.g.b.g.o?this.g.b.g.o.d:null;var t=this;var r=new _C(function(){n&&n();t.k||t.p.a(function(n){t.k=n;t.L(t.k,!1)});i&&i()},_a.a.f);this.g.b.g.e(r)},N:function(){this.e.m("ThemePanelViewTemplateID")},L:function(n,t){var i=null;if(t){var r=this;i=function(){r.N()}}this.g.X(n);this.e.I(new _o365sg2p.bb(this.g,n,this.o,new _o365sg2p.bV(this.o),i));if(t){if(this.g.b.b){this.e.c.a=this.g.b.b;this.e.c.a.bq(!1)}this.e.b.ThemePanelViewTemplateID=this.e.c}else this.e.c.k(!0)},W:function(n){this.M(n.a)},M:function(n){n&&this.e.a.bi(!n.a&&!n.c)},m:function(){if(!this.j){this.j=new _o365sa.SAl;this.j.Title=_u.R.Tu;this.j.IsLocal=!0;this.j.NotificationToastShouldPersist=!0}return this.j},w:function(){if(!this.i){this.i=new _o365sa.SAl;this.i.Title=_u.R.aZ;this.i.ActionText=_u.R.IH;this.i.IsLocal=!0;this.i.NotificationToastShouldPersist=!0}return this.i},X:function(n){if(n.c())if(n.d()){this.m().ActionText=n.b();this.m().ActionCallback=n.a();this.e.a.c.r(this.m());this.e.a.c.a.d(this.r)}else{this.w().ActionCallback=n.a();this.e.a.c.r(this.w())}},Z:function(n){if(n.a()){this.E=!0;this.e.a.c.a.e(this.r);this.e.a.c.a.m(this.m(),!0)}else this.e.a.c.a.m(this.w(),!0)},U:function(n){var t=new _o365sa.SAl;t.Title=n.c()?_u.R.TC:_u.R.IQ;t.IsLocal=!0;t.ActionText=n.b();t.ActionCallback=n.a();this.e.a.c.r(t)},Y:function(n,t){if(!$a(t.b))for(var r=0;r<t.b.length;r++)if(t.b[r]===this.m()){var i=this;this.F.a(_a.a.f,"Process send failure alert",function(){i.E||i.e.a.c.r(i.m())},0)}},T:function(n,t){t.g(new _o365sg2p.bl(new _sp2.v(n)));var i=t.G;i&&i.E(this.n("im_notify.mp3"))},S:function(){var n=this;this.A.a(function(n){n.a(101,null,null)})},Q:function(){if("NotificationsID"in this.e.b&&!this.e.a.h())return"MNotif";else if("SkypeID"in this.e.b&&!this.e.l.h())return"MSkype";else if("NFD"in this.e.b&&!this.e.j.h())return"MHelp";else if("ThemePanelViewTemplateID"in this.e.b&&!this.e.c.h())return"MTheme";return"MPanel"}};_sp2.s=function(n){this.b=new _o365sg2p.cr(n)};_sp2.s.prototype={b:null,a:function(n){_js.j.b(n,"sharedHeaderViewModel");_js.j.c(_o365sg2c.e.isInstanceOfType(n),"sharedHeaderViewModel type not match.");window.O365SuiteServiceProxy||_js.Trace.logError(_a.a.f,"O365SuiteServiceProxy place6 GlobalAppsManagerInitialize is null");this.b.U(n);n.q=this.b}};_sp2.B=function(n){this.c=n;this.a=new _js.f};_sp2.B.prototype={c:null,a:null,b:null,BegineGetNextAppointments:function(n,t,i,r,u){this.b=this.c.f();this.c.l(r);this.a.g();if(this.b)for(var o=0;o<this.b.y.length;o++){var e=new _o365sg2p.I;var f=this.b.y[o];e.m=f.bh.ItemId;e.n=f.bh.ParentFolderId;e.i=f.k();e.h=f.bh.Subject;e.g=f.r()?f.r().bh.DisplayName:"";e.a=f.a();e.b=f.b();e.d=f.bh.IsAllDayEvent;e.l=f.e()?f.e().f():!1;this.a.a(e)}t&&t(this.a.f())}};_sp2.o=function(n){_sp2.o.initializeBase(this);this.a=n};_sp2.o.prototype={a:null};_sp2.C=function(n,t,i,r,u,f){_sp2.C.initializeBase(this);t==="Mouse"&&_a.b.i("Mouse layout is not supported in GlobalMiniaturesPlusViewModel");this.c=f.c;var s=t==="TouchWide"?1:2;if(u){var o=this;u.a(function(n){var t=i||r.a().bD().Enabled;o.e=t?new _sp2.n(n,f,i):null;o.c.v(o.e)})}if(n){var e=this;n.a(function(n){e.d=new _o365sg2p.k(new _sp2.B(n),s);e.c.a&&e.c.a.i(e.d)})}};_sp2.C.prototype={c:null,d:null,e:null,a:function(){return this.d},b:function(){return this.e}};_sp2.n=function(n,t,i){this.D=Function.createDelegate(this,this.O);this.A=Function.createDelegate(this,this.F);this.E=Function.createDelegate(this,this.P);this.C=Function.createDelegate(this,this.I);_sp2.n.initializeBase(this);_js.Trace.logInfo(_a.a.f,"GroupsViewModelAdapter -- initialize");this.c=t;this.c.c.m(this.C);this.c.F(this.E);this.n=i;var r=this;_js.g.a().d(_ff.e.a,"GroupsViewModelAdapter",function(){r.a=n.g;r.d=new _sp2.t(r.a.A);r.H();r.g=new _js.f;r.i=new _js.f;r.j=new _js.f;r.L();r.F();r.a.m(r.A)})};_sp2.n.prototype={c:null,d:null,a:null,g:null,i:null,j:null,n:!1,q:function(){return this.a?this.a.bc:!1},p:function(){return this.a?this.a.bb:!1},r:function(){return this.a?this.a.N:!1},t:function(){return!this.n},u:function(){return this.a?this.a.O:!1},e:function(){var n=this.a?this.a.E:!1;_js.Trace.logInfo(_a.a.f,"GroupsViewModelAdapter IsReady {0}",n);return n},v:function(){return this.a?this.a.p():!0},w:function(){return this.g},x:function(){return this.i},z:function(){return this.j},y:function(){return this.d},l:function(n){this.d=n;if(null===this.d){if(!this.a.A){_js.Trace.logInfo(_a.a.f,"Clear selected group");this.K()}}else{_js.Trace.logInfo(_a.a.f,"Cache selected group");this.J(this.d.a.a());this.a.G(this.d.a)}this.b("SelectedGroup");return n},o:function(){var n=this;return new _C(function(){n.c.a();n.a.Q.a()},_ff.e.a)},b:function(n){this.bk(n)},N:function(n){this.bU(n)},M:function(n){for(var t=0;t<n.y.length;t++)n.y[t].dispose();n.g()},P:function(){if(this.e()){this.a.G(null);this.l(null)}},L:function(){var r=this;this.a.apcl("HasJoinedAndVisitedGroups",function(){r.b("HasJoinedAndVisitedGroups")});var u=this;this.a.apcl("HasPinnedAndUnpinnedGroups",function(){u.b("HasPinnedAndUnpinnedGroups")});var f=this;this.a.apcl("InitialGroupsLoadFailed",function(){f.b("InitialGroupsLoadFailed")});var n=this;this.a.apcl("IsReady",function(){n.b("IsReady")});var t=this;this.a.apcl("IsWelcomeMessageHidden",function(){t.b("IsWelcomeMessageHidden")});var i=this;this.a.apcl("HideBrowseGroups",function(){i.b("HideBrowseGroups")});this.a.bv(this.D);this.N(_sp2.n.a)},O:function(n){this.I()},I:function(){this.c.c.d||this.H()},H:function(){this.c.c.o(this.e()&&!!this.a.A&&this.a.A.k!==1)},F:function(){this.m(this.a.x,this.g,"JoinedGroups");this.m(this.a.y,this.i,"PinnedGroups");this.m(this.a.z,this.j,"VisitedGroups")},m:function(n,t,i){if(t){t.y.length&&this.M(t);for(var r=n.y.length-1;r>=0;r--)t.u(0,new _sp2.t(n.y[r]));this.b(i)}}};_sp2.t=function(n){this.e=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);_sp2.t.initializeBase(this);this.a=n;this.j(this.a.j.unseenData.bh.UnseenCount);this.i(this.a.j.bh.DisplayName);this.a.j.unseenData.apcl("LastVisitedTime",this.g);this.a.j.apcl("DisplayName",this.e)};_sp2.t.prototype={a:null,bl:function(){_js.u.prototype.bl.call(this);this.a.j.unseenData.rpcl("LastVisitedTime",this.g);this.a.j.rpcl("DisplayName",this.e)},m:function(n,t){this.j(this.a.j.unseenData.bh.UnseenCount)},l:function(n,t){this.i(this.a.j.bh.DisplayName)}};_sp2.q=function(){};_sp2.q.registerInterface("_sp2.q");var INFDContentProvider=function(){};INFDContentProvider.registerInterface("INFDContentProvider");_sp2.D=function(){};_sp2.D.registerInterface("_sp2.D");_sp2.b=function(n,t){this.m=Function.createDelegate(this,this.n);this.l=n;this.b=!1;this.g=t};_sp2.b.prototype={l:null,g:!1,a:function(){return _nbs.a.Nk},i:function(){return _nbs.a.Ye},h:function(){return _nbs.a.gS},d:function(){return _nbs.a.fQ},f:function(){return"calendar_card.m.png"},e:function(){return null},c:function(){return new _C(this.m,_a.a.f)},k:function(){return this.g},n:function(){this.b=!0;var n=_a.X.a(1);this.l.a(n)},b:!1,j:function(){return this.b}};_sp2.c=function(n,t){this.m=Function.createDelegate(this,this.n);this.l=n;this.g=t;this.b=!1};_sp2.c.prototype={l:null,g:null,a:function(){return _nbs.a.LM},i:function(){return _nbs.a.ba},h:function(){return _nbs.a.ZF},d:function(){return _nbs.a.cv},f:function(){return"filters_card.m.png"},e:function(){return null},c:function(){return new _C(this.m,_a.a.f)},b:!1,j:function(){return this.b},k:function(){return!0},n:function(){this.b=!0;var n=this;this.g.a(function(t){var i=t.a(1060);n.l.a(i)})}};_sp2.d=function(n){this.l=Function.createDelegate(this,this.m);this.g=n;this.b=!1};_sp2.d.prototype={g:null,a:function(){return _nbs.a.XF},i:function(){return _nbs.a.Xn},h:function(){return _nbs.a.Pd},d:function(){return _nbs.a.az},f:function(){return"displaysettings_card.m.png"},e:function(){return null},c:function(){return new _C(this.l,_a.a.f)},k:function(){return!0},b:!1,j:function(){return this.b},m:function(){this.b=!0;this.g.b&&this.g.a()}};_sp2.e=function(n,t,i,r){this.l=n;this.b=!1;this.n=i;this.g=t;var u=this;this.m=new _C(function(){u.b=!0;r.b&&r.a()},_a.a.f)};_sp2.e.prototype={l:!1,g:!1,n:null,m:null,a:function(){return _nbs.a.fJ},i:function(){return _nbs.a.Ir},h:function(){return _nbs.a.bg},d:function(){return _nbs.a.aL},f:function(){return null},e:function(){return this.g?null:this.n},c:function(){return this.g?this.m:null},k:function(){return this.l},b:!1,j:function(){return this.b}};_sp2.f=function(n,t){_js.j.a(n,"primaryViewModel");var i=new _o365sg2p.F(_nbs.a.nX,_nbs.a.Se);i.E(40);this.l=new _sp2.o(i);this.m=t;!n.a().a&&n.b&&n.b.mj(this.l)};_sp2.f.prototype={l:null,m:!1,a:function(){return _nbs.a.JK},i:function(){return _nbs.a.mc},h:function(){return _nbs.a.Se},d:function(){return null},f:function(){return"filters_card.m.png"},e:function(){return null},c:function(){return null},k:function(){return this.m},n:!1,j:function(){return this.n},g:function(n){this.l.a.a(n.b)}};_sp2.r=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.e=n;var y=t;this.b=y.w||(y.w=Function.createDelegate(y,y.p));this.d=i;this.c=[l,a,v,r,u,f,new _sp2.z,new _sp2.x,c,e,o,s,h]};_sp2.r.prototype={e:null,b:null,d:null,c:null,a:function(){for(var i=new _js.f,r=this.c,u=r.length,n=0;n<u;++n){var t=r[n];t.k()&&i.a(this.f(t))}return i},f:function(n){var t=new _o365sg2p.P(n.a(),n.i());t.o(new _o365sg2p.cM);t.a.n(n.h());if(n.f()){t.a.l(this.b(n.f()));t.a.k(n.a())}if(n.d()){t.a.m(new _o365sg2c.m);t.a.a.n(n.d());t.a.a.m(n.a())}n.e()&&t.a.a.w(n.e());n.c()&&t.a.a.e(n.c());if(_sp2.q.isInstanceOfType(n)){var u=n;var i=u;t.m(i.b||(i.b=Function.createDelegate(i,i.g)))}var r=this;t.apcl("ShowDetails",function(){if(!t.b){var i=new _sp2.y;i.a.cn=n.a();i.a.cc=n.j()?1:0;r.d.a(i)}});return t}};_sp2.x=function(){};_sp2.x.prototype={a:function(){return _nbs.a.hD},i:function(){return _nbs.a.dY},h:function(){return _nbs.a.EB},d:function(){return _nbs.a.cy},f:function(){return"mobile_card.m.png"},e:function(){return"https://www.microsoft.com/en-us/outlook-com/mobile/"},c:function(){return null},k:function(){return!0},b:!1,j:function(){return this.b}};_sp2.y=function(){_sp2.y.initializeBase(this,[1,"NFD"])};_sp2.g=function(n){this.g=n;this.b=!1};_sp2.g.prototype={g:null,a:function(){return _nbs.a.gr},i:function(){return _nbs.a.gJ},h:function(){return _nbs.a.SM},d:function(){return _nbs.a.Zr},f:function(){return"offline_card.m.png"},e:function(){return null},c:function(){return this.g},k:function(){return!1},b:!1,j:function(){return this.b}};_sp2.z=function(){};_sp2.z.prototype={a:function(){return _nbs.a.ev},i:function(){return _nbs.a.lL},h:function(){return _nbs.a.No},d:function(){return null},f:function(){return"onedrive_card.m.png"},e:function(){return null},c:function(){return null},k:function(){return!0},b:!1,j:function(){return this.b}};_sp2.h=function(n,t){this.n=Function.createDelegate(this,this.s);this.o=Function.createDelegate(this,this.t);var i=new _o365sg2p.F(_nbs.a.UC,_nbs.a.bO);this.m=new _sp2.o(i);this.m.a.D(200);this.l=n;this.r=t};_sp2.h.prototype={m:null,l:null,r:null,a:function(){return _nbs.a.Zg},i:function(){return _nbs.a.Ok},h:function(){return _nbs.a.kJ},d:function(){return _nbs.a.Ub},f:function(){return null},e:function(){return null},c:function(){return new _C(this.o,_a.a.f)},p:!1,j:function(){return this.p},k:function(){return!0},g:function(n){},t:function(){if(!this.l.a().a&&this.l.b)if(this.l.b.g&&_y.l.isInstanceOfType(this.l.b.g.f().a()))this.q(500);else{this.l.b.g.f().apcl("Top",this.n);this.l.b.cd()}},s:function(n,t){this.q(2e3);this.l.b.g.f().rpcl("Top",this.n)},q:function(n){if(_mcp.d.isInstanceOfType(this.l.b.g.f().a())){var i=this.l.b.g.f().a();i.C().d(this.m);var t=this;_js.g.a().a(_a.a.f,"ShowOutlookAddinsCallout",function(){t.m.a.a(!0)},n)}}};_sp2.i=function(n,t){this.m=Function.createDelegate(this,this.n);this.l=n;this.b=!1;this.g=t};_sp2.i.prototype={l:null,g:!1,a:function(){return _nbs.a.fR},i:function(){return _nbs.a.Zw},h:function(){return _nbs.a.ZA},d:function(){return _nbs.a.Cu},f:function(){return"people_card.m.png"},e:function(){return null},c:function(){return new _C(this.m,_a.a.f)},k:function(){return this.g},n:function(){this.b=!0;var n=_a.X.a(2);this.l.a(n)},b:!1,j:function(){return this.b}};_sp2.j=function(n){this.b=n};_sp2.j.prototype={b:!1,a:function(){return _nbs.a.iP},i:function(){return _nbs.a.Fc},h:function(){return _nbs.a.ED},d:function(){return null},f:function(){return"pintotop_card.m.png"},e:function(){return null},c:function(){return null},k:function(){return this.b},g:!1,j:function(){return this.g}};_sp2.k=function(n,t,i){this.n=Function.createDelegate(this,this.o);this.g=n;this.l=t;this.m=i};_sp2.k.prototype={g:null,l:null,m:!1,a:function(){return _nbs.a.Oj},i:function(){return _nbs.a.aD},h:function(){return _nbs.a.Jn},d:function(){return _nbs.a.Ku},f:function(){return"skype_card.m.png"},e:function(){return null},c:function(){return new _C(this.n,_a.a.f)},k:function(){return this.g.a().j().Enabled&&this.m},o:function(){this.b=!0;this.l.n("SkypeID")},b:!1,j:function(){return this.b}};_sp2.l=function(n){this.l=Function.createDelegate(this,this.m);this.b=n};_sp2.l.prototype={b:null,a:function(){return _nbs.a.li},i:function(){return _nbs.a.hZ},h:function(){return _nbs.a.KT},d:function(){return _nbs.a.N},f:function(){return"themes_card.m.png"},e:function(){return null},c:function(){return new _C(this.l,_a.a.f)},k:function(){return!0},g:!1,j:function(){return this.g},m:function(){this.g=!0;this.b.b&&this.b.a()}};_sp2._TI=function(){};_sp2._TI.$$cctor=function(){var t="FlexPanePanelView";new _A(t,function(){_sp2._TI.a[t]===undefined&&(_sp2._TI.a[t]=[[[-1,0,["FlexPanePanelViewModel","FlexPaneViewModel"],[_sp2._TI.h,_sp2._TI.i],null,"DataContext",null,_sp2._TI.b,1,null,null,null]]]);var n=_sp2._TI._hf.childNodes[0].cloneNode(!0);var i=new _o365sg2p.bc(n.children[0]);return new _B(n,[i])},_y.q,_o365sg2p.bc,function(n){return new _o365sg2p.bc(n)},!1,!1,!1,0,_sp2._TI.a);var n="CalloutView";new _A(n,function(){_sp2._TI.a[n]===undefined&&(_sp2._TI.a[n]=[[[-1,0,["ShellCalloutViewModel"],[_sp2._TI.j],null,"DataContext",null,_sp2._TI.b,1,null,null,null],[0,0,["VerticalOffset"],[_sp2._TI.e],null,"VerticalOffset",null,_sp2._TI.g,1,null,null,0],[0,0,["HorizontalOffset"],[_sp2._TI.d],null,"HorizontalOffset",null,_sp2._TI.f,1,null,null,0]]]);var i=_sp2._TI._hf.childNodes[1].cloneNode(!0);var t=new _o365sg2p.q(i.children[0]);t.l(0);t.m(1);return new _B(i,[t])},_sp2.o,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_sp2._TI.a)};_sp2._TI.c=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_ShellPlusG2_O365_templates_cs_2'></div> </div><div> <div></div> </div>";_js.c.a().appendChild(n);return n};_sp2._TI.h=function(n){return n.h};_sp2._TI.i=function(n){return _sp2.a.isInstanceOfType(n)?n.e:null};_sp2._TI.j=function(n){return n.a};_sp2._TI.e=function(n){return n.j};_sp2._TI.d=function(n){return n.g};_sp2._TI.b=function(n,t){n.X(t)};_sp2._TI.g=function(n,t){n.j(t)};_sp2._TI.f=function(n,t){n.i(t)};_sp2.u.registerClass("_sp2.u",null,_o365sg2p.df);_sp2.p.registerClass("_sp2.p",_js.u,_o365sg2p.dh);O365ShellPlusG2Component.registerClass("O365ShellPlusG2Component",null,_a.ih);_sp2.m.registerClass("_sp2.m");_sp2.a.registerClass("_sp2.a",_a.bx,IFlexPanePanelViewModel);_sp2.s.registerClass("_sp2.s",null,IGlobalAppsManager);_sp2.o.registerClass("_sp2.o",_a.bx);_sp2.C.registerClass("_sp2.C",_a.bx,IGlobalMiniaturesPlusViewModel);_sp2.n.registerClass("_sp2.n",_o365sg2p.h);_sp2.t.registerClass("_sp2.t",_o365sg2p.bj);_sp2.b.registerClass("_sp2.b",null,_sp2.D);_sp2.c.registerClass("_sp2.c",null,_sp2.D);_sp2.d.registerClass("_sp2.d",null,_sp2.D);_sp2.e.registerClass("_sp2.e",null,_sp2.D);_sp2.f.registerClass("_sp2.f",null,_sp2.D,_sp2.q);_sp2.r.registerClass("_sp2.r",null,INFDContentProvider);_sp2.x.registerClass("_sp2.x");_sp2.y.registerClass("_sp2.y",_a.bm);_sp2.g.registerClass("_sp2.g",null,_sp2.D);_sp2.z.registerClass("_sp2.z");_sp2.h.registerClass("_sp2.h",null,_sp2.D,_sp2.q);_sp2.i.registerClass("_sp2.i",null,_sp2.D);_sp2.j.registerClass("_sp2.j",null,_sp2.D);_sp2.k.registerClass("_sp2.k",null,_sp2.D);_sp2.l.registerClass("_sp2.l",null,_sp2.D);_sp2._TI.registerClass("_sp2._TI");O365ShellPlusG2Component.$$cctor();_sp2.n.a=["IsReady","IsWelcomeMessageHidden","InitialGroupsLoadFailed","HasPinnedAndUnpinnedGroups","HasJoinedAndVisitedGroups"];_sp2._TI._hf=_sp2._TI.c();_sp2._TI.a={};_sp2._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.shellplusg2.o365.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.shellplusg2.o365.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
