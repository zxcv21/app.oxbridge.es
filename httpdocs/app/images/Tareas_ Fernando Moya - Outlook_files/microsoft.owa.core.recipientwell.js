try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime();
Type.registerNamespace("_rw");_rw.i=function(n,t){this.a=n;this.b=t};_rw.i.prototype={a:null,b:null};function RecipientWellComponent(){}RecipientWellComponent.$$cctor=function(){_a.r.a().a(RecipientWellComponent)};RecipientWellComponent.prototype={a:function(n,t,i){var e=this;n.b(_rw.d,function(){return new _rw.d(window.document.createElement("div"),n.a(_y.a))});var o=this;n.b(_rw.h,function(){return new _rw.h(n.a(_y.a),n.a(_pe.h))}).a();var f=this;n.b(_rw.g,function(){return new _rw.g(n.a(_y.a),n.a(IBasePersonaViewModelFactory),n.d(IFindRecipientMailComposeViewModelFactory),n.a(_a.f),n.a(_ff.c))}).b(IRecipientWellViewModelFactory).a();var r=this;n.b(IAtMentionsHandler,function(){return new _rw.m}).b(IAtMentionsHandler).a();var u=this;n.b(_rw.k,function(){return new _rw.k(window.document.createElement("div"),n.a(_y.a),n.a(_ff.c),n.a(_a.f))})},b:function(){return[]}};_rw.m=function(){};_rw.m.prototype={a:function(n,t,i){i&&(i[t]=n)},b:function(n,t){if(t){var i=t.E();if(i&&!i.cc(n)){i.bp(!1);i.ba(n);i.bp(!0)}}},c:function(n,t,i,r){var e=!1;if(i&&n&&r&&t){var o=i.E();if(o&&o.u()===t&&r)for(var f=Object.keys(r),u=0;u<f.length;u++)if(r[f[u]].EmailAddress===n.EmailAddress){delete r[f[u]];e=!0}}return e}};_rw.h=function(n,t){this.d=n;this.c=t};_rw.h.prototype={d:null,c:null,a:function(n,t,i,r,u,f,e,o,s,h){return new _rw.a(this.d.a(),n,t,i,r,u,f,this.c,e,o,s,h,null)},h:function(n){return new _rw.a(this.d.a(),3,n,null,4,!1,!1,this.c)}};_rw.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.cH=Function.createDelegate(this,this.dx);this.bP=Function.createDelegate(this,this.dq);this.cF=Function.createDelegate(this,this.ds);this.cG=Function.createDelegate(this,this.dw);this.bV=Function.createDelegate(this,this.dD);this.bS=Function.createDelegate(this,this.dz);this.bR=Function.createDelegate(this,this.dy);this.bU=Function.createDelegate(this,this.dC);this.bQ=Function.createDelegate(this,this.du);this.Y=Function.createDelegate(this,this.dB);this.bT=Function.createDelegate(this,this.dA);this.z=-1;_rw.b.initializeBase(this,[n,t,i,r,1,u,!1,f,!1,r?r.b():0,0,null,l]);_a.b.b(e,"findRecipientMailComposeViewModelFactoryAsyncLazy");this.bZ=e;this.bc=o;this.bY=s;this.bs=h;this.cf=c;this.bX=a;this.cd=v};_rw.b.b=function(n){var t=n.i.e();!_js.d.b(t)&&t.endsWith(";")&&(t=t.substr(0,t.length-1));return t};_rw.b.e=function(n,t){t.val=!1;if(_js.d.b(n))return null;var i="";var s="";var v="SMTP";var r=n.indexOf("[");var e=n.lastIndexOf("]");var o=n.indexOf(":");if(r>=0&&e>=0&&o>=0&&o>r&&o<e){s=n.substring(0,r);v=n.substring(r+1,o);i=n.substring(o+1,e).trim();if(_js.d.b(i))return null;t.val=!0}else{var a=n.indexOf("<");var p=n.indexOf(">");var y=n.indexOf("(");var l=n.indexOf(")");if(r>=0&&e>=0&&e>r||a>=0&&p>=0&&p>a||y>=0&&l>=0&&l>y){var f=n.match(_rw.b.f);if(f&&f.length>0){if(!_js.d.b(f[0])){var c=n.indexOf(f[0]);if(c!==-1){i=f[0];var b=i.replace(_rw.b.g,"\\$1");var k=new RegExp(String.format("\\(\\s*{0}\\s*\\)|\\<\\s*{0}\\s*\\>|\\[\\s*{0}\\s*\\]",b));var h=n.match(k);h&&h.length>0&&!_js.d.b(h[0])&&(c=n.indexOf(h[0]));s=n.substring(0,c).trimEnd()}}}else i=n}else i=n;if(_js.d.b(i))return null;i=i.trim();t.val=_a.C.a(i)}var u=new _g.d;u.MailboxType="OneOff";u.RoutingType=v.trim();u.EmailAddress=i;u.Name=_js.d.b(s)?i:s.trim();return _pc.a.a(u)};_rw.b.prototype={bZ:null,bk:null,A:null,J:!1,P:null,F:null,ce:null,cg:null,I:!1,bA:!1,bB:!1,bw:!1,bu:!1,bx:!1,bY:!1,Q:!1,R:null,bc:null,bj:0,bs:null,cf:null,bX:0,cd:0,bW:function(n){this.ef("BulkResolveOperationComplete",n)},ch:function(n){this.eg("BulkResolveOperationComplete",n)},dn:function(n){this.ef(_rw.b.c,n)},dE:function(n){this.eg(_rw.b.c,n)},G:function(n){if(this.A!==n){!this.A||this.z!==-1||this.v().j(this.bT);this.A=n;!this.A||this.z!==-1||this.v().p(this.bT);this.ea("RecipientBeingEdited")}return n},v:function(){if(!this.P){var n=this;this.bZ.a(function(t){n.dG(t)})}return this.P},dF:function(n){if(this.P!==n){this.P=n;this.ea("FindRecipientViewModel")}return n},cO:function(n){if(this.J!==n){this.J=n;this.ea("IsAnyRecipientInvalid")}return n},K:function(n){if(this.bk!==n){this.bk=n;this.ea("TextBeingEdited")}return n},by:function(n){if(this.I!==n){this.I=n;this.dt(n);this.ea("DisableActionsOnAllRecipients")}return n},cQ:function(n){if(this.bA!==n){this.bA=n;this.ea("ShouldShowHiddenRecipient")}return n},cR:function(n){if(this.bB!==n){this.bB=n;this.ea("UpdateFindControlPopupPosition")}return n},cP:function(n){if(this.bw!==n){this.bw=n;this.ea("ResetFindControlPopupPosition")}return n},cN:function(n){if(this.bu!==n){this.bu=n;this.ea("HandleBackspaceCommandAtEndOfReadWriteWell")}return n},bz:function(n){if(this.bx!==n){this.bx=n;this.ea("ResizeFindControl")}return n},dv:function(){return _a.UserAgent.getInstance().F},bt:function(){return!!this.bc&&this.bc.a().Q().Enabled},cK:function(){return!!this.bc&&this.bc.a().b().Enabled},Z:null,bi:function(){this.ca()},dI:function(){this.v()&&this.v().l(!1)},cb:function(){this.ca();this.Q=!0;if(this.cK()||!this.J||OwaApplication.b){this.ej("BulkResolveOperationComplete",!0);this.Q=!1}else{this.F=new _js.f;this.v().bw(new _js.f);for(var i=0,r=this.t.y.length;i<r;i++){var n=this.t.y[i];if(!n.k){this.F.a(n);var t=_rw.b.b(n);this.v().bi().a(t);if(!(this.z!==-1)){this.v().bj(t);this.by(!0);this.v().c(null);this.cM(n);this.K(t);this.G(n);this.v().p(this.Y)}}}}},bJ:function(){_rw.a.prototype.bJ.call(this);this.P&&this.P.b(null)},bb:function(){if(this.z!==-1){this.z=-1;this.v().H();this.by(!1);this.v().j(this.Y);this.v().c(this.R);if(this.v().a()===this.bk)this.cQ(!0);else{var n=this.v().a();_js.d.a(n)||this.bC(n)}this.K("");this.G(null);this.cQ(!1);if(this.Q){this.ej("BulkResolveOperationComplete",!1);this.Q=!1}}},cc:function(n){if(this.t)for(var t=0;t<this.t.y.length;t++){var i=this.t.y[t];if(i.j&&i.j.a().EmailAddress===n.EmailAddress)return!0}return!1},ba:function(n){return this.bD(n)},bD:function(n){var i;var u;var t=!1;if(this.ct){var o=n.EmailAddress;var r=n.Name;if(_js.d.a(o))if(_js.d.a(r))throw Error.argumentNull("Address and Name parameters are set to null in emailAddress");else if(n.RoutingType!=="MAPIPDL"){var e,f;i=(f=_rw.b.e(r,e={val:t}),t=e.val,f)}else{t=!0;i=_pc.a.a(n);_js.Trace.logInfo(_rw.b.a,"AddRecipientGivenEmail: Creating PDL with name: {0}",r)}else{t=_g.p.d(n)?!0:_a.C.a(o);i=_pc.a.a(n)}}else{t=!0;i=_pc.a.a(n)}u=this.H(i);this.D(u,this.C,t);this.cO(!!(this.J|!t));return u},bF:function(n){n.bh(this.bQ);_rw.a.prototype.bF.call(this,n)},ed:function(){this.v().v(this.bU);this.v().bl(this.bR);this.v().bn(this.bS);this.v().bm(this.bV);this.G(null);this.z!==-1&&this.v().j(this.Y);_rw.a.prototype.ed.call(this)},dw:function(){if(this.t.y.length>0){this.cN(!0);this.cN(!1)}},ds:function(){var n=this.t.y.length;if(n>0){var t=this.t.y[n-1];this.U(t);this.v().I(!0)}},dC:function(n,t){var i=this.v().i();if(i){this.dp();this.A||this.bv()}},dq:function(){if(this.z!==-1)this.bC(this.v().a());else if(!this.v().kx()){this.cI(this.v().a(),4);this.cL()}_pc.b.b(2,-1,-1,-1,4,1);this.A||this.bv()},cY:function(n,t){var i=n;if(i.p){this.v().c(null);this.K(_rw.b.b(i));this.G(i)}},cs:function(n){if(n.i()===1||n.i()===2){_rw.a.b(n,!0,0);n.d(0,n.e(),0)}},T:function(n,t,i){this.bt()&&(t|=8);return _rw.a.prototype.T.call(this,n,t,i)},cp:function(){this.bt()?this.y&&!this.y.c()&&this.y.h(!0):_rw.a.prototype.cp.call(this)},cq:function(n,t){if(t.c===2)for(var i=t.b.length-1;i>=0;i--){var r=this.w.y[t.d+i];this.bs&&this.bs.a(_rw.i,new _rw.i(r,this.u()))}_rw.a.prototype.cq.call(this,n,t);this.dK()},be:function(n,t){n.S(this.bQ);_rw.a.prototype.be.call(this,n,t)},D:function(n,t,i){if(!n)throw Error.argument("personaViewModel");if($a(n.a()))throw Error.argument("personaViewModel.BasePersona");var f=this.dJ(t,i);var r=this.T(n,f,i);this.be(r,f);if(this.A){var e=this.t.j(this.A);this.U(this.t.y[e]);var u=r.i;u.g(!this.I);u.C(!this.I);u.H(!this.I);this.I&&r.O();this.t.u(e,r);this.ci()}else this.t.a(r);this.bh();return r},dG:function(n){var t=n.a(this.cf,this.bf,this.bX,this.cd);if(this.bt()){this.R=new _C(this.cG,_rw.b.a);t.U(this.bV)}else this.R=new _C(this.cF,_rw.b.a);t.bt(new _C(this.cT,_rw.b.a));t.c(this.R);t.N(new _C(this.bP,_rw.b.a));this.cK()&&this.bt()&&t.M(new _C(this.bP,_rw.b.a));t.q(this.bU);t.T(this.bR);t.V(this.bS);t.br(this.E);t.bq(this.t);this.bf&&t.bs(this.cm);t.L(this.bY);this.dF(t)},ca:function(){if(this.bj>0){var t=_a.d.b(_a.a.S,"AddEmailAddressRecipient ");var n=new _a.q;n.a("rc",this.bj);t.j=n.toString();_a.d.a(t);this.bj=0}if(this.z!==-1)this.bb();else{var i=this.v().r();this.v().d(!1);this.cL();this.v().d(i);this.v().I(!1)}},dy:function(n){if(!$a(n)&&n.y.length&&!$a(this.v().u())&&this.v().u().y.length){this.F=new _js.f;for(var t=0,i=n.y.length;t<i;t++){this.cI(n.y[t].a().EmailAddress,5);this.dr(n.y[t],this.v().u().y[t])}if(this.F.y.length>0){this.by(!0);this.v().c(null);this.K(this.cg);this.G(this.ce);this.v().p(this.Y)}_pc.b.b(2,-1,-1,-1,4,1)}},dz:function(n,t){for(var u=0,f=this.t.y.length;u<f;u++){var i=this.t.y[u];var r=i.i.a();if(i.k&&r.h()===1&&!_js.d.b(r.a().EmailAddress)&&r.a().EmailAddress.toLowerCase()===n.toLowerCase()){i.i.P(t);this.cs(i.i)}}},cJ:function(n,t){t&&this.v().bx(n.a())},dp:function(){var t=this.v().i();var n=this.dH(t);n&&n.D()&&t.a().cA(n.D());var i=this.H(t.a());i.C(!0);this.D(i,this.C,!0)},dH:function(n){return _pe.l.isInstanceOfType(n)?n:null},bv:function(){this.v().fu=_js.d.b(this.v().a())?-1:this.v().a().length;this.v().b("");this.bh()},cL:function(){var i=this.v().a();if(!_js.d.b(i)){for(var t=this.v().bk(i),n=0,r=t.length;n<r;n++)this.bC(t[n]);this.bv()}},bC:function(n){var t;var u,f;var i=(f=this.v().X(n,u={val:t}),t=u.val,f);if(i){var r=this.H(i);t&&this.bj++;this.D(r,this.C,t);this.cJ(r,t)}},dr:function(n,t){var r=this.H(n);var i=this.D(r,this.C,t);this.cJ(r,t);this.bv();if(!t&&!OwaApplication.b){this.F.a(i);this.z!==-1||this.cM(i)}},cM:function(n){this.z=0;this.ce=n;this.cg=_rw.b.b(n)},dK:function(){for(var t=!1,i=this.t.y.length,n=0;n<i;n++){t=!this.t.y[n].k;if(t)break}this.cO(t)},ci:function(){if(!(this.z!==-1)){this.v().c(this.R);this.K("");this.G(null);return}this.v().w(!1);var n=this.F.y[this.z];var t=n.i.e();this.F.o(this.z);if(this.z<this.F.y.length){n=this.F.y[this.z];this.K(_rw.b.b(n));this.G(n)}else{this.F=null;this.z=-1;this.v().H();this.by(!1);this.v().c(this.R);this.v().j(this.Y);this.K("");this.G(null);if(this.Q){this.ej("BulkResolveOperationComplete",!0);this.Q=!1}}},dt:function(n){for(var r=0,u=this.t.y.length;r<u;r++){var t=this.t.y[r];var i=t.i;i.g(!n);i.C(!n);i.H(!n);n?t.O():t.L()}},cI:function(n,t){if(!_js.d.a(n)&&this.v()&&this.v().e())if(n in this.v().e())Array.add(this.v().e()[n],t);else{this.v().e()[n]=[];Array.add(this.v().e()[n],t)}},dJ:function(n,t){var i=n;t||(i^=1);return i},dD:function(n,t){var i=n;i.be()&&this.ca()},dA:function(n,t){var e=n;if(!e.F()){var r=this.t.j(this.A);if(r>=0){var i=this.v().a();if(_js.d.a(i)){this.U(this.t.y[r]);this.ci()}else if(this.A&&i===this.A.j.c()){var f=this.A.i.a();var u=this.H(f);this.D(u,this.C,this.A.k)}else this.bC(i)}}},dB:function(n,t){var u=n;if(!u.F()){var i=this.t.j(this.A);if(i>=0){var r=this.v().a();if(_js.d.a(r)){this.U(this.t.y[i]);this.ci()}else this.v().bb()&&this.bb()}}},du:function(n){this.Z=n;var t=this.Z.b().a();var r=_js.d.a(t.M())?_pc.h.a(t):null;var i=new _pc.h(r,t.M(),t.a(),new _h.q(0,_rw.b.d),2,!1);i.z(this.cH);OwaApplication.a.a(i)},dx:function(n){var u=_a.l.c("ExpandDLInRecipientWell");if(n.t){this.ej(_rw.b.c,1);u.k=n.D()}else{var h=n;if(h.g<=_rw.b.d){this.Z.g().a();for(var t,s=!1,c=h.l,l=c.length,r=0;r<l;++r){var i=c[r];if(i.a())if(i.a().RoutingType.toUpperCase()==="MAPIPDL"){t=!0;s=!0}else{var o,e;e=_rw.b.e(i.a().EmailAddress,o={val:t}),t=o.val,e}else t=!1;this.D(this.H(i),this.C,t)}if(u){var f=new _a.q;f.a("mc",n.g).c("ip",s);u.j=f.toString()}}else this.ej(_rw.b.c,0)}_a.l.a("ExpandDLInRecipientWell")}};_rw.e=function(n,t,i){this.K=Function.createDelegate(this,this.bi);this.G=Function.createDelegate(this,this.M);this.E=Function.createDelegate(this,this.bf);this.x=Function.createDelegate(this,this.bg);this.H=Function.createDelegate(this,this.U);this.I=Function.createDelegate(this,this.bd);this.J=Function.createDelegate(this,this.be);_rw.e.initializeBase(this);this.i=n;this.i.H(!0);this.L();this.bm(i);this.N(n.a(),t,!0);if(this.r){this.i.bt(new _C(this.J,_rw.e.a));this.i.v(!0)}else this.i.o(!0);if(this.v()){this.i.b(!0);this.i.br(this.e())}this.i.j(!this.i.bh()&&!this.r&&this.v());this.A=this.i.V().e()};_rw.e.prototype={i:null,l:null,y:null,j:null,k:!0,m:0,t:!1,C:!1,p:!1,q:!1,D:!1,r:!1,w:!1,n:null,z:null,A:null,W:function(){return this.k&&_g.p.l(this.j.a())},bb:function(){var n=this;return new _C(function(){n.P(!0)},_a.a.S)},bc:function(){var n=this;return new _C(function(){n.P(!1)},_a.a.S)},S:function(n){this.ef("DLExpansionClicked",n)},bh:function(n){this.eg("DLExpansionClicked",n)},P:function(n){if(this.w!==n){this.w=n;this.ea("IsSelectedOrBeingDragged")}return n},d:function(n){if(this.t!==n){this.t=n;this.ee("IsSelected","IsSelectedOrBeingDragged")}this.i.F()!==n&&this.i.A(n);return n},Z:function(){return this.t||this.w},bj:function(n){if(this.C!==n){this.C=n;this.ea("IsDeleted")}return n},c:function(){return this.p},h:function(n){if(this.p!==n){this.p=n;this.ea("IsBeingEdited")}return n},bm:function(n){if(this.k!==n){this.k=n;this.ee("IsValid","DisplayAsValid")}return n},v:function(){return this.k&&!this.W()},X:function(){return this.v()?"":_nbs.a.OH},bk:function(n){if(this.q!==n){this.q=n;this.ee("IsMailTipsTriggered","IsMailTipsOrPolicyTipsTriggered")}return n},bl:function(n){if(this.D!==n){this.D=n;this.ee("IsTriggeredPolicyTips","IsMailTipsOrPolicyTipsTriggered")}return n},Y:function(){return this.q||this.D},a:function(){return this.j},f:function(){var t;if(this.k){var n=this.j.a();if(n.RoutingType==="SMTP"){var r=n.EmailAddress;var i=n.Name;t=_js.d.b(i)?r:String.format("{0} <{1}>",n.MailboxType==="OneOff"?i:'"'+i.replace('"','\\"')+'"',r)}else t=n.RoutingType==="MAPIPDL"?n.Name:String.format("{0} [{1}:{2}]",n.Name,n.RoutingType,n.EmailAddress)}else t=this.i.e();return t},b:function(){return this.i},e:function(){this.y||(this.y=new _C(this.I,_rw.e.a));return this.y},g:function(){return this.l},bn:function(n){if(this.l!==n){this.l=n;this.ea("RemoveRecipientCommand")}return n},V:function(){this.z||(this.z=new _C(this.H,_rw.e.a));return this.z},ba:function(){return this.i.bb()&&!!this.A&&this.A.a().dq().Enabled},N:function(n,t,i){i||this.i.bo(n);this.j=n;if(i||this.m!==t){this.m=t;this.T()}},L:function(){this.i.apcl("IsSelected",this.x);this.i.apcl("IsPersonaCardShown",this.E)},O:function(){this.i.rpcl("IsSelected",this.x);this.i.rpcl("IsPersonaCardShown",this.E)},bg:function(n,t){this.d(n.bQ)},bf:function(n,t){this.i.r()&&(_rw.a.e=this)},bd:function(){var t=this;var n=function(){t.i.t();t.n=null};if(this.r){var i=this;this.n=_js.g.a().a(_rw.e.a,"RecipientViewModel.OnClick",function(){i.n&&n()},300)}else n()},be:function(){if(this.i&&this.i.X()){this.i.r()&&this.i.f(!1);if(this.r&&this.n){_js.g.a().b(this.n);this.n=null}this.M()}},T:function(){var n=[];if(((this.m&8)==8||OwaApplication.b&&_y.c.a.a()==="TouchNarrow")&&this.i&&this.i.a()&&this.i.a().a()){var t=this.i.a().a().EmailAddress;_js.d.b(t)||Array.add(n,new _fm.n(t))}if((this.m&4)==4&&!_y.c.a.h()){Array.add(n,new _fm.d(_u.R.Wu,null,new _C(this.G,_rw.e.a),!1,null,null,null,null,null));this.r=!0}if((this.m&2)==2){this.bn(new _C(this.K,_rw.e.a));Array.add(n,new _fm.d(_u.R.Uz,null,this.l));this.i.bx(this.l)}!$a(this.i.n())&&this.v()&&(this.m&1)==1&&Array.addRange(n,this.i.n());this.i.Q(n)},M:function(){_a.k.b("VM.Recipient.Edit");this.h(!0)},bi:function(){this.i.rpcl("IsSelected",this.x);this.bj(!0)},U:function(){_a.l.b(_rw.e.a,"ExpandDLInRecipientWell");this.ej("DLExpansionClicked",this)}};_rw.g=function(n,t,i,r,u){_rw.g.initializeBase(this,[n,t]);this.e=i;this.g=r;this.f=u};_rw.g.prototype={e:null,g:null,f:null,b:function(n,t,i,r,u,f,e,o,s){return new _rw.b(this.d.a(),n,t,i,r,this.c,this.e,this.g,u,this.f,f,e,o,s)}};_rw.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.cl=Function.createDelegate(this,this.dT);this.cj=Function.createDelegate(this,this.dS);this.ck=Function.createDelegate(this,this.cY);this.cS=Function.createDelegate(this,this.cp);this.bl=Function.createDelegate(this,this.cq);this.cT=Function.createDelegate(this,this.bh);this.M=_bc.f.a;_rw.a.initializeBase(this);_a.b.a(o,"personaViewModelFactory");this.bK=n;this.bo=l;this.ct=$a(f)?!1:f;this.bI=o;this.cu=s;this.cr=c;this.V=e;this.C=t;this.M=i;this.X=u;this.bH=$a(h)?r?r.b():0:h;this.r(new _js.f);this.q(new _js.f);this.E={};this.W=[];this.cX(r);r&&_js.Trace.logInfo(_a.a.S,"RecipientWellViewModel::Number of EmailAddresses passed in: {0} and Number of recipients created: {1}",r.b(),this.t.y.length);this.t.d(this.bl);if(a){this.bf=a;this.cm={}}};_rw.a.b=function(n,t,i){OwaApplication.b&&(t=!1);var r=n.a().a();if(r&&!_js.d.b(r.EmailAddress)&&n.a().b()===1){if(i===9){n.d(0,r,4);return}t||r.MailboxType==="Contact"?_js.d.b(r.Name)||r.Name===r.EmailAddress?n.d(0,r.EmailAddress,0):n.d(0,r.Name,0):(r.MailboxType==="OneOff"||r.MailboxType==="Unknown")&&n.d(0,r,2)}};_rw.a.g=function(n){return $a(n)||0===n.w.y.length};_rw.a.f=function(){var n=null;if(_rw.a.a>=0){n=_rw.a.c[_rw.a.a];_rw.a.c[_rw.a.a]=null;_rw.a.a-=1}return n};_rw.a.prototype={ct:!1,X:1,V:!1,bI:null,cu:!1,bH:0,bK:0,C:1,y:null,w:null,t:null,W:null,cv:0,bm:0,bM:!1,bG:null,bL:!0,bg:0,co:!1,E:null,cr:0,bo:null,bf:null,dL:function(n){this.ef("RefreshLayoutRequest",n)},dU:function(n){this.eg("RefreshLayoutRequest",n)},dP:function(){return _a.UserAgent.getInstance().H},a:function(){return this.t},r:function(n){if(this.t!==n){this.t=n;this.ea("Recipients")}return n},dO:function(){this.bG||(this.bG=new _C(this.cS,_rw.a.d));return this.bG},d:function(){return this.w},q:function(n){if(this.w!==n){this.w=n;this.ea("Addresses")}return n},cm:null,j:function(){return this.y},m:function(n){if(this.y!==n){this.y&&this.y.d(!1);this.y=n;if(this.y){this.y.d(!0);this.dN()}this.ea("SelectedRecipient")}return n},p:function(){return this.M},bp:function(n){this.bL!==n&&(this.bL=n);return n},da:function(n){this.cv!==n&&(this.cv=n);return n},f:function(n){if(this.bm!==n){this.bm=n;if(this.bm===2){for(var i=0,f=this.W.length;i<f;i++)this.cU(this.W[i]);Array.clear(this.W);this.da(1)}else if(this.bm===1){if(this.t)for(var r=this.t.y.length,t=this.bg;t<r;r--){var u=this.t.y[t];$a(u)||Array.add(this.W,u);this.t.o(t)}this.da(0)}}return n},cn:function(){return!!_y.c.a&&_y.c.a.a()==="Mouse"&&!!this.bo&&this.bo.a().bS().Enabled&&this.bo.a().e().Enabled},g:function(){return this.bM&&!this.cn()},b:function(n){if(this.bM!==n){this.bM=n;this.ea("ShowEllipsis")}return n},e:function(){return this.co},dQ:function(){return this.cn()?"ReadOnlyRecipientViewAggregated":"ReadOnlyRecipientView"},i:function(n){if(this.t){this.bJ();this.t.e(this.bl)}this.cX(n);this.t&&this.t.d(this.bl)},c:function(){if(!$a(this.t)&&this.t.y.length){if(!_rw.a.c){_rw.a.c=[];_rw.a.a=-1}for(var n=0,t=this.t.y.length;n<t&&_rw.a.a<49;n++){_rw.a.a+=1;_rw.a.c[_rw.a.a]=this.t.y[n]}this.t=null}},o:function(n,t){if(n.i()!==this.X)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bn(n);var i=this.T(n,t,!0);this.be(i,t);this.t.u(0,i)},S:function(n){if(n.i()!==this.X)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");this.bn(n);this.D(n,this.C,!0)},L:function(n,t){if(n.i()!==this.X)throw Error.invalidOperation("The size of the PersonaControl getting added to the well should match the control size of the well");t=$a(t)?this.C:t;this.bn(n);this.D(n,t,!0)},n:function(n){var t=this.H(n);this.D(t,this.C,!0)},l:function(n){for(var i,t=0,r=this.t.y.length;t<r;t++){i=this.t.y[t];if(i.i===n){this.U(this.t.y[t]);return}}},bd:function(n){var t=this.H(n);this.D(t,this.C,!1)},bJ:function(){this.t&&this.t.g();this.w&&this.w.g()},bD:function(n){var r=_h.l.a(n);var i=this.V?_rw.a.f():null;var t;if(i){i.N(r,this.C,!1);t=i.i;this.bn(t);this.t.a(i)}else{t=this.H(r);this.D(t,this.C,!0)}return t},h:function(){for(var i=new _ff.d,n=0,u=this.t.y.length;n<u;n++){var t=this.t.y[n].j.a();if(!$a(t.EmailAddress))if(this.t.y[n].j.b()===5){var r=new _a.C(t.EmailAddress);_js.d.a(r.b)||i.c(r.b)}else i.c(t.EmailAddress)}return i.h()},ed:function(){this.t.e(this.bl);if(!$a(this.t)&&this.t.y.length){for(var n=0,i=this.t.y.length;n<i;n++){var t=this.t.y[n];this.bF(t)}_a.iX.prototype.ed.call(this)}},cs:function(n){if(n.i()===1||n.i()===2||OwaApplication.b){_rw.a.b(n,!1,this.cr);n.d(0,_js.d.c("{0};",n.e()),0)}},bh:function(){this.eh("RefreshLayoutRequest")},cq:function(n,t){switch(t.c){case 0:for(var r=0,h=t.a.length;r<h;r++){var o=t.a[r];this.dM(o,t.d+r)}break;case 2:for(var u=t.b.length-1;u>=0;u--){var e=this.cZ(t.d+u);this.bf&&!_js.d.a(e)&&this.bf.h([e])}break;case 3:for(var i=0,s=t.b.length;i<s;i++)this.dY(t.a[i],t.d+i);break;case 4:for(var f=t.b.length-1;f>=0;f--)this.cZ(t.d+f);break;default:break}},T:function(n,t,i){return new _rw.e(n,t,i)},be:function(n,t){if(!this.V){(t&4)==4&&n.apcl("IsBeingEdited",this.ck);(t&2)==2&&n.apcl("IsDeleted",this.cj);n.apcl("IsSelected",this.cl)}},bF:function(n){var t=n.m;if(!this.V){(t&4)==4&&n.rpcl("IsBeingEdited",this.ck);(t&2)==2&&n.rpcl("IsDeleted",this.cj);n.rpcl("IsSelected",this.cl)}},dT:function(n,t){var i=n;i.t?this.m(i):this.m(null);this.bh()},dS:function(n,t){var i=n;i.C&&this.U(i)},cY:function(n,t){},H:function(n){var t=null;t=this.bI.a(n,this.M,!0,this.X);this.bn(t);return t},D:function(n,t,i){if($a(n))throw Error.argument("personaViewModel");var r=this.T(n,t,i);return this.cV(r)},cV:function(n){this.be(n,n.m);this.t.a(n);this.bh();return n},U:function(n){this.bF(n);this.t.m(n,!0);this.bh()},k:function(n){for(var r=[],t=0,e=this.t.y.length;t<e;t++){var f=this.t.y[t].j;if(!$a(f)){var u=f.a();$a(u.EmailAddress)||u.EmailAddress!==n||Array.add(r,t)}}for(var i=r.length-1;i>=0;i--)this.t.o(r[i])},cp:function(){this.y&&!this.y.c()&&this.y.b().N()},cX:function(n){if(!$a(n)){var r=n.b();switch(this.bK){case"TouchWide":this.bg=4;break;case"TouchNarrow":this.bg=2;break;default:this.bg=this.cn()?20:7;break}for(var i=this.V?this.bg:r,t=0;t<i&&t<r;t++){var e=n.c(t);$a(e)||this.cU(e)}(i<r||this.bH>i)&&(this.co=!0);for(var u=i;u<r;u++){var f=n.c(u);$a(f)||Array.add(this.W,f)}}},bn:function(n){this.cs(n);n.C(!this.V)},cU:function(n){if(_bc.z.isInstanceOfType(n)){var r=n;this.w.a(r.a());this.n(r);this.bE(r.a())}else if(_rw.e.isInstanceOfType(n)){var i=n;this.w.a(i.j.a());this.bE(i.j.a());i.k?this.n(i.j):this.bd(i.j)}else{var t;if(_g.p.o(n))t=n.Mailbox;else if(_g.p.b(n))t=n;else throw Error.invalidOperation("Recipient is not a known type.");if(!t.Submitted||this.cu){this.w.a(t);this.bD(t);this.bE(t)}}},dM:function(n,t){var i=this.cW(n);this.w.u(t,i);return this.bE(i)},cZ:function(n){var t=this.w.y[n];this.w.o(n);return this.dX(t)},dY:function(n,t){var i=this.cW(n);this.w.o(t);this.w.u(t,i)},cW:function(n){return this.dR(n)},dR:function(n){var t;var i=n.i.z();t=$a(i)?$a(n.j.a())?!$a(n.j.f())&&n.j.f().length>0?n.j.f()[0]:new _g.d:n.j.a():i;return t},bE:function(n){var t;var r,i;(i=_g.p.h(n,r={val:t}),t=r.val,i)&&(this.E[t]=t in this.E?this.E[t]+1:1);return t},dX:function(n){var t;var r,i;(i=_g.p.h(n,r={val:t}),t=r.val,i)&&(t in this.E&&this.E[t]>1?this.E[t]=this.E[t]-1:delete this.E[t]);return t},dN:function(){_pe.c.c&&_pe.c.c!==this.y.b()&&_pe.c.c.f(!1)}};_rw.l=function(n){_rw.l.initializeBase(this,[n])};_rw.l.prototype={b:null,a:null,e:function(){return null},h:function(n){this.b&&this.b.b&&this.b.a()},f:function(n){},g:function(n){this.a&&this.a.b&&this.a.a()}};_rw.n=function(){};_rw.n.prototype={a:function(n,t){return Boolean.isInstanceOfType(n)&&n?_pe.a.F():_pe.a.E()},b:function(n,t){throw Error.notImplemented();}};_rw.k=function(n,t,i,r){this.r=Function.createDelegate(this,this.dc);_rw.k.initializeBase(this,[n,t]);this.k=i;this.l=r};_rw.k.prototype={k:null,m:null,h:null,d:null,bx:!1,cq:!1,bH:!1,t:!1,bp:!1,l:null,ds:function(n){if(this.m!==n){this.m=n;this.db(n)}return n},dj:function(n){this.h!==n&&(this.h=n);return n},dA:function(n){if(this.bx!==n){this.bx=n;n&&this.dI()}return n},dH:function(n){if(this.bH!==n){this.bH=n;n&&this.cx()}return n},dt:function(n){if(this.t!==n){this.t=n;n&&this.dK()}return n},dk:function(n){this.cq=n;n&&this.i();return n},dz:function(n){if(this.bp!==n){this.bp=n;n&&this.dJ()}return n},bV:function(){return!!this.l&&this.l.a().Q().Enabled},T:function(){_rw.d.prototype.T.call(this);this.bS.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.u)&&this.k.b(_ff.o,this.r)},bl:function(){this.bS.a()!=="Mouse"&&_rw.f.isInstanceOfType(this.u)&&this.k.c(_ff.o,this.r);_rw.d.prototype.bl.call(this)},ca:function(){if(_rw.f.isInstanceOfType(this.u)){this.bd(null);var n=this.u.b;n.f()}},i:function(){var n=_rw.f.isInstanceOfType(this.u);if(n&&this.u.b.co()){this.u.b.bR();this.y.focus()}_rw.d.prototype.i.call(this)},dI:function(){this.d.length===1&&this.d.show()},db:function(n){var t=this.u;var i=t.b;if(n){var r=this.bO(n);if(r<0)return;this.d=t.a.c(r).y;this.d.hide();if(r!==this.z().b()-1){var u=t.a.c(r+1).y[0];t.c.A(!0);t.y[0].insertBefore(i.y[0],u);t.b.c(this.d.width()+10);t.c.A(!1)}else t.y[0].appendChild(i.y[0]);t.c.a()===this.h&&t.c.b("");t.c.b(this.h);t.c.bp(!0)}else{this.d=null;t.y[0].appendChild(i.y[0]);t.c.b("")}var f=this;_js.g.a().c(_a.a.S,"RecipientWellView.AdjustFindControlPosition",function(){i.f();i.cr();t.c&&(n?t.c.w(!0):t.c.w(!1))})},dc:function(n){this.cx()},cx:function(){if(_rw.f.isInstanceOfType(this.u)){var n=this;_js.g.a().c(_a.a.S,"RecipientWellView.TryUpdateTextBoxDropDownPosition",function(){n.u.b.bS()})}},dK:function(){if(_rw.f.isInstanceOfType(this.u)){var n=this;_js.g.a().c(_a.a.S,"RecipientWellView.TryResetTextBoxDropDownPosition",function(){n.u.b.cf()})}},dJ:function(){if(_rw.f.isInstanceOfType(this.u)){var n=this;_js.g.a().c(_a.a.S,"RecipientWellView.TriggerResizeFindControl",function(){n.u.bx()})}}};_rw.j=function(n){_rw.j.initializeBase(this,[n]);this.w("ReadWriteRecipientWellView")};_rw.j.prototype={a:null,c:null,b:null,cs:function(){return this.c},Y:function(n){if(this.c!==n){this.c=n;this.bk("AriaLabelledBy")}return n},ch:function(){return this.b},W:function(n){if(this.b!==n){this.b=n;this.bk("AriaLabel")}return n},d:function(){var n=null;if(this.a){var t=this.a.c();n=this.a.u.a.c(t)}return n},e:function(){this.P()&&this.a&&this.a.u.b.f()},K:function(){_js.b.prototype.K.call(this);var n=this.F;this.a=n?n.a("RecipientWell"):null}};_rw.f=function(n){this.Z=Function.createDelegate(this,this.g);this.q=Function.createDelegate(this,this.bR);this.u=Function.createDelegate(this,this.bd);this.v=Function.createDelegate(this,this.bW);this.K=Function.createDelegate(this,this.bs);_rw.f.initializeBase(this,[n]);this.y.attr("tabIndex","-1");this.b=this.bO();this.b.r(new _C(this.K,_rw.f.a));this.p=_y.c.a.a()==="Mouse"?25:50;var i=this;this.y.bind("click",function(n){i.bb(n)});var t=256;this.bf(t)};_rw.f.prototype={b:null,p:0,c:null,f:null,by:function(n){if(this.c!==n){if(!$a(this.c)){this.c.rpcl("IsTextBoxFocused",this.v);this.c.rpcl("IsTypedown",this.u)}this.c=n;this.b.X(this.c);if(!$a(this.c)){this.b.p(this.c.C());this.b.u(this.c.t());this.c.apcl("IsTextBoxFocused",this.v);this.c.apcl("IsTypedown",this.u);this.bd(null,"IsTypedown")}this.bk("FindRecipientViewModelForWell")}return n},bV:function(n){this.b.cn(n);return n},bT:function(n){this.b.cm(n);return n},h:function(){if($a(this.f)){this.f=$(window.document.createElement("SPAN"));this.f.addClass("dynamicResizingElement");this.f.addClass("ms-fwt-r")}return this.f},k:function(){return this.y.width()},bx:function(){this.b.c(0);this.c&&this.g()},T:function(){_js.c.prototype.T.call(this);$(window).bind("resize",this.q);_js.g.a().a(_a.a.S,"RecipientWell.FindControl.Resize",this.Z,500)},J:function(){_js.D.prototype.J.call(this);this.b.y.addClass("findControlWrapper");this.b.y.css("line-height","normal");this.b.y[0].appendChild(this.h().get(0));_y.c.a.a()!=="Mouse"&&this.bs()},j:function(n,t){_fce.c.prototype.j.call(this,n,t);if(this.E()&&this.E().bL){t.c!==2&&t.c||this.g();if(!this.c||this.c.bg()){if(!t.c||t.c===2&&!this.a.b()){var i=this;_js.g.a().c(_a.a.S,"RecipientWellPanelView.OnChildrenModified",function(){i.b.f()})}}else this.c.z(!0)}},bm:function(n,t){if(n.y.parents().length)throw Error.argument("Can't add already added control to panel");var i=this.y[0];this.b.y.width("auto");this.b.c(0);i.insertBefore(n.y[0],this.b.y[0])},bl:function(){$(window).unbind("resize",this.q);var i=this;this.y.unbind("click",function(n){i.bb(n)});this.by(null);var n=this.h().get(0);var t=this.b.y.has(n);t.length===1&&this.b.y[0].removeChild(n);this.b.dispose();_fce.c.prototype.bl.call(this)},bb:function(n){var t="";if($a(window.document.selection))$a(window.getSelection)||(t=window.getSelection().toString());else{var r=window.document.selection.createRange();t=r.text}if(_js.d.a(t))if(n.target.nodeName==="SPAN"||n.target.nodeName==="IMG")this.b.bR();else if(this.bS()){var i=this;_js.g.a().c(_a.a.S,"RecipientWellPanelView.OnClickPanel",function(){i.b.f()})}else this.b.f()},bO:function(){var n=new _b.q(window.document.createElement("SPAN"));n.X(this.c);n.w("FindRecipientView");n.M(!1);n.j(!0);n.q(0);n.v(100);n.br();this.y[0].appendChild(n.y[0]);return n},bd:function(n,t){this.b&&this.b.o!==this.c.r()&&this.b.j(this.c.r())},bW:function(n,t){this.c.E()?this.b.bL()<this.p&&this.g():_js.d.a(this.c.a())&&this.g()},bs:function(){if(this.c){var n=this.c.a();if(_js.d.a(n)){this.h().text("");this.g()}else{n=_ff.i.a(n);this.h().text(n);var i=this.h().innerWidth();if(i<this.b.bL())return;var t=this.k()-30;this.b.c(t)}}},g:function(){this.b.c(this.k()-this.bQ()-30)},bQ:function(){var n=0;if(this.a.b()>0){var t=this.a.c(this.a.b()-1).y;n=_g.a.a().c().bh.IsUserCultureRightToLeft?this.k()-t.position().left:t.position().left+t.outerWidth(!0)}return this.k()-n-30<this.p?0:n},bR:function(n){this.bx()},bS:function(){return _a.UserAgent.getInstance().Q&&_y.c.a.a()!=="Mouse"}};_rw.c=function(n){_rw.c.initializeBase(this,[n])};_rw.c.prototype={b:null,a:null,cs:function(){return this.b},Y:function(n){if(this.b!==n){this.b=n;this.bk("AriaLabelledBy")}return n},ch:function(){return this.a},W:function(n){if(this.a!==n){this.a=n;this.bk("AriaLabel")}return n}};_rw.d=function(n,t){this.n=Function.createDelegate(this,this.cS);this.o=Function.createDelegate(this,this.cT);this.bL=Function.createDelegate(this,this.cH);_rw.d.initializeBase(this,[n,t]);this.da();this.bb(this.bL)};_rw.d.a=function(n,t){if($a(window.getSelection)){if(!$a(window.document.selection)){var i=document.selection.createRange();i.moveToElementText(n.get(0));_js.g.a().c(_a.a.S,"RecipientWellView.HighLightSelectedElement",function(){i.select();t.focus()})}}else{var u=window.getSelection();var r=document.createRange();r.selectNodeContents(n.get(0));u.removeAllRanges();_js.g.a().c(_a.a.S,"RecipientWellView.HighLightSelectedElement",function(){u.addRange(r);t.focus()})}};_rw.d.prototype={b:null,f:!1,p:!1,e:!1,a:function(n){this.f!==n&&(this.f=n);return n},cW:function(n){if(this.p!==n){this.p=n;this.hx(n)}return n},j:function(n){n!==this.e&&(this.e=n);return n},c:function(){return this.z().j(this.Z())},bV:function(){return!1},T:function(){_fce.a.prototype.T.call(this);this.bf(524288);this.y.bind("click",this.o);this.y.bind("cut",this.n)},K:function(){_fce.a.prototype.K.call(this);var n=this.F;this.b=n?n.a("ClipboardTextArea"):null},bl:function(){this.y.unbind("click",this.o);this.y.unbind("cut",this.n);try{_fce.a.prototype.bl.call(this)}catch(u){var t="UIObject.Remove threw while disposing RecipientWellView: "+u.message+u.stack;if(this.E()){var n=this.E();if(n){_rw.b.isInstanceOfType(n)&&(t+=" ReadWrite well ");if(n.t){t+=" NumRecipients:"+n.t.y.length+"[";for(var r=0;r<n.t.y.length;r++){var i=n.t.y[r];i&&i.j&&(t+=i.j.c()+",")}t+="]"}}}else t+="RecipientWellView datacontext is null";_js.Trace.logError(_a.a.S,t)}},ci:function(n){var t=n.a();if(n.d().nodeName!=="INPUT"||t===_ff.k.a)if(t===46||t===8){if(!$a(this.Z())&&!this.f){this.bQ(t===46);n.b()}}else if(t===_ff.k.a){this.cV();n.b()}else if(t===_ff.k.b){this.cU();n.b()}},eP:function(){_fce.a.prototype.eP.call(this);_js.Trace.logInfo(_a.a.S,"RecipientWellView::FinishedRendering: Panel children count: {0}, data count: {1}",this.u.a.b(),this.ft())},ca:function(){},i:function(){this.g(this.z().c(this.z().b()-1))},q:function(){if(!$a(this.by()))if(this.b){var n=this.by().E();this.b.c(n.f()+";");this.b.y.focus().select()}else _rw.d.a(this.by().y,this.y)},cT:function(n){if(n.target.nodeName!=="DIV"&&n.target.nodeName!=="INPUT"){this.e&&this.q();return}this.bd(null)},cS:function(n){if(this.b&&this.b.y[0]===n.target){var t=this;_js.g.a().c(_a.a.S,"RecipientWellView.OnCut",function(){t.bQ(!1)})}},dF:function(n){var t=this;_js.g.a().c(_a.a.S,"RecipientWellView.OnFocusOut",function(){if(t.E()&&(!document.activeElement||!t.x.contains(document.activeElement))){var n=t.E().y;!n||n.b()&&n.b().r()||t.E().m(null)}})},da:function(){this.f?this.y.attr("tabIndex","0"):this.y.attr("tabIndex","-1");var n=256;this.bf(n)},cH:function(){return new _fce.d(window.document.createElement(this.hi()))},bQ:function(n){if(this.bV()){var t=this.z().j(this.Z());t&&(t+=n&&t+1<this.z().b()?0:-1);this.z().m(this.Z());this.z().b()&&this.g(this.z().c(t))}else{var i=this.z().j(this.Z());i&&i--;this.z().m(this.Z());this.z().b()&&this.g(this.z().c(i))}},cU:function(){if(this.z().b())if(this.Z())if(this.c()<this.z().b()-1)this.g(this.z().c(this.c()+1));else{this.f||this.bd(null);this.ca()}else this.g(this.z().c(0))},cV:function(){this.z().b()&&(this.Z()?this.c()>0?this.g(this.z().c(this.c()-1)):this.e&&this.q():this.i())},g:function(n){this.bd(n);this.e&&this.q()}};_rw._TI=function(){};_rw._TI.$$cctor=function(){var f="ReadOnlyRecipientView";new _A(f,function(){_rw._TI.a[f]===undefined&&(_rw._TI.a[f]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[0].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.w("PersonaView.ReadOnlyRecipientPopup");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var u="ReadOnlyRecipientViewAggregated";new _A(u,function(){_rw._TI.a[u]===undefined&&(_rw._TI.a[u]=[[[-1,0,["CurrentPersonaViewModel"],[_rw._TI.c],null,"DataContext",null,_rw._TI.d,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.w("PersonaView.ReadOnlyRecipientPopupAggregated");n.m=!0;return new _B(t,[n])},_rw.e,_js.b,function(n){return new _js.b(n)},!1,!1,!0,5,_rw._TI.a);var o="ReadOnlyRecipientWellExpandCollapseView._tid1";new _A(o,function(){_rw._TI.a[o]===undefined&&(_rw._TI.a[o]=[null,[[-1,5,["ShowEllipsis"],[_rw._TI.U],null,"hidden",null,null,0,_rw._TI.b(),null,null]]]);var n=_rw._TI._hf.childNodes[2].cloneNode(!0);var i=new _js.c(n.children[1]);var t=new _fce.c(n.children[0]);return new _B(n,[t,i]).R({ListPanel:t})},_rw.a,_rw.d,function(n){return new _rw.d(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var e="ReadOnlyRecipientWellExpandCollapseView";new _A(e,function(){_rw._TI.a[e]===undefined&&(_rw._TI.a[e]=[[[-1,1,["AriaLabel"],[_rw._TI.X],null,"AriaLabel",null,_rw._TI.z,1,null,null,null],[-1,0,["Recipients"],[_rw._TI.n],null,"DataSource",null,_rw._TI.h,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.s],null,"DataTemplateId",null,_rw._TI.q,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.o],_rw._TI.p,"SelectedItem",_rw._TI.g,_rw._TI.i,2,null,null,null]]]);var i=_rw._TI._hf.childNodes[3].cloneNode(!0);var n=new _rw.d(i.children[0],_js.a.Instance.a(_y.a));n.a(!0);n.bs=!0;n.bC(!1);n.bh("span");n.bo("_rw_6");n.j(!0);n.C(0);var r=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.m],null,"Command",null,_rw._TI.j,1));t.i("ENTER");r.a([t]);n.H([r]);n.w("ReadOnlyRecipientWellExpandCollapseView._tid1");return new _B(i,[n])},_rw.a,_rw.c,function(n){return new _rw.c(n)},!1,!1,!0,5,_rw._TI.a);var t="ReadOnlyRecipientWellView._tid2";new _A(t,function(){_rw._TI.a[t]===undefined&&(_rw._TI.a[t]=[null]);var i=_rw._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(i.children[0]);return new _B(i,[n]).R({ListPanel:n})},_rw.a,_rw.d,function(n){return new _rw.d(n,_js.a.Instance.a(_y.a))},!1,!0,!1,0,_rw._TI.a);var n="ReadOnlyRecipientWellView";new _A(n,function(){_rw._TI.a[n]===undefined&&(_rw._TI.a[n]=[[[-1,0,["Recipients"],[_rw._TI.n],null,"DataSource",null,_rw._TI.h,1,null,null,null],[-1,0,["ReadOnlyRecipientTemplateId"],[_rw._TI.s],null,"DataTemplateId",null,_rw._TI.q,0,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.o],_rw._TI.p,"SelectedItem",_rw._TI.g,_rw._TI.i,2,null,null,null]]]);var r=_rw._TI._hf.childNodes[5].cloneNode(!0);var t=new _rw.d(_B.a(r,[0,0]),_js.a.Instance.a(_y.a));t.a(!0);t.bs=!0;t.bC(!0);t.bI(5);t.bh("span");t.bo("_rw_a");t.j(!0);t.C(0);var u=new _fc.g;var i=new _fc.c;i.A(_E.a(["EnterKeyCommand"],[_rw._TI.m],null,"Command",null,_rw._TI.j,1));i.i("ENTER");u.a([i]);t.H([u]);t.w("ReadOnlyRecipientWellView._tid2");return new _B(r,[t])},_rw.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_rw._TI.a);var r="ReadWriteRecipientWellView._tid4";new _A(r,function(){_rw._TI.a[r]===undefined&&(_rw._TI.a[r]=[null,[[-1,4,null,null,null,"TextSelectionType",null,_rw._TI.A,0,null,null,0,2],[-1,1,["TemplatedParent","AriaLabelledBy"],[_rw._TI.r,_rw._TI.y],null,"FindTextBoxAriaLabelledBy",null,_rw._TI.ba,0,null,null,null],[-1,1,["TemplatedParent","AriaLabel"],[_rw._TI.r,_rw._TI.x],null,"FindTextBoxAriaLabel",null,_rw._TI.Z,0,null,null,null],[-1,0,["FindRecipientViewModel"],[_rw._TI.D],null,"FindRecipientViewModelForWell",null,_rw._TI.Y,1,null,null,null]]]);var t=_rw._TI._hf.childNodes[10].cloneNode(!0);var i=new _rw.f(t.children[1]);var n=new _fce.q(t.children[0]);n.I(0);n.N(!0);n.C(-1);return new _B(t,[n,i]).R({ClipboardTextArea:n,ListPanel:i})},_rw.b,_rw.k,function(n){return new _rw.k(n,_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.f))},!1,!0,!1,0,_rw._TI.a);var i="ReadWriteRecipientWellView";new _A(i,function(){_rw._TI.a[i]===undefined&&(_rw._TI.a[i]=[[[-1,0,["Recipients"],[_rw._TI.n],null,"DataSource",null,_rw._TI.h,1,null,null,null],[-1,0,["SelectedRecipient"],[_rw._TI.o],_rw._TI.p,"SelectedItem",_rw._TI.g,_rw._TI.i,2,null,null,null],[-1,0,["RecipientBeingEdited"],[_rw._TI.G],_rw._TI.M,"ItemBeingEdited",_rw._TI.bd,_rw._TI.bg,2,null,null,null],[-1,0,["TextBeingEdited"],[_rw._TI.K],_rw._TI.N,"FindControlText",_rw._TI.bc,_rw._TI.be,2,null,null,null],[-1,0,["DisableActionsOnAllRecipients"],[_rw._TI.C],null,"DisableActions",null,_rw._TI.bb,1,null,null,!1],[-1,0,["ShouldShowHiddenRecipient"],[_rw._TI.J],null,"ShouldShowHiddenEditItem",null,_rw._TI.bj,1,null,null,!1],[-1,0,["UpdateFindControlPopupPosition"],[_rw._TI.L],null,"UpdateFindControlDropDownPosition",null,_rw._TI.bk,1,null,null,!1],[-1,0,["ResetFindControlPopupPosition"],[_rw._TI.H],null,"ResetFindControlDropDownPosition",null,_rw._TI.bh,1,null,null,!1],[-1,0,["HandleBackspaceCommandAtEndOfReadWriteWell"],[_rw._TI.E],null,"HandleBackspaceCommandAtEndOfWell",null,_rw._TI.bf,1,null,null,!1],[-1,0,["ResizeFindControl"],[_rw._TI.I],null,"ResizeFindControl",null,_rw._TI.bi,1,null,null,!1],[-1,5,["IsFirefox"],[_rw._TI.F],null,"_rw_k",null,null,0,_rw._TI.b(),null,null]]]);var r=_rw._TI._hf.childNodes[11].cloneNode(!0);var n=new _rw.k(r.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.f));n.a(!1);n.I(41);n.v("ReadWriteRecipientView");n.j(!0);n.bh("span");n.bo("_rw_j");var u=new _fc.g;var t=new _fc.c;t.A(_E.a(["EnterKeyCommand"],[_rw._TI.m],null,"Command",null,_rw._TI.j,1));t.i("ENTER");u.a([t]);n.H([u]);n.w("ReadWriteRecipientWellView._tid4");return new _B(r,[n]).R({RecipientWell:n})},_rw.b,_rw.j,function(n){return new _rw.j(n)},!1,!1,!1,0,_rw._TI.a)};_rw._TI.u=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_rw_2'></span> </div><div> <span class='_rw_3'></span> </div><div> <div class='_rw_4'></div> <span class='_rw_7 ms-font-weight-regular ms-font-color-black'>...</span>  </div><div> <div class='_rw_5'></div> </div><div> <div class='_rw_8'></div>  </div><div> <div> <div class='_rw_9'></div> </div> </div><div> <span class='_rw_b ms-fwt-r'> <span class='_rw_f'> <button type='button'></button> </span> <span class='_rw_d'></span> </span>  </div><div> <div class='_rw_c'></div> </div><div> <span class='_rw_g ms-font-m ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <span class='_rw_h ms-fwt-r ms-font-color-themeDark ms-font-color-themePrimary-hover ms-bg-color-neutralLighter'> <span></span> </span> </div><div> <textarea class='_rw_l'></textarea> <div class='_rw_i'></div>  </div><div> <div autoid=\"_rw_0\" class='_rw_i'></div> </div>";_js.c.a().appendChild(n);return n};_rw._TI.c=function(n){return n.i};_rw._TI.U=function(n){return n.g()};_rw._TI.n=function(n){return n.t};_rw._TI.s=function(n){return n.dQ()};_rw._TI.o=function(n){return n.y};_rw._TI.g=function(n){return n.Z()};_rw._TI.X=function(n){return n.ch()};_rw._TI.m=function(n){return n.dO()};_rw._TI.l=function(n){return n.Y()};_rw._TI.k=function(n){return n.v()};_rw._TI.Q=function(n){return n.Z()};_rw._TI.R=function(n){return n.ba()};_rw._TI.bm=function(n){return n.F()};_rw._TI.O=function(n){return n.V()};_rw._TI.S=function(n){return n.bb()};_rw._TI.T=function(n){return n.bc()};_rw._TI.P=function(n){return n.X()};_rw._TI.bl=function(n){return n.bc()};_rw._TI.D=function(n){return n.v()};_rw._TI.r=function(n){return n.L};_rw._TI.y=function(n){return n.cs()};_rw._TI.x=function(n){return n.ch()};_rw._TI.G=function(n){return n.A};_rw._TI.bd=function(n){return n.m};_rw._TI.K=function(n){return n.bk};_rw._TI.bc=function(n){return n.h};_rw._TI.C=function(n){return n.I};_rw._TI.J=function(n){return n.bA};_rw._TI.L=function(n){return n.bB};_rw._TI.H=function(n){return n.bw};_rw._TI.E=function(n){return n.bu};_rw._TI.I=function(n){return n.bx};_rw._TI.F=function(n){return n.dv()};_rw._TI.d=function(n,t){n.X(t)};_rw._TI.h=function(n,t){n.bm(t)};_rw._TI.q=function(n,t){n.v(t)};_rw._TI.p=function(n,t){n.m(t)};_rw._TI.i=function(n,t){n.bd(t)};_rw._TI.z=function(n,t){n.W(t)};_rw._TI.j=function(n,t){n.k=t};_rw._TI.w=function(n,t){n.i(t)};_rw._TI.v=function(n,t){n.ba(t)};_rw._TI.W=function(n,t){n.b=t};_rw._TI.V=function(n,t){n.a=t};_rw._TI.B=function(n,t){n.bw(t)};_rw._TI.Y=function(n,t){n.by(t)};_rw._TI.A=function(n,t){n.cd(t)};_rw._TI.ba=function(n,t){n.bV(t)};_rw._TI.Z=function(n,t){n.bT(t)};_rw._TI.M=function(n,t){n.G(t)};_rw._TI.bg=function(n,t){n.ds(t)};_rw._TI.N=function(n,t){n.K(t)};_rw._TI.be=function(n,t){n.dj(t)};_rw._TI.bb=function(n,t){n.cW(t)};_rw._TI.bj=function(n,t){n.dA(t)};_rw._TI.bk=function(n,t){n.dH(t)};_rw._TI.bh=function(n,t){n.dt(t)};_rw._TI.bf=function(n,t){n.dk(t)};_rw._TI.bi=function(n,t){n.dz(t)};_rw._TI.b=function(){_rw._TI.e||(_rw._TI.e=new _fc.k);return _rw._TI.e};_rw._TI.t=function(){_rw._TI.f||(_rw._TI.f=new _rw.n);return _rw._TI.f};_rw.i.registerClass("_rw.i");RecipientWellComponent.registerClass("RecipientWellComponent",null,_a.ih);_rw.h.registerClass("_rw.h");_rw.a.registerClass("_rw.a",_a.bx,_y.eW);_rw.b.registerClass("_rw.b",_rw.a);_rw.e.registerClass("_rw.e",_a.bx,_y.dv);_rw.g.registerClass("_rw.g",_rw.h,IRecipientWellViewModelFactory);_rw.l.registerClass("_rw.l",_js.b,_b.bS);_rw.n.registerClass("_rw.n",null,_js.T);_rw.d.registerClass("_rw.d",_fce.a);_rw.k.registerClass("_rw.k",_rw.d);_rw.j.registerClass("_rw.j",_js.b);_rw.f.registerClass("_rw.f",_fce.c);_rw.c.registerClass("_rw.c",_js.b);_rw._TI.registerClass("_rw._TI");RecipientWellComponent.$$cctor();_rw.b.c="ShowDLExpansionError";_rw.b.g=new RegExp("([.*+?${}/])","g");_rw.b.f=new RegExp("[\\w-\\.!#%&'=~`/\\$\\|\\?\\*\\+\\{\\}]+@[\\w-\\.]+");_rw.b.d=100;_rw.b.a=_a.a.S;_rw.e.a=_a.a.S;_rw.a.d=_a.a.S;_rw.a.c=null;_rw.a.a=-1;_rw.a.e=null;_rw.f.a=_a.a.S;_rw._TI._hf=_rw._TI.u();_rw._TI.e=null;_rw._TI.f=null;_rw._TI.a={};_rw._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.recipientwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.recipientwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
