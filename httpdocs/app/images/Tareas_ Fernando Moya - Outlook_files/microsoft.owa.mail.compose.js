try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.r.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.a()&&t.f().a()<9);var r=i.c().bh.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.i()&&i.i().bh.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bh.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={a:function(n,t,i){var g=this;n.b(_mcp.C,function(){return new _mcp.C(n.a(_a.t),n.c(ICancelCalendarItemActionFactory))}).b(IMailComposeActionFactory).a();var p=this;n.b(_mcp.K,function(){return new _mcp.K(n.a(_a.t),n.c(ICancelCalendarItemActionFactory))}).b(IGroupInlineComposeActionFactory).a();var b=this;n.b(_mcp.ba,function(){return new _mcp.ba(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.c(ISmimeCommandFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory))}).b(IMailResponseViewModelFactory).a();var w=this;n.b(_mcp.V,function(){return new _mcp.V(n.a(_y.dD),n.a(_a.t))}).b(IMailComposeContextFactory).a();var o=n.a(_a.e);var e=n.a(_g.f);var f=MailComposeComponent.a(i.a(),o,e);var u=n.a(_a.f);var r=i.a()==="Mouse"&&u.a().bs().Enabled;var d=this;n.b(_mcp.u,function(){return new _mcp.u(n.a(_a.s),n.a(_ff.c),n.a(_g.f))}).a();var k=this;n.b(_mcp.X,function(){return new _mcp.X(n.c(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.D),n.a(_y.M),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dm),n.a(_a.w),n.d(IMyLocationBuilder),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.q):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bh.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.a(_a.e),i,n.a(_y.r),n.a(_h.bi),n.a(_mcp.u))}).b(IMailComposeViewModelFactory).a();var y=this;n.b(_mcp.Y,function(){return new _mcp.Y(n.c(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.C),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.D),n.a(_y.M),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dm),n.a(_a.w),n.d(IMyLocationBuilder),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.q):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bh.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.a(_a.e),i,n.a(_y.r),n.a(_h.bi),n.a(_mcp.u))}).b(IMailInlineComposeViewModelFactory).a();var c=this;n.b(_mcp.S,function(){return new _mcp.S(n.c(IExtensibilityViewModelFactory),n.a(_rw.g),f?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.K),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.D),n.a(_y.M),n.a(_ff.c),n.c(IAttachmentWellViewModelFactory),u,n.a(_a.t),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.dm),n.a(_a.w),n.d(IMyLocationBuilder),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.q):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bh.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.a(_a.e),i,n.a(_y.r),n.a(_h.bi),n.a(_mcp.u))}).b(IGroupInlineComposeViewModelFactory).a();var h=this;n.b(_mcp.D,function(){return new _mcp.D(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var s=this;n.b(_mcp.H,function(){return new _mcp.H(n.a(_y.a),n.a(_js.k),n.a(_g.f),n.a(_ff.c),n.a(IMailComposeViewModelFactory))}).a();var v=this;n.b(_mcp.n,function(){return new _mcp.n(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.f),n.a(_ff.c),n.a(_a.w),n.a(_b.e),n.c(IAtMentionsHandler))});var l=this;n.b(_mcp.j,function(){return new _mcp.j(window.document.createElement("div"),i.a(),n.a(_a.e),n.a(_a.t),n.a(_a.f),n.a(_ff.c),n.a(_a.w),n.a(_b.e),n.c(IAtMentionsHandler))});var a=this;n.b(_mcp.I,function(){return new _mcp.I(n.d(IPopOutHelper),i.a())}).a()},b:function(){return[new _a.B(_mcp.I,1,1),new _a.B(_mcp.u,1,73),new _a.B(_mcp.H,4,1)]}};_mcp.H=function(n,t,i,r,u){this.f=Function.createDelegate(this,this.j);this.d=n;this.e=t;this.h=i;this.b=r;this.c=u;this.b.b(IDelayedSendEvent,this.f)};_mcp.H.prototype={d:null,e:null,h:null,b:null,c:null,a:null,j:function(n){_js.j.a(n.a(),"SendEvent.DelayedSendCallback is null.");_js.j.a(n.b(),"SendEvent.MailComposeContext is null.");var u=n.c()*1e3;var e=n.b();var r=n.a();var t=this,o=this;var i=new _mcp.bf(this.b,u,function(){t.g()||_js.Trace.logWarning(_a.a.a,"TryCancelQueuedTask failed on undo delayed send. Continuing to try to navigate to the draft...");t.k(e)},function(){if(o.g()){_js.Trace.logInfo(_a.a.a,"Flushing the delayed-send task by firing the send callback.");r()}});var f=this;this.a=_js.g.a().a(_a.a.a,"SubmitDelayedComposeAction",function(){f.i(r,i)},u);_h.A.a().g(i)},i:function(n,t){_js.Trace.logInfo(_a.a.a,"DelayedSendTaskDelegate - executing the send callback.");n();this.a=null;if(t===_h.A.a().a()){_js.Trace.logInfo(_a.a.a,"DelayedSendTaskDelegate - popping the undo action off the undo stack after executing the send callback.");_h.A.a().f()}},g:function(){var n=!1;if(this.a){this.a=this.e.b(this.a);n=!this.a}else _js.Trace.logWarning(_a.a.a,"queuedTaskHandle is null on flush, skipping...");return n},k:function(n){n.j(!1);var t=this.c.a(n,null,null);t.k(!1);t.q(!1);this.d.f(t,0,!0)}};_mcp.I=function(n,t){if(t==="Mouse"){var i=this;n.e(function(n){n.a(_mcp.a,"MailComposeContext")})}};_mcp.u=function(n,t,i){_mcp.u.initializeBase(this);this.c=n;this.d=t;this.b=i.a();this.a=0;var r=this.b.bh.SignatureHtml;r===""||r||this.e()};_mcp.u.prototype={c:null,d:null,b:null,a:0,e:function(){this.a=1;var n=new _mcp.be;var t=this;n.w(function(){t.b.bS(n.b.bh.SignatureHtml);t.b.bT(n.b.bh.SignatureText);t.a=2;t.ea("CurrentStatus")});var i=this;n.v(function(){i.a=3;_js.Trace.logError(_a.a.a,"Signature Preload Service failed to fetch signature");i.ea("CurrentStatus")});this.c.a(n)}};_mcp.bf=function(n,t,i,r){this.k=n;this.n=i;this.m=r;_h.A.a().c()&&_js.Trace.logWarning(_a.a.a,"There is already an action being undone, cannot add action to undo delayed send.")};_mcp.bf.prototype={k:null,n:null,m:null,l:!1,toString:function(){return _u.R.NP},f:function(){this.l=!0;this.n();this.l=!1;return!0},a:function(){this.m()},i:function(){this.k.a(_a.bf,new _a.bf(4,"","","",null,null))},j:function(){this.k.a(_a.bf,new _a.bf(3,"","","",null,null))},e:function(){return this.l},d:function(n){return!1},c:function(n){return!1},b:function(n){return!0},h:function(n){},g:function(){}};_mcp.E=function(n){_mcp.E.initializeBase(this);this.b=n};_mcp.E.prototype={b:null,u:function(n){var i=this.c();var t=new _gg.qF(this.x);t.explicitLogonUser=this.b.G;$a(this.b.g)||t.actionName||(t.actionName=this.b.g);n.dA(i,t,this.r,this.q)},c:function(){var t=this.b.bV();var i=new _gg.he(this.y());var n=new _gg.er;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},Q:function(n){_h.dX.prototype.Q.call(this,n)},cp:function(n){this.b.bY(n)}};_mcp.bd=function(){_mcp.bd.initializeBase(this)};_mcp.bd.prototype={b:null,c:null,u:function(n){var i=new _gg.eP(this.y());var t=new _gg.mZ(200);n.u(i,t,this.r,this.q)},cy:function(n,t,i){if(n.Options){this.b=n.Options.EmailAddresses;this.c=n.Options.NotManagedEmailAddresses;t&&t()}else!_js.d.a(n.ErrorMessage)&&i&&i(Error.create(n.ErrorMessage))}};_mcp.be=function(){_mcp.be.initializeBase(this)};_mcp.be.prototype={b:null,u:function(n){var t=new _gg.ne(this.x);n.x(t,this.r,this.q)},cy:function(n,t,i){this.b=new _gg.h(n.Options);t()}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.W=function(){};_mcp.W.a=function(n){var t=null;_h.p.isInstanceOfType(n)?t=n.f:_h.n.isInstanceOfType(n)&&(t=n.U);return t};_mcp.T=function(n,t,i){this.d=n;this.e=t;this.f=i};_mcp.T.prototype={e:0,d:0,f:0,a:function(){return this.e},b:function(){return this.d},c:function(){return this.f}};_mcp.bE=function(n,t,i){this.e=n;this.f=t;this.d=i};_mcp.bE.prototype={e:0,c:function(){return this.e},f:null,b:function(){return this.f},d:null,a:function(){return this.d}};_mcp.bF=function(){};_mcp.bI=function(n,t,i,r){this.e=n;this.h=t;this.g=i;this.f=r};_mcp.bI.prototype={e:null,h:null,f:null,g:null,a:function(){return this.e},d:function(){return this.h},c:function(){return this.g},b:function(){return this.f}};_mcp.bH=function(n,t){this.c=n;this.d=t};_mcp.bH.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bb=function(n){this.a=n};_mcp.bb.prototype={a:null};_mcp.bL=function(n){this.b=n};_mcp.bL.prototype={b:null,a:function(){return this.b}};_mcp.G=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.G.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.bc=function(n){this.b=n};_mcp.bc.prototype={b:!1,a:function(){return this.b}};_mcp.bM=function(n){this.b=n};_mcp.bM.prototype={b:null,a:function(){return this.b}};_mcp.C=function(n,t){this.d=n;this.g=t};_mcp.C.prototype={d:null,g:null,e:function(n,t){var i=n.N;var u=i.a();var h=3===u||2===u||1===u;var s=this.d.b()&&i.g();(n.bz().h()||i.cN()&&i.cS())&&(s=!!(s&i.S()));var f=null;if(h&&!s){_js.Trace.logInfo(_a.a.a,"Creating CreateResponseAction for context:{0}; layout={1}; disposition={2}",i,_y.c.a.a(),t);var c=i.w(!1);var e=this.b(i,c);e.d=t;e.bf=i.bG(100);e.bE=_y.n.toString(i.a());e.bq=i.bF();e.br=i.bh();if(i.bl()){var l=new _mcp.E(e);f=l}else f=e}else if(i.by()){_js.Trace.logInfo(_a.a.a,"Creating UpdateMessageForComposeAction for context:{0}; disposition={1}",i,t);var o=this.h(t,i);if(i.bl()&&!i.a()){o.b.bV(o.Y);i.I(o.Y)}f=o}else if(8===i.a()){_js.Trace.logInfo(_a.a.a,"Creating CancelCalendarItemAction for context:{0}; disposition={1}",i,t);f=this.j(i,t)}else if(u!==5&&u!==6&&u!==7)if(u===9||u===10){_js.Trace.logInfo(_a.a.a,"CreateComposeAction: ApprovalRequestAction");f=this.i(i,t)}else{_js.Trace.logInfo(_a.a.a,"Creating CreateMessageForComposeAction for context:{0}; disposition={1}",i,t);var r=null;if(u===11||u===12){r=new _h.j(i.bt(!1),i.bB(),this.d);r.d=0}else{r=new _h.j(i.w(!1),null,this.d);r.d=t}r.T=!this.d.a();$a(i.p())||(r.U=i.p());r.bf=i.bG(100);r.bE=_y.n.toString(i.a());r.bq=i.bF();r.br=i.bh();if(i.bl()&&!i.a()){r.b.bV(r.bf);i.I(r.bf)}f=r}f.I=i.b();return f},f:function(n,t,i){var r=new _h.cQ(200,n);r.d=t||_h.b.c();r.h=$a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.ei([n],r,2)},c:function(n,t){var r=null;r=n.N()?n.bt(!0):n.w(!0);var i=this.b(n,r);i.m=t;i.bb=!this.d.a()&&n.e()==="HTML"?"MailComposeNormalizedBody":"MailCompose";i.bB=_g.a.a().a().bh.TimeFormat;return i},j:function(n,t){var i=null;var r=this;this.g.b(function(t){i=t.a(n.be(),1,n.cJ());i.c(n.w(!1));n.p()&&i.b(n.p())});return i},b:function(n,t){var r=n.cf()?new _h.R(n.be()):n.be();var i=null;i=new _h.Q(this.k(n.a()),r,this.d);i.be(t);i.c=n.cP();i.T=!this.d.a();n.p()&&(i.U=n.p());i.n=n.bj();i.e=n.cQ();i.I=n.b();n.d()&&_g.o.isInstanceOfType(n.d())&&n.d().bh.IsReadReceiptRequested&&(i.Z=!0);switch(n.a()){case 1:case 2:i.bu=_u.R.KG;break;case 3:i.bu=_nbs.a.QD;break}return i},h:function(n,t){var i=null;if(t.N()){i=new _h.n(t.bt(!1),this.d);i.R=_g.r.c(t.bB());i.f=0}else{i=new _h.n(t.w(!1),this.d);i.f=n}i.bB=!this.d.a();i.bb=t.bF();i.be=t.bh();t.p()&&(i.m=t.p());i.Y=t.bG(100);i.X="AlwaysOverwrite";i.bf=_y.n.toString(t.a());return i},k:function(n){switch(n){case 1:return new _g.cg;case 2:return new _g.bO;case 3:return new _g.ce;case 12:return new _g.fG;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.n.toString(n));}},i:function(n,t){var r=n.d();var i=new _c.u(r,n.w(!1),n.a()===9,t);i.T=!this.d.a();return i}};_mcp.K=function(n,t){_mcp.K.initializeBase(this,[n,t])};_mcp.K.prototype={e:function(n,t){if(_mcp.h.isInstanceOfType(n)){var i=n;if(i.bP&&t===1&&(i.N.a()===2||!i.N.a())){i.N.d()&&i.bk&&i.N.d().bh.ConversationId.Id!==i.bk.bh.ConversationId.Id&&i.N.d().gf(i.bk.bh.ConversationId);var u=this;var r=i.bP(i.bR,i.N,function(n){i.bA=n});r.I=i.N.b();return r}}return _mcp.C.prototype.e.call(this,n,t)}};_mcp.V=function(n,t){this.d=n;this.c=t};_mcp.V.prototype={c:null,d:null,a:function(n,t){var i=new _mcp.a;if(this.c){i.dM(this.c.b());i.ds(this.c.a())}i.o(n?0:this.d.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.o(this.d.a());u.f(4);u.j(!1);u.F(n);u.dz(t);r&&!r.a()?u.m(r.e()):u.m(i===1?"Text":"HTML");return u}};_mcp.X=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt){_a.b.b(k,"nativeBridge");this.q=n;this.H=t;this.v=i;this.I=r;this.Q=u;this.c=f;this.F=e;this.E=o;this.C=s;this.o=h;this.G=c;this.p=l;this.u=v;this.r=y;this.s=p;this.k=a;this.x=w;this.m=b;this.B=k;this.A=d;this.g=g;this.h=nt;this.i=tt;this.n=it;this.K=rt;this.J=ut;this.t=ft;this.M=et;this.j=ot;this.y=st;this.z=ht;this.N=ct;this.e=lt;this.d=at;this.f=vt;this.O=yt;this.l=pt;this.w=wt;this.D=bt;this.L=kt};_mcp.X.prototype={q:null,H:null,v:null,I:null,Q:null,c:null,p:null,F:null,E:null,C:null,o:null,G:null,u:null,r:null,s:null,N:null,k:null,m:null,x:null,n:null,A:null,B:null,g:null,h:null,i:null,K:null,J:null,t:null,M:null,j:null,y:null,z:null,e:null,d:null,f:null,O:null,l:null,w:null,D:null,L:null,b:function(n,t,i){return this.R(n,null,t,i)},a:function(n,t,i){return this.P(n,null,t,i)},R:function(n,t,i,r){var u=this.Q.a(!1,!1);u.go(n);return this.P(u,t,i,r)},P:function(n,t,i,r){var u=new _mcp.d(n,t,this.q,this.H,this.v,this.I,this.F,this.E,this.C,this.o,this.G,this.p,this.k,this.u,this.r,this.s,this.x,this.m,this.B,this.c,i,r,this.A,this.g,this.h,this.i,this.n,this.K,this.J,this.t,this.M,this.j,this.y,this.z,this.N,this.e,this.d,this.f,this.O,this.l,this.w,this.D,this.L);u.cK();return u}};_mcp.Y=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt){_mcp.Y.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt])};_mcp.Y.prototype={P:function(n,t,i,r){var u=new _mcp.g(n,t,this.q,this.H,this.v,this.I,this.F,this.E,this.C,this.o,this.G,this.p,this.k,this.u,this.r,this.s,this.x,this.m,this.B,this.c,i,r,this.A,this.g,this.h,this.i,this.n,this.K,this.J,this.t,this.M,this.j,this.y,this.z,this.N,this.e,this.d,this.f,this.O,this.l,this.w,this.D,this.L);u.cK();return u}};_mcp.S=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt){_mcp.S.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt])};_mcp.S.prototype={P:function(n,t,i,r){var u=new _mcp.h(n,t,this.q,this.H,this.v,this.I,this.F,this.E,this.C,this.o,this.G,this.p,this.k,this.u,this.r,this.s,this.x,this.m,this.B,this.c,i,r,this.A,this.g,this.h,this.i,this.n,this.K,this.J,this.t,this.M,this.j,this.y,this.z,this.N,this.e,this.d,this.f,this.O,this.l,this.w,this.D,this.L);u.cK();return u}};_mcp.U=function(){_mcp.U.initializeBase(this)};_mcp.U.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.ea("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.ea("ConversationOwner")}return n}};_mcp.L=function(n){this.e=Function.createDelegate(this,this.i);_mcp.L.initializeBase(this);this.b=OwaApplication.a;this.c=n};_mcp.L.prototype={c:null,b:null,a:function(n,t,i,r){$a(t)||n.w(t);n.v(i||this.e);$a(r)||n.z(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.MA;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.t;if(o){if(_g.V.a(o)){var h=o;if(h.ErrorCode===503){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.gq);e=_u.R.gq}else if(h.ErrorCode===408&&u){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.V.c(h)&&i){_js.Trace.logInfo(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.Zh:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.a.cg,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.a.cg,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_js.Trace.logInfo(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.a(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.bX("MailComposeActionFailed",n)}};_mcp.a=function(){this.eT=Function.createDelegate(this,this.ga);this.v=this.t;this.bV=this.I;this.cC=this.K;this.cD=this.bY;this.dZ=this.e;this.dY=this.x;_mcp.a.initializeBase(this);this.m("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.a.c.a,this.eT);this.apcl(_mcp.a.i.a,this.eT);if(_a.j.a&&_a.j.d()){this.dQ(_g.a.a().a().bh.SmimeEncrypt);this.dS(_g.a.a().a().bh.SmimeSign)}this.eD=-1;this.ev={};this.es={}};_mcp.a.$$cctor=function(){_mcp.a.m.b(new _a.bs(_g.d));_mcp.a.g.b(new _a.bs(_g.d));_mcp.a.f.b(new _a.bs(_g.d));_mcp.a.l.b(new _a.bs(_pc.a));_mcp.a.e.b(new _a.bs(_g.Attachment));_mcp.a.h.b(new _a.bs(_g.bw))};_mcp.a.bX=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.d.a(u)?r:_js.l.a(n,u)};_mcp.a.bU=function(n,t,i){var u=new(_a.fJ.$$(n));if(t)for(var e=Object.keys(t),r=0;r<e.length;r++){var f=t[e[r]];u.G(f,i)<0&&u.c(f)}return u};_mcp.a.bW=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.d.a(r)?i:Boolean.parse(r)};_mcp.a.bV=function(n){return!_js.d.b(_mcp.a.a)&&!_js.d.b(n)&&(_mcp.a.a===n||_mcp.a.a.toLowerCase()===n.toLowerCase())};_mcp.a.b=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.b();u++){r.val+=_g.p.g(t.c(u));u!==t.b()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.a.cb=function(n){return n.replace(_mcp.a.bY,"\r\n")};_mcp.a.prototype={fh:null,er:null,eB:!1,eS:null,cE:function(n){this.ef("OnAsyncSendCallbackEvent",n)},dd:function(n){this.eg("OnAsyncSendCallbackEvent",n)},eM:!1,cL:function(){return this.eM},cq:function(n){this.eM=n;return n},fs:!1,b:function(){return this.ec(_mcp.a.bQ)},fq:function(n){this.eb(_mcp.a.bQ,n);return n},a:function(){return this.ec(_mcp.a.c)},f:function(n){this.eb(_mcp.a.c,n);return n},l:function(){return this.ec(_mcp.a.j)},o:function(n){this.eb(_mcp.a.j,n);return n},be:function(){return this.ec(_mcp.a.bn)},cu:function(n){this.eb(_mcp.a.bn,n);return n},cP:function(){return this.ec(_mcp.a.bm)},dH:function(n){this.eb(_mcp.a.bm,n);return n},d:function(){this.er||(this.er=this.ec(_mcp.a.bo));return this.er},dI:function(n){this.er=n;this.eb(_mcp.a.bo,this.er);return n},h:function(){return this.ec(_mcp.a.D)},F:function(n){if($a(this.h())||!n)this.eb(_mcp.a.D,n);else{this.h().Id=n.Id;this.h().ChangeKey=n.ChangeKey}return n},by:function(){return!!this.h()},W:function(){return!this.fF()},gh:function(){return this.ec(_mcp.a.bK)},gy:function(n){this.eb(_mcp.a.bK,n);return n},t:function(){return this.ec(_mcp.a.bL)},I:function(n){this.eb(_mcp.a.bL,n);return n},K:function(){return this.ec(_mcp.a.G)},G:function(n){this.eb(_mcp.a.G,n);return n},u:function(){return this.ec(_mcp.a.by)},cv:function(n){this.eb(_mcp.a.by,n);return n},cI:function(){return this.ec(_mcp.a.F)},co:function(n){this.eb(_mcp.a.F,n);return n},et:null,bY:function(){return this.et},dq:function(n){this.et=n;return n},e:function(){return this.ec(_mcp.a.r)},m:function(n){this.eb(_mcp.a.r,n);return n},i:function(){return this.ec(_mcp.a.m)},r:function(n){this.eb(_mcp.a.m,n);return n},bE:function(){return this.ec(_mcp.a.l)},dT:function(n){this.eb(_mcp.a.l,n);return n},bg:function(){return this.ec(_mcp.a.bM)},cx:function(n){this.eb(_mcp.a.bM,n);return n},n:function(){return this.ec(_mcp.a.g)},bi:function(n){this.eb(_mcp.a.g,n);return n},Y:function(){return this.ec(_mcp.a.s)},dh:function(n){this.eb(_mcp.a.s,n);return n},c:function(){return this.ec(_mcp.a.f)},cm:function(n){this.eb(_mcp.a.f,n);return n},J:function(){return this.ec(_mcp.a.q)},dg:function(n){this.eb(_mcp.a.q,n);return n},cT:function(){return this.ec(_mcp.a.k)},j:function(n){this.eb(_mcp.a.k,n);return n},ba:function(){return this.ec(_mcp.a.Q)},dt:function(n){this.eb(_mcp.a.Q,n);return n},cR:function(){return this.ec(_mcp.a.bv)},eL:function(n){this.eb(_mcp.a.bv,n);return n},gg:function(){return this.ec(_mcp.a.bD)},gx:function(n){this.eb(_mcp.a.bD,n);return n},bD:function(){return this.ec(_mcp.a.bF)},cw:function(n){this.eb(_mcp.a.bF,n);return n},fC:function(){return this.ec(_mcp.a.bG)},dR:function(n){this.eb(_mcp.a.bG,n);return n},eY:function(){return this.ec(_mcp.a.n)},df:function(n){this.eb(_mcp.a.n,n);return n},eH:0,P:function(){return this.eH},bM:function(n){this.eH=n;return n},eu:null,bu:function(){return this.eu},bH:function(n){this.eu=n;return n},ew:0,cU:function(){return this.ew},H:function(n){this.ew=n;return n},fb:function(){return this.ec(_mcp.a.V)},eC:function(n){this.eb(_mcp.a.V,n);return n},bm:function(){return this.ec(_mcp.a.i)},fn:function(n){this.eb(_mcp.a.i,n);return n},bx:function(){return this.ec(_mcp.a.Z)},fo:function(n){this.eb(_mcp.a.Z,n);return n},cM:function(){return this.ec(_mcp.a.bh)},fP:function(n){this.eb(_mcp.a.bh,n);return n},cO:function(){return this.ec(_mcp.a.bl)},fQ:function(n){this.eb(_mcp.a.bl,n);return n},ca:function(){return this.ec(_mcp.a.M)},fL:function(n){this.eb(_mcp.a.M,n);return n},k:function(){return this.ec(_mcp.a.J)},cp:function(n){this.eb(_mcp.a.J,n);return n},bp:function(){return this.ec(_mcp.a.bz)},dN:function(n){this.eb(_mcp.a.bz,n);return n},g:function(){return this.ec(_mcp.a.bk)},cs:function(n){this.eb(_mcp.a.bk,n);return n},cS:function(){return this.ec(_mcp.a.bC)},gw:function(n){this.eb(_mcp.a.bC,n);return n},M:function(){return this.ec(_mcp.a.X)},dy:function(n){this.eb(_mcp.a.X,n);return n},cd:function(){return this.ec(_mcp.a.T)},eR:function(n){this.eb(_mcp.a.T,n);return n},Q:function(){return this.ec(_mcp.a.S)},bN:function(n){this.eb(_mcp.a.S,n);return n},ci:function(){return this.ec(_mcp.a.br)},dK:function(n){this.eb(_mcp.a.br,n);return n},bB:function(){return this.ec(_mcp.a.bq)},dJ:function(n){this.eb(_mcp.a.bq,n);return n},fd:function(){return this.ec(_mcp.a.bd)},dB:function(n){this.eb(_mcp.a.bd,n);return n},cf:function(){return this.ec(_mcp.a.bb)},cr:function(n){this.eb(_mcp.a.bb,n);return n},cJ:function(){return this.ec(_mcp.a.I)},dn:function(n){this.eb(_mcp.a.I,n);return n},gc:function(){return this.ec(_mcp.a.R)},du:function(n){this.eb(_mcp.a.R,n);return n},bZ:function(){return this.ec(_mcp.a.L)},fl:function(n){this.eb(_mcp.a.L,n);return n},bF:function(){return this.ec(_mcp.a.bN)},cy:function(n){this.eb(_mcp.a.bN,n);return n},bh:function(){return this.ec(_mcp.a.bO)},gz:function(n){this.eb(_mcp.a.bO,n);return n},bn:function(){return this.ec(_mcp.a.bi)},dD:function(n){this.eb(_mcp.a.bi,n);return n},Z:function(){return this.ec(_mcp.a.E)},dl:function(n){this.eb(_mcp.a.E,n);return n},X:function(){return this.ec(_mcp.a.o)},gt:function(n){this.eb(_mcp.a.o,n);return n},bk:function(){return this.ec(_mcp.a.K)},dr:function(n){this.eb(_mcp.a.K,n);return n},x:function(){return this.ec(_mcp.a.e)},bq:function(n){var i=null;if(n){i=new _js.f;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.eb(_mcp.a.e,i);this.fW();return n},D:function(){return this.ec(_mcp.a.bP)},dU:function(n){this.eb(_mcp.a.bP,n);return n},en:function(){return this.ec(_mcp.a.p)},eK:function(n){this.eb(_mcp.a.p,n);return n},ep:null,eI:!1,bl:function(){return this.eI},dv:function(n){this.eI=n;return n},y:function(){return this.ec(_mcp.a.bx)},bQ:function(n){if(n!==this.y()){this.eb(_mcp.a.bx,n);this.ee("IsCopyRestricted","IsPrintRestricted")}return n},p:function(){return this.ec(_mcp.a.x)},bL:function(n){this.eb(_mcp.a.x,n);return n},ft:!1,dP:function(n){this.ft=n;return n},R:function(){return this.eB},dx:function(n){if(this.eB!==n){this.eB=n;n&&!this.en()&&this.fA();this.ea("IsEditorInitialized")}return n},eU:null,dm:function(n){this.eU=n;return n},eV:!1,dF:function(n){this.eV=n;return n},ce:function(){return this.ec(_mcp.a.Y)},fm:function(n){this.eb(_mcp.a.Y,n);return n},cY:function(){return this.ec(_mcp.a.bR)},ey:function(n){this.eb(_mcp.a.bR,n);return n},cc:function(){return this.ec(_mcp.a.O)},fN:function(n){this.eb(_mcp.a.O,n);return n},fc:function(){return this.ec(_mcp.a.ba)},dz:function(n){this.eb(_mcp.a.ba,n);return n},ck:function(){return this.ec(_mcp.a.bS)},fr:function(n){this.eb(_mcp.a.bS,n);return n},ge:function(){return!!this.y()&&!this.y().a()&&!this.y().i()&&!this.y().b()},bC:function(){return this.bm()&&_mcp.f.g(this)},gd:function(){return!!this.y()&&0===this.y().a()&&!this.y().f()&&!this.y().b()},V:function(){return null},bR:function(){return this.t()},bs:function(){return this.fh},bw:function(){return this.ec(_mcp.a.U)},bO:function(n){this.eb(_mcp.a.U,n);return n},eZ:function(){return this.ec(_mcp.a.u)},bK:function(n){this.eb(_mcp.a.u,n);return n},bX:function(){return this.ec(_mcp.a.C)},dk:function(n){this.eb(_mcp.a.C,n);return n},bW:function(){return this.ec(_mcp.a.B)},dj:function(n){this.eb(_mcp.a.B,n);return n},gb:function(){return this.ec(_mcp.a.A)},di:function(n){this.eb(_mcp.a.A,n);return n},cF:function(){return this.ec(_mcp.a.w)},bI:function(n){this.eb(_mcp.a.w,n);return n},cG:function(){return this.ec(_mcp.a.t)},bJ:function(n){this.eb(_mcp.a.t,n);return n},fB:function(){return this.ec(_mcp.a.v)},fH:function(n){this.eb(_mcp.a.v,n);return n},z:function(){return this.ec(_mcp.a.bB)},dO:function(n){this.eb(_mcp.a.bB,n);return n},bb:function(){return this.ec(_mcp.a.W)},dw:function(n){this.eb(_mcp.a.W,n);return n},bd:function(){return this.ec(_mcp.a.bf)},dC:function(n){this.eb(_mcp.a.bf,n);return n},gi:function(){return this.A()},ff:function(){return this.ec(_mcp.a.bH)},fS:function(n){this.eb(_mcp.a.bH,n);return n},A:function(){return _a.j.a&&(this.q()||this.C())},q:function(){if(!_a.j.a||!_a.j.i()||!this.dc()||_g.a.a().a().bh.AlwaysShowFrom)return!1;var n=_g.a.a().bh.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.ec(_mcp.a.bE)},dQ:function(n){this.eb(_mcp.a.bE,n);this.ea(_mcp.a.d);_js.Trace.logInfo(_a.a.j,"Context.SmimeEncryptMessage is set to {0}",n);return n},C:function(){if(!_a.j.a||!_a.j.i()||!this.dc()||_g.a.a().a().bh.AlwaysShowFrom)return!1;var n=_g.a.a().bh.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.ec(_mcp.a.bI)},dS:function(n){this.eb(_mcp.a.bI,n);this.ea(_mcp.a.d);_js.Trace.logInfo(_a.a.j,"Context.SmimeSignMessage is set to {0}",n);return n},cW:function(){return _g.a.a().bh.SmimeAdminSettings&&(_g.a.a().bh.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bh.AlwaysShowFrom)||this.M()?!1:!0},cX:function(){return _g.a.a().bh.SmimeAdminSettings&&(_g.a.a().bh.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bh.AlwaysShowFrom)||this.M()?!1:!0},eD:0,bj:function(){return this.ec(_mcp.a.y)},fj:function(n){this.eb(_mcp.a.y,n);return n},cQ:function(){return this.ec(_mcp.a.bp)},fp:function(n){this.eb(_mcp.a.bp,n);return n},cg:function(){if(this.bm()||_y.c.a.h()||this.A())return!1;var n=this.y();return!n||!!n.a()||n.b()},bz:function(){return OwaApplication.b?!1:this.a()!==8&&!this.N()},ex:function(){return this.ec(_mcp.a.be)},gu:function(n){this.eb(_mcp.a.be,n);return n},eN:!1,fu:!1,bf:function(){return this.fu},N:function(){return this.a()===11||this.a()===12||this.a()===13},cH:function(){return this.ec(_mcp.a.bt)},E:function(n){this.eb(_mcp.a.bt,n);return n},eQ:function(){return this.ec(_mcp.a.bs)},T:function(n){this.eb(_mcp.a.bs,n);return n},gj:function(){return this.ec(_mcp.a.bT)},U:function(n){this.eb(_mcp.a.bT,n);return n},dM:function(n){this.eb(_mcp.a.bZ,n);return n},cK:function(){return this.ec(_mcp.a.P)},ds:function(n){this.eb(_mcp.a.P,n);return n},L:function(){return this.ec(_mcp.a.h)},dp:function(n){this.eb(_mcp.a.h,n);return n},S:function(){return this.ec(_mcp.a.bc)},dA:function(n){this.eb(_mcp.a.bc,n);return n},cN:function(){return this.ec(_mcp.a.bj)},dE:function(n){this.eb(_mcp.a.bj,n);return n},cb:function(){return this.ec(_mcp.a.N)},fM:function(n){this.eb(_mcp.a.N,n);return n},gf:function(){return this.ec(_mcp.a.bA)},gv:function(n){this.eb(_mcp.a.bA,n);return n},cV:function(){this.eS||(this.eS=this.eJ());return this.eS},cA:function(){return this.ec(_mcp.a.bu)},bS:function(n){this.eb(_mcp.a.bu,n);return n},bv:function(){return this.ec(_mcp.a.z)},cn:function(n){this.eb(_mcp.a.z,n);return n},bc:function(){if(!$a(this.L())){var n=_g.c.a(this.L().f(),_g.c.c());return!!n&&n.bh.Value.toUpperCase()==="TRUE"}return!1},bP:function(n){_js.Trace.logInfo(_a.a.a,"Setting IsOmeRequested to {0}",n);this.gC(n);return n},bA:function(){if($a(this.L()))return null;var n=_g.c.a(this.L().f(),_g.c.b());if(n&&n.bh.Value){var i=n.bh.Value;var t=_a.c.b(i);t||_js.Trace.logError(_a.a.X,"Attempt to get OME expiration time but value in extended property cannot be parsed into a datetime object.  Value: {0}",i);return t}else return null},ct:function(n){_js.Trace.logInfo(_a.a.a,"Setting OmeTimeExpiration to {0}",n);this.gD(n?_a.c.bJ(n):"");return n},eE:null,ch:function(){return this.eE},dG:function(n){this.eE=n;return n},eF:null,dL:function(n){this.eF=n;return n},ev:null,bo:function(){return this.ev},fe:function(){return _mcp.a.bU(_g.d,this.ev,_zz.d.o)},es:null,cj:function(){return this.es},fa:function(){return _mcp.a.bU(String,this.es,_zz.d.p)},bU:function(){return this.ec(_mcp.a.bJ)},fT:function(n){this.eb(_mcp.a.bJ,n);return n},bT:function(){return this.ec(_mcp.a.H)},fI:function(n){this.eb(_mcp.a.H,n);return n},dX:function(){return this.ec(_mcp.a.bw)},fR:function(n){this.eb(_mcp.a.bw,n);return n},cB:function(){return this.ec(_mcp.a.bg)},fO:function(n){this.eb(_mcp.a.bg,n);return n},go:function(n){this.o(_mcp.a.bX(_y.dC,n,_mcp.a.j.a,0));this.f(_mcp.a.bX(_y.n,n,_mcp.a.c.a,0));this.j(_mcp.a.bW(n,_mcp.a.k.a,!0));this.dB(_mcp.a.bW(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.eC(!1);this.gy(n.StoreId)}this.gp(n);this.cs(0===this.a()||4===this.a())},da:function(n){_g.cN.isInstanceOfType(n)?this.f(1):_g.cM.isInstanceOfType(n)?this.f(2):_g.dh.isInstanceOfType(n)&&this.f(3);this.fX(n,n.f());this.cu(n.bh.ReferenceItemId);this.dH(n.q());this.F(n.bh.ItemId);this.I(n.bh.Subject);this.G(n.f().bh.Value);this.cp(n.bh.From);this.r(n.k()?n.k().e:null);this.bi(n.m()?n.m().e:null);this.cm(n.o()?n.o().e:null);this.j(!1);this.dt(n.bx());this.eO(n);this.bQ(n.bu());this.dO(n.bF());this.dw(n.bh.IsDeliveryReceiptRequested);this.dC(n.bh.IsReadReceiptRequested);this.y()&&!this.y().a()?this.m(this.y().e()):$a(n.f())||(n.bM()?this.m(n.bM().a()):this.m(n.cM()===1?"Text":"HTML"));this.fE(n);this.cs(!1);this.eC(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with smart response, context: {0}",this)},cZ:function(n){if($a(n))throw Error.argumentNull("message");this.fX(n,n.C());this.dl(n);this.F(n.bh.ItemId);this.I(n.bh.Subject);this.G(n.bM()?n.bM().bh.Value:n.C().bh.Value);this.fj(n.bh.ConversationId);if(_g.o.isInstanceOfType(n)){var t=n;this.cp(t.bh.From);this.r(t.k()?t.k().w():null);this.bi(t.m()?t.m().w():null);this.cm(t.o()?t.o().w():null);this.dw(t.bh.IsDeliveryReceiptRequested);this.dC(t.bh.IsReadReceiptRequested);n.dN()&&this.fZ(n.dN())}else if(_g.bq.isInstanceOfType(n)){var u=n;this.cp(u.bh.From)}this.j(!1);this.dt(n.bx());this.eO(n);this.bQ(n.bu());this.dO(n.bF());n.bu()&&!n.bu().a()?this.m(n.bu().e()):n.bM()?this.m(n.bM().a()):this.m(n.cM()===1?"Text":"HTML");this.fn(_g.bh.isInstanceOfType(n));if(this.bm()){var i=n;this.eP(i.t());this.fo(_g.I.isInstanceOfType(i));i.bh.From&&this.cp(i.bh.From);i.bh.Sender&&this.dN(i.bh.Sender)}n.bL()&&n.bL().b()?this.bq(n.bL()?n.bL().e:null):(!this.ex()||this.g())&&this.bq(n.S()?n.S().e:null);if(this.x()&&n.C().a()==="Text")for(var r=0;r<this.x().b();r++)this.x().c(r)&&this.x().c(r).b()&&this.x().c(r).f(!1);this.fE(n);this.cs(!0);this.eC(!0);_js.Trace.logInfo(_a.a.a,"Initialized context with draft, context: {0}",this)},fZ:function(n){for(var r=0;r<n.b();r++){var t=null;var i=null;var e,f;_zz.d.s(n.a(r),e={val:t},f={val:i}),t=e.val,i=f.val;if(!_js.d.a(t)&&!_js.d.a(i))if(_zz.d.l(t))this.es[t]=i;else if(_zz.d.t(t))try{var u=JsonParser.deserialize(i);u&&(this.ev[t]=u)}catch(o){_js.Trace.logWarning(_a.a.bt,"Failed to deserialize tag from draft. TagId={0}, TagContent={1}. Error={2}.",t,i,o.toString())}}},O:function(n){this.dI(n);this.gl(n)},fD:function(){this.ej("OnAsyncSendCallbackEvent",this)},w:function(n){var i=new _g.o;var t;this.fU(i,t={val:n}),n=t.val;return i},bt:function(n){var i=new _g.bq;var t;this.fU(i,t={val:n}),n=t.val;return i},fx:function(){var t=this.fy();_a.b.b(this.et,"GetEditorContentCommand");this.et.a();var n=this.K();t.a()==="Text"&&(n=_mcp.a.cb(n));t.b(n);this.eD=_js.d.a(n)?0:n.length;_js.Trace.logInfo(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.eD);return t},gB:function(n){var t=this.en();if(!t||this.ba()===t.i()){this.dt(n);t&&t.A(n)}},fA:function(){if(this.eB&&this.eV){this.et.a();if($a(this.en())){this.eK(_mcp.b.b(this));_js.Trace.logInfo(_a.a.a,"Captured baseline for the first time, context: {0}",this);if(this.eN&&this.ep){this.ep.r(this.en().a());this.eN=!1}if(!this.h()||this.ex()&&this.cY()){this.ep=_mcp.b.b(this);_js.Trace.logInfo(_a.a.a,"Captured initial baseline for context: {0}",this)}}else{_mcp.b.z(this.en(),this);_js.Trace.logInfo(_a.a.a,"Updated baseline, context: {0}",this)}}},fF:function(){if($a(this.en()))return!1;this.et.a();return!this.en().t(this)},bG:function(n){var t=null;if(this.e()==="HTML"){var r,i;i=_a.u.a(this.K(),r={val:t}),t=r.val,i}else t=this.K();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},ez:function(n,t,i,r,u){this.r(new _js.f);var f=n?n.Mailbox:null;if(!_mcp.a.a){var h=_g.a.a().c();_mcp.a.a=_js.d.a(h.bh.SharePointUrl)?h.bh.UserEmailAddress||"":h.bh.LogonEmailAddress||""}if(this.gc()||this.a()!==8&&(!u||!u.b())&&f&&(2!==this.a()||!_mcp.a.bV(f.EmailAddress))){this.i().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.p.g(n),_mcp.a.a)}if(this.a()===2||this.a()===8){_js.Trace.logInfo(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.eW(t,this.i(),f,null);_js.Trace.logInfo(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.bi(new _js.f);this.eW(i,this.n(),f,this.i());_js.Trace.logInfo(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.cm(new _js.f);this.eW(r,this.c(),f,this.i())}if(u&&u.b()>0)if(this.a()===1){this.i().g();for(var s=0;s<u.b();s++){var l=u.c(s);this.i().a(l)}}else if(this.a()===2)for(var e=0;e<u.b();e++){var o=u.c(e);var a=this;if(this.i().b()===this.i().k(function(n){return _g.p.a(o,n)})){var v=this;var c=this.n().k(function(n){return _g.p.a(o,n)});c!==this.n().b()&&this.n().o(c);this.i().a(o)}}if(this.a()!==8&&f&&0===this.i().b()&&(!this.n()||0===this.n().b())){this.i().a(f);_js.Trace.logInfo(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.p.g(n))}this.fv()},toString:function(){var n="Id="+this.b()+"; Op="+this.a()+"; Mode="+this.l()+"; Oid=";n+=this.be()?this.be().Id+":"+this.be().ChangeKey+";":this.er&&this.er.bh.ItemId?this.er.bh.ItemId.Id+":"+this.er.bh.ItemId.ChangeKey+";":"null;";n+=" Did=";n+=this.h()?this.h().Id+":"+this.h().ChangeKey+";":this.Z()&&this.Z().bh.ItemId?this.Z().bh.ItemId.Id+":"+this.Z().bh.ItemId.ChangeKey+";":"null;";n+=" Subject="+this.t()+"; ContentLength="+(_js.d.a(this.K())?"0":this.K().length.toString())+"; BodyType="+this.e()+";";var u;_mcp.a.b("To",this.i(),this.bg(),u={val:n}),n=u.val;var f;_mcp.a.b("Cc",this.n(),this.Y(),f={val:n}),n=f.val;var r;_mcp.a.b("Bcc",this.c(),this.J(),r={val:n}),n=r.val;var t;_mcp.a.b("Metions",this.fe().w(),"",t={val:n}),n=t.val;var i;_mcp.a.b("Hashtags",this.fa().w(),"",i={val:n}),n=i.val;n+=" AutoSig="+this.cT()+"; Imp="+this.ba()+"; QuotedBodyLength="+(_js.d.a(this.cR())?"0":this.cR().length.toString())+"; IsComplete="+this.fb()+"; IsMeeting="+this.bm()+"; IsMeetingForward="+this.bx()+"; IsReplyBcc="+this.cM()+"; HasLocation="+this.ca()+"; MeetingTime="+(this.bm()?"null":this.cB()+":"+(this.bU()?this.bU().j():"null")+":"+(this.bT()?this.bT().j():"null"))+"; From="+_g.p.g(this.k())+"; Sender="+_g.p.g(this.bp())+"; IsFromShown="+this.M()+"; IsCcShown="+this.cd()+"; IsBccShown="+this.Q()+"; AttachmentCount="+(this.x()?this.x().b().toString():"0")+"; UpgradeFailed="+this.D()+"; HasBaseline="+(!!this.en()).toString()+"; HasInitBaseline="+(!!this.ep).toString()+"; UserSaved="+this.bZ()+"; IsReplyForward="+this.bn()+"; HasDraft="+(!!this.Z()).toString()+"; HasRMLD="+(!!this.y()).toString()+"; Classified="+this.bw()+"; Class="+this.cF()+"; Sensitivity="+this.z()+"; DeliveryReceipt="+this.bb()+"; ReadReceipt="+this.bd()+"; SmimeEncryptMessage="+this.q()+"; SmimeSignMessage="+this.C()+"; ConversationId="+(this.bj()?this.bj().Id+":"+this.bj().ChangeKey:"null")+" ParentConversationNodeId="+this.cQ()+"; IsOriCalId="+this.fd()+"; OccurrenceRefMaster="+this.cf()+"; IsLoadedDraft="+this.ce()+"; IsMovedToDraftFromOutbox="+this.fc()+"; IsUpgraded="+this.g()+"; IsCached="+this.fs+";";return n},de:function(){_js.Trace.logInfo(_a.a.a,"Context reset start.");this.fq(null);this.a()&&this.f(0);this.l()&&this.o(0);this.be()&&this.cu(null);this.d()&&this.dI(null);this.h()&&this.F(null);_js.d.a(this.t())||this.I(null);_js.d.a(this.K())||this.G("");this.i()&&this.r(null);_js.d.a(this.bg())||this.cx(null);this.n()&&this.bi(null);_js.d.a(this.Y())||this.dh(null);this.c()&&this.cm(null);_js.d.a(this.J())||this.dg(null);this.cT()||this.j(!0);this.ba()!=="Normal"&&this.dt("Normal");_js.d.a(this.cR())||this.eL(null);this.fb()&&this.eC(!1);this.bm()&&this.fn(!1);this.bx()&&this.fo(!1);this.cM()&&this.fP(!1);this.cO()&&this.fQ(null);this.ca()&&this.fL(!1);this.bU()&&this.fT(null);this.bT()&&this.fI(null);this.dX()&&this.fR(null);this.cB()&&this.fO(!1);this.k()&&this.cp(null);this.bp()&&this.dN(null);this.g()&&this.cs(!1);this.M()&&this.dy(!1);this.cd()&&this.eR(!1);this.Q()&&this.bN(!1);this.x()&&this.bq(null);this.D()&&this.dU(!1);this.en()&&this.eK(null);this.bZ()&&this.fl(!1);this.bn()&&this.dD(!1);this.Z()&&this.dl(null);this.y()&&this.bQ(null);_js.d.a(this.p())||this.bL(null);this.bw()&&this.bO(!1);_js.d.a(this.eZ())||this.bK(null);_js.d.a(this.cF())||this.bI(null);_js.d.a(this.cG())||this.bJ(null);this.fB()&&this.fH(!1);this.z()!=="Normal"&&this.dO("Normal");this.bb()&&this.dw(!1);this.bd()&&this.dC(!1);this.q()&&this.dQ(!1);this.C()&&this.dS(!1);this.fC()&&this.dR(null);this.bj()&&this.fj(null);_js.d.a(this.cQ())||this.fp(null);this.fd()&&this.dB(!1);this.cf()&&this.cr(!1);this.ce()&&this.fm(!1);this.fc()&&this.dz(!1);this.L()&&this.dp(null);if(this.cH()){_y.i.a(this.cH(),null,"ContextReset",null,null);this.E(null)}_js.Trace.logInfo(_a.a.a,"Context reset end.")},db:function(){return!!this.d().bu()&&0===this.d().bu().a()&&!this.d().bu().k()&&!this.d().bu().m()},cl:function(){var n=null;if(this.k()&&this.k().Mailbox&&!_js.d.a(this.k().Mailbox.EmailAddress))n=this.k().Mailbox;else if(this.bp()&&this.bp().Mailbox&&!_js.d.a(this.bp().Mailbox.EmailAddress))n=this.bp().Mailbox;else if(!_js.d.a(_mcp.a.a)){n=new _g.d;n.EmailAddress=_mcp.a.a;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},dc:function(){if(!_a.j.a||_a.j.q)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.Z()&&!this.fg(this.Z())?!1:this.d()&&!this.fg(this.d())?!1:_js.d.a(this.bv())?!0:!1},fg:function(n){if(_js.d.a(n.bh.ItemClass)||n.bh.ItemClass==="IPM.Note"||n.bw())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bh.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bh.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bh.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bh.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bh.ItemClass==="IPM.Post"?!0:!1}},cz:function(n){_js.Trace.logInfo(_a.a.j,"Updating S/MIME options...");if(_a.j.a)switch(n){case 6:this.dQ(!0);this.dS(!1);break;case 10:case 11:this.dQ(!1);this.dS(!0);break;case 12:case 13:case 14:this.dQ(!0);this.dS(!0);break;case-1:case 0:default:this.dQ(!1);this.dS(!1);break}},gE:function(n){_js.Trace.logInfo(_a.a.j,"Upgrading S/MIME options...");if(_a.j.a)switch(n){case 6:this.dQ(!0);break;case 10:case 11:this.dS(!0);break;case 12:case 13:case 14:this.dQ(!0);this.dS(!0);break;case-1:case 0:default:break}},br:function(){if(this.cH()){var t=!1;var n=this;this.fh=function(i){if(!t&&n.cH()){_y.i.a(n.cH(),null,i);n.E(null);t=!0}}}},eJ:function(n,t){var i=this.fC();if(!i||!i.length)return null;$a(n)&&(n=0);$a(t)&&(t=i.length);for(var r=new _ff.d,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.d.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.d.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},fU:function(n,t){t.val=$a(t.val)?!1:t.val;n.bV(this.t());n.dC(this.ba());n.bG(this.h());n.Y(new(_a.fK.$$(_g.Attachment,_g.bz)));if(this.A()){var o=_g.a.a().bh.SmimeAdminSettings.ClearSign;n.eV(this.q()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bh.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.cr(this.fw(t.val)):n.cr(new _g.B(new _g.D(this.e(),"")));var e=_a.be.b(this.gg());n.hf(new _g.fy(e))}else{n.cr(this.fw(t.val));(this.Z()&&this.Z().bw()||this.d()&&this.d().bw())&&n.eV("IPM.Note");this.x()&&n.S().g(this.x().f())}n.iW(this.y());n.cQ(this.z());n.fr(this.bw());n.fm(this.cF());n.fn(this.cG());n.fo(this.eZ());n.gV(this.bX());n.gU(this.bW());n.gT(this.gb());if(this.L()){n.gg(new(_a.fK.$$(_g.bw,_g.bk)));n.bC().g(this.L().f())}if(_g.o.isInstanceOfType(n)){var i=n;i.cR(this.k());_zz.d.g(i.C().bh.Value,i.bh.Subject,this.ev);_zz.d.h(i.C().bh.Value,i.bh.Subject,this.es);_zz.d.f(i,!!this.h(),this.ev,this.fe(),this.es,this.fa());if(this.A()&&this.ew){if(this.ew===1){i.cp(new(_a.fJ.$$(_g.d)));this.i()&&i.k().g(this.i().f());i.cA(new(_a.fJ.$$(_g.d)));this.n()&&i.m().g(this.n().f())}else if(this.ew===2){i.cH(new(_a.fJ.$$(_g.d)));this.c()&&i.o().c(this.c().c(this.eH))}else if(this.ew===3){i.cH(new(_a.fJ.$$(_g.d)));this.c()&&i.o().g(this.c().f())}}else{i.cp(new(_a.fJ.$$(_g.d)));this.i()&&i.k().g(this.i().f());i.cA(new(_a.fJ.$$(_g.d)));this.n()&&i.m().g(this.n().f());i.cH(new(_a.fJ.$$(_g.d)));this.c()&&i.o().g(this.c().f())}i.cS(this.bb());i.cT(this.bd());i.fE(this.q());i.fF(this.C())}else{var u=n;u.cd(this.bB());var f=_g.a.a().c();var r=null;r=_js.d.a(f.bh.LogonEmailAddress)?null!==this.k()&&this.k().Mailbox?this.k().Mailbox.EmailAddress:_h.j.f(null)||f.bh.UserEmailAddress:f.bh.LogonEmailAddress;if(r){u.g(new _g.bg);u.bh.From.Mailbox=new _g.d;u.bh.From.Mailbox.EmailAddress=r}}},eW:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.p.a(u,i)){_js.Trace.logInfo(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.a.bV(u.EmailAddress)||this.gq(u.EmailAddress)){_js.Trace.logInfo(_a.a.a,"Excluding self address {0}",_mcp.a.a||"null");continue}var e=this;if(r&&r.b()!==r.k(function(n){return _g.p.a(u,n)})){_js.Trace.logInfo(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},gq:function(n){var t=this.k();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},ga:function(n,t){this.ea("ShowMeetingReadonlyFields")},gp:function(n){var t=this.gr(n);switch(this.a()){case 0:case 4:this.F(t);break;case 1:case 2:case 3:this.cu(t);break}},fE:function(n){if(n.bC()){this.dp(new _js.f);this.L().n(n.bC().f())}},gr:function(n){var t=null;if(!$a(n)&&"Id"in n){t=new _g.g(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},fX:function(n,t){0===n.cM()&&n.gl(t&&t.a()==="Text"?1:3)},gn:function(n){var r=_h.j.f(n);if(r){this.cp(new _g.bg);this.k().Mailbox=new _g.d;this.k().Mailbox.EmailAddress=r}this.dB(!1);this.y()&&!this.y().a()?this.m(n.bu().e()):n.bM()?this.m(n.bM().a()):n.C()&&this.m(n.C().a());switch(this.a()){case 1:case 2:case 12:this.eO(n);if(_g.o.isInstanceOfType(n)){var t=n;t.r()?this.ez(t.bh.From||t.bh.Sender,null,null,null,null):this.ez(t.bh.From||t.bh.Sender,t.k()?t.k().e:null,t.m()?t.m().e:null,t.o()?t.o().e:null,t.ev()?t.ev().e:null);this.fP(this.a()===2&&n.is()&&!t.bh.IsGroupEscalationMessage);this.dH(n.eQ())}else if(_g.bq.isInstanceOfType(n)){var i=n;this.ez(i.bh.From||i.bh.Sender,null,null,null,null)}this.fi(n);break;case 3:_g.bh.isInstanceOfType(n)||this.eO(n);this.dH(n.eQ());this.fv();this.fi(n);this.gs(n);break;case 9:case 10:_g.o.isInstanceOfType(n)?this.ez(n.bh.Sender,null,null,null,null):_g.bq.isInstanceOfType(n)&&this.ez(n.bh.Sender,null,null,null,null);this.fi(n);break;case 5:case 6:case 7:default:this.fV();break}_js.Trace.logInfo(_a.a.a,"Initialized context with original email message, context: {0}",this)},gl:function(n){this.cu(n.bh.ItemId);var i=this.db();this.bQ(i?null:n.bu());this.gA(n.cN());this.dO(n.bF());this.G(this.K()||"");this.y()&&!this.y().a()?this.m(this.y().e()):n.bM()?this.m(n.bM().a()):this.m(n.cM()===1?"Text":"HTML");if(!this.g()){this.cs(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.j.a&&n.bw()||i||this.y()&&this.y().a()||this.bq(n.S()?n.S().e:null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.bc();this.gm(t)}else if(_g.o.isInstanceOfType(n)||_g.bq.isInstanceOfType(n)){if(3===this.a()&&!this.g()){this.dt(n.bx());_js.Trace.logInfo(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.ba(),_h.bh.a(n.bh.ItemId))}this.gn(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.fW();_g.o.isInstanceOfType(n)&&n.bQ?this.eC(!1):this.eC(!0)},gk:function(n){var t=null;_g.bs.isInstanceOfType(n)||_g.Y.isInstanceOfType(n)?t=n.bh.From:n.E()?t=n.E():_js.Trace.logError(_a.a.a,"ICalendaring doesnt have an organizer");return t},fW:function(){var n=new _ff.d;this.bx()&&n.i(_g.I.a(this.x()));if(this.er&&_a.j.a&&this.er.bw()&&this.er.ez()){var t=this.er.S().a(0).bh.AttachmentId.Id;n.c(t)}this.gt(n.h())},gm:function(n){this.dB(!0);n.C()&&this.m(n.C().a());var r=this.gk(n);var t;var i;if(_g.bs.isInstanceOfType(n)||_g.Y.isInstanceOfType(n)){t=n.k()?_g.p.f(n.k().e):null;i=n.m()?_g.p.f(n.m().e):null}else{t=n.q()?_g.p.f(_g.t.d(n.q().e)):null;i=n.v()?_g.p.f(_g.t.d(n.v().e)):null}switch(this.a()){case 1:case 2:this.ez(r,t,i,null,null);break;case 5:case 6:case 7:this.ez(r,t,i,null,null);this.eP(n);this.fN(!0);break;case 8:var u=n.q().t();u.g(n.G().f());t=_g.p.f(_g.t.d(u.e));this.ez(r,t,i,null,null);this.eP(n);this.fN(!0);break;case 3:if(_g.I.isInstanceOfType(n)||_g.i.isInstanceOfType(n)){this.fo(!0);this.cp(r);this.eP(n)}break;default:this.fV();break}this.fn(!0);_js.Trace.logInfo(_a.a.a,"Initialized context from original calendar item, context: {0}",this)},eP:function(n){this.fY(n);this.fQ(n.u());this.fL(!!this.cO()&&!_js.d.a(this.cO().bh.DisplayName))},gA:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.R.KG;break;case 3:t=_nbs.a.QD;break;case 5:t=_nbs.a.Tu;break;case 6:t=_nbs.a.ea;break;case 7:t=_nbs.a.cO;break;case 8:t=_nbs.a.RI;break;case 9:t=_nbs.a.kP;break;case 10:t=_nbs.a.MZ;break}var i=String.format(_nbs.a.gG,t,n);_js.Trace.logInfo(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.I(i.substr(0,255));_js.Trace.logInfo(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.t(),255)}else this.I(i)},fi:function(n){this.fj(n.bh.ConversationId);_g.o.isInstanceOfType(n)?this.fp(n.bh.InternetMessageId):_g.bq.isInstanceOfType(n)&&this.fp(n.bh.InternetMessageId)},fV:function(){var n=_js.l.b(_y.n,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},eO:function(n){this.bO(n.dM());this.bK(n.eP());this.bI(n.eN());this.bJ(n.eO());this.fH(n.il())},fw:function(n){return n?this.fy():this.fx()},fy:function(){var n=new _g.B(new _g.D("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.cK()){_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.e());n.c(this.e())}else{_js.Trace.logInfo(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},fv:function(){if(_y.c.a.h()){var n=this.cl();if(n){if(!this.fG(this.i(),n.EmailAddress)&&!this.fG(this.n(),n.EmailAddress)){this.n()||this.bi(new _js.f);this.n().a(n);_js.Trace.logInfo(_a.a.a,"Adding self to CC")}}else _js.Trace.logError(_a.a.a,"Could not add self to CC as the address was missing")}},fG:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},gC:function(n){var t=null;if(n){$a(this.L())?this.dp(new _js.f):t=_g.c.a(this.L().f(),_g.c.c());if($a(t)){var i=new _g.bk;i.ExtendedFieldURI=_g.c.c();t=new _g.bw(i);this.L().a(t)}t.c("True")}else{if($a(this.L()))return;t=_g.c.a(this.L().f(),_g.c.c());$a(t)||t.c("False")}},fY:function(n){this.fT(n.c());this.fI(n.f());this.fR(n.F());this.fO(n.J())},gD:function(n){var t=null;if(_js.d.a(n)){if($a(this.L()))return;t=_g.c.a(this.L().f(),_g.c.b());if(!$a(t)){t.c(undefined);this.L().m(t,!0)}}else{$a(this.L())?this.dp(new _js.f):t=_g.c.a(this.L().f(),_g.c.b());if($a(t)){var i=new _g.bk;i.ExtendedFieldURI=_g.c.b();t=new _g.bw(i);this.L().a(t)}t.c(n)}},gs:function(n){if(OwaApplication.b){var t=n.bC()?_g.c.a(n.bC().f(),_g.c.b()):null;t&&this.ct(_a.c.b(t.bh.Value))}}};_mcp.D=function(n){this.e={};this.f=n};_mcp.D.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.O(t))}else this.e[n]=new _mcp.O(t)},g:function(n,t){var u=n.a;var i=u.N;var r=i.b();var o=i.h();var f=!1;if(i.ce())_js.Trace.logInfo(_a.a.a,"Not discarding a loaded draft for context {0}",r);else if(i.bZ())_js.Trace.logInfo(_a.a.a,"Not discarding an explicitly saved draft for context {0}",r);else if(u.d().e())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",r);else if(u.e().b())_js.Trace.logInfo(_a.a.a,"Not discarding a draft currently being sent for context {0}",r);else{var e=!1;if(t)_js.Trace.logInfo(_a.a.a,"Skipping dirty check for context {0}",r);else{_js.Trace.logInfo(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away. Context:{0}",i);e=u.bt()}if(e)_js.Trace.logInfo(_a.a.a,"Not discarding a dirty draft for context {0}",r);else if(i.ep)if(i.ep.s(i.en())){if(_g.j.b&&i.bn()&&!i.h()){_js.Trace.logInfo(_a.a.a,"Calling main window to remember the pending discard for context {0}",r);_g.j.b.ii(r,!i.bZ());f=!0}else if(!i.N()){_js.Trace.logInfo(_a.a.a,"Discarding unused draft for context {0}",r);this.b(r,o,u.X,i.bZ());f=!0}}else _js.Trace.logInfo(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",r);else _js.Trace.logInfo(_a.a.a,"Not discarding without an initial baseline for context {0}",r)}return f},b:function(n,t,i,r){i||(i=new _mcp.L(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_js.Trace.logInfo(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.O(u);_js.Trace.logInfo(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.L(new _bc.b),!1)}};_mcp.b=function(){_mcp.b.initializeBase(this)};_mcp.b.$$cctor=function(){_mcp.b.h.b(_mcp.b.f);_mcp.b.e.b(_mcp.b.f);_mcp.b.d.b(_mcp.b.f);_mcp.b.c.b(new _a.bs(_g.Attachment));_mcp.b.g.b(new _a.bs(_g.bw))};_mcp.b.b=function(n){var t=new _mcp.b;_mcp.b.z(t,n);return t};_mcp.b.z=function(n,t){n.K(t.v());n.r(t.K());if(t.i()){n.B(new _js.f);n.e().n(t.i().f())}else n.B(null);n.L(t.bg());if(t.n()){n.x(new _js.f);n.d().n(t.n().f())}else n.x(null);n.D(t.Y());if(t.c()){n.w(new _js.f);n.c().n(t.c().f())}else n.w(null);if(t.x()){n.p(new _js.f);n.b().n(t.x().f())}else n.p(null);if(t.L()){n.y(new _js.f);n.q().n(t.L().f())}else n.y(null);n.C(t.J());n.A(t.ba());n.z(t.k());n.E(t.p());n.H(t.z());n.F(t.bb());n.G(t.bd());n.I(t.q());n.J(t.C())};_mcp.b.a=function(n,t,i,r){if(i!==r&&!(_js.d.a(i)&&_js.d.a(r))||!_mcp.b.x(n,t))return!1;if($a(n)||$a(t))return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.b.i(e,f))return!1}return!0};_mcp.b.i=function(n,t){return $a(n)&&!$a(t)||$a(t)&&!$a(n)?!1:$a(n)&&$a(t)?!0:_g.p.a(n,t)};_mcp.b.x=function(n,t){var r=_mcp.b.y(n);var i=_mcp.b.y(t);return r===i};_mcp.b.y=function(n){return $a(n)?0:n.b()};_mcp.b.w=function(n,t){if(!_mcp.b.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.b.B(u,r))return!1}return!0};_mcp.b.A=function(n,t){return _h.cJ.a(n,t)};_mcp.b.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bh.AttachmentId&&t.bh.AttachmentId||!t.bh.AttachmentId&&n.bh.AttachmentId?!1:n.bh.AttachmentId&&n.bh.AttachmentId.Id!==t.bh.AttachmentId.Id?!1:n.bh.Name!==t.bh.Name?!1:n.bh.ContentType!==t.bh.ContentType?!1:n.bh.ContentId!==t.bh.ContentId?!1:n.bh.ContentLocation!==t.bh.ContentLocation?!1:n.a()!==t.a()?!1:!n.o()&&t.o()||!t.o()&&n.o()?!1:n.o()&&!n.o().w(t.o())?!1:n.b()!==t.b()?!1:!0};_mcp.b.prototype={f:function(){return this.ec(_mcp.b.u)},K:function(n){this.eb(_mcp.b.u,n);return n},a:function(){return this.ec(_mcp.b.m)},r:function(n){this.eb(_mcp.b.m,n);return n},e:function(){return this.ec(_mcp.b.h)},B:function(n){this.eb(_mcp.b.h,n);return n},j:function(){return this.ec(_mcp.b.v)},L:function(n){this.eb(_mcp.b.v,n);return n},d:function(){return this.ec(_mcp.b.e)},x:function(n){this.eb(_mcp.b.e,n);return n},h:function(){return this.ec(_mcp.b.k)},D:function(n){this.eb(_mcp.b.k,n);return n},c:function(){return this.ec(_mcp.b.d)},w:function(n){this.eb(_mcp.b.d,n);return n},g:function(){return this.ec(_mcp.b.j)},C:function(n){this.eb(_mcp.b.j,n);return n},i:function(){return this.ec(_mcp.b.o)},A:function(n){this.eb(_mcp.b.o,n);return n},l:function(){return this.ec(_mcp.b.n)},z:function(n){this.eb(_mcp.b.n,n);return n},k:function(){return this.ec(_mcp.b.l)},E:function(n){this.eb(_mcp.b.l,n);return n},o:function(){return this.ec(_mcp.b.r)},H:function(n){this.eb(_mcp.b.r,n);return n},m:function(){return this.ec(_mcp.b.p)},F:function(n){this.eb(_mcp.b.p,n);return n},n:function(){return this.ec(_mcp.b.q)},G:function(n){this.eb(_mcp.b.q,n);return n},u:function(){return this.ec(_mcp.b.s)},I:function(n){this.eb(_mcp.b.s,n);return n},v:function(){return this.ec(_mcp.b.t)},J:function(n){this.eb(_mcp.b.t,n);return n},b:function(){return this.ec(_mcp.b.c)},p:function(n){this.eb(_mcp.b.c,n);return n},q:function(){return this.ec(_mcp.b.g)},y:function(n){this.eb(_mcp.b.g,n);return n},t:function(n){if(this.i()!==n.ba()){_js.Trace.logInfo(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.ba());return!1}if(this.f()!==n.v()){_js.Trace.logInfo(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$a(this.f())?0:this.f().length,$a(n.v())?0:n.v().length);return!1}if(this.k()!==n.p()){_js.Trace.logInfo(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.p());return!1}if(this.o()!==n.z()){_js.Trace.logInfo(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.z());return!1}if(this.m()!==n.bb()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.bb());return!1}if(this.n()!==n.bd()){_js.Trace.logInfo(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.bd());return!1}if(this.u()!==n.q()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.q());return!1}if(this.v()!==n.C()){_js.Trace.logInfo(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.C());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.k()?n.k().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.i(),this.j(),n.bg())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.e())?0:this.e().y.length,$a(n.i())?0:n.i().b(),$a(this.j())?0:this.j().length,$a(n.bg())?0:n.bg().length);return!1}if(!_mcp.b.a(this.d(),n.n(),this.h(),n.Y())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.d())?0:this.d().y.length,$a(n.n())?0:n.n().b(),$a(this.h())?0:this.h().length,$a(n.Y())?0:n.Y().length);return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.J())){_js.Trace.logInfo(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$a(this.c())?0:this.c().y.length,$a(n.c())?0:n.c().b(),$a(this.g())?0:this.g().length,$a(n.J())?0:n.J().length);return!1}if(!_mcp.b.w(this.b(),n.x())){_js.Trace.logInfo(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.x()?n.x().b():0));return!1}if(!_mcp.b.A(this.q(),n.L())){_js.Trace.logInfo(_a.a.a,"snapshotExtendedPropertyCount="+(this.q()?this.q().y.length:0)+", contextExtendedPropertyCount="+(n.L()?n.L().y.length:0));return!1}if(this.a()!==n.K()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$a(this.a())?0:this.a().length,$a(n.K())?0:n.K().length);return!1}_js.Trace.logInfo(_a.a.a,"Context is clean");return!0},s:function(n){if(!n){_js.Trace.logInfo(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_js.Trace.logInfo(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_js.Trace.logInfo(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_js.Trace.logInfo(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_js.Trace.logInfo(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_js.Trace.logInfo(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_js.Trace.logInfo(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.b.i(i,t)){_js.Trace.logInfo(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.b.a(this.e(),n.e(),this.j(),n.j())){_js.Trace.logInfo(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().y.length:0,n.e()?n.e().y.length:0,this.j(),n.j());return!1}if(!_mcp.b.a(this.d(),n.d(),this.h(),n.h())){_js.Trace.logInfo(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().y.length:0,n.d()?n.d().y.length:0,this.h(),n.h());return!1}if(!_mcp.b.a(this.c(),n.c(),this.g(),n.g())){_js.Trace.logInfo(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().y.length:0,n.c()?n.c().y.length:0,this.g(),n.g());return!1}if(!_mcp.b.w(this.b(),n.b())){_js.Trace.logInfo(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_js.Trace.logInfo(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_js.Trace.logInfo(_a.a.a,"snapshot is clean");return!0}};_mcp.bG=function(n,t){this.g=Function.createDelegate(this,this.i);if($a(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bG.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_js.g.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_js.Trace.logInfo(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_js.Trace.logInfo(_a.a.a,"Clearing timer.");this.a=_js.g.a().b(this.a)}},i:function(){_js.Trace.logInfo(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni){this.ck=Function.createDelegate(this,this.Q);this.cV=Function.createDelegate(this,this.dF);this.cX=Function.createDelegate(this,this.dS);this.cY=Function.createDelegate(this,this.dX);this.bT=Function.createDelegate(this,this.dj);this.bU=Function.createDelegate(this,this.dH);this.cU=Function.createDelegate(this,this.db);this.cj=Function.createDelegate(this,this.dJ);this.cW=Function.createDelegate(this,this.dG);_mcp.d.resolveInheritance();this.I=this.dispose;_mcp.d.initializeBase(this);_a.b.b(k,"nativeBridge");this.bK=4;this.N=n;this.W=t||new _bc.b;this.W.w(g);this.O=this.bd();this.cv=i;this.bL=r;this.ca=u;this.X=new _mcp.L(this.W);this.cR=f;this.bJ=s;this.cP=e;this.bc=o;this.bs=h;this.bh=c;this.S=l;this.bl=v;this.cx=p;this.cs=a;this.cJ=w;this.Y=b;this.cw=y;this.cN=k;this.bw=d;this.bf=g;this.cQ=nt;this.cM=tt;this.co=it;this.cp=rt;this.cq=ut;this.ct=ft;this.bu=et;this.bE=ot;this.cy=st;this.bO=ht;this.cr=ct;this.di=lt;this.cL=at;this.cT=vt;this.cm=yt;this.cl=pt;this.cn=wt;this.bj=bt;this.bY=kt;this.cI=dt;this.cO=gt;this.cS=ni;if(o){var ti=o;this.br=ti.t||(ti.t=Function.createDelegate(ti,ti.d))}this.bf||(this.bI=!0);this.bV=!0;this.bX=!0;_js.Trace.logInfo(_a.a.a,"ViewModel created")};_mcp.d.a=function(){return+new Date+":"+Math.random()};_mcp.d.prototype={cv:null,N:null,bL:null,ca:null,cR:null,cP:null,bJ:null,W:null,bc:null,bl:null,cx:null,cT:null,bs:null,S:null,bh:null,cw:null,cN:null,cJ:null,di:null,bw:null,co:null,cp:null,cq:null,ct:null,bf:null,cQ:null,bu:null,bE:null,cy:null,bj:null,cs:null,cM:null,bO:null,cr:null,bY:null,cI:null,cO:null,cS:null,cL:null,cm:null,cl:null,cn:null,cf:null,O:null,bH:!1,bN:!1,ch:null,cg:!1,bi:!1,bK:0,bI:!1,bM:!1,bp:null,bZ:null,a:function(){return this.N},dM:function(n){if(this.O!==n){this.O=n;this.ea("InfoBarViewModel")}return n},bF:function(){_a.b.d(this.bO.c(),"MailComposeViewModel: Smime override factory has not been created");return this.bO.b()},bb:function(){return this.R.b(0)},D:function(){return this.R.b(10)},b:function(){return this.R.b(2)},T:function(){return this.R.b(5)},dE:function(){return this.R.b(4)},P:function(){return this.R.b(1)},dv:function(){return this.R.b(6)},e:function(){return this.R.b(7)},d:function(){return this.R.b(8)},bC:function(){return this.R.b(9)},bD:function(){return this.R.b(29)},bm:function(){return this.R.b(16)},cd:function(){return this.R.b(18)},cb:function(){return this.R.b(3)},cB:function(){return this.R.b(17)},dg:function(){return this.R.b(30)},cG:function(){return this.R.b(23)},be:function(){return this.R.b(19)},bg:function(){return this.R.b(22)},cz:function(){return this.R.b(24)},dd:function(){return this.R.b(31)},bn:function(){return this.R.b(25)},bz:function(){return this.R.b(12)},ce:function(){return this.R.b(27)},C:function(){return this.R.b(28)},X:null,c:function(){return this.bf},bo:function(){return!this.bc.c()||!!this.bf},V:function(){return!1},cA:function(){return"MailCompose"},df:function(){return!1},bB:function(){var t=this.bo();var n=new _a.q;n.c("P",t);n.b("I",t?this.cc().toString():"NA");n.b("ET",this.N.eU);return n},dt:function(){return this.bo()||this.bc.h()},dN:function(n){if(this.bI!==n){this.bI=n;this.ea("IsReadyForViewInitialization")}return n},cc:function(){return!!this.bf},bx:function(){return this.bK},dl:function(n){if(this.bK!==n){this.bK=n;this.ea("PopupPanelSize")}return n},w:function(){if(this.D()){var n=this.D();return n.d||(n.d=Function.createDelegate(n,n.i))}else return this.cW},p:function(){return this.cf},g:function(n){_js.Trace.logInfo(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.cf?"non-null":"null",n?"non-null":"null");this.cf=n;return n},bV:!1,by:function(){return this.bV},k:function(n){this.bV=n;return n},bX:!1,q:function(n){this.bX=n;return n},dy:function(){return this.bj.g()},dw:function(){return this.bj.d()},dB:function(){return this.bj.i()},dz:function(){return this.bj.e()},dA:function(){return this.bj.a()},l:function(){return this.bc.a()==="Mouse"?0:1},ds:function(){return this.bj.B()},bW:!1,A:function(){return this.bW},H:function(n){this.bW=n;return n},dk:function(n){if(this.bH!==n){this.bH=n;this.ea("IsInView")}return n},bv:!1,r:function(n){this.bv=n;return n},dm:function(n){var t=this.dh();if(this.bN!==t){this.bN=t;this.ea("ShouldShowToolbarMessage")}return n},dn:function(n){if(this.ch!==n){this.ch=n;this.ea("ToolbarMessage")}return n},R:null,dO:function(n){var t=this.dh();if(t!==this.cg){this.cg=t;this.ea("ShouldBlockView")}return n},G:function(n){if(this.bi!==n){this.bi=n;this.ea("IsNavigatingAway")}return n},dh:function(){return this.b()&&(this.b().k()||this.b().j())?!0:this.e()&&this.e().b()?!0:!1},dc:function(){return!this.bj.j()},Y:null,cZ:null,f:function(n){this.cZ=n;return n},br:null,y:function(n){this.br=n;return n},h:function(){var n=this.R.b(28);n.c()||n.g();return n.a()},bG:function(){return this.N.gi()},m:function(n){if(this.bM!==n){this.bM=n;this.ea("SharedCommandingBarShown")}return n},de:function(){return!!this.bl&&this.bl.a().f().Enabled&&this.bc.a()==="Mouse"},cH:function(){return this.bY.c()&&this.bc.a()==="Mouse"},U:function(){this.bZ||(this.bZ=new _cmc.U);return this.bZ},dJ:function(n,t){if(this.N.A()){this.M();this.R.r()}else{this.L();this.R.m()}},dr:function(){this.N.apcl(_mcp.a.d,this.cj)},M:function(){if(this.bG()&&!this.bp){_js.Trace.logInfo(_a.a.a,"Setting mail compose viewmodel override");this.bp=this.bF().c();this.bp.b(this.O)}},L:function(){if(this.bp){this.bp.a();this.bp=null}},Q:function(){this.bn().e();this.P().Y()},cK:function(){this.N.b()&&(this.N.ex()||this.N.cN())||this.N.fq(_mcp.d.a());_js.Trace.logInfo(_a.a.a,"Init:Context:{0}",this.N);this.R||(this.R=new _mcp.bj(this,this.cs,this.bl,this.cw,this.cx,this.cJ,this.cN,this.bf,this.cM,this.co,this.cp,this.cq,this.cr,this.cL,this.cm,this.cl,this.cn,this.bj,this.bY,this.cI,this.cS));if(this.bG()){_js.Trace.logInfo(_a.a.a,"Creating Smime override factory");this.cu(this.cU)}else this.db()},cu:function(n){_js.Trace.logInfo(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.bO.a(function(i){_js.Trace.logInfo(_a.a.a,"Smime override factory created");i.f(t.N,t.S);_js.Trace.logInfo(_a.a.a,"Calling createFactoryCallback");n()})},db:function(){_js.Trace.logInfo(_a.a.a,"Completing initialization");this.M();this.dr();if(this.O){this.O.o();this.S.a(_y.dE,new _y.dE);this.N.cN()&&this.da(this.N.gf())}this.G(!1);this.S.b(_a.dF,this.bU);this.R.b(0).g();if(!this.bf){this.bc.n(this.bT);this.bc.k(this.bT);_js.Trace.logInfo(_a.a.a,"Before unload handler has been hooked up")}},da:function(n){switch(n){case 94:case 99:case 100:this.O.d(n,null,_u.R.Ss,this.cY);break;case 98:this.O.d(n,null,_u.R.Ss,this.cX);break;default:this.O.a(n,null);break}},dX:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.O.b(100);this.O.b(99);this.O.b(94)},dS:function(){window.open("https://login.live.com/logout.srf?id=292841&ru=https:%2F%2Foutlook.com");this.O.b(98)},dP:function(n){this.dC(n);_js.Trace.logInfo(_a.a.a,"Set screen view model appbar. ContextId={0}",this.N.b())},dR:function(n){this.dI(n);_js.Trace.logInfo(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.N.b())},cC:function(){_y.hO.prototype.cC.call(this);var n=this.bb();if(n.c()){_js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, begin secondary init now since primary init is already finished.");n.b()}else _js.Trace.logInfo(_a.a.a,"PostTransitionIn view model, primary init not finished yet. Relying on primary init to fire secondary init...");this.dk(!0);if(this.N.cN()&&this.N.cb()){var i=this.N.b();this.S.a(_y.ex,new _y.ex(i))}(this.N.a()||this.bc.a()!=="TouchNarrow")&&this.N.eE&&this.N.eE();if(this.bc.a()==="Mouse"){var t=this;_js.g.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.T();n&&n.p()})}if(this.N.eF){this.N.eF(this);this.N.eF=null}this.U().i(this.cA())},cD:function(){_js.Trace.logInfo(_a.a.a,"Post transition out");if(this.e().f()){var n=this.e().f();n.j=this.N.cb()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.d.a(n)}this.dk(!1);this.U().d();if(!this.e().l()){if(this.bv){this.P().j();this.N.et.a()}this.j()}if(this.bl.a().d()&&this.bl.a().d().Enabled){this.S.a(_a.bV,new _a.bV(!0,""));this.S.a(_a.bo,new _a.bo("QComp"))}_y.hO.prototype.cD.call(this)},j:function(){_js.Trace.logInfo(_a.a.a,"Calling reset on the mail compose view model, context:{0}",this.N);this.L();this.N.rpcl(_mcp.a.d,this.cj);if(this.R){var n=this.b();if(n&&n.i()){this.R.k();this.N&&!this.bv&&this.N.de();this.O&&this.O.c.g();this.bg()&&this.bg().a()&&this.bg().a().e(!1);this.bf||this.bc.n(this.bT);this.S.c(_a.dF,this.bU);this.br=null;n.f(!1)}else _js.Trace.logWarning(_a.a.a,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.a.a,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.bW=!1},bt:function(){if(this.T().b()){_js.Trace.logInfo(_a.a.a,"Dirty due to attachment in progress");return!0}var n=this.R.b(1);n.j();return this.N.fF()},bd:function(){$a(this.O)&&this.dM(new _y.t);return this.O},E:function(){_h.u.k()},F:function(){_h.u.g()},dU:function(){this.bp&&this.bp.c()},K:function(){this.dN(!0)},J:function(){var n=new _y.eH;this.dj(n);return n.b},dj:function(n){this.b().h(n);this.U().d()},n:function(){this.U().d()},dq:function(){this.bo()&&this.N&&!_js.d.a(this.N.t())&&!this.bf&&(document.title=this.N.t())},ed:function(){_js.Trace.logInfo(_a.a.a,"Disposing view model, context: {0}",this.N?this.N:"null");this.R&&this.R.k();this.bc.a()==="TouchNarrow"&&_ms.b.isInstanceOfType(this.dD)&&this.dD.dispose();_a.iX.prototype.ed.call(this)},dG:function(n,t){return t===1?!this.bX:!1},dp:function(n){if(this.W.i)_js.Trace.logWarning(_a.a.a,"ShowMessageBoxForSessionTimeout: A message is already being shown, pending timeout dialog was not shown");else{_js.Trace.logWarning(_a.a.a,"ShowMessageBoxForSessionTimeout: Show pending timeout dialog");n?this.W.a(0,_u.R.Lx,this.cV,!1,_u.R.bP,null,_u.R.bO,this.W.v):this.W.a(0,_u.R.EL,null,!1,null,null,_u.R.bO,this.W.v)}},dH:function(n){if(n.b()<120){_js.Trace.logInfo(_a.a.a,"OnSessionTimeoutEvent: Timeout header recieved with less than 2 minutes until session expires");this.S.c(_a.dF,this.bU);var i=this,t=this;this.d().a("Save",function(){_js.Trace.logInfo(_a.a.a,"OnSessionTimeoutEvent: Save was successful");i.dp(!0)},function(){_js.Trace.logInfo(_a.a.a,"OnSessionTimeoutEvent: Save was unsuccessful");t.dp(!1)},!1)}},dF:function(n,t){if(n){_js.Trace.logInfo(_a.a.a,"HandleSessionTimeoutDialog: Logout for user");var r=new _a.bz;this.S.a(_a.bz,r);var i=new _a.cf(this.cO.d());this.S.a(_a.cf,i)}}};_mcp.g=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni){_mcp.g.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni])};_mcp.g.prototype={V:function(){return!0},cA:function(){return"MailInlineCompose"}};_mcp.h=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni){_mcp.h.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni])};_mcp.h.prototype={V:function(){return!0},df:function(){return!0},cA:function(){return"GroupInlineCompose"},bP:null,x:function(n){this.bP=n;return n},bR:!1,z:function(n){this.bR=n;return n},bk:null,v:function(n){this.bk=n;return n},bA:null,ci:null,t:function(n){this.ci=n;return n}};_mcp.i=function(n,t){this.b=n;this.c=t};_mcp.i.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.i.prototype={b:null,e:null,c:!1,a:null,f:null,d:null,g:function(){!this.e&&this.b&&(this.e=_a.E.a(this.b.EmailAddress));return this.e},l:function(n){if(!this.c)return n.val.i();_js.Trace.logInfo(_mcp.i.a,"begin calculating initial audience");var t=new _js.f;this.a={};if(this.b){_js.Trace.logInfo(_mcp.i.a,"adding always keep address "+this.g()+" as the first To recipient");t.a(this.b);this.a[this.g()]=0}this.h(t,n.val.i(),0);this.h(t,n.val.n(),1);_js.Trace.logInfo(_mcp.i.a,"end calculating initial audience");this.k(t,n);return t},n:function(n,t){_rw.b.isInstanceOfType(n)&&(this.f=n);this.d=t},k:function(n,t){if(!this.c||!n){t.val.r(n);return}for(var f=new _js.f,e=new _js.f,o=n.y.length,r=0;r<o;r++){var i=n.y[r];var u=_mcp.i.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_js.Trace.logInfo(_mcp.i.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.r(f);t.val.bi(e);if(this.d){this.d.q(e);_js.Trace.logInfo(_mcp.i.a,"Update Cc recipient well with the separated Cc recipients")}},m:function(n,t){if(this.c){var i=t.c;_js.Trace.logInfo(_mcp.i.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.i(r);break;case 2:this.j(u);break;case 3:this.j(u);this.i(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},j:function(n){if(n)for(var u=n.length,r=0;r<u;r++){var f=n[r].j.a();var t=_mcp.i.b(f);_js.Trace.logInfo(_mcp.i.a,"recording removed recipient "+t);if(t in this.a)if(t===this.g()){var i=this;_js.g.a().a(_mcp.i.a,"ProcessAlwaysKeepRecipients",function(){if(i.f){_js.Trace.logInfo(_mcp.i.a,"adding the always keep address "+t+" back in To well");i.f.ba(i.b)}},0)}else{_js.Trace.logInfo(_mcp.i.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},i:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].j.a();var i=_mcp.i.b(u);_js.Trace.logInfo(_mcp.i.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},h:function(n,t,i){var e=t?t.b():0;_js.Trace.logInfo(_mcp.i.a,"merging "+e+" "+_y.by.toString(i)+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.i.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.Z=function(n,t,i,r,u,f,e,o){this.L=Function.createDelegate(this,this.P);this.A=Function.createDelegate(this,this.I);this.K=Function.createDelegate(this,this.N);_mcp.Z.initializeBase(this);this.H=o;this.k=o.a;this.o=n;this.t=t;this.l=o.d;this.y=i;this.D=r;this.G=u;this.F=f;this.E=e};_mcp.Z.prototype={t:null,o:null,k:null,l:null,H:null,y:null,D:null,G:null,F:null,E:null,p:null,m:0,x:!1,z:null,n:null,q:null,v:!1,f:function(){$a(this.p)&&(this.p=new _y.bs);return this.p},e:function(n){this.p=n;return n},w:function(){return this.l?this.l.bU():null},C:null,j:function(n){this.C=n;return n},c:function(n){_a.A.stPT(_a.a.t,"MailComposeReplyLoad",3);this.v=!0;this.n=_y.i.b(_a.a.t,"MailComposeReply",!0);this.q=_y.i.b(_a.a.t,"MailComposeReplyLoad",!0);this.o.g("Inference.Reply",this.k.bh.ItemId,this.k.bh.ConversationId,this.l?this.l.K():null,this.w());this.r(1,n)},d:function(n){_a.A.stPT(_a.a.t,"MailComposeReplyAllLoad",3);this.v=!0;this.n=_y.i.b(_a.a.t,"MailComposeReplyAll",!0);this.q=_y.i.b(_a.a.t,"MailComposeReplyAllLoad",!0);this.o.g("Inference.ReplyAll",this.k.bh.ItemId,this.k.bh.ConversationId,this.l?this.l.K():null,this.w());this.r(2,n)},h:function(n){this.x=!0;this.d(n)},b:function(n){this.o.a("Inference.PostReply",this.k.bh.ItemId,this.w());this.r(12,n)},a:function(n){_a.A.stPT(_a.a.t,"MailComposeForwardLoad",3);this.v=!0;this.n=_y.i.b(_a.a.t,"MailComposeForward",!0);this.q=_y.i.b(_a.a.t,"MailComposeForwardLoad",!0);this.o.g("Inference.Forward",this.k.bh.ItemId,this.k.bh.ConversationId,this.l?this.l.K():null,this.w());this.r(3,n)},g:function(n){this.x=!0;this.a(n)},i:function(){if(!this.H.o())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _c.bg(this.k.bh.ItemId.Id,t.Id);n.w(this.K);n.v(this.A);OwaApplication.a.a(n)},N:function(n){var i=n.d;if(i.length>0){var t=this.D.f(_g.g.b(i));t.w(this.L);t.v(this.A);OwaApplication.a.a(t)}else this.I(n)},I:function(n){this.l.I().b(9500);this.l.I().a(9500)},P:function(n){var t=n;if(t.b){this.l.I().b(9500);var i=this.y.b(t.e[0],!1,t.b.cM(),t.b.bu());_y.c.a.c()||i.o(0);this.f().a(i)}else this.I(n)},r:function(n,t){this.m=n;this.Q(t)},Q:function(n){var u=_g.i.isInstanceOfType(this.k);n||(n=!_y.c.a.c());var t=this.y.a(n,!1);t.U(this.v);n&&t.o(0);var r=null;switch(this.m){case 1:r=!t.l()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.l()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.l()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.n){this.n.q=r;t.E(this.n);t.T(this.q);t.br()}t.dJ(this.k.bh.ParentFolderId);this.l&&t.dK(this.l.cd());t.f(this.m);t.dD(!0);t.eI=this.x;t.j(!t.eI||this.m===3);var i=new _g.bg;i.Mailbox=new _g.d;i.Mailbox.EmailAddress=this.t.c().bh.UserEmailAddress;i.Mailbox.Name=this.t.c().bh.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.dN(i);t.eE=this.C;if(u){var o=this.k;if(o.bQ())t.O(o);else{t.dB(!0);t.cu(this.k.bh.ItemId);t.cr(_g.i.d(o))}}else t.O(this.k);if((this.m===1||this.m===2)&&_g.o.isInstanceOfType(this.k)){var e;var f=this.k;var l=this.J(f.o())+this.J(f.m())+this.J(f.k());e=this.m===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.d.b(_a.a.t,e);c.j=l.toString();_a.d.a(c)}if((_g.o.isInstanceOfType(this.k)||u)&&t.fg(this.k)){var s=_a.j.d();s&&t.gE(this.k.ds());if(this.k.bP()||t.A()&&s){var h=this;this.O(function(n){n.b(t,h.k,h.m)})}else this.f().a(t)}else this.f().a(t)},O:function(n){_js.Trace.logInfo(_a.a.j,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.G.a(function(i){t.F.a(function(r){t.E.a(function(u){t.z||(t.z=t.M(i,r,u));_js.Trace.logInfo(_a.a.j,"[MailResponseViewModel] Executing smime operation.");n(t.z)})})})},M:function(n,t,i){_js.Trace.logInfo(_a.a.j,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");var r=null;r=n.f();var f=this,u=this;r.a(this,this.t,function(n,i){var u=t.a(n.bh.ItemId,i.cf());var r=t.b(200,u);r.I=i.b();return r},function(n,t,r){var u=new _mcp.bK(n,t,r,i);return u.toString()});return r},J:function(n){return n?n.b():0}};_mcp.ba=function(n,t,i,r,u,f,e){this.e=n;this.h=t;this.f=i;this.b=r;this.g=u;this.d=f;this.c=e};_mcp.ba.prototype={e:null,h:null,f:null,b:null,g:null,d:null,c:null,a:function(n){return new _mcp.Z(this.e,this.h,this.f,this.b,this.g,this.d,this.c,n)}};_mcp.F=function(){_mcp.F.initializeBase(this)};_mcp.F.prototype={c:null,d:"Normal",e:!1,f:!1,a:!1,b:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,r:function(){if($a(this.c)){this.c=new _js.f;this.c.a("Normal");this.c.a("Personal");this.c.a("Private");this.c.a("Confidential")}return this.c},o:function(n){if(this.d!==n){this.d=n;this.ea("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.ea("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.ea("IsReadReceiptRequested")}return n},w:function(n){if(this.h!==n){this.h=n;this.ea("ShowSmimeOptions")}return n},p:function(n){if(this.a!==n){this.a=n;this.ea("SmimeEncryptMessage")}return n},q:function(n){if(this.b!==n){this.b=n;this.ea("SmimeSignMessage")}return n},x:function(n){if(this.i!==n){this.i=n;this.ea("SmimeEncryptMessageIsEnabled")}return n},y:function(n){if(this.j!==n){this.j=n;this.ea("SmimeSignMessageIsEnabled")}return n},z:function(n){if(this.l!==n){this.l=n;this.ea("WaitingForPreviousAction")}return n},v:function(n){if(this.g!==n){this.g=n;this.ea("Conductor")}return n},t:function(n){this.k=n.A();this.w(_a.j.a&&_a.j.i()&&n.dc());this.z(!1);this.o(n.z());this.m(n.bb());this.n(n.bd());this.p(n.q());this.q(n.C());this.x(n.cW());this.y(n.cX())}};_mcp.N=function(n){_mcp.N.initializeBase(this);this.h=n;var t=_a.c.bZ();if(t.length>=3){this.c=new _mcp.M(t[0]);this.e=new _mcp.M(t[1]);this.f=new _mcp.M(t[2])}};_mcp.N.prototype={h:0,b:null,a:0,d:!1,g:"",c:null,e:null,f:null,l:function(){return(this.h&3)==3},j:function(n){if(this.d!==n){this.d=n;this.ea("IsTimeExpirationSelected")}return n},n:function(n){this.a=n;this.j(this.a===1?!0:!1);this.ea("SelectedOption");return n},i:function(n){this.g=n;this.ea("ErrorText");return n},k:function(){return[this.c,this.e,this.f]},m:function(n){if(this.b!==n){this.b=n;this.ea("Conductor")}return n}};_mcp.M=function(n){this.b=n};_mcp.M.prototype={b:0,a:null,c:!1,f:function(n){this.a!==n&&(this.a=n);return n},e:function(){var n="";switch(this.b){case 7:n=_nbs.a.CQ;break;case 6:n=_nbs.a.mK;break;case 5:this.c=!0;n=_nbs.a.ep;break}return n},d:function(){var n=0;switch(this.b){case 7:case 6:n=2;break;case 5:n=4;break}return n}};_mcp.O=function(n){this.a=n};_mcp.O.prototype={a:!1};_mcp.bJ=function(n,t){this.a=n;this.b=t};_mcp.bJ.prototype={a:null,b:null};_mcp.bK=function(n,t,i,r){this.j=new RegExp("<","g");this.i=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.bK.prototype={e:0,a:null,d:!1,f:null,toString:function(){_js.Trace.logInfo(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.n();var t=this.g(!0);var r=this.g(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.R.Ow,r,t));var o=this.a.cx()||this.a.cw();var w=o?o.toString():this.a.it();var h=this.h(!0);var e=this.h(!1);var i,n;var s,u;this.o(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.cX,t);var k=this.b(_nbs.a.Jw,w);var b=h?this.b(_u.R.OS,h.join("; ")):null;var y=e?this.b(_u.R.Rh,e.join("; ")):null;var l=this.b(_u.P.Y,a);var c=i?this.b(_u.P.N,i):null;var v=n?this.b(_u.P.H,n):null;var f=this.k(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},k:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _ff.d,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.d.a(i)||f.c(i)}return f.h()},n:function(){if(this.a.bh.Subject)return this.a.bh.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.R.KG;break;case 3:n=_nbs.a.QD;break;case 8:n=_nbs.a.RI;break;case 9:n=_nbs.a.kP;break;case 10:n=_nbs.a.MZ;break;case 5:case 6:case 7:n="";break;default:n="";break}return String.format(_nbs.a.gG,n,this.a.cN()||_u.R.VO)}},g:function(n){if(_g.o.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bh.From:r.bh.Sender;return i?this.c(i.Mailbox):null}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return t.bh.Organizer?this.c(t.bh.Organizer.Mailbox):null}else return null},h:function(n){if(_g.o.isInstanceOfType(this.a)){var i=this.a;return this.m(n?i.k():i.m())}else if(_g.i.isInstanceOfType(this.a)){var t=this.a;return this.l(n?t.q():t.v(),n)}else return null},o:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.bh.isInstanceOfType(this.a)){var f=this.a;i=f.t();r=f.eJ()}else if(_g.i.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=this.f.a();n.val=e.a(r,null)||" "}i&&(t.val=i.u()?i.u().bh.DisplayName||" ":" ")},m:function(n){if(!n||!n.b())return null;var t=new _ff.d;var i=this;n.o(function(n){t.c(i.c(n))});return t.h()},l:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bh.Organizer.Mailbox)]:null;var i=new _ff.d;var r=this;n.o(function(n){i.c(r.c(n.bh.Mailbox))});return i.h()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.p(t):n+" "+t},p:function(n){if(!n)return null;n=n.replace(this.j,"&lt;");n=n.replace(this.i,"&gt;");return n}};_mcp.R=function(){};_mcp.R.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.R.registerEnum("_mcp.R",!1);_mcp.p=function(n,t,i,r,u,f,e,o){this.br=Function.createDelegate(this,this.bW);this.Y=Function.createDelegate(this,this.bB);this.Z=Function.createDelegate(this,this.bT);this.bv=Function.createDelegate(this,this.bE);this.bs=Function.createDelegate(this,this.bY);this.bu=Function.createDelegate(this,this.bZ);this.bf=Function.createDelegate(this,this.cf);this.be=Function.createDelegate(this,this.bV);this.W=Function.createDelegate(this,this.bR);this.X=Function.createDelegate(this,this.bS);this.bo=Function.createDelegate(this,this.bN);this.bp=Function.createDelegate(this,this.bO);this.bq=Function.createDelegate(this,this.bQ);this.bm=Function.createDelegate(this,this.bG);this.m=this.a;_mcp.p.initializeBase(this,[5,n]);this.y=i;this.F=u;this.bi=t;this.z=new _C(this.bm,this.bd());this.A=r;this.V=f;this.O=e;this.N=o};_mcp.p.prototype={H:null,y:null,A:null,F:null,bi:null,V:null,E:null,O:null,z:null,T:null,S:null,K:null,I:null,U:!1,C:null,x:null,J:!1,N:null,bj:!0,bg:0,Q:null,R:null,i:function(){this.H||this.bz();return this.H},bD:function(n){if(this.H!==n){this.H=n;this.bk("Menu")}return n},cd:function(n){if(this.Q!==n){this.Q=n;this.bk("InsertButtonCommand")}return n},bC:function(n){if(this.R!==n){this.R=n;this.bk("InsertButtonText")}return n},f:function(){if(!this.T){var n=this;this.T=new _C(this.bq,this.bd(),this.bb.a.N,"BodyType",function(){return n.bb.a.N.e()==="HTML"})}return this.T},bL:function(){this.S||(this.S=new _C(this.bp,this.bd()));return this.S},n:function(n){this.bt("AttachmentWellInitialized",n)},q:function(n){this.bJ("AttachmentWellInitialized",n)},a:function(){return this.ec(_mcp.p.a)},r:function(n){this.eb(_mcp.p.a,n);return n},b:function(){return(this.a()?this.a().h():!1)||(this.E?this.E.c():!1)},e:function(){return this.a()&&this.a().b()?this.a().b().y.length>0:!1},ca:function(n){if(this.bg!==n){this.bg=n;this.bk("AttachmentsVisibleCount")}return n},t:function(n){this.bj=n;return n},h:function(){var n=_a.UserAgent.getInstance();return n.c()&&!!this.y&&this.A.a()&&(this.y.a().D().Enabled&&n.b()||this.y.a().J().Enabled&&n.H)},M:function(){if(this.ba.bG()&&!this.x){_js.Trace.logInfo(_a.a.a,"Setting attachment component override");this.x=this.ba.bF().a();this.x.c(this.bo)}},L:function(){if(this.x){this.x.a();this.x=null}},g:function(){var t=this.bb.a.N;this.M();this.bz();var i=t.cc();var r=t.x();var u=!((t.a()===4||t.a()===13)&&!this.A.a());if(this.a()){this.a().bK(t.h(),r,i,t.b(),t.X());this.bw(t,i)}else{var n=this;this.bi.a(function(f){if(_y.c.a.a()==="TouchNarrow")n.r(f.a(t.h(),r,i,u,t.X(),!0,n.bb.a.O,t.b()));else{var e=f.b(t.h());e.e(t.Z());e.j(1);var o=n.ba.N.bk();var s=o?o.EmailAddress:null;n.r(f.c(e,r,i,_y.c.a.a()==="Mouse"?3:0,u&&n.bj,t.X(),!0,n.bb.a.O,t.b(),n.bb.a.bf,n.bb.a.cQ,n.bb.a.br,s))}n.a().p(n.X);n.a().w(n.W);n.a().apcl("EditorCallContext",n.be);n.a().M(n.ba.ck);n.bX("AttachmentWellInitialized",n);n.ba.V()&&n.a().apcl("VisibleCount",n.bf);n.bw(t,i)})}},bN:function(){return this.a()},bV:function(n,t){t==="EditorCallContext"&&this.ba.bn().a(this.a().Q())},l:function(n){this.K&&this.K.a(!n)},k:function(n){this.I&&this.I.a(!n)},bR:function(n){if(_a.bk.a){var t=this;_js.g.a().c(_a.a.E,"TriggerPolicyTipsIfNeeded",function(){var n=t.bb.b(23);n.a(8)})}},bS:function(){var t=this.bb.a;var n=t.N;if(n.h()){this.bx(n);this.a()&&this.a().e(n.h(),n.x(),n.X())}else t.d().a("Attach",this.bu,this.bs,!1)},u:function(){if(!this.U&&this.a()){var n=this.bb.a.N;if(_y.c.a.a()==="Mouse")this.a().e(n.h(),n.x(),n.X());else{_js.Trace.logInfo(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bp(n.h(),n.x(),n.X(),this.bv)}this.bE();this.bb.a.S.a(_y.dB,new _y.dB);this.U=!0}},bE:function(){var n=this.bb.a.N;if(n.ep)if(n.x()){var t=new _js.f;t.n(n.x().f());n.ep.p(t);n.en()&&n.en().p(t)}else{n.ep.p(null);n.en()&&n.en().p(null)}},bh:function(){var n=this.a();if(n){n.E(this.X);n.D(this.W);n.rpcl("EditorCallContext",this.be);this.a().ba(this.ba.ck);this.ba.V()&&this.a().rpcl("VisibleCount",this.bf)}this.U=!1;this.L();_mcp.bh.prototype.bh.call(this)},o:function(){var n=[];var t=this.bb.b(13);var i=this.bb.b(20);if(t){t.a().b&&Array.add(n,new _y.h(_u.P.l,t.a()));t.b().b&&Array.add(n,new _y.h(_u.P.U,t.b()));this.G()&&Array.add(n,new _y.h(this.D(),this.z))}else if(i)Array.add(n,new _y.h(this.D(),i.a()));else if(_a.UserAgent.getInstance().z()){Array.add(n,new _y.h(this.D(),this.z));!this.A.b()||this.bb.a.N.e()!=="HTML"||_a.UserAgent.getInstance().c()||this.y.a().G().Enabled||Array.add(n,new _y.h(_u.P.F,this.f()))}return n},j:function(){var n=new _ff.d;var t=this.bb.b(13);var i=this.bb.b(20);if(t){t.a().b&&n.c(new _fm.d(_u.P.l,null,t.a(),!1,null,_u.P.J));t.b().b&&n.c(new _fm.d(_u.P.U,null,t.b(),!1,null,_u.P.C));this.G()&&n.c(new _fm.d(this.D(),null,this.z,!1,null,this.P()))}else if(i)n.c(new _fm.d(this.D(),null,i.a(),!1,null,this.P()));else if(_a.UserAgent.getInstance().z()){n.c(new _fm.d(this.D(),null,this.z,!1,null,this.P()));!this.A.b()||this.bb.a.N.e()!=="HTML"||_a.UserAgent.getInstance().c()||this.y.a().G().Enabled||n.c(new _fm.d(_u.P.F,null,this.f()))}return n},v:function(){var n=this.bb.a.N;if(!_js.d.a(n.bv())&&!this.J&&n.h()&&this.a()){this.J=!0;var t=!1;try{this.a().bi(n.bv(),this.Z,this.Y);t=!0}finally{t||(this.J=!1)}}},w:function(n){this.O&&this.a()&&this.O.a(this.a(),this.bd()).b(n)},d:function(){var t=this.bb.a;var n=t.N;if($a(n)||!n.g()){_js.Trace.logInfo(_a.a.a,"Show not allowed to add attachment due to context={0}; Upgraded={1}",n?"non-null":"null",n.g());t.W.a(0,_nbs.a.Yl,null);return!1}return!0},bG:function(){var t=this.bb.a;var i=t.N;_js.Trace.logInfo(_a.a.a,"Insert attachment start");if(this.d()&&this.a()){this.ba.P().x(!1);if(this.x)this.x.b(!1);else if(this.G()){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_js.Trace.logInfo(_a.a.a,"Opening OWA's file picker");this.ce(n)}else{_js.Trace.logInfo(_a.a.a,"Opening OS's file picker");this.a().f(!1,null,null)}}this.ba.U().a("AttachFile");_js.Trace.logInfo(_a.a.a,"Insert attachment end")},bQ:function(){var n=this.bb.a;var t=n.N;_js.Trace.logInfo(_a.a.a,"Insert picture start");if(this.d()&&this.a()){this.x?this.x.b(!0):this.a().f(!0,null,null);this.ba.U().a("InsertPicture")}_js.Trace.logInfo(_a.a.a,"Insert picture end")},bO:function(){if(this.E)this.bA(this.E);else if(this.V){var n=this;this.V.a(function(t){n.E=t;n.bA(n.E)})}},bA:function(n){_js.Trace.logInfo(_a.a.a,"Inserting location");var i=_a.d.b(_a.a.bf,"BeamMeUpPlaceholderPopulated");var t=this;n.d(function(i){t.ba.bn().a(i);n.a(t.a(),i.a())},this.br,i)},bW:function(n){if(n){var t=this.bb.a;t.W.a(0,n,null)}},bz:function(){if(!this.H){var n=[];var t=new _fm.d(this.D(),null,this.z,!1,null,this.P());Array.add(n,t);if(this.A.b()){this.K=new _fm.d(_u.P.F,null,this.f(),!1,null,_u.P.S);this.y.a().G().Enabled||Array.add(n,this.K);this.l(this.bb.a.N.e()==="HTML");if(_a.UserAgent.getInstance().c()&&this.y&&this.y.a().D().Enabled){this.I=new _fm.d(_nbs.a.ey,null,this.bL(),!1,null,_nbs.a.ns);Array.add(n,this.I)}this.k(this.bb.a.N.e()==="HTML")}if(n.length===1){this.cd(this.z);this.bC(_nbs.a.IF);this.y.a().f().Enabled&&!this.ba.V()&&this.bD(new _fm.f(n))}else{this.bD(new _fm.f(n));this.bC(_nbs.a.bj)}}},bw:function(n,t){this.a().bR(!n.g());_js.Trace.logInfo(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.g()&&this.u();this.bH(n);_mcp.bh.prototype.g.call(this)},bH:function(n){if(n&&this.a()&&n.a()===3&&this.a().r()){var t=_a.d.b(_a.a.c,"IntentToForwardReferenceAttachment");_a.d.a(t)}},bx:function(n){n.x()||n.bq(new _js.f)},bZ:function(n){var i=this.bb.a;var t=i.N;if(n.I===t.b()){this.bx(t);this.a()&&this.a().e(t.h(),t.x(),t.X());this.v()}},bY:function(n){var t=this.bb.a;var i=t.N;if(this.a()&&n.I===i.b()){this.a().F();t.W.i||t.W.a(0,_nbs.a.lG,null);this.v()}},ce:function(n){if(this.F){var t=this;this.F.a(function(i){t.C=i;t.C&&t.C.a(t.a(),n,!1,t.bb.a.br,t.bb.a.bf,t.ba.N.e()==="Text")})}},p:function(){if(this.G()&&this.F){var n=this;this.F.a(function(t){n.C=t;n.C&&n.C.c()})}},G:function(){return!this.bc.N()&&!!this.A&&!!this.N&&this.A.f(this.N.AttachmentDataProviderAvailable)},bT:function(n){this.bb.a.N.cn(null);this.bB(n)},bB:function(n){n.y(this.Z);n.S(this.Y);this.J=!1},D:function(){return this.G()?_u.P.i:_u.P.A},P:function(){return this.G()?_u.P.V:_u.P.D},cf:function(n,t){this.ca(this.a().n())}};_mcp.bg=function(n,t,i,r,u){this.K=Function.createDelegate(this,this.bi);this.N=Function.createDelegate(this,this.bj);this.x=Function.createDelegate(this,this.bm);this.F=Function.createDelegate(this,this.bg);_mcp.bg.initializeBase(this,[n,t,i,r,u]);this.o=new _mcp.bG(this.F,6e4)};_mcp.bg.prototype={o:null,g:function(){var n=this.bb.a;var t=n.N;_js.Trace.logInfo(_a.a.a,"Enabling timer during initialization of auto save component");this.o.b=!0;if(!t.bf()){this.bo();_js.Trace.logInfo(_a.a.a,"Auto save timer started")}_mcp.B.prototype.g.call(this);n.S.b(_a.cG,this.x)},bg:function(){var u=this.bb;var r=u.a;var n=r.N;if(!n.bf()){if(!n.bz()){_js.Trace.logInfo(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var f=u.b(5);_js.Trace.logInfo(_a.a.a,"Checking dirty before auto save");var t=r.bt();var i=f.b();if(t&&!i){_js.Trace.logInfo(_a.a.a,"AutoSave:Context:{0}",n);this.o.e();this.a("AutoSave",this.N,this.K,!1)}else{this.o.c();_js.Trace.logInfo(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},bo:function(){var n=this.bb.a.N;!n.bf()&&n.bz()&&this.o.c()},bh:function(){_js.Trace.logInfo(_a.a.a,"Disabling the timer on reset");this.o.h();var n=this.bb.a;n.S.c(_a.cG,this.x);_mcp.B.prototype.bh.call(this)},bl:function(){var n=this.bb.a;n.S.c(_a.cG,this.x)},bm:function(n){_js.g.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.F)},bj:function(n){var r=this.bb;var i=r.a;var t=i.N;t.bf()||this.o.c()},bi:function(n){_js.Trace.logInfo(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.t.message);this.bb.a.N.bf()||this.o.c()}};_mcp.s=function(n,t,i){this.t=Function.createDelegate(this,this.L);this.l=Function.createDelegate(this,this.M);_mcp.s.initializeBase(this,[0,n]);this.x=t;this.u=i};_mcp.s.prototype={u:null,j:null,k:null,p:null,q:null,r:null,n:null,f:null,m:null,x:null,b:function(){return this.m},d:function(n){if(n!==this.m){this.m=n;this.bk("AddinsCalloutViewModel")}return n},a:function(){return this.f},N:function(n){if(this.f!==n){this.f=n;this.bk("ComposeCommandingBar")}return n},bh:function(){_mcp.bh.prototype.bh.call(this);this.bb.a.rpcl("ShouldShowToolbarMessage",this.l);this.f&&this.f.dispose()},v:function(){return this.ba.e().a()},A:function(){return this.ba.be().a()},K:function(){return this.ba.bg().b()},F:function(){return this.ba.b().e()},H:function(){return this.ba.d().j()},o:function(){return this.ba.T().i()},w:function(){this.r||(this.r=new _fm.i(this.K(),_u.P.K,_mcp.c.y(),0,null,_mcp.c.z(),!1,!1,!1));return this.r},J:function(){if(!this.j)if(this.bc.N())this.j=new _fm.i(this.v(),_u.P.c,_mcp.c.T(),0,null,null,!1,!1,!1);else if(this.ba.e().k()){var n=new _fm.d(_u.P.m,_mcp.c.u(),this.v());this.j=new _fm.p(this.ba.e().m(),n)}else this.j=new _fm.i(this.v(),_u.P.m,_mcp.c.u(),0,null,null,!1,!1,!1);return this.j},C:function(){this.n||(this.n=new _fm.i(this.A(),_u.R.aL,null,0,null,null,!1,!1,!1));return this.n},D:function(){if(!this.k)if(this.o().h.y.length>1){var n=this;this.k=new _fm.m(_nbs.a.cd,function(t){t(n.o())},0,_nbs.a.cd,!1,!1,_mcp.c.o(),!1)}else this.o().h.y.length===1&&(this.k=new _fm.i(this.o().h.y[0].k,_nbs.a.IF,_mcp.c.o(),0,null,null,!1,!1,!1));return this.k},G:function(){this.p||(this.p=new _fm.i(this.F(),null,_mcp.c.S(),0,_u.R.GJ,null,!0,!1,!1));return this.p},I:function(){this.q||(this.q=new _fm.i(this.H(),null,_mcp.c.G(),0,_u.R.Ce,null,!0,!1,!1));return this.q},E:function(){return this.u.g()},g:function(){if(this.c()){_js.Trace.logInfo(_mcp.s.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.ba.V()){_js.Trace.logInfo(_mcp.s.a,"Initializing compose commanding bar");this.N(new _fm.o(_u.R.Bv));this.f.P=!0;this.f.E=!0;this.f.H(3);this.f.q(0);this.i(this.J(),!0);this.i(this.D(),!0);this.i(this.w(),!1);this.i(this.C(),!0);(this.x.b||this.ba.bo())&&!this.bc.cN()&&this.i(this.I(),!0);this.bb.a.bo()||this.bb.a.N.l()===3||this.i(this.G(),!0);this.bb.a.apcl("ShouldShowToolbarMessage",this.l);if(this.ba.bb().c()){_js.Trace.logInfo(this.bd(),"Primary init is complete; creating commanding bar affordance menu synchronously.");this.y()}else{_js.Trace.logInfo(this.bd(),"Scheduling commanding bar affordance menu creation because primary initialization has not finished.");this.ba.bb().apcl("IsInitialized",this.t)}this.f.q(1);this.z(this.ba.bg().h());this.e(0);_js.Trace.logInfo(_mcp.s.a,"Completed initializing compose commanding bar")}_mcp.bh.prototype.g.call(this)},e:function(n){var u=this.ba.bo();var r=this.E();var t;var i;if(u){t=0;i=0}else{t=r?15:n;i=r?n:15}this.f.S(t);this.f.G(i)},bl:function(){this.bb.a.rpcl("ShouldShowToolbarMessage",this.l);_js.u.prototype.bl.call(this)},y:function(){_js.Trace.logInfo(_mcp.s.a,"Adding affordance items to compose commanding bar");var n=new _ff.d;this.f.q(0);this.h(n,8);this.h(n,11);this.h(n,1);this.h(n,29);this.h(n,6);this.h(n,3);this.h(n,15);this.h(n,9);for(var t=0;t<n.d.length;t++)this.f.b(n.d[t]);this.f.q(1);var i=n.d[0];i?_js.Trace.logInfo(_mcp.s.a,"Completed added affordance items to compose commanding bar"):_js.Trace.logWarning(_mcp.s.a,"Affordance menu item at index 0 is null.")},h:function(n,t){var r=null;var i=this.bb.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_js.Trace.logInfo(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.c());i.c()||i.g();r=i;n.i(r.A())}},i:function(n,t){if(!this.f.bC(n)){n.a(!0);n.b(t);this.f.b(n)}},M:function(n,t){var i=!this.bb.a.bN;this.O(i)},O:function(n){if(this.f)for(var r=this.f.c.y.length,t=0;t<r;t++){var i=this.f.c.y[t];i&&i.h!==1&&i.a(n)}},z:function(n){this.f&&this.f.bC(this.w())&&this.w().b(n)},L:function(n,t){this.ba.bb().rpcl("IsInitialized",this.t);var i=this;_js.g.a().c(_a.a.a,"AddAffordanceMenuItemsToComposeCommandingBar",function(){i.f&&i.f.c?i.y():_js.Trace.logInfo(i.bd(),"OnInitializerComponentPrimaryInitCompleted - commanding bar or its item collection is null, skipping affordance async init.")})}};_mcp.v=function(n,t,i,r){this.y=Function.createDelegate(this,this.M);this.D=Function.createDelegate(this,this.N);this.v=Function.createDelegate(this,this.J);this.E=Function.createDelegate(this,this.x);_mcp.v.initializeBase(this,[3,n,i,r]);this.I=t;this.k=!1};_mcp.v.b=function(n,t){return new _y.h(n,t)};_mcp.v.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.v.prototype={I:null,p:null,j:null,o:null,l:null,n:!1,r:null,i:null,m:null,b:function(){return"IsIrmProtected"},h:null,f:null,a:function(){return this.n},q:function(n){if(this.n!==n){this.n=n;this.bk("IsIrmProtected")}return n},e:function(){return this.r},L:function(n){if(this.r!==n){this.r=n;this.bk("ShowIrmInformationCommand")}return n},d:function(){return this.i},K:function(n){if(this.i!==n){this.i=n;this.bk("DialogViewModel")}return n},k:!1,u:function(){var i=_g.a.a();if(!$a(i.e())&&!i.e().bh.Irm||this.bu.c()){_js.Trace.logInfo(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.bb.a.N.y();var t=!n||!!n.a()||n.b()||n.m();_js.Trace.logInfo(_a.a.a,"CanSetCompliance={0}",t);return t},w:function(){return!this.bc.N()&&this.u()&&!this.ba.V()},g:function(){var n=this.ba;var u=n.N;var o=n.dx;var r=n.Y;if(this.u())if(_g.j.b){_js.Trace.logInfo(_a.a.a,"Checking main window for compliance configuration");this.f=_mcp.v.a;_g.j.b.hX(this.E)}else if(r.WasLoadedFromServer)this.x(r);else{_js.Trace.logInfo(_a.a.a,"Adding the loading permissions menu item");this.f=_mcp.v.a;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.S;e.b(_a.cI,this.v);var s=new _h.cp(r,n.S);s.d()}}else if(this.f&&this.k&&o.a){n.dx.t(this.f);this.k=!1}var t=u.y();this.q(!!t&&!t.a());if(this.n&&"Mouse"===_y.c.a.a()){var i=n.bd();i.a.apply(i,[4499].concat([t.bh.TemplateName,t.bh.TemplateDescription]));i.a.apply(i,[4500].concat([t.bh.ContentOwner]))}else if(u.bw()){var f=n.bd();f.a.apply(f,[3800].concat([u.cF(),u.cG()]))}"Mouse"===_y.c.a.a()||this.r||this.L(new _C(this.D,this.bd()));_mcp.k.prototype.g.call(this)},bh:function(){this.q(!1);_mcp.k.prototype.bh.call(this)},bw:function(){if(this.w()){!this.h&&this.ba.Y.WasLoadedFromServer&&this.t();if(this.h){this.j=new _fm.k(_nbs.a.kQ,null,this.h);return[this.j]}else if(this.u()&&this.ba.Y.IsLoadingFromServer){this.j=new _fm.k(_nbs.a.kQ,null,null);this.j.a(!0);this.p=new _fm.d(_u.P.b,null,null);return[this.p,this.j]}else _js.Trace.logWarning(_a.a.a,"Compliance sub-menu creation has been skipped.")}return null},bv:function(){if(this.w()){var n=this;this.l=new _fm.m(_nbs.a.kQ,function(t){t(n.h)},1,null,!1,!1,null,!1);if(this.h)return[this.l];else if(this.u()&&this.ba.Y.IsLoadingFromServer){this.l.a(!1);this.o=_mcp.k.a(null,_u.P.b);return[this.l,this.o]}}return null},br:function(){if(this.w())return[this.f];else{this.k=!1;return null}},bE:function(){this.o&&this.o.a(!1);if(!this.h&&this.ba.Y.WasLoadedFromServer){this.t();this.h||(this.l=null)}this.l&&this.l.a(!0)},bB:function(){this.p&&this.p.a(!0);if(!this.h&&this.ba.Y.WasLoadedFromServer){this.t();this.h||(this.j=null)}if(this.j){this.j.D(this.h);this.j.a(!1)}},ce:function(){this.f&&this.ba.dx&&this.ba.dx.t(this.f);this.f=null;this.k=!1;this.t()},H:function(n){var t=this.bb.a.Y;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_js.Trace.logInfo(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.p,new _C(this.y,this.bd()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _C(this.F(c.Id),this.bd()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _C(this.G(l.Id),this.bd()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _C(this.F(s.Id),this.bd()));r++}else{i[f++]=n(h.Name,new _C(this.G(h.Id),this.bd()));u++}}return i},t:function(){if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){var i=this.H(_mcp.v.c);i&&(this.h=new _fm.f(i))}else if(!this.k){if(!this.f){var t=this.H(_mcp.v.b);t&&(this.f=new _y.h(_nbs.a.kQ,null,t))}var n=this.ba.dx;if(this.f&&n){var r=n.a;if(r){this.cd=[this.f];this.ba.D().b();this.k=!0}}}},J:function(n){var t=this.bb.a;this.x(t.Y);t.S.c(_a.cI,this.v)},x:function(n){var t=this.ba;t.Y=n;_js.Trace.logInfo(_a.a.a,"Updating menu with complete compliance configuration.");n.WasLoadedFromServer&&this.bp()},M:function(){var i=this.bb.a;var n=i.N;i.U().a(_mcp.R.toString(0));_js.Trace.logInfo(_a.a.a,"Set no restriction");n.bL("0");var t=i.bd();if($a(n.y())){if(n.bw()){t.b(3800);n.bO(!1);n.bI(null);n.bJ(null);n.bK(null)}}else{if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.bQ(null);this.q(!1)}},G:function(n){var t=this;return function(){var h=_a.d.b(_a.a.a,"MailComposeSetIRM",!0);var e=t.bb.a;var r=e.N;r.bL(n);if(r.bw()){e.O.b(3800);t.ba.Q();r.bO(!1);r.bI(null);r.bJ(null);r.bK(null)}for(var s=e.Y.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.U().a(c);var i=new _g.cO;i.v(n);i.r(_g.a.a().c().bh.UserEmailAddress);i.t(!0);i.u(0);i.y(u.Name);i.w(u.Description);i.q(r.e());r.bQ(i);if("Mouse"===_y.c.a.a()){var f=e.bd();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bh.ContentOwner]))}t.q(!0);_js.Trace.logInfo(_a.a.a,"Set IRM {0}",u.Name);break}}_a.d.a(h)}},F:function(n){var t=this;return function(){var u=t.bb.a;var r=u.N;r.bL(n);if(!$a(r.y())&&"Mouse"===_y.c.a.a()){var s=u.bd();s.b(4499);s.b(4500);r.bQ(null);t.q(!1)}for(var o=u.Y.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.U().a(h);r.bO(!0);r.bI(i.Name);r.bJ(i.Description);r.bK(i.Id);var e=u.bd();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.a.a,"Set class {0}",i.Name);break}}}},N:function(){var t=this.bb.a.N;if(t.y()){var n=t.y();this.O(n.bh.TemplateName,n.bh.TemplateDescription,n.bh.ContentOwner)}else _js.Trace.logError(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},O:function(n,t,i){if($a(this.i)){this.K(new _bc.i);this.i.h.a(new _ff.f(this.i.j,_nbs.a.Qy,null,!0))}this.i.k(n);$a(this.m)&&(this.m=new _mcp.U);this.m.d(t);this.m.c(String.format(_nbs.a.mC,i));this.i.m(this.m);this.i.g(!0)}};_mcp.bh=function(n,t){_mcp.bh.initializeBase(this);this.dn=n;this.bb=t;if(t&&t.a){this.ba=t.a;this.bc=this.ba.N;this.by=this.ba.O}};_mcp.bh.prototype={dn:0,bb:null,ba:null,bc:null,by:null,cN:!1,c:function(){return this.cN},bK:function(n){this.cN=n;return n},bd:function(){return _a.a.a},g:function(){this.bK(!0)},bh:function(){this.bK(!1)},cl:function(n){var t=this.cc(n);this.ba.da(t);if(t===55||t===50){var i=this;this.ba.bJ.a(function(n){n.a(i.by);i.ba.Q()})}else this.ba.Q()},cb:function(n){this.by.h(n);this.ba.Q()},dm:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.by).f.apply(r,[t,n].concat(u));this.ba.Q()},bI:function(){this.by.H();this.by.e(_mcp.B.a);this.by.e(_mcp.x.a);this.by.e(_mcp.r.b);var n=this;this.ba.bJ.a(function(t){t.b(n.by);n.ba.Q()})},cc:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.bj=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){this.f=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bi(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g);this.a=n};_mcp.bj.prototype={c:null,e:null,a:null,b:function(n){var t=n;$a(this.c[t])&&(this.c[t]=this.e.v(n,this.a.bc.a()));return this.c[t]},n:function(){this.d(this.g)},k:function(){_js.Trace.logInfo(_a.a.a,"Component Map Reset start.");this.d(this.h,!0);_js.Trace.logInfo(_a.a.a,"Component Map Reset end.")},r:function(){_js.Trace.logInfo(_a.a.a,"Component Map set override start.");this.d(this.i);_js.Trace.logInfo(_a.a.a,"Component Map set override end.")},m:function(){_js.Trace.logInfo(_a.a.a,"Component Map clear override start.");this.d(this.f);_js.Trace.logInfo(_a.a.a,"Component Map clear override end.")},d:function(n,t){if($a(t)||!t)for(var r=0;r<this.c.length;r++)this.j(n,r);else for(var i=this.c.length-1;i>=0;i--)this.j(n,i)},j:function(n,t){var i=this.c[t];$a(i)||n(i,t)},o:function(n,t){IMailComposeInitializerComponent.isInstanceOfType(n)||n.c()||n.g()},p:function(n,t){var i=Object.getType(n).getName();if(n.c()){_js.Trace.logInfo(_a.a.a,"Reset {0} at index {1}",i,t);n.bh()}else _js.Trace.logInfo(_a.a.a,"Skip uninitialized {0} at index {1}",i,t)},q:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.M()},l:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.L()}};_mcp.bk=function(n,t,i,r){this.l=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.p);_mcp.bk.initializeBase(this,[15,n,i,r]);this.i=t};_mcp.bk.prototype={a:null,d:null,e:null,b:null,h:null,f:null,i:null,g:function(){this.d||(this.d=new _C(this.k,this.bd()));this.a||(this.a=new _C(this.j,this.bd()));_mcp.k.prototype.g.call(this)},bw:function(){if(this.ba.V())return null;this.e=new _fm.d(_nbs.a.ZL,null,this.d);this.b=new _fm.d(_nbs.a.bH,null,this.a,!0);this.bp();return[this.e,this.b]},bv:function(){this.h=_mcp.k.a(this.d,_nbs.a.ZL);this.f=_mcp.k.a(this.a,_nbs.a.bH);this.bp();return[this.h,this.f]},br:function(){return null},bB:function(){if(this.b&&this.e){this.b.a(this.bc.e()==="HTML");this.e.a(this.bc.e()!=="HTML")}},bE:function(){this.f.a(this.bc.e()!=="HTML");this.h.a(this.bc.e()==="HTML")},p:function(){_js.Trace.logInfo(this.bd(),"User chose to convert to plain text");this.bb.a.U().a("SwitchToPlain");if(this.n(_nbs.a.OT)){this.bb.a.N.bY().a();var r=this.bb.a.N.K();var n;var i,t;var f=(t=_a.u.e(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.bd(),"Using html due to failed conversion")}if(n.length>0){var u=this.bb.a.W;u.b(1,[_nbs.a.Uo],this.l,!1,null,null,null,this.i,null)}else this.m()}},q:function(n,t){n&&this.m()},m:function(){var n=this.bb.b(5);n.l(!1);n.k(!1);n.a()&&n.a().bX();this.bb.a.N.m("Text");this.bp();_js.Trace.logInfo(this.bd(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},o:function(){_js.Trace.logInfo(this.bd(),"User chose to convert to html");this.bb.a.U().a("SwitchToHTML");if(this.n(_nbs.a.Pf)){var t=this.bb;var r=t.a;var i=r.N;i.m("HTML");this.bp();var n=this.bb.b(5);n.l(!0);n.k(!0);_js.Trace.logInfo(this.bd(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},n:function(n){_js.Trace.logInfo(this.bd(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.bb.a.N.g()){this.bb.a.W.a(0,n,null);_js.Trace.logInfo(this.bd(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.bb.a.N.R()){this.bb.a.W.a(0,n,null);_js.Trace.logInfo(this.bd(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.bb.b(5);if(t.a()&&t.a().r()){this.bb.a.W.a(0,_nbs.a.Yo,null);_js.Trace.logInfo(this.bd(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.y=function(n){_mcp.y.initializeBase(this,[16,n])};_mcp.y.prototype={a:function(){return this.ec(_mcp.y.a)},e:function(n){this.eb(_mcp.y.a,n);return n},g:function(){if(this.c()){_js.Trace.logInfo(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}var n=this.d();if(n&&n.d.length>0){_js.Trace.logInfo(_a.a.a,"Creating context menu items.");this.e(new _fm.f(n.h()))}_mcp.bh.prototype.g.call(this)},d:function(){var n=new _ff.d;if("Mouse"===_y.c.a.a()){this.b(n,7);this.b(n,8);this.b(n,11);this.b(n,1);this.b(n,29);this.b(n,6);this.b(n,3);this.b(n,15);this.b(n,9);this.b(n,2)}return n},b:function(n,t){var r=null;var i=this.bb.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_js.Trace.logInfo(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.c());i.c()||i.g();r=i;n.i(r.C())}}};_mcp.bl=function(n){_mcp.bl.initializeBase(this,[n])};_mcp.bl.prototype={d:function(){var n=new _ff.d;if("TouchNarrow"===_y.c.a.a()){var t;var f=this.ba.T();var i=f.j();if(i)if(i.d.length>1){t=new _fm.k(_nbs.a.cd,null,new _fm.f(i.d));n.c(t)}else if(i.d.length===1){var u=i.d[0].k;t=new _fm.d(_nbs.a.cd,null,u);n.c(t)}var r=this.ba.bg();t=new _fm.d(_u.P.h,null,r.b());n.c(t);this.b(n,11);this.b(n,1);this.b(n,29);this.b(n,6);this.b(n,3);this.b(n,9)}return n}};_mcp.w=function(n,t,i,r,u){_mcp.w.initializeBase(this,[n,t,i,r,u]);this.R=!!i&&i.a().bF().Enabled};_mcp.w.prototype={R:!1,Q:null,v:null,I:!1,P:!1,k:function(){return this.P},cp:function(n){this.P=n;return n},m:function(){this.v||this.ck();return this.v},cj:function(){return this.k()&&this.q>0},g:function(){this.cp(this.R&&_y.c.a.a()==="Mouse"&&!this.ba.bo()&&!this.bc.A());_mcp.x.prototype.g.call(this)},bw:function(){if(this.k()&&this.ba.V()){this.Q=new _fm.k(_u.R.EZ,null,new _fm.f(this.m()));return[this.Q]}return null},bv:function(){return null},br:function(){return null},bB:function(){this.k()&&this.bg()},N:function(){this.I=!1;if(this.cj()&&!this.bN()){_js.Trace.logInfo(_a.a.a,"Queueing delayed async send.");this.co();this.I=!0}else{_js.Trace.logInfo(_a.a.a,"Submitting send action with no delay.");_mcp.x.prototype.N.call(this)}},co:function(){var n=this;_js.g.a().c(_a.a.a,"QueueAsyncSend",function(){_js.Trace.logInfo(_a.a.a,"Firing optimistic save for delayed send.");n.ba.d().a("Save",function(){_js.Trace.logInfo(_a.a.a,"Optimistic save for delayed send succeeded.")},function(){_js.Trace.logError(_a.a.a,"Optimistic save for delayed send failed! Continuing with delayed send anyway...")},!0);n.bc.Z()?_h.d.K(n.bc.Z(),!0):_js.Trace.logInfo(n.bd(),"QueueAsyncSendWithDelay - there is no draft to update as submitted.");var t=new _mcp.bE(n.q,n.bc,function(){_mcp.x.prototype.N.call(n);n.ba.bu.a(function(){n.p.a(ISendEvent,new _mcp.bb(n.ba))})});n.p.a(IDelayedSendEvent,t)})},ca:function(){if(this.I)_js.Trace.logInfo(_a.a.a,"Skipping firing send event for delayed async send.");else{_js.Trace.logInfo(_a.a.a,"Firing send event for immediate async send.");this.bS()}},ck:function(){var t=_mcp.w.a.length;this.v=new Array(t);for(var n=0;n<t;n++){var i=_mcp.w.a[n];this.v[n]=this.ci(i)}},ci:function(n){var r=n>0?_js.d.c(_u.R.VE,n.toString()):_u.R.o;var u=n===this.q?_b.d.d():null;var t=this;return new _fm.d(r,u,new _C(function(){var i=t.q;if(n!==i){t.q=n;t.cq();t.bg()}},this.bd()))},bg:function(){for(var t=_mcp.w.a.length,n=0;n<t;n++)this.q===_mcp.w.a[n]?this.v[n].v(_b.d.d()):this.v[n].v(null)},cq:function(){if(this.k()){var n=this.ba.O;n.b(1002);this.q>0&&n.a(1002,this.q.toString())}}};_mcp.z=function(n){this.x=Function.createDelegate(this,this.G);this.z=Function.createDelegate(this,this.u);this.y=Function.createDelegate(this,this.E);this.w=Function.createDelegate(this,this.D);this.A=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.N);_mcp.z.initializeBase(this,[19,n]);this.t=new _C(this.C,this.bd());this.r=new _C(this.A,this.bd());this.o=n.a.bs};_mcp.z.prototype={t:null,r:null,o:null,n:null,m:null,q:!1,p:!1,a:function(){return this.t},i:function(){return this.r},j:function(){return this.n},I:function(n){if(n!==this.n){this.n=n;this.bk("DiscardConfirmDialogButtonData")}return n},H:function(n){if(n!==this.m){this.m=n;this.bk("CloseConfirmDialogButtonData")}return n},k:function(){return this.q},l:function(n){if(n!==this.q){this.q=n;this.bk("IsDiscardConfirmDialogShown")}return n},v:function(n){if(n!==this.p){this.p=n;this.bk("IsCloseConfirmDialogShown")}return n},h:function(){var i=this.bb;var t=i.a;var n=t.N;t.U().a("Discard");if(n.a()||!n.a()&&(n.h()||t.d().b())){_js.Trace.logInfo(_a.a.a,"Discard");this.F(n.b(),n.h())}},b:function(n,t){if(this.o.a(n)){_js.Trace.logInfo(_a.a.a,"Resuming discard of {0}",_h.bh.a(t));this.F(n,t)}else _js.Trace.logInfo(_a.a.a,"User had already discarded.")},f:function(){if(!this.bc.ep)return!0;_js.Trace.logInfo(_a.a.a,"Comparing initial baseline to baseline. Context:{0}",this.bc);if(!this.bc.ep.s(this.bc.en()))return!0;_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.ba.bt()?!0:this.bc.bZ()?!0:!1},d:function(n){this.bt("IsDiscardingCompose",n)},e:function(n){this.bJ("IsDiscardingCompose",n)},L:function(){_js.Trace.logInfo(_a.a.a,"Checking dirty before showing discard confirmation.");return this.ba.bt()?!0:!1},F:function(n,t){this.E();var i=this.bb.a;var r=i.N.ce()||i.N.bZ();this.o.b(n,t,i.X,r)},N:function(){var t=this.bb.a;var n=t.N;_js.Trace.logInfo(_a.a.a,"User chose to discard");if(this.f()){this.K();_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:{0}",n);this.l(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:{0}",n);this.D()}},M:function(){var t=this.bb.a;var n=t.N;_js.Trace.logInfo(_a.a.a,"User chose to close");if(this.L()){this.J();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog. Context:{0}",n);this.v(!0)}else{_js.Trace.logInfo(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away. Context:{0}",n);this.u()}},E:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:{0}",this.bb.a.N);this.l(!1)},G:function(){_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog. Context:{0}",this.bb.a.N);this.v(!1)},K:function(){if($a(this.n)){_js.Trace.logInfo(_a.a.a,"Creating discard confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.w,this.bd()),_u.R.Ik,_u.R.VB,!0));n.a(new _ff.f(new _C(this.y,this.bd()),_u.R.fH,_u.R.at));this.I(n)}},J:function(){if($a(this.m)){_js.Trace.logInfo(_a.a.a,"Creating close confirm dialog.");var n=new _js.f;n.a(new _ff.f(new _C(this.z,this.bd()),_u.R.dS,_u.R.cx,!0));n.a(new _ff.f(new _C(this.x,this.bd()),_u.R.KT,_u.R.at));this.H(n)}},D:function(){_js.Trace.logInfo(_a.a.a,"Discard and close");this.h();this.u();this.ba.P().o("Discard")},u:function(){this.bc.eK(null);this.ba.b().a(this.ba,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from compose");this.cg("IsDiscardingCompose")}};_mcp.bm=function(n,t){this.j=Function.createDelegate(this,this.e);this.h=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.o);_mcp.bm.initializeBase(this,[25,n]);this.f=t;this.l=new _C(this.m,_a.a.a);var i=n.a.N;i.dq(this.l)};_mcp.bm.prototype={l:null,f:null,i:!1,k:null,b:function(){return this.k},a:function(n){this.k=n;this.bk("EditorCallContext");return n},e:function(){this.a(new _cmc.x)},g:function(){if(!this.i){this.q();this.i=!0;_g.a.a().b().F(this.h);_g.a.a().b().Y(this.h)}_mcp.bh.prototype.g.call(this)},bh:function(){this.r();this.i=!1;_g.a.a().b().N(this.h);_g.a.a().b().bd(this.h);_js.Trace.logInfo(_a.a.a,"Editor component reset.");_mcp.bh.prototype.bh.call(this)},d:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().cU();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_js.d.b(t)?"<P><BR></P>":_a.u.f+t+_a.u.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_js.d.b(t)?"\r\n":t;return i},o:function(){this.a(new _cmc.c(!1))},p:function(n,t){this.e()},q:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_js.m.b(n);var i=this;r.c("resize",function(n){i.e()},"MCEditorComponent")}}catch(u){var t=this.n(this.f);_js.Trace.logException(this.bd(),u,"Projection window dump: {0}",t)}else _y.c.a.o(this.j)},r:function(){if(this.f){var n=_js.m.b(this.f);n.e("resize","MCEditorComponent")}else _y.c.a.r(this.j)},n:function(n){var t="";for(var i in n)t=t+i+",";return t}};_mcp.bn=function(n){_mcp.bn.initializeBase(this,[n,null])};_mcp.bn.prototype={e:function(){}};_mcp.bp=function(n,t,i,r){this.k=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.u);this.j=Function.createDelegate(this,this.r);_mcp.bp.initializeBase(this,[6,n,i,r]);this.n=t};_mcp.bp.prototype={b:null,d:null,h:!1,e:!1,i:!1,n:null,o:function(n){if(n!==this.h){this.h=n;this.bk("IsHighImportance")}return n},a:function(){return this.e},q:function(n){if(n!==this.e){this.e=n;this.bk("IsNormalImportance")}return n},p:function(n){if(n!==this.i){this.i=n;this.bk("IsLowImportance")}return n},g:function(){var i=this.bb.a.N.ba();this.f(i);_js.Trace.logInfo(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){if(!this.b){var t=this.m(_mcp.k.b);t&&(this.b=new _fm.f(t))}}else if(!this.d){var n=this.m(_mcp.k.c);n&&(this.d=new _y.h(_nbs.a.eb,null,n))}_mcp.k.prototype.g.call(this)},bw:function(){var n=new _fm.k(_nbs.a.eb,null,this.b);return[n]},bv:function(){var t=this;var n=new _fm.m(_nbs.a.eb,function(n){n(t.b)},1,null,!1,!1,null,!1);return[n]},br:function(){return[this.d]},r:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets high importance");this.f("High");this.bb.a.U().a("Importance:High");_a.d.a(n)},u:function(){_js.Trace.logInfo(_a.a.a,"User sets normal importance");this.f("Normal");this.bb.a.U().a("Importance:Normal")},t:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_js.Trace.logInfo(_a.a.a,"User sets low importance");this.f("Low");this.bb.a.U().a("Importance:Low");_a.d.a(n)},f:function(n){this.bb.a.N.dt(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},m:function(n){return[n(new _C(this.j,this.bd()),_nbs.a.WI),n(new _C(this.l,this.bd()),_nbs.a.MG),n(new _C(this.k,this.bd()),_nbs.a.Zf)]}};_mcp.br=function(n,t,i){this.O=Function.createDelegate(this,this.bR);this.x=Function.createDelegate(this,this.bS);this.W=Function.createDelegate(this,this.bO);this.be=Function.createDelegate(this,this.ci);this.V=Function.createDelegate(this,this.bD);this.y=Function.createDelegate(this,this.br);this.J=Function.createDelegate(this,this.bz);this.I=Function.createDelegate(this,this.bx);this.K=Function.createDelegate(this,this.bA);this.L=Function.createDelegate(this,this.bB);this.M=Function.createDelegate(this,this.bC);this.N=Function.createDelegate(this,this.bG);this.T=Function.createDelegate(this,this.bi);this.X=Function.createDelegate(this,this.ca);this.U=Function.createDelegate(this,this.bw);this.Y=Function.createDelegate(this,this.cd);this.Z=Function.createDelegate(this,this.ce);_mcp.br.initializeBase(this,[24,n]);this.m=_h.t.c(t);this.R=i;this.S=_a.UserAgent.getInstance();this.A=t;_b.i.c()||this.bp(!1)};_mcp.br.prototype={o:null,C:null,m:!1,G:!1,F:!1,H:null,E:null,z:null,w:null,u:null,D:null,R:null,l:null,p:null,r:null,t:null,S:null,q:null,A:null,v:null,bp:function(n){if(n!==this.m){this.m=n;this.bk("IsLinkPreviewEnabled")}return n},bT:function(n){if(n!==this.o){this.o=n;this.cf()}return n},bE:function(){this.D||(this.D={});return this.D},bV:function(n){this.C=n;this.bk("LinkPreviewResponse");this.C&&this.l&&this.bf(this.C,this.l.bN());return n},bY:function(n){if(n!==this.w){this.w=n;this.w&&_h.t.a(this.w,null,this.Z,null,null)}return n},bW:function(n){if(n!==this.u){this.u=n;this.u&&_h.t.a(this.u,null,this.Y,null,null)}return n},e:function(){return this.G},i:function(n){if(this.G!==n){this.G=n;this.bk("ShowYouTubePlayer")}return n},d:function(){return this.F},h:function(n){if(this.F!==n){this.F=n;this.bk("ShowOEmbedVideoPlayer")}return n},f:function(){return this.H},bZ:function(n){this.H=n;this.bk("YouTubePlayerUrl");return n},b:function(){return this.E},bq:function(n){this.E=n;this.bk("OEmbedVideoPlayerHtml");return n},a:function(){this.z||(this.z=new _C(this.U,_a.a.e));return this.z},cf:function(){if(_h.t.b){_js.Trace.logInfo(_a.a.e,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.o.Url);this.bi();return}if(this.o){var i=1;var r=_a.d.b(_a.a.e,"GetComposeLinkPreview");var n=[];Array.add(n,this.o);_js.Trace.logInfo(_a.a.e,"Preparing GetLinkPreview action for {0}",this.o.Url);this.o.Autoplay=!0;var u=new _h.t(this.o);_js.Trace.logInfo(_a.a.e,"Submitting GetLinkPreview action for {0}",this.o.Url);var t=this,f=this;this.bb.a.X.a(u,function(u){_h.t.k(u,t.X,t.T,i,r,"GetComposeLinkPreview",n)},function(t){_h.t.h(t,i,r,"GetComposeLinkPreview",n)},null)}},ca:function(n){this.bV(n)},bi:function(){this.bp(!1);this.l&&(this.l.de=!1)},ce:function(n){this.bZ(n);this.i(!!this.H)},cd:function(n){var t=this.p.b(n);t?this.bq(t):this.bq(n);this.h(!!this.E)},bw:function(){this.h(!1)},j:function(n){n.r(this.N);n.b(this.M);n.a(this.L);n.c(this.K);n.p(this.I);n.q(this.J)},k:function(n){n.v(this.N);n.e(this.M);n.d(this.L);n.f(this.K);n.t(this.I);n.u(this.J)},bL:function(n){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var r="a[id^='"+t+"']";var i=$(n);return _b.i.a(n.id,t)||i.find(r).length>0},bH:function(n){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var r=$(n);var i="a[id^='LPlnk']";t=_b.i.a(n.id,"LPlnk")||r.find(i).length>0;!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.i.a(n.parentNode.id,"LPlnk"));return t},bG:function(n){var i=n.c();var t=n.d();if(_zz.h.isInstanceOfType(t))this.l=t;else{_js.Trace.logError(_a.a.e,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}this.bs(i)},bs:function(n){if(n&&this.m){if(this.bL(n)||this.bH(n))return;if(_b.i.e(n.id))return;if(n.href.toLowerCase().startsWith("https")){n.id=_b.i.f();_js.Trace.logInfo(_a.a.e,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.ch(n.id,n.href)}}},bA:function(n){var t=n.d();if(_zz.h.isInstanceOfType(t))this.l=t;else{_js.Trace.logError(_a.a.e,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.P(n.c())},bx:function(n){n.c()===1&&this.bu(n.e())},bz:function(n){this.P(n.c())},bC:function(n){var t=n.c();this.bv(t)},bB:function(n){var t=n.c();this.P(t)},ch:function(n,t){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview requests because previews are disabled");return}_js.Trace.logInfo(_a.a.e,"RTE: Trigger link preview request for {0}",t);var i=new _g.dO;i.Id=n;i.Url=t;i.RequestStartTimeMilliseconds=_a.c.a().h();this.br(i)},bf:function(n,t){_js.Trace.logInfo(_a.a.e,"Adding link preview for {0}",n.Url);var i=!1;_h.t.d(n)&&(i=!0);if(!this.n()){this.r=n;this.t=t;this.p&&this.bo();return}if(i){this.n().g(this.y);return}if(this.l&&this.l.P()&&this.l.Z){this.l.bx(!0);this.n().c(n,this.y,t,this.V);this.l.bp(3);this.l.bS()}else _js.Trace.logInfo(_a.a.e,"Ignore AddLinkPreview since the editor isn't active or initialized")},n:function(){if(!this.p){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: Create LinkPreviewBuilder");var t=!0;var n=this;this.R.a(function(i){n.p=i.a(n.be,n.W,t,_y.c.a,n.A);n.p.a(n.bE());n.bo()})}return this.p},ci:function(n){this.bY(new _a.bW(new _a.bi(n)))},bO:function(n){this.bW(new _a.bW(new _a.bi(n)))},bo:function(){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: LinkPreviewBuilderFactoryOnOnCreated");if(this.r&&this.t){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: There was a deferred AddLinkPreview. Calling it now");this.bf(this.r,this.t);this.r=null;this.t=null}if(this.q){_js.Trace.logInfo(_a.a.e,"LinkPreviewBuilder: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bm(this.q);this.q=null}},bm:function(n){this.q=n;var s=!1;var o=!1;if(this.n())this.q=null;else return;for(var u=0;u<n.length;u++){var i=n[u];if(_b.i.a(i.id,"LPUrlAnchor")){var t;var h,f;if(f=this.n().m(i,h={val:t}),t=h.val,f){var l=this.v+"[id^='LPRemovePreview']";var c=$(t).find(l);if(c.length>0){_js.Trace.logInfo(_a.a.e,"Remove preview button already added. Skipping preview initialization.");return}this.Q(t);var r=!1;var e;this.n().i(t,e={val:r}),r=e.val;if(r){this.n().h(i);s=!0}this.bg(t)}}else if(!o){this.bs(i);o=!0}}s&&this.n().g(this.y)},br:function(n){this.bT(n)},bD:function(n){this.bg(n);var t=n;if(this.S.a()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.Q(t);return t},bg:function(n){this.A.a().Y().Enabled?this.bN(n):this.bQ(n)},bQ:function(n){var t=window.document.createElement("div");t.id="LPRemovePreview";this.v=t.tagName;t.setAttribute("unselectable","on");var i=$(t);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");t.style.textAlign="right";i.text(_nbs.a.WX);t.style.width=n.children[0].style.width;t.style.fontSize="13px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#000000";t.style.cursor="pointer";i.one("click",this.x);n.appendChild(t)},bN:function(n){var t=window.document.createElement("a");t.id="LPRemovePreview";this.v=t.tagName;t.style.fontSize="12px";t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.color="#333333";t.style.fontWeight="normal";t.style.position="relative";t.style.cssText+="float: right";var i=$(t);t.style.cursor="pointer";i.one("click",this.x);i.text(_nbs.a.WX);i.css("-moz-user-select","none");i.css("-khtml-user-select","none");i.css("-webkit-user-select","none");i.css("-ms-user-select","none");var f=$(n);var r=f.find("td[id^='LPRemovePreviewContainer']");if(r.length>0){var u=r.get(0);u.appendChild(t)}},Q:function(n){_js.Trace.logInfo(_a.a.e,"InitializePreviewForEditor: InitializePreviewForEditor.");n.setAttribute("contenteditable",!1);var t=$(n);t.bind("click",this.O)},bj:function(n){for(var r=[],i=n.getElementsByTagName(this.v),t=0;t<i.length;t++)i[t].id==="LPRemovePreview"&&Array.add(r,i[t]);return r},bS:function(n){var r=_a.d.b(_a.a.e,"RemoveLinkPreviewClickEvent");if(!this.l){_js.Trace.logError(_a.a.e,"RemovePreviewClicked: editor was null");return}this.l.cG(n);var h=n.target;var f=_b.i.b(h);var l=this.l.cP();if(f){var t=new _a.q;var c=20;var u=$(f).find("[id^='LPBorder']");if(u){var i=null;if(u.length===1){var o=u[0];i=o.getAttribute("id")}else if(u.context){var s=u.context;i=s.getAttribute("id")}i&&(i.startsWith("LPBorder_YT")?t.b("T","Y"):i.startsWith("LPBorder_VT")?t.b("T","V"):i.startsWith("LPBorder_PT")?t.b("T","P"):i.startsWith("LPBorder_BVT")?t.b("T","BV"):t.b("T","G"))}var e=_b.i.h(f);e&&t.b("U",_h.t.f(e.href,c));r.j=t.toString();r.j.length<1;this.l.nF(f);_a.d.a(r)}else if(r){r.k="NullPreview";_a.d.a(r)}},bv:function(n){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var r=this.bj(n),u=0;u<r.length;u++){var f=r[u];var t=_b.i.b(f);if(t){t.removeAttribute("contenteditable");var i=$(t);i.unbind("click",this.O);$(f).remove();this.n().k(i);this.n().j(i)}}return r.length>0},P:function(n){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is text node");return}var t=n.getElementsByTagName("A");this.bm(t)},bu:function(n){if(!this.m){_js.Trace.logInfo(_a.a.e,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var u=this.bj(n),t=0;t<u.length;t++){var r=u[t];var i=_b.i.b(r);if(i){this.Q(i);var f=$(r);f.one("click",this.x)}}},bR:function(n){if(!this.l){_js.Trace.logError(_a.a.e,"PreviewClicked: editor was null");return}if(this.l.cP()){var i=n.target.parentNode;var t=_b.i.b(i);if(t){this.l.nQ(t);this.bb.a.S.a(_a.bE,new _a.bE(_nbs.a.Bm+t.textContent.replace(_nbs.a.WX,"")))}}}};_mcp.J=function(n,t){_mcp.J.initializeBase(this,[14,n]);this.e=t};_mcp.J.prototype={e:null,b:null,d:0,a:null,g:function(){_mcp.bh.prototype.g.call(this);this.a=this.j();var n=this.bb.a;this.b=n.bd();this.d=n.N.a();_mcp.f.g(n.N)&&!n.N.by()&&this.n()},n:function(){this.b.e(_mcp.J.a);this.f()},j:function(){var n=this.bb.a.N;var t=n.d()||n.Z();return t&&n.bm()?t:null},m:function(){if(_g.i.isInstanceOfType(this.a))return this.a.y();else if(_g.bh.isInstanceOfType(this.a)){var n=this.a;return n.t().y()==="RecurringMaster"?n.J()?"RecurringMaster":"Occurrence":n.t().y()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},f:function(){if(this.a&&!_g.bs.isInstanceOfType(this.a)){this.b.a(6800);switch(this.m()){case"Occurrence":case"Exception":this.i();break;case"RecurringMaster":this.h();break}}},k:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},l:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},h:function(){var n=this.l(this.d);this.b.a(n)},i:function(){var n=this;this.e.a(function(t){var u=t.a();var r=u.a(n.a,null);var i=n.k(n.d);n.b.a(i,r)})}};_mcp.bq=function(n,t,i,r){this.p=Function.createDelegate(this,this.X);this.q=Function.createDelegate(this,this.Z);this.H=Function.createDelegate(this,this.bp);this.D=Function.createDelegate(this,this.k);this.F=Function.createDelegate(this,this.N);this.E=Function.createDelegate(this,this.Y);this.J=Function.createDelegate(this,this.br);this.I=Function.createDelegate(this,this.bq);this.h=Function.createDelegate(this,this.bf);this.G=Function.createDelegate(this,this.bj);this.r=Function.createDelegate(this,this.bg);this.t=Function.createDelegate(this,this.bm);_mcp.bq.initializeBase(this,[0,n]);this.f=n.a.bs;this.l=t;this.v=i;this.C(!0);this.x=r};_mcp.bq.prototype={f:null,v:null,m:!1,j:!1,o:!1,z:null,A:null,n:null,l:null,x:!1,e:null,c:function(){return _mcp.bh.prototype.c.call(this)},bK:function(n){if(n!==_mcp.bh.prototype.c.call(this)){_mcp.bh.prototype.bK.call(this,n);this.bk("IsInitialized")}this.bb.a.N.dF(n);return n},d:function(){return this.m},S:function(n){if(n!==this.m){this.m=n;this.bk("IsSecondInitializationComplete")}return n},a:function(){return this.j},C:function(n){if(this.j!==n){this.j=n;this.bk("CanLoadPopoutSuccessfully")}return n},T:function(){if(this.e){this.e.a();this.e=null}},g:function(){this.z=_js.e.s(_a.a.a,517,"VM.MailCompose.FirstInit");var i=this.bb.a;var n=i.N;n.apcl("IsEditorInitialized",this.t);n.apcl("IsUpgraded",this.r);this.ba&&this.ba.bl.a().d()&&this.ba.bl.a().d().Enabled&&n.l()===1&&!this.ba.bo()&&!this.ba.V()&&this.ba.S.a(_a.bV,new _a.bV(!1,"NotLoadedByReadingPaneComposeHide"));if(!n.ep&&!n.h()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline, context: {0}",n);n.ep=_mcp.b.b(n);n.ex()||n.ey(!0)}if(n.fb()){_js.Trace.logInfo(_a.a.a,"Finish 1st init for complete context");this.i();_js.Trace.logInfo(_a.a.a,"Check begin upgrade for complete context");this.w()}else{var o=i.X;var r=n.h();var t=n.be();var s=n.gh();if(!r&&s){var e;var u=_g.a.a().c();e=_js.d.a(u.bh.SharePointUrl)?u.bh.UserEmailAddress||"":u.bh.LogonEmailAddress||"";var l=new _gg.bp("StoreId",s,e);var a=new _c.T([l],"EwsId");var v=this;o.a(a,this.G,function(n){v.bi(n)},this.h);_js.Trace.logInfo(_a.a.a,"Calling server to convert id, storeId={0}",s)}else if(r)if(n.ck()&&n.ex()){_js.Trace.logInfo(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.R()}else{_js.Trace.logInfo(_a.a.a,"Load draft {0}",_h.bh.a(r));this.y(r)}else if((4===n.a()||13===n.a())&&n.ex()){_js.Trace.logInfo(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.R()}else if(t){i.O.b(3400);i.O.a(3400,null);if(n.fd()){var f=this;this.v.b(function(i){var u=i.a(t,n.cf());var r=i.b(200,u);r.I=n.b();o.a(r,f.I,function(n){f.Q(n)},f.h);_js.Trace.logInfo(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)})}else{var h=i.bw.f(t);h.I=n.b();var c=this;o.a(h,this.J,function(n){c.Q(n)},this.h);_js.Trace.logInfo(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cs(!0);n.eC(!0);_js.Trace.logInfo(_a.a.a,"Finish 1st init for new mail");this.i()}else{this.k("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.l.b(_y.n,n.a())));}}_js.d.a(_g.a.a().c().bh.SharePointUrl)||i.O.a(110,null)},bh:function(){var t=this.bb.a;var n=t.N;n.rpcl("IsEditorInitialized",this.t);n.rpcl("IsUpgraded",this.r);this.bK(!1);this.S(!1);this.C(!0);this.o=!1;this.T()},b:function(){this.V();this.A=_js.e.s(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.bb;var n=i.a;var r=n.N;_js.Trace.logInfo(_a.a.a,"Queue secondary init task, context:{0}",r);_js.g.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.E);if(n.fL()&&!n.dx.a){var f=i.b(10);_js.Trace.logInfo(_a.a.a,"Queue appbar setup task");var t=f;_js.g.a().c(_a.a.a,"SetupApplicationBarMenu",t.e||(t.e=Function.createDelegate(t,t.b)))}if(r.bv()){_js.Trace.logInfo(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var o=this;_js.g.a().c(_a.a.a,"Diagnostics save:",function(){n.d().a("Diagnostics",null,null,!1)})}if(_a.cw.a){var u=i.b(17);_js.Trace.logInfo(_a.a.a,"Queue GetMailTips if needed task");var e=this;_js.g.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){u.a(32)})}},bp:function(n){var f=_js.e.s(_a.a.a,2,"VM.MailCompose.ProcessDraft");var o=this.bb.a.N;var e=this.ba.be();var i=n;var t=n.I;_js.Trace.logInfo(_a.a.a,"Got draft, checking pending discards for {0}",t);if(this.f.a(t))e.b(t,i.e[0]);else if(t===this.bc.b()){var r=i.b;if(_g.bC.isInstanceOfType(r)){this.bc.da(r);this.u(!0);this.P(i)}else _a.j.a&&r.bw()?this.be(r,i):this.N(r,i);if(_a.bk.a){var u=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=u.bb.b(23);n.a(32)})}}else _js.Trace.logInfo(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",t,this.bc);_js.e.e(f);_js.e.e(this.n)},be:function(n,t){var i=this;this.ba.cu(function(){i.U();i.e.c(n,t)})},U:function(){if(!this.e){_js.Trace.logInfo(_a.a.a,"Setting initializer component override");this.e=this.ba.bF().b();var t=this.ba.ce();var n=t;this.e.b(this.F,n.a||(n.a=Function.createDelegate(n,n.d)),this.D,this.ba.X)}},N:function(n,t){this.bc.cZ(n);this.u(!1);this.P(t)},P:function(n){if(this.bc.ex()&&this.bc.cY()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline for a loaded draft.");this.bc.ep=_mcp.b.b(this.bc)}_js.Trace.logInfo(_a.a.a,"Finish 1st init for a loaded draft.");this.i();var t=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){var n=t.bb.b(23);n.a(32)})},bq:function(n){var u=this.bb;var f=u.a;var t=f.N;var i=n.I;if(i===t.b()&&!this.f.a(i)){var r=n;t.O(r.b());t.cr(!1);_js.Trace.logInfo(_a.a.a,"Got original cal item, finish 1st init with context:{0}",t);this.i();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original cal item");this.w()}},br:function(n){var u=this.bb;var f=u.a;var t=f.N;var i=n.I;if(i===t.b()&&!this.f.a(i)){var r=n;t.O(r.b);_js.Trace.logInfo(_a.a.a,"Got original message, finish 1st init with context:{0}",t);this.i();_js.Trace.logInfo(_a.a.a,"Check begin upgrade on original message item");this.w()}},X:function(n,t){this.ba.b().a(this.bb.a,!1);_js.Trace.logInfo(_a.a.a,"Navigate away on action failure")},bf:function(n){var t=this.bb.a;var i=t.N;if(n.I===i.b()){t.O.b(3400);this.ba.Q()}},i:function(){var o=_js.e.s(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.bb;var f=n.a;var e=f.N;var s=e.a();n.b(7).g();n.b(8).g();n.b(1).g();e.bm()&&n.b(14).g();var t=n.b(11);t.g();if(this.bc.a()!==4&&!this.bc.K()||!this.bc.a()&&this.bc.K()){var i=this.ba.bn().d(this.l.a()&&this.bc.e()==="HTML",this.bc.K());if(t.a()){var u=t.b();u&&(i=i+u)}this.bc.G(i)}var r=_y.c.a.a();if(r!=="Mouse"){if(r==="TouchNarrow"){n.b(5).g();n.b(6).g();n.b(3).g();n.b(9).g();n.b(22).g();n.b(16).g()}n.b(10).g()}else n.b(22).g();_js.e.e(o);_js.e.e(this.z);if(f.bH){_js.Trace.logInfo(_a.a.a,"Finishing primary init, beginning secondary init because we are already in view.");this.b()}this.bK(!0)},Y:function(){var n=this.bb;var i=n.a;var t=i.N;n.b(2);n.b(15);n.b(25);n.b(28);n.n();t.en()||t.fA();this.S(!0);_js.Trace.logInfo(_a.a.a,"Finished secondary init, context:{0}",t);_js.e.e(this.A)},y:function(n){this.n=_js.e.s(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.bb.a;var t=i.N;var e=i.X;if(t.ex()){if(t.cY()){_js.Trace.logInfo(_a.a.a,"Capture initial baseline since message was a clean new message before popout, context: {0}",t);t.ep=_mcp.b.b(t)}t.bn()&&!t.g()&&this.u(!0)}else t.fm(!0);i.O.b(3400);i.O.a(3400,null);t.fc()&&i.O.a(3480);var r=this.l.a()&&t.e()==="HTML"?_h.b.c():_h.b.m();var o="MailCompose";var u=i.bw.f(n,r,o);u.I=t.b();var f=this;e.a(u,this.H,function(n){f.bo(n)},this.h);_js.Trace.logInfo(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.bh.a(n),r.BodyType,_y.c.a.a(),t.e())},u:function(n){if(n!==this.o){var t=this.bb.a.O;t.b(3440);n&&t.a(3440,null);this.ba.Q();this.o=n}},bj:function(n){var i=n;var t=new _g.g(i.e().Id);this.bb.a.N.F(t);this.y(t)},w:function(){var u=this.bb;var n=u.a.N;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.h()||n.g()){if(i&&n.h()&&n.g()&&_a.UserAgent.getInstance().E){var r=this;_js.g.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.ba.Q()},1e3)}}else this.ba.bz().d()},R:function(){var n=this.bb.a.N.b();if(this.x){_js.Trace.logInfo(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.P.b,this.q)}else{_js.Trace.logInfo(_a.a.a,"Calling main window to process save result {0}",n);_g.j.b.getSaveResultForPopout(n,_a.P.b,this.q)}},Z:function(n){var t=this.bb.a.N;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bn()&&!t.g()&&t.cs(!0);this.y(i)}else{_js.Trace.logInfo(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.C(!1);this.k("ErrorSaveFailedOnMainWindow",null,null)}},bm:function(n,t){var r=this.bb.a;var i=r.N;i.eB&&this.W()},bg:function(n,t){var r=this.bb.a;var f=r.N;if(f.g()){var i=this.ba.bz();if(i.b()){var u=r.bB()?r.bB().toString():"";_y.i.a(i.b(),null,null,null,u);i.k(null)}}},W:function(){var t=this.bb.a;var n=t.N;if(n.eQ()){var i=t.bB()?t.bB().toString():"";_y.i.a(n.eQ(),null,"",null,i);n.T(null)}this.K()},k:function(n,t,i){var f=this.bb.a;var r=f.N;if(r.cH()){var u=new _a.q;_js.d.a(i)||u.b("E",i);_y.i.a(r.cH(),null,n,t,this.O(u.toString(),r.cH().j));r.E(null)}if(r.eQ()){_y.i.a(r.eQ(),null,n,t,i);r.T(null)}this.K()},O:function(n,t){var i="";i=_js.d.a(n)?t:_js.d.a(t)?n:n+"|"+t;return i},V:function(){var i=this.bb.a;var n=i.N;if(n.cH()){var t=n.cH().j;i.bB()&&(t=this.O(i.bB().toString(),t));_y.i.a(n.cH(),null,"",null,t);n.E(null)}},K:function(){var i=this.bb.a;var t=i.N;if(t.gj()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.A.endPT(n);t.U(!1)}}},bi:function(n){this.M(n,"ConvertIdAction")},bo:function(n){this.M(n,n.g)},M:function(n,t){var i=this;this.L(n,t,function(t){t.g(n,_nbs.a.Ki,_nbs.a.DA,_nbs.a.Ki,_bms.E.BC,i.p)})},Q:function(n){var t=this;this.L(n,n.g,function(i){i.f(n,t.p)})},L:function(n,t,i){var u=t+"_UnknownError";var s=this.bb;var e=s.a;var h=e.N;var f=n.I;f!==h.b()||this.f.a(f)||i(e.X);var r=u;r=_g.V.a(n.t)?_g.V.b(n.t)||u:n.t.ExceptionName||u;var o=n.t.FaultMessage||n.t.message;_js.e.e(this.n);this.k(r,n.C(),o)}};_mcp.f=function(n,t,i){_mcp.f.initializeBase(this,[4,n]);this.j=t;this.i=i};_mcp.f.f=function(){_mcp.f.b||(_mcp.f.b=new _H("LocationViewModel",ILocationViewModel,_mcp.f));return _mcp.f.b};_mcp.f.e=function(){_mcp.f.a||(_mcp.f.a=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.f));return _mcp.f.a};_mcp.f.g=function(n){switch(n.a()){case 4:return n.by();case 8:case 3:return!0;case 5:case 7:case 6:return!1;default:return!1}};_mcp.f.prototype={j:null,i:null,h:null,a:function(){return this.ec(_mcp.f.c)},l:function(n){this.eb(_mcp.f.c,n);return n},e:function(){return this.ec(_mcp.f.d)},f:function(n){this.eb(_mcp.f.d,n);return n},b:function(){return this.ec(_mcp.f.f())},m:function(n){this.eb(_mcp.f.f(),n);return n},k:function(){return this.ec(_mcp.f.e())},n:function(n){this.eb(_mcp.f.e(),n);return n},d:function(){return this.h},o:function(n){if(n!==this.h){this.h=n;this.bk("MeetingCalendarTimePeriod")}return n},g:function(){var n=this.bb.a.N;var i=this.bb.a.cP;if(n.ca()){var e=this;this.j.a(function(t){e.m(t.a(n.cO(),null,!1))})}else this.m(null);if(n.bm()){if(n.bC()){var o=this;this.i.a(function(t){var i=t.a();o.o(i.a(n,null))})}if(n.bx()){var t=2;var s=_pc.a.l(n.k());var r=i.d(s,_bc.f.a,!0,t);this.l(r);this.n(!!n.bp()&&!!n.bp().Mailbox&&!!n.k()&&!!n.k().Mailbox&&!_g.p.a(n.k().Mailbox,n.bp().Mailbox));if(this.k()){var f=_pc.a.l(n.bp());var u=i.d(f,_bc.f.a,!0,t);this.f(u)}else this.e()&&this.f(null)}}else{this.a()&&this.l(null);this.e()&&this.f(null)}_js.Trace.logInfo(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bm(),n.bx());_mcp.bh.prototype.g.call(this)}};_mcp.k=function(n,t,i,r){_mcp.k.initializeBase(this,[n,t]);this.bu=r;this.bq=i};_mcp.k.a=function(n,t){return new _fm.i(n,t,null,1,null,null,!1,!1,!1)};_mcp.k.c=function(n,t){return new _y.h(t,n)};_mcp.k.b=function(n,t){return new _fm.d(t,null,n,!0)};_mcp.k.prototype={bu:null,bq:null,cn:null,cm:null,cd:null,C:function(){return this.cn},A:function(){return this.cm},z:function(){return this.cd},dp:function(){return this.bu.a()==="Mouse"&&!!this.bq&&this.bq.a().f().Enabled&&!this.ba.V()},g:function(){_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"?this.dp()?this.cm=this.bv():this.cn=this.bw():this.cd=this.br();_mcp.bh.prototype.g.call(this)},bh:function(){this.cn=null;this.cm=null;_mcp.bh.prototype.bh.call(this)},bB:function(){},bE:function(){},ce:function(){},bp:function(){_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"?this.dp()?this.bE():this.bB():this.ce()}};_mcp.bt=function(n,t,i,r){this.h=Function.createDelegate(this,this.w);this.f=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.x);this.m=Function.createDelegate(this,this.r);this.o=Function.createDelegate(this,this.y);this.p=Function.createDelegate(this,this.G);_mcp.bt.initializeBase(this,[9,n,i,r]);this.l=t};_mcp.bt.prototype={l:null,e:null,d:null,b:null,k:null,F:function(n){if(this.e!==n){this.e=n;this.bk("ShowMessageOptionsCommand")}return n},a:function(){return this.d},E:function(n){if(this.d!==n){this.d=n;this.bk("DialogViewModel")}return n},g:function(){this.e||this.F(new _C(this.p,this.bd()));this.q();_mcp.k.prototype.g.call(this)},bw:function(){if(!this.bc.N()&&!this.bu.c()&&!this.ba.V()){var n=_mcp.k.b(this.e,_nbs.a.NK);return[n]}return null},bv:function(){if(!this.bc.N()&&!this.bu.c()){var n=_mcp.k.a(this.e,_nbs.a.NK);return[n]}return null},br:function(){if(!this.bc.N()&&!this.bu.c()){var n=new _y.h(_nbs.a.NK,this.e);return[n]}return null},G:function(){_js.Trace.logInfo(_a.a.a,"User chose to show message options");$a(this.b)&&(this.b=new _mcp.F);this.b.t(this.bc);if($a(this.d)){var t=new _bc.i;t.w(this.l);this.E(t);this.d.k(_nbs.a.FF);this.k=[new _ff.f(new _C(this.o,this.bd()),_u.P.T,null,!0),new _ff.f(new _C(this.m,this.bd()),_u.R.ho,null)];this.d.h.n(this.k)}this.d.m(this.b);if("TouchNarrow"===_y.c.a.a()){var n=this.bb.a.bS();this.b.v(n);n.b().d(this.j)}this.d.g(!0)},y:function(){if(this.d.D){_js.Trace.logInfo(_a.a.a,"User tried to click OK button more than once.");return}var n=this.ba.N;if(n.z()!==this.b.d){this.bb.a.U().a("Sensitivity:"+this.b.d);"Normal"!==n.z()&&this.D();n.dO(this.b.d);"Normal"!==n.z()&&this.q()}n.bb()!==this.b.e&&this.bb.a.U().a("RequestDeliveryReceipt");n.bd()!==this.b.f&&this.bb.a.U().a("ReadReceiptRequested");n.dw(this.b.e);n.dC(this.b.f);this.b.a&&!n.q()||this.b.b&&!n.C()?this.ba.cu(this.n):this.t();this.b.a!==n.q()&&this.bb.a.U().a("EncryptMessage");this.b.b!==n.C()&&this.bb.a.U().a("SignMessage")},t:function(){var n=this.ba.N;var u=this.bb.a;var t=this.ba.T();var i=t.a();if(n.q()!==this.b.a){n.dQ(this.b.a);this.bk("SmimeEncryptMessage");_js.Trace.logInfo(_a.a.j,"SmimeEncryptMessage option is changed to {0} by user.",this.b.a)}if(n.C()!==this.b.b){n.dS(this.b.b);this.bk("SmimeSignMessage");_js.Trace.logInfo(_a.a.j,"SmimeSignMessage option is changed to {0} by user.",this.b.b)}var r=this.b.a||this.b.b;r&&u.dU();i&&i.bd(n.A());if(this.b.k&&!r&&t.e())if(t.b()){_js.Trace.logInfo(_a.a.j,"Waiting to move attachments because the attachment well is currently in progress.");this.d.r(!0);i.B(this.f)}else this.v(null,null);else if(!this.b.k&&r){this.ba.bz().f()&&!n.S()&&this.ba.bz().a().a();if(t.e())if(t.b()){_js.Trace.logInfo(_a.a.j,"Waiting to move attachments because the attachment well is currently in progress.");this.d.r(!0);i.B(this.h)}else this.w(null,null);else this.i()}else this.i()},v:function(n,t){if(this.u(n,t)){_js.Trace.logInfo(_a.a.j,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.s(this.f);this.d.r(!1)}var i=this.ba.T().a();if(this.ba.N.h())i.W();else{var r=this;this.ba.d().a("Attach",function(){i.W()},null,!1)}this.i()}},w:function(n,t){if(this.u(n,t)){_js.Trace.logInfo(_a.a.j,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.s(this.h);this.d.r(!1)}this.ba.T().a().X();this.i()}},u:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.h()},i:function(){_js.Trace.logInfo(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.bc.z()+"; DeliveryReceipt="+this.bc.bb()+"; ReadReceipt="+this.bc.bd()+"; SmimeEncryptMessage="+this.bc.q()+"; SmimeSignMessage="+this.bc.C());this.r()},r:function(){if(this.d.D){_js.Trace.logInfo(_a.a.a,"User tried to close dialog when busy.");return}var t=this.bb.a.N;var i=this.ba.bd();if(t.A()&&t.M()){_a.F.a(_u.R.IP,1);i.a(750)}else i.b(750);this.ba.P().P().c(!t.A());var n=this.ba.T();if(n.a()){n.a().s(this.f);n.a().s(this.h)}"TouchNarrow"===_y.c.a.a()&&this.b.g.b().e(this.j);_js.Trace.logInfo(_a.a.a,"Close message options dialog");this.d.j.a()},x:function(n,t){_mcp.d.isInstanceOfType(this.bb.a.bS().a())?this.d.g(!0):this.d.g(!1)},D:function(){var t=this.bb.a;var n=t.bd();switch(t.N.z()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.ba.Q()},q:function(){var t=this.bb.a;var n=t.bd();switch(t.N.z()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.ba.Q()}};_mcp.r=function(n,t,i,r){this.M=Function.createDelegate(this,this.Y);this.T=Function.createDelegate(this,this.bC);this.P=Function.createDelegate(this,this.bx);this.R=Function.createDelegate(this,this.bf);this.S=Function.createDelegate(this,this.bA);this.N=Function.createDelegate(this,this.bm);this.Q=Function.createDelegate(this,this.bz);this.F=Function.createDelegate(this,this.bo);this.U=Function.createDelegate(this,this.bD);this.O=Function.createDelegate(this,this.bs);_mcp.r.initializeBase(this,[2,n,i,r]);this.H=new _C(this.O,this.bd());var o=this;this.bg=new _C(function(){o.D("Upconvert")},this.bd());var s=this;this.J=new _C(function(){s.D("ShowOriginalMessage")},this.bd());var e=this,u=this;this.bi=new _C(function(){e.D("UpconvertOnFormat")},this.bd(),this.bb.a.N,"BodyType",function(){return u.bb.a.N.e()==="HTML"});var f=this;this.L=new _C(function(){f.D("UpconvertOnMoreOptions")},this.bd());this.K=new _C(this.U,this.bd());this.o=n.a.bs;this.r=t};_mcp.r.prototype={o:null,r:null,H:null,bg:null,bi:null,J:null,K:null,L:null,u:!1,v:!1,n:!1,p:!1,y:!1,m:null,q:null,x:!1,e:function(){return this.H},w:function(n){this.u!==n&&(this.u=n);return n},k:function(){return this.v},E:function(n){if(this.v!==n){this.v=n;this.V(n)}return n},j:function(){return this.n},I:function(n){if(this.n!==n){this.n=n;this.V(n)}return n},l:function(){return this.p},i:function(){return this.t().n()},f:function(n){this.t().p(n);return n},t:function(){$a(this.q)&&(this.q=this.X());return this.q},g:function(){var n=_y.c.a;"Mouse"!==n.a()||n.c()||n.x(this.F);_mcp.k.prototype.g.call(this)},b:function(n){this.q=n},a:function(n,t){n.G(!0);this.t().g(n,t)},h:function(n){this.bb.a.bi&&(this.x=!0);if(!this.x){_js.Trace.logInfo(_a.a.a,"Checking dirty before prompting user for before unload confirmation. Context: {0}",this.bb.a.N);this.bb.a.bt()&&n.a(_nbs.a.JP)}this.x=!0;_js.g.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.Q,100)},d:function(){var n=!0;var u=this.bb;var t=u.a;var i=t.N;var r=t.e();var o=t.d();var e=i.b();var s=i.a();if(this.o.a(e))_js.Trace.logInfo(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bn()&&this.o.g(u,!1))_js.Trace.logInfo(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.W())n=!1;else if(r.b()){_js.Trace.logInfo(_a.a.a,"We're sending the message, can't exit yet.");n=!1}else if(r.j()){_js.Trace.logInfo(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.h();n=!1}else if(i.N()){var f=t.be();f.a().a();n=!1}else{_js.Trace.logInfo(_a.a.a,"Checking dirty before navigating away from compose. Context:{0}",i);if(t.bt()){this.y=!1;_js.g.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.N,1e4);this.bI();if(o.a("ReadingPaneExit",this.S,this.R,!1)){this.I(!0);_js.Trace.logInfo(_a.a.a,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},X:function(){return new _y.bs},bw:function(){if(this.ba.V()){var n=new _fm.d(_nbs.a.mg,null,this.L);return[n]}return null},bv:function(){return null},br:function(){return null},bz:function(){this.x=!1},bo:function(){_y.c.a.I(this.F);this.o.g(this.bb,!0)},V:function(n){var t=this.bb.a;t.dn(_u.P.n);t.dm(n);t.dO(n)},bs:function(){var f=this.bb;var t=f.a;var n=t.N;var o=n.b();_js.g.a().i(_a.a.a,"MailComposePopOut");if(this.u){_js.Trace.logInfo(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.Z()){n.E(this.m=_y.i.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.w(!0);var e=!1;try{var h=this.bb.a.O;h.e(_mcp.r.b);this.ba.Q();var i=t.d();_js.Trace.logInfo(_a.a.a,"Checking dirty before popping out from reading pane. Context:{0}",n);var u=t.bt();var r=t.N.cL();var s=f.b(11);if(!n.h()||u||s.a()||r){this.E(!0);(n.h()&&!r||u||i.e())&&n.ey(!1);_js.Trace.logInfo(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.cY());this.p=!1;_js.g.a().a(_a.a.a,"PopoutSaveTimeout",this.P,1e4);n.fr(!0);this.bI();t.bh.get_saveForPopoutMap()[o]=new _y.fP;this.be();i.a("Popout",this.T,this.M,!1)}else{if(n.ce())n.ey(!1);else if(n.bZ())n.ey(!1);else if(i.e())n.ey(!1);else if(n.ep){_js.Trace.logInfo(_a.a.a,"Comparing initial baseline with baseline. Context:{0}",n);n.ep.s(n.en())||n.ey(!1)}else n.ey(!1);n.fr(!1);_js.j.b(t.bh,"PopoutManager");_js.j.b(t.bh.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bh.get_saveForPopoutMap()[o];this.be()}_js.Trace.logInfo(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.t().o(!0);e=!0}finally{if(!e){this.w(!1);this.E(!1);_y.i.a(this.m,null,_mcp.r.a.toString(4));n.E(null);this.m=null}}}},Z:function(){var r=this.bb;var u=r.a;var i=u.N;var n=i.b();var t=this.ba.e();if(t.b()){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.W()||this.o.a(n)){_js.Trace.logInfo(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}return!0},W:function(){var n=this.bb.a;var t=n.T();if(t.b()){if(!n.W.i){_js.Trace.logInfo(_a.a.a,"Show attachment in progress error dialog");n.W.a(0,_u.R.OJ,null)}return!0}return!1},be:function(){var r=this.bb.a;var t=r.N;var n=new _mcp.a;if(this.r){n.dM(this.r.b());n.ds(this.r.a())}n.o(0);n.j(!1);if(t.a()===11||t.a()===12){n.f(13);n.dK(t.ci());n.dJ(t.bB())}else n.f(4);n.F(t.h());n.m(t.e());var i=this.X();n.gu(!0);n.cs(t.g());n.dU(t.D());n.dD(t.bn());n.fm(t.ce());n.fl(t.bZ());n.ey(t.cY());n.fr(t.ck());n.fq(t.b());n.I(t.v());n.E(t.cH());n.eR(t.cd());n.bN(t.Q());t.g()||t.a()!==3||t.db()||!t.d().S()||n.bq(t.d().S().e);i.a(n);if(!t.ck()){this.G();this.w(!1)}},bC:function(n){this.E(!1);if(this.p){_js.Trace.logInfo(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.i.a(this.m,null,_mcp.r.a.toString(3));this.m=null}else{var i=n.I;var t=this.bb.a;if(i in t.bh.get_saveForPopoutMap()){var u=_mcp.W.a(n);var r=t.bh.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bh.pushSaveResultToPopout(f,r.a);delete t.bh.get_saveForPopoutMap()[i]}else r.b=u}if(t.N.b()===i){_js.Trace.logInfo(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.G();this.w(!1)}else _js.Trace.logInfo(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.N.b())}},bA:function(n){this.n&&this.I(!1);if(this.y){_js.Trace.logInfo(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.G()},bf:function(n){if(this.n){_js.Trace.logInfo(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.I(!1)}},G:function(){var n=this.bb.a;this.a(n,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from reading-pane compose")},bj:function(){var u=this.bb;var r=u.a;var n=r.N;if(!n.g()&&!n.h()&&!n.D()){_js.Trace.logInfo(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",n.b());r.W.a(0,_nbs.a.fo);return}if(this.Z()){var t=this.t();if(IInlineComposeConductorViewModel.isInstanceOfType(t)){var i=t;this.ba.bz().a().a();i.e(!1);i.j(n)}}},bD:function(){var n=this;this.bb.a.N.dL(function(n){n.bg().b().a()});this.ba.U().a("UpconvertAndShowApps");this.bj()},Y:function(n){if(this.u){this.w(!1);this.E(!1);var f=this.bb;var i=f.a;var t;t=n?n.I:i.N.b();if(t in i.bh.get_saveForPopoutMap()){var r=i.bh.get_saveForPopoutMap()[t];r.a.length>0&&i.bh.pushSaveResultToPopout(null,r.a);delete i.bh.get_saveForPopoutMap()[t]}}var u=this.p?2:1;_y.i.a(this.m,null,_mcp.r.a.toString(u));this.m=null},bx:function(){_js.Trace.logInfo(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.v){this.p=!0;this.Y(null);var t=this.bb;var n=t.a.O;this.bI();n.a(84);this.ba.Q()}},bm:function(){_js.Trace.logInfo(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.n){this.y=!0;this.bf(null);var n=this.ba.O;this.bI();n.a(86);this.ba.Q()}},D:function(n){this.ba.U().a(n);this.bj()}};_mcp.r.a=function(){};_mcp.r.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.r.a.registerEnum("_mcp.r.a",!1);_mcp.bu=function(n,t,i,r){this.x=Function.createDelegate(this,this.L);this.E=Function.createDelegate(this,this.J);this.H=Function.createDelegate(this,this.R);this.o=Function.createDelegate(this,this.N);this.F=Function.createDelegate(this,this.O);this.I=Function.createDelegate(this,this.S);this.G=Function.createDelegate(this,this.Q);_mcp.bu.initializeBase(this,[29,n,i,r]);this.i=new _C(this.G,this.bd());this.n=new _C(this.I,this.bd());this.h=new _C(this.F,this.bd());this.D=t;this.ba.N.bc()&&this.K();if(OwaApplication.b){var u=this.ba.N.bA();if(u){var f=this.ba.bd();f.a(10213,u.a(9))}}};_mcp.bu.prototype={i:null,n:null,h:null,m:null,u:null,k:null,w:null,t:null,v:null,l:null,r:null,j:null,f:null,b:null,d:null,D:null,y:null,e:0,p:function(){return!!this.ba.Y.OmeSettings},q:function(){var n=this.ba.Y.OmeSettings;return(n&3)==3||(n&5)==5},a:function(){return this.b},P:function(n){if(this.b!==n){this.b=n;this.bk("DialogViewModel")}return n},g:function(){if(!this.ba.Y.WasLoadedFromServer){var n=this.ba.S;n.b(_a.cI,this.o)}_mcp.k.prototype.g.call(this)},bh:function(){this.ba.S.c(_a.cI,this.o);this.i=null;this.h=null;_mcp.k.prototype.bh.call(this)},bw:function(){if(!_y.c.a.h()&&!this.ba.V()){this.u=new _fm.d(_nbs.a.Yz,null,this.n);this.m=new _fm.d(_nbs.a.JC,null,this.i);this.k=new _fm.d(_nbs.a.kr,null,this.h);this.bB();return[this.u,this.m,this.k]}return null},bv:function(){if(!_y.c.a.h()){this.t=new _fm.i(this.n,_nbs.a.Yz,null,1,null,null,!1,!1,!1);this.w=new _fm.i(this.i,_nbs.a.JC,null,1,null,null,!1,!1,!1);this.v=new _fm.i(this.h,_nbs.a.kr,null,1,null,null,!1,!1,!1);this.bE();return[this.t,this.w,this.v]}return null},br:function(){if(!_y.c.a.h()&&this.p()){this.r=new _y.h(_nbs.a.Yz,this.n);this.l=new _y.h(_nbs.a.JC,this.i);this.j=new _y.h(_nbs.a.kr,this.h);this.f=this.ba.N.bc()?this.j:this.q()?this.r:this.l;return[this.f]}return null},bE:function(){var t=this.p();var n=this.ba.N.bc();var i=this.q();this.t.a(t&&i&&!n);this.w.a(t&&!i&&!n);this.v.a(t&&n)},bB:function(){if(this.m&&this.k){var t=this.p();var n=this.ba.N.bc();var i=this.q();this.u.a(!t||!i||n);this.m.a(!t||i||n);this.k.a(!t||!n)}},ce:function(){if(this.p()){this.j||this.l||(this.cd=this.br());var n=this.bc.bc()?this.j:this.q()?this.r:this.l;if(this.f&&this.f!==n){this.ba.dx.K(this.f,n);this.f=n}else this.ba.D().b()}},Q:function(){this.ba.N.bP(!0);this.bp();var n=this.ba.bd();this.e=10206;n.a(this.e,null)},O:function(){this.ba.N.bP(!1);$a(this.ba.N.bA())||this.ba.N.ct(null);this.bp();var n=this.ba.bd();n.b(this.e)},S:function(){_js.Trace.logInfo(_a.a.a,"User chose to show message options");$a(this.d)&&(this.d=new _mcp.N(this.ba.Y.OmeSettings));if($a(this.b)){var t=new _bc.i;t.w(this.D);this.P(t);this.b.k(_nbs.a.dE);this.y=[new _ff.f(new _C(this.H,this.bd()),_u.P.T,null),new _ff.f(new _C(this.E,this.bd()),_u.R.ho,null)];this.b.h.n(this.y)}this.b.m(this.d);if("TouchNarrow"===_y.c.a.a()){var n=this.bb.a.bS();this.d.m(n);n.b().d(this.x)}this.b.g(!0)},J:function(){if(this.b.D){_js.Trace.logInfo(_a.a.a,"User tried to close dialog when busy.");return}"TouchNarrow"===_y.c.a.a()&&this.d.b.b().e(this.x);_js.Trace.logInfo(_a.a.a,"Close message options dialog");this.b.j.a()},K:function(){var i=this.ba.bd();var u=this.ba.N.bc();if(u){var n=this.ba.N.bA();var f=!!n;var t="";if(f){var r=_a.c.a().v;t=n.E(r).a(1);this.e=10214}else this.e=10206;i.a(this.e,t)}else i.b(this.e)},L:function(n,t){_mcp.d.isInstanceOfType(this.bb.a.bS().a())?this.b.g(!0):this.b.g(!1)},R:function(){if(this.b.D){_js.Trace.logInfo(_a.a.a,"User tried to click OK button more than once.");return}var n=!0;switch(this.d.a){case 0:break;case 1:n=this.M();break}if(n){this.d.i("");this.ba.N.bP(!0);this.K();this.bp();this.J()}},M:function(){for(var n="",h=0,s=0,o=0,c,t=!0,l=this.d.k(),a=l.length,r=0;r<a;++r){var u=l[r];var i;if(_js.d.a(u.a)){n=_u.R.Eq;t=!1;break}else if(isNaN(i=Number.parseInvariant(u.a))){n=_u.R.Fa;t=!1;break}switch(u.b){case 7:h=i;break;case 6:s=i-1;break;case 5:o=i;break}}if(t){var f,e;c=(e=this.T(o,s,h,f={val:n}),n=f.val,e);_js.d.a(n)&&this.ba.N.ct(c.t())}if(!_js.d.a(n)){this.d.i(n);t=!1}return t},T:function(n,t,i,r){var u=new _a.c(n,t,i,23,59,0,0,_a.c.a().v);r.val="";t<0||t>11||_a.c.p(t,n)<i?r.val=_u.R.VH:u.k(_a.c.a())<0&&(r.val=_u.R.SL);return _js.d.a(r.val)?u:null},N:function(n){var t=this.bb.a;this.bp();t.S.c(_a.cI,this.o)}};_mcp.bv=function(n,t){this.d=Function.createDelegate(this,this.e);_mcp.bv.initializeBase(this,[13,n]);this.b=new _C(this.d,this.bd());this.b.c(t.d().a().c())};_mcp.bv.prototype={b:null,a:function(){return this.b},e:function(){_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL.");var n=this.bb.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}if(!n.d()){_js.Trace.logError(_a.a.a,"Unable to open file picker, ViewModel is not upgraded.");return}n.a().bG();_js.Trace.logInfo(_a.a.a,"OpenFilePicker on PAL end.")}};_mcp.bx=function(n,t){this.h=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.i);_mcp.bx.initializeBase(this,[13,n]);var i;i=t.b(t.d())?t.d().a():this;var u=this;this.d=new _C(this.f,this.bd(),i,"CameraAvailable",function(){return t.b(t.d())&&t.d().a().e()});var r=this;this.e=new _C(this.h,this.bd(),i,"GalleryAvailable",function(){return t.b(t.d())&&t.d().a().f()})};_mcp.bx.prototype={d:null,e:null,a:function(){return this.d},b:function(){return this.e},i:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from camera");var n=this.bb.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}if(!n.d()){_js.Trace.logError(_a.a.a,"Unable to open camera, ViewModel is not upgraded.");return}n.a().Y(n.h());_js.Trace.logInfo(_a.a.a,"Attach from camera end")},j:function(){_js.Trace.logInfo(_a.a.a,"User chose to attach from gallery");var n=this.bb.b(5);if(!n){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_js.Trace.logError(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}if(!n.d()){_js.Trace.logInfo(_a.a.a,"Unable to open gallery, ViewModel is not upgraded.");return}n.a().C(n.h());_js.Trace.logInfo(_a.a.a,"Attach from gallery end")}};_mcp.e=function(n,t,i){this.dq=Function.createDelegate(this,this.dV);this.dr=Function.createDelegate(this,this.ct);this.ds=Function.createDelegate(this,this.dC);this.dt=Function.createDelegate(this,this.dD);this.cS=Function.createDelegate(this,this.es);this.cP=Function.createDelegate(this,this.em);this.cQ=Function.createDelegate(this,this.eo);this.bs=Function.createDelegate(this,this.en);this.dx=Function.createDelegate(this,this.et);this.bL=Function.createDelegate(this,this.el);this.cR=Function.createDelegate(this,this.er);this.co=Function.createDelegate(this,this.dM);this.dw=Function.createDelegate(this,this.ep);this.dy=Function.createDelegate(this,this.ev);this.cO=Function.createDelegate(this,this.dU);this.dv=Function.createDelegate(this,this.ej);this.dA=Function.createDelegate(this,this.dJ);this.du=Function.createDelegate(this,this.ei);this.dz=Function.createDelegate(this,this.ex);_mcp.e.initializeBase(this,[1,n,t,i]);this.cU={};this.dF()&&(this.bG=new _fp.i(OwaApplication.a,i.i()));this.bf=this.da(0);this.be=this.da(1);this.bg=this.da(2);this.bY=new _C(this.dz,this.bd());this.ch=new _C(this.du,this.bd());this.bD=new _C(this.dA,this.bd());this.ci=new _C(this.dv,this.bd());this.db=new _C(this.cO,this.bd());this.cY=new _C(this.dy,this.bd());this.bT=new _C(this.dw,this.bd());this.bH=new _ff.d;this.dP();if(this.ea()){var r=_fp.a.h("ASD",1,"","",0,null);n.a.X.a(r,null,null,null);this.dB=!0}};_mcp.e.d=function(n,t){n.bi(t)};_mcp.e.b=function(n,t){n.cm(t)};_mcp.e.e=function(n,t){n.cx(t)};_mcp.e.c=function(n,t){n.dh(t)};_mcp.e.a=function(n,t){n.dg(t)};_mcp.e.prototype={bf:null,be:null,bg:null,bY:null,ch:null,bD:null,ci:null,db:null,cY:null,bT:null,cL:null,cr:null,cq:null,cI:null,ca:null,bS:null,bW:null,bQ:null,bV:null,bO:null,bZ:null,bR:null,cJ:null,cw:null,cH:null,cv:null,bi:null,bx:null,cC:!1,bj:!1,bm:null,bN:null,cs:null,cx:null,dh:!1,dk:!1,cF:!1,cD:!1,bH:null,bA:null,bo:null,cy:null,cz:null,di:null,cj:null,cG:!0,E:function(n){this.bt("ResolveOperationSucceeded",n)},U:function(n){this.bJ("ResolveOperationSucceeded",n)},D:function(n){this.bt("ResolveOperationCanceled",n)},T:function(n){this.bJ("ResolveOperationCanceled",n)},cU:null,bG:null,d:function(){return this.bG},cB:function(n){if(this.bi!==n){this.bi=n;this.bk("FromPersonaViewModel")}return n},Z:function(){return this.bi&&this.bi.bA?this.bi.bA.a():null},ed:function(){return!!this.bq&&this.bq.a().B().Enabled&&_y.c.a.a()==="Mouse"},ea:function(){return!!this.bq&&this.bq.a().N().Enabled},dF:function(){return!!this.bq&&this.bq.a().cu().Enabled},J:function(){var n=(this.bf.D()+this.be.D()+this.bg.D()).trim();return n===""?n:n.substring(0,n.length-1)},dB:!1,e:function(){if(!this.bx){var n=this;this.ba.cy.a(function(t){var i=t.a(null,null,0,0);i.d(!0);i.J(!1);i.bv(100);i.K(0);i.bu("PersonaDetailedView");i.W();i.y(!0);i.N(new _C(n.co,_a.a.a));n.bu.c()&&n.ef()&&i.M(new _C(n.co,_a.a.a));_y.c.a.a()!=="Mouse"&&i.bo(new _C(n.co,_a.a.a));i.q(n.cR);n.bx=i;if(n.cF){n.dJ();n.cF=!1}else if(n.cD){n.dg();n.cD=!1}})}return this.bx},O:function(){return this.cC},w:function(n){if(this.cC!==n){this.cC=n;this.bk("ShouldHighlightFromAsInvalid")}return n},ef:function(){return!!this.bq&&this.bq.a().Q().Enabled},M:function(){return this.bj},ew:function(n){this.bj=n;this.bk("IsReadWrite");return n},cp:!1,K:function(){return this.cp},L:function(){return this.dh},ck:function(n){this.dh=n;this.bk("IsPeoplePickerShown");return n},N:function(){return this.bT},q:function(){return this.bY},P:function(){return this.bD},h:function(){var n=this.bb.a.N;return!!n.k()&&!!n.k().Mailbox&&!_a.C.a(n.k().Mailbox.EmailAddress)},cT:!1,bC:!1,cf:function(){this.cJ||(this.cJ=new _y.h(_nbs.a.kW,this.bD));return this.cJ},de:function(){this.cw||(this.cw=new _y.h(_nbs.a.NP,this.ci));return this.cw},df:function(){this.cH||(this.cH=new _y.h(_nbs.a.Je,this.bY));return this.cH},dd:function(){this.cv||(this.cv=new _y.h(_nbs.a.Px,this.ch));return this.cv},ee:function(){return!this.bb.a.N.N()},dZ:function(){return this.bb.a.N.N()},H:function(){return this.cW(this.bj?this.bf.a.w:this.bf.b.d())||this.cW(this.bj?this.be.a.w:this.be.b.d())||this.cW(this.bj?this.bg.a.w:this.bg.b.d())},f:function(){return this.bf.h()||this.be.h()||this.bg.h()},I:function(){return this.bf.i()&&this.be.i()&&this.bg.i()},dE:function(){return this.bb.a.N.N()||this.bb.a.df()},p:function(){return this.cG},x:function(n){if(!this.ba.V())return n;if(this.cG!==n){if(n){this.j();this.bf.d.i(this.bc.i());this.be.d.i(this.bc.n());this.bg.d.i(this.bc.c())}this.cG=n;this.bk("ShowAggregatedHeader")}return n},v:function(n){return this.cu(n).a.t},F:function(n,t){this.cu(t).a.ba(n)},V:function(n){this.cu(n).a.bJ()},b:function(n){this.cu(n).bf()},Y:function(){this.bf.H();this.be.H();this.bg.H()},X:function(n){this.cx=n},dQ:function(n,t,i){if(this.bm){this.bm.c(this.bN);this.bm.a(i);this.bN=i;this.bm.d(t);this.bm.e(n);this.ck(!0);this.bb.a.br(this.bm)}else{var r=this;this.ba.cR.a(function(u){r.bm=u.a(n,t);r.bm.a(i);r.bm.b(r.bL);r.bN=i;r.ck(!0);r.bb.a.br(r.bm)})}},dO:function(){this.cV(0);this.cV(1)},a:function(){return this.bH},dR:function(n,t,i,r){var f=null;this.cy=n;this.cz=r;this.di=t;this.cj=i;r&&(f=this.dH(this.cz));if(!this.bo&&f){var u=this;this.ba.cT.a(function(t){u.bo=t.a();u.bo.c(u.bL);u.bo.b(u.cy);u.bo.a(u.cj);u.cs=n;f.a.v().O(u.bo);u.ck(f.m=!0);f.a.v().P()})}else if(f){f.a.v().O(this.bo);this.bo.d(this.cs);this.bo.c(this.bL);this.bo.b(n);this.bo.a(this.cj);this.cs=n;this.ck(f.m=!0);f.a.v().P()}},dH:function(n){var t=null;n===_u.R.OS?t=this.bf:n===_u.R.Rh?t=this.be:n===_u.R.OA&&(t=this.bg);return t},g:function(){var n=this.bb.a.N;var t=n.y();this.ew(!t||!!t.a()||t.p()||t.b());this.bA=new _mcp.i(n.bk(),this.dE());if(n.bE()&&n.bE().b()>0){this.bf.U(n.bE(),this.bj,_u.R.OS);n.dT(null)}else{var u,f;var e=(f=this.bA.l(u={val:n}),n=u.val,f);this.bf.E(e,n.bg(),this.bj,_u.R.OS)}this.be.E(n.n(),n.Y(),this.bj,_u.R.Rh);this.bc.eR(this.bc.cd()||!this.dE()&&(this.ba.cH()||this.ba.V()?!$a(n.n())&&n.n().b()>0:!0));this.bA.n(this.bj?this.bf.a:this.bf.b,this.bj?this.be.a:this.be.b);_y.c.a.h()&&this.dK(!0);this.dO();var i=_g.a.a().c();if(!_js.d.a(i.bh.SharePointUrl)&&!_js.d.a(i.bh.LogonEmailAddress)){var r=new _g.bg;r.Mailbox=this.cZ(i.bh.LogonEmailAddress);n.cp(r)}("Mouse"===_y.c.a.a()||n.k()||_g.a.a().a().bh.AlwaysShowFrom||!$a(n.c())&&n.c().b()>0||_g.a.a().a().bh.AlwaysShowBcc)&&this.bz();this.dL(n);if(this.ba.V()){this.bf.x(this.ba.N.i());this.be.x(this.ba.N.n());this.bg.x(this.ba.N.c())}_mcp.k.prototype.g.call(this);this.dF()&&this.bG.j(this.Q())},bh:function(){if(this.bi){this.bi.dispose();this.bi=null}if(this.bm){this.bm.c(this.bN);this.bm.f(this.bL);this.bm.dispose();this.bm=null;this.bN=null}if(this.ed()&&this.bo){this.bo.f(this.bL);this.bo.d(this.cy);this.bo.e(this.cj)}this.dI();if(this.bx){this.bx.v(this.cR);this.bx.Y();this.bx=null}this.dI();this.eu();this.bH.f();this.bf.dispose();this.be.dispose();this.bg.dispose();this.bA=null;_mcp.k.prototype.bh.call(this)},j:function(){this.bz();var n=this.bb.a.N;this.cM();this.dj(n,this.bf,this.dx,_mcp.e.e);this.dj(n,this.be,_mcp.e.d,_mcp.e.c);this.dj(n,this.bg,_mcp.e.b,_mcp.e.a)},y:function(n,t){var r=_a.C.a(n);if(r){this.e().b("");var e=this.cZ(n);var o=_pc.a.a(e);var f=this.bb.a.bL.c;var i=f.a(o,4,!0,2);i.br(this.cY);i.b(!0);i.ca=!0;this.cB(i);this.dT()}else{this.e().b(n);this.cB(null)}if(t&&_a.cw.a){var u=this.bb.a.cB();u.a(1)}this.w(!r);this.j()},u:function(){this.bz();return this.bf.j()+this.be.j()+this.bg.j()},i:function(){this.bz();return this.bf.j()},t:function(){this.bz();return this.be.j()},r:function(){this.bz();return this.bg.j()},W:function(n){this.x(!1);this.bz();this.cM();this.dS();this.dk=n;this.dW()},Q:function(){var n=new _ff.d;this.bf.a?n.i(this.bf.a.h()):this.bf.b&&n.i(this.bf.b.h());this.be.a?n.i(this.be.a.h()):this.be.b&&n.i(this.be.b.h());this.bg.a?n.i(this.bg.a.h()):this.bg.b&&n.i(this.bg.b.h());return n.h()},o:function(n){this.bG&&this.bG.c(n)},bw:function(){var n=new _ff.d;if(!this.bc.N()){this.bW=new _fm.d(_nbs.a.Je,null,this.bY);(_g.a.a().a().bh.AlwaysShowBcc||this.ba.V())&&this.bW.a(!0);n.c(this.bW);this.bQ=new _fm.d(_nbs.a.Px,null,this.ch);(!_g.a.a().a().bh.AlwaysShowBcc||this.ba.V())&&this.bQ.a(!0);n.c(this.bQ)}if(this.bc.cg()||this.bc.A()){var i=this.bb.b(1);this.ca=new _fm.d(_nbs.a.kW,null,this.bD);(_g.a.a().a().bh.AlwaysShowFrom||this.bc.M())&&this.ca.a(!0);n.c(this.ca);this.bD.c(!this.bc.A());this.bS=new _fm.d(_nbs.a.NP,null,this.ci);_g.a.a().a().bh.AlwaysShowFrom||this.bc.M()||this.bS.a(!0);n.c(this.bS)}if(!this.bc.N()&&!_y.c.a.h()&&!this.ba.V()&&_y.c.a.a()!=="TouchNarrow"){var t=new _fm.d(_nbs.a.eD,null,this.bT);n.c(t)}return n.h()},bv:function(){var n=new _ff.d;if(!(this.bc.N()||this.ba.cH())){this.bV=_mcp.k.a(this.bY,_nbs.a.Je);n.c(this.bV);this.bO=_mcp.k.a(this.ch,_nbs.a.Px);n.c(this.bO);this.bV.a(!_g.a.a().a().bh.AlwaysShowBcc);this.bO.a(_g.a.a().a().bh.AlwaysShowBcc)}if(this.bc.cg()||this.bc.A()){this.bZ=_mcp.k.a(this.bD,_nbs.a.kW);n.c(this.bZ);this.bR=_mcp.k.a(this.ci,_nbs.a.NP);n.c(this.bR);(_g.a.a().a().bh.AlwaysShowFrom||this.bc.M())&&this.bZ.a(!1);this.bD.c(!this.bc.A());_g.a.a().a().bh.AlwaysShowFrom||this.bc.M()||this.bR.a(!1)}if(!this.bc.N()&&!_y.c.a.h()){var t=_mcp.k.a(this.bT,_nbs.a.eD);n.c(t)}return n.h()},br:function(){var n=new _ff.d;_g.a.a().a().bh.AlwaysShowBcc?n.c(this.dd()):n.c(this.df());if(this.bc.cg())if(_g.a.a().a().bh.AlwaysShowFrom){n.c(this.de());this.bC=!1}else{n.c(this.cf());this.bC=!0}else this.bC=!1;OwaApplication.b||n.c(new _y.h(_nbs.a.eD,this.bT));return n.h()},ce:function(){var n=this.bc;var t=this.ba.dx;if(t){var u=n.M()?this.de():this.cf();var f=n.M()?this.cf():this.de();t.K(f,u);var i=n.Q()?this.dd():this.df();var r=n.Q()?this.df():this.dd();t.K(r,i)}},bB:function(){if(this.ca&&this.bS){this.ca.a(this.bc.M());this.bS.a(!this.bc.M())}if(this.bW&&this.bQ){this.bW.a(this.bc.Q()||this.ba.V());this.bQ.a(!this.bc.Q()||this.ba.V())}},bE:function(){if(this.bZ&&this.bR){this.bZ.a(!this.bc.M());this.bR.a(this.bc.M())}if(this.bV&&this.bO){this.bV.a(!this.bc.Q());this.bO.a(this.bc.Q())}},dW:function(){this.bf.c?this.bf.C():this.dD(!0)},dD:function(n){n?this.be.c?this.be.C():this.dC(!0):this.ct(!1)},dC:function(n){n?this.bg.c?this.bg.C():this.ct(!0):this.ct(!1)},ct:function(n){if(this.dk)if(n){_js.Trace.logInfo(_a.a.a,"Force resolve completed");this.cg("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.a.a,"Force resolve cancelled");this.cg("ResolveOperationCanceled")}},G:function(){this.bz();this.cM();this.bf.A();this.be.A();this.bg.A()},bz:function(){if(!this.cT){this.cT=!0;var n=this.bb.a.N;this.bg.E(n.c(),n.J(),this.bj,_u.R.OA);if(!$a(n.c())&&0<n.c().b()||!_js.d.a(n.J())||_g.a.a().a().bh.AlwaysShowBcc){n.bN(!0);_js.Trace.logInfo(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$a(n.c())?0:n.c().b(),!_js.d.a(n.J()),_g.a.a().a().bh.AlwaysShowBcc)}this.cV(2);_js.Trace.logInfo(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,$a(n.i())?0:n.i().b(),$a(n.n())?0:n.n().b(),$a(n.c())?0:n.c().b());this.dL(n);if(n.cg()&&(n.k()||_g.a.a().a().bh.AlwaysShowFrom||this.ek())){_js.Trace.logInfo(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.k()||!n.k().Mailbox?"<not set>":n.k().Mailbox.EmailAddress,_g.a.a().a().bh.AlwaysShowFrom);this.e()?this.dg():this.cD=!0}else if(_g.a.a().a().bh.AlwaysShowFrom&&!$a(n.y())&&!n.y().b()){var t=this.bb.a.O;t.b(4525);t.a(4525);this.ba.Q()}}},S:function(){this.bf.F();this.be.F();this.bg.F()},R:function(){_js.Trace.logInfo(_a.a.j,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.bb.a.N;var t=new _ff.d;var u=this.bj?this.bf.a.w:this.bf.b.d();var f=this.bj?this.be.a.w:this.be.b.d();var r=this.bj?this.bg.a.w:this.bg.b.d();if(u){_js.Trace.logInfo(_a.a.j,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.i(u.f())}if(f){_js.Trace.logInfo(_a.a.j,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.i(f.f())}if(r){_js.Trace.logInfo(_a.a.j,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.i(r.f())}_js.Trace.logInfo(_a.a.j,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.cl();if(!n){var i=_g.a.a().c();n=new _g.d;n.Name=i.bh.UserDisplayName;n.EmailAddress=i.bh.UserEmailAddress||i.bh.LogonEmailAddress;n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.c(n);return t},ev:function(){if(this.bi){_js.Trace.logInfo(_a.a.a,"User selected from persona");this.bi.A(!0);this.cx&&this.cx()}else _js.Trace.logInfo(_a.a.a,"User tries to select from persona, but it is null")},ep:function(){this.bb.a.U().a("ResolveRecipients");this.W(!1)},dU:function(){_js.Trace.logInfo(_a.a.a,"User chose to delete from persona");this.cB(null);this.e().k(!0)},dM:function(){this.y(this.e().a(),!0)},er:function(n,t){this.dN()},da:function(n){return new _mcp.t(this.bb.a.bL,this,this.bq,this.bb,this.cU,this.bG,n,this.ba.N.a())},et:function(n,t){if(this.bA){var i;this.bA.k(t,i={val:n}),n=i.val}else n.r(t)},en:function(n,t){this.bH.f();this.dl(this.bf);this.dl(this.be);this.dl(this.bg)},dl:function(n){n.a?this.bH.c(n.a):n.b&&this.bH.c(n.b)},dP:function(){this.bf.apcl("ReadWriteRecipientWellViewModel",this.bs);this.be.apcl("ReadWriteRecipientWellViewModel",this.bs);this.bg.apcl("ReadWriteRecipientWellViewModel",this.bs);this.bf.apcl("ReadOnlyRecipientWellViewModel",this.bs);this.be.apcl("ReadOnlyRecipientWellViewModel",this.bs);this.bg.apcl("ReadOnlyRecipientWellViewModel",this.bs)},eu:function(){this.bf.rpcl("ReadWriteRecipientWellViewModel",this.bs);this.be.rpcl("ReadWriteRecipientWellViewModel",this.bs);this.bg.rpcl("ReadWriteRecipientWellViewModel",this.bs);this.bf.rpcl("ReadOnlyRecipientWellViewModel",this.bs);this.be.rpcl("ReadOnlyRecipientWellViewModel",this.bs);this.bg.rpcl("ReadOnlyRecipientWellViewModel",this.bs)},em:function(n,t){this.x(!1);this.bf.h()||this.be.h()||this.bg.h()||(this.bu.c()?this.bb.a.O.b(97):this.bb.a.O.b(65));this.bf.i()&&this.be.i()&&this.bg.i()||this.bb.a.O.b(70);_y.c.a.h()&&this.dK(!1);if(t&&t.c===2){var r=this.bb.a.cB();r.b();if(_a.bk.a){var i=this;_js.g.a().c(_a.a.E,"TriggerPolicyTipsIfNeeded",function(){if(i.bb&&i.bb.a){var n=i.bb.a.cG();n.a(1)}})}}},es:function(n,t){this.bA&&this.bA.m(n,t)},dS:function(){this.bf.a&&this.bf.a.bb();this.be.a&&this.be.a.bb();this.bg.a&&this.bg.a.bb()},el:function(){this.ck(!1);this.dH(this.cz).m=!1;this.di()},dI:function(){this.cA(0);this.cA(1);this.cA(2)},cV:function(n){var t=this.cA(n);if(t){t.bW(this.dG(n));t.dL(this.cQ);t.t.d(this.cP);n||t.t.d(this.cS)}return t},cA:function(n){var t=null;switch(n){case 0:t=this.bf.a;break;case 1:t=this.be.a;break;case 2:t=this.bg.a;break}if(t){t.ch(this.dG(n));t.dU(this.cQ);t.t.e(this.cP);n||t.t.e(this.cS)}return t},dG:function(n){switch(n){case 0:return this.dt;case 1:return this.ds;case 2:return this.dr;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},eo:function(){this.ba.Q()},ex:function(){var t=_a.d.b(_a.a.a,"MailComposeShowBcc",!0);this.bb.a.U().a("ShowBcc");_js.Trace.logInfo(_a.a.a,"User chose to show bcc");this.bz();var n=this.bb.a.N;if(!n.Q()){n.bN(!0);this.bk("ShowBccButton");this.ba.Q();this.bp()}_a.d.a(t)},ei:function(){var t=_a.d.b(_a.a.a,"MailComposeHideBcc",!0);this.bb.a.U().a("HideBcc");_js.Trace.logInfo(_a.a.a,"User chose to hide bcc");this.bz();var n=this.bb.a.N;if(n.Q()){n.bN(!1);this.bk("ShowBccButton");this.ba.Q();this.bp()}_a.d.a(t)},dL:function(n){if("Mouse"!==_y.c.a.a()){var f=this.bb;var u=f.a;var r=u.dx;if(r){var i=r.a;if(i)if(n.cg()){if(!this.bC)for(var t=0;t<i.length;t++)if(_nbs.a.Je===i[t].b){r.x(this.cf(),t+1);this.bC=!0}}else if(this.bC){u.dx.t(this.cf());this.bC=!1}}}},cM:function(){var i=this.bb.a.N;var n=null;if(i.M()){var t=null;this.bi?t=this.bi.bA.a():this.bx&&!_js.d.a(this.bx.a())&&(t=this.cZ(this.bx.a()));n=new _g.bg;n.Mailbox=t;i.cp(n);this.h()||this.bb.a.O.b(66)}return n},ek:function(){var t=!1;if(this.bu.c()){var n=_g.a.a().c();t=n.i().b()>0||!$a(n.b())&&n.b().b()>0||n.a().b()>1}return t},cZ:function(n){var t=new _g.d;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},dT:function(){var t=_mcp.t.b;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.R.Wu,null,new _C(this.dq,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.R.Uz,null,new _C(this.cO,_a.a.a)));$a(this.bi.bP)||(t&1)!=1||Array.addRange(n,this.bi.bP);this.bi.Q(n)},dg:function(){var n=this.bb.a.N;var i=null;var t=_g.a.a().c();i=_js.d.a(t.bh.SharePointUrl)||_js.d.a(t.bh.LogonEmailAddress)?null!==n.k()&&n.k().Mailbox?n.k().Mailbox.EmailAddress:_h.j.f(null)||t.bh.UserEmailAddress:t.bh.LogonEmailAddress;this.y(i,!1);n.dy(!0);var u=this.cM();n.en()&&n.en().z(u);var r=this.ba.cd();$a(r.b())&&r.g();this.bp()},dV:function(){var n=this.bi.bA.a().EmailAddress;this.cB(null);this.e().b(n);this.e().k(!0)},dN:function(){var n=this.e().i();if($a(n)||$a(n.a())||$a(n.a().a()))_js.Trace.logWarning(_a.a.a,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.a().a().EmailAddress;_js.Trace.logInfo(_a.a.a,"User selected from={0}",t);this.y(t,!0)}},dJ:function(){if(!this.e()){this.cF=!0;return}var t=_a.d.b(_a.a.a,"MailComposeShowFrom",!0);this.bb.a.U().a("ShowFrom");var n=this.bb.a.N;if(n.M())_js.Trace.logInfo(_a.a.a,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.a.a,"User chose to show from");this.x(!1);this.cp=!0;this.dg();this.ba.Q();this.bp()}_a.d.a(t)},ej:function(){this.x(!1);var t=_a.d.b(_a.a.a,"MailComposeHideFrom",!0);this.bb.a.U().a("HideFrom");var n=this.bb.a.N;if(n.M()){n.dy(!1);this.cp=!1;this.ba.Q()}else _js.Trace.logInfo(_a.a.a,"Skip hide from since it is already hidden");this.bp();this.bb.a.O.b(750);_a.d.a(t)},dj:function(n,t,i,r){var u=this.bj?t.a:t.b;if(!$a(u)){i(n,u.d());if(_rw.b.isInstanceOfType(u)){var f=u;f.v()&&r(n,f.v().a())}}},dK:function(n){var e=this.bb.a.N;var i=!1;var u=e.cl();if(u){var t=this.be.a.w;if(t)for(var r=0;r<t.y.length;r++){var f=t.y[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.bb.a.O.b(4450);this.bb.a.O.a(4450)}else n||i||this.bb.a.O.b(4450)},cW:function(n){if(!n||!n.y.length)return!1;for(var t=0;t<n.y.length;t++){var i=n.y[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},dc:function(n){var t=this.bf.y(n)||this.be.y(n)||this.bg.y(n);t&&n.a.cV(t)},eh:function(){if(!this.cL){var n=this;this.cL=new _C(function(){n.dc(n.bf)},_a.a.a)}return this.cL},dY:function(){if(!this.cr){var n=this;this.cr=new _C(function(){n.dc(n.be)},_a.a.a)}return this.cr},dX:function(){if(!this.cq){var n=this;this.cq=new _C(function(){n.dc(n.bg)},_a.a.a)}return this.cq},eg:function(){if(!this.cI){var n=this;this.cI=new _C(function(){n.bc.eR(!0);n.ba.Q();n.bb.a.U().a("ShowCc")},_a.a.a)}return this.cI},cu:function(n){switch(n){case 0:return this.bf;case 1:return this.be;case 2:return this.bg;default:throw Error.argument();}}};_mcp.t=function(n,t,i,r,u,f,e,o){this.K=Function.createDelegate(this,this.Z);this.J=Function.createDelegate(this,this.Y);this.M=Function.createDelegate(this,this.bb);this.L=Function.createDelegate(this,this.ba);this.u=Function.createDelegate(this,this.bc);this.t=Function.createDelegate(this,this.W);this.p=Function.createDelegate(this,this.X);this.I=Function.createDelegate(this,this.V);_mcp.t.initializeBase(this);this.o=n;this.e=t;this.n=i;this.g=r;this.G=u;this.z=f;this.w=e;this.v=o};_mcp.t.prototype={o:null,n:null,r:null,a:null,b:null,d:null,e:null,f:null,k:null,q:null,g:null,G:null,z:null,S:function(){return!!this.n&&this.n.a().B().Enabled&&_y.c.a.a()==="Mouse"},R:function(){return!!this.e&&!!this.e.bu&&this.e.bu.c()},P:function(n){if(this.a!==n){this.a=n;this.bk("ReadWriteRecipientWellViewModel")}return n},m:!1,T:function(){this.r||(this.r=new _C(this.I,_a.a.bj));return this.r},l:0,be:function(n){if(n!==this.b){this.b=n;this.bk("ReadOnlyRecipientWellViewModel")}return n},D:function(){return this.a?this.O(!0):""},bd:function(n){if(n!==this.d){this.d=n;this.bk("AggregatedRecipientWellViewModel")}return n},i:function(){var o=this.c&&_rw.a.g(this.a);if(this.c){var f;var n;var s="";var t="";var i="";var r="";if(this.a){for(var u=0;u<this.a.t.y.length;u++){f=this.a.t.y[u];if(f){s=f.i.e();i=i+" "+s}}for(var e=0;e<this.a.w.y.length;e++){n=this.a.w.y[e];if(n){t="";_js.d.b(n.EmailAddress)?_js.d.b(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.a.S,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.f,o,i,r)}return o},c:!1,h:function(){return this.c&&!$a(this.a)&&this.a.J},bf:function(){this.c&&this.a&&this.a.dI()},w:0,v:0,U:function(n,t,i){this.k=n;this.c=t;this.a?this.a.i(null):this.P(this.N(null));var r=this.a.v();if(r){r.b("");r.G(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.f=i},E:function(n,t,i,r){this.c=i;this.q=t;if(this.c){this.a?this.a.i(n):this.P(this.N(n));var u=this.a.v();if(u){!_js.d.a(u.a())&&_js.d.a(t)&&u.b(t);_js.d.a(t)||u.b(t)}else this.a.apcl("FindRecipientViewModel",this.p);this.f=r}else this.b?this.b.i(n):this.be(this.Q(n))},C:function(){$a(this.a)||this.a.cb()},A:function(){this.a&&!this.m&&this.a.bi()},H:function(){if(!$a(this.a)&&this.a.v().E())if(this.a.v().bc()){this.a.cP(!0);this.a.cP(!1)}else{this.a.cR(!0);this.a.cR(!1)}},j:function(){var n;n=this.c?$a(this.a)?0:!this.a.v()||_js.d.a(this.a.v().a())?this.a.w.y.length:this.a.w.y.length+1:$a(this.b)?0:this.b.d().y.length;return n},F:function(){if(this.a){var n=this.O(!1);n!==""&&_js.Trace.logInfo(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.f,n)}},O:function(n){var e="";if(this.a)for(var o="",f="",u,t,i=0,s=this.a.t.y.length;i<s;i++){u=this.a.t.y[i];if(u&&!u.k){t=this.a.w.y[i];if(t){f=_js.d.b(t.Name)?"":t.Name;var r=null;if(n)r=String.format("{0}, ",f);else{o=_js.d.b(t.EmailAddress)?"":t.EmailAddress;r=String.format("( {0} , {1} ),",f,o)}e+=r}}}return e},bl:function(){if(!$a(this.a)){this.a.dE(this.t);this.a.rpcl("SelectedRecipient",this.u);this.a.bp(!1);this.a.dispose();this.a=null}},N:function(n){var t=this.o.b(_mcp.t.b,_pe.c.b,n,!0,!0,this.G,this.z,this.w,this.v);t.dn(this.t);t.apcl("SelectedRecipient",this.u);return t},Q:function(n){return this.o.a(_mcp.t.a,_bc.f.a,n,2)},x:function(n){this.bd(this.o.a(_mcp.t.a,_bc.f.a,n,2,!1,!0,!1,n?n.b():0,0,this.n));return this.d},bc:function(n,t){if(this.g){var i=n;var r=this.g.a;if(i.y!==i.Z){r.O.e([10210,10211]);i.Z=null}}},W:function(n){if(this.g){var t=this.g.a;switch(n){case 1:t.O.a(10210);break;case 0:t.O.a(10211);break}}},X:function(n,t){var r=n;var i=r.v();if(this.k&&this.k.y.length>0){i.b("");i.G(this.k)}_js.d.b(this.q)||i.b(this.q);r.rpcl("FindRecipientViewModel",this.p)},V:function(){if(this.c&&!OwaApplication.b)if(this.S()&&this.R()){_js.Trace.logInfo(_a.a.a,"User chose to launch the new people picker");_a.k.a.c("VM.PeoplePicker.Launched",_a.c.a());var t;_a.l.b(_a.a.bj,"LaunchV2PeoplePicker",!0,(t=new _a.T,t.b=!0,t));this.l=0;this.e.dR(this.L,this.M,this.J,this.f)}else{_js.Trace.logInfo(_a.a.a,"User chose to launch rich people picker");this.a.bi();_a.k.a.c("VM.PeoplePicker.Launched",_a.c.a());var n;_a.l.b(_a.a.bj,"PeoplePicker",!0,(n=new _a.T,n.b=!0,n));this.e.dQ(this.a.t,this.f,this.K)}},Y:function(n){this.a&&this.a.v().A(n)},ba:function(n){var t=n;if(t.a()){_a.C.a(_g.p.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.n(t):this.a.bd(t);this.l++}},bb:function(){if(this.l>0){var t=_a.d.b(_a.a.bj,"CloseV2ToPicker ");var n=new _a.q;n.a("sc",this.l);t.j=n.toString();_a.d.a(t)}},Z:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.t.g();var t=this;n.q(function(n){var i=n;i.k?t.a.n(i.j):t.a.bd(i.j)})},y:function(n){var u=this.a.t;var r=null;if(this!==n)for(var t=0;t<u.y.length;t++){var i=u.y[t];if(i.w){r=i;this.a.U(i);break}}return r}};_mcp.B=function(n,t,i,r,u){this.O=Function.createDelegate(this,this.bx);this.P=Function.createDelegate(this,this.bz);this.S=Function.createDelegate(this,this.be);this.T=Function.createDelegate(this,this.bf);this.R=Function.createDelegate(this,this.bC);this.Q=Function.createDelegate(this,this.bA);this.l={};_mcp.B.initializeBase(this,[8,n,r,u]);this.H=t;this.E=new _C(this.Q,this.bd());this.I=new _C(this.R,this.bd());this.y=n.a.bs;this.V=i};_mcp.B.prototype={y:null,E:null,I:null,V:null,H:null,q:!1,u:!1,w:null,p:null,v:null,D:null,m:null,f:function(){return this.E},j:function(){return this.I},b:function(){return this.q},J:function(n){if(n!==this.q){this.q=n;this.bk("IsSaving")}return n},bD:function(n){if(n!==this.D){this.D=n;this.bk("DraftSavedTime")}return n},r:!1,h:function(){return this.r},k:function(n){this.r=n;return n},n:!1,e:function(){return this.n},d:function(n,t){var i=this.bb;var f=i.b(5);var u=i.a.W;var r=i.a.N;_js.Trace.logInfo(_a.a.a,"UserInitiatedSave - SaveStart:Context:{0}",r);i.a.U().a("Save");this.bI();if(!r.bz()){_js.Trace.logInfo(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_js.Trace.logInfo(_a.a.a,"Skip save and show attachment in progress dialog");u.i||u.a(0,_u.R.OJ,null);return}this.n=!0;this.a("Save",n,t,!1)},g:function(){this.M();_mcp.k.prototype.g.call(this)},M:function(){if(this.ba.bG()&&!this.m){_js.Trace.logInfo(_a.a.a,"Setting save component override");this.m=this.ba.bF().d();var i=this.ba.ce();var t=i,n=i;this.m.b(this.T,this.S,t.b||(t.b=Function.createDelegate(t,t.f)),n.a||(n.a=Function.createDelegate(n,n.d)))}},L:function(){if(this.m){this.m.a();this.m=null}},a:function(n,t,i,r){if(this.m&&!this.m.c()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var h=this.bb;var o=h.a;var u=o.N;var c=o.O;var f=u.b();var a=this.bb.b(5);var s=this.ba.e();if(s.b()&&!r){_js.Trace.logInfo(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.y.a(f)){_js.Trace.logInfo(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.l={};return!1}var e=this.ba.P();e.G();if(_g.a.a().bh.MaxRecipientsPerMessage<e.u()){c.a(800,null);this.ba.Q();return!0}this.ba.N.R()&&this.ba.bn().a(new _cmc.bb);e.j();u.bY().a();this.l[n]=new _mcp.bJ(t,i);if(!this.q||r){this.w=_mcp.b.b(u);this.J(!0)}else{this.u=!this.w.t(u);return!0}if(!u.g()&&!u.h()&&!u.D()){_js.Trace.logInfo(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}_a.A.stPT(_a.a.a,"MailComposeSave",5);this.p=_y.i.b(_a.a.a,"MailComposeSave",!0);this.v=n;_js.g.a().i(_a.a.a,"MailComposeSave");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting save.");try{this.m?this.m.d(n):this.bf(n);return!0}catch(l){this.be(l);throw l;}},bh:function(){this.q=!1;this.u=!1;this.n=!1;this.r=!1;this.l={};this.w=null;this.L();_mcp.k.prototype.bh.call(this)},i:function(){this.q=!1;this.u=!1;_js.Trace.logInfo(_a.a.a,"ResumeSave:Context:{0}",this.bb.a.N);var i=this.l;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.a(n.key,t.a,t.b,!0);break}},cc:function(n){return _y.t.c(n.t,40,50,60,700,88,89,43,57)},cl:function(n){if("ReadingPaneExit"in this.l||"Popout"in this.l){var u=this.bb.a;var t=u.O;var r=this.cc(n);var e=new _y.cM;var i=e.a(r,null);t.e(_mcp.r.b);"ReadingPaneExit"in this.l?t.a(87,i):t.a(85,i);if(r===50){var f=this;u.bJ.a(function(n){n.a(t);f.ba.Q()})}else this.ba.Q()}else"Save"in this.l&&_mcp.bh.prototype.cl.call(this,n)},bw:function(){if(this.bc.a()!==8&&!this.bc.N()&&!_y.c.a.h()){var n=new _fm.d(_nbs.a.Dr,null,this.ba.d().f());return[n]}return null},bv:function(){if(this.bc.a()!==8&&!this.bc.N()&&!_y.c.a.h()){var n=_mcp.k.a(this.E,_nbs.a.Dr);return[n]}return null},br:function(){return null},bf:function(n){_js.Trace.logInfo(_a.a.U,"Setup save action, context:{0}; OriParentFolderId={1}",this.bc,this.bc.d()&&this.bc.d().bh.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.bc.d().bh.ParentFolderId):"null");var t=this.ba.bw.e(this.ba,0);if((_h.j.isInstanceOfType(t)||_h.n.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.bc.N()){var i=t;i.R=new _g.Q(new _g.A("internalsubmission"))}this.ba.X.a(t,this.P,this.O,null);_js.Trace.logInfo(_a.a.a,"Save action submitted")},bA:function(){this.bb.a.U().a("Save");this.d(null,null)},bC:function(){_js.Trace.logInfo(_a.a.a,"User chose to close and save");if(this.ba.bt()){_js.Trace.logInfo(_a.a.a,"User hit close, the form is dirty, attempt to save and navigate away. Context:{0}",this.bc);var n=this;this.d(function(){n.Y()},null)}else this.Y()},be:function(n){this.J(!1);this.n=!1;var t=n.toString();_y.i.a(this.p,null,t,null,this.G(this.v,n.message));this.p=null;_a.A.endPT("MailComposeSave");_js.Trace.logWarning(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},Z:function(n){var s=this.bb;var u=s.a;var f=u.N;var t=n.I;var r=!1;if(this.y.a(t)){f.b()===t&&(this.l={});this.t(n);var e=_mcp.W.a(n);if(e){_js.Trace.logInfo(_a.a.a,"Resume discard for context {0}",t);u.be().b(t,e)}r=!0}else if(t===f.b()){if(this.r){this.r=!1;_js.Trace.logInfo(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.l={};this.t(n);var i=null;_h.p.isInstanceOfType(n)?i=n.f:_h.n.isInstanceOfType(n)&&(i=n.U);i&&f.F(i);var o=this.ba.e();o.e();r=!0}else if(this.u){_js.Trace.logInfo(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.i();r=!0}}else _js.Trace.logInfo(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,u.N.b());return r},bz:function(n){var e=this.bb;var r=e.a;var u=r.N;var h=r.be();var f=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned success, ContextId={0}; Context:{1}",f,u);if(!this.Z(n)&&f===u.b()){this.bs(n);this.X();var i=!1;var t=null;if("Attach"in this.l){if("AutoSave"in this.l){t=this.l.AutoSave;t&&t.a(n)}t=this.l.Attach}else if("Popout"in this.l){t=this.l.Popout;var o=r.b();if(o&&o.l()&&"ReadingPaneExit"in this.l){t&&t.a(n);t=this.l.ReadingPaneExit}}else if("ReadingPaneExit"in this.l)t=this.l.ReadingPaneExit;else if("AutoSave"in this.l){t=this.l.AutoSave;i=!0}else if("Save"in this.l){t=this.l.Save;i=!0}else"Diagnostics"in this.l&&(i=!0);t&&t.a&&t.a(n);if(i){var s=e.b(5);s.v()}this.l={}}_y.i.a(this.p,null,"",this.W(n),this.G(this.v,""));this.p=null},X:function(){var i="";var t=this.l;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.a.a,"ProcessorKeys:{0}",i)},bx:function(n){var o=this.bb.a.N;var e=n.I;_js.Trace.logInfo(_a.a.a,"Save action returned a failure, ContextId={0}; Context:{1}",e,o);if(!this.Z(n)&&e===o.b()){this.X();var t=!1;var h=this.l;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.b){u.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.U(n);t=!0}}else if(!t){this.U(n);t=!0}}t||this.t(n);this.l={}}var r="SaveFailure_UnknownError";var f="";if(_g.V.a(n.t)){r=_g.V.b(n.t)||"SaveFailure_UnknownError";f=n.t.FaultMessage}_y.i.a(this.p,null,r,this.W(n),this.G(this.v,f));this.p=null},bs:function(n){var f=this.bb;var t=f.a;var i=t.N;var e=n.I;var h=this.n;if(e===i.b()){this.bG(n);i.cq(!1);t.dq()}this.cg("MailSaveSucceeded");if(e===i.b()){var s=_a.c.a();var r=s.a(0);this.bD(String.format(_nbs.a.Ze,r));if(h&&!t.V()){var u=t.O;u.e(_mcp.B.a);u.a(1001,r);this.ba.Q()}}if(_a.bk.a){var o=f.b(23);o.a(this.n?4:2)}this.t(n)},U:function(n){_js.Trace.logInfo(_a.a.a,"SaveActionFailed: Error: {0}",n.t.message);n.I===this.bb.a.N.b()&&this.cl(n);var t=this.bb.a;t.bi&&t.G(!1);this.t(n)},t:function(n){var i=this.bb;var t=i.a.N;if(n.I===t.b()){this.J(!1);this.n=!1}_a.A.endPT("MailComposeSave")},W:function(n){var t=null;_h.p.isInstanceOfType(n)&&n.E?t=n.E.correlationId:_h.n.isInstanceOfType(n)&&n.E&&(t=n.E.correlationId);return t},G:function(n,t){var i=new _a.q;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},bG:function(n){var t=this.bb.a.N;t.eK(this.w);if(this.n){t.fl(!0);this.n=!1;_js.Trace.logInfo(_a.a.a,"Explicit save recorded. ContextId={0}",t.b())}if(_h.j.isInstanceOfType(n)){var u=n;var r=u.f;u.b.bG(r);t.F(r);t.dl(u.b);_js.Trace.logInfo(_a.a.a,"Updated context from create action. Context:{0}",t.toString());this.H.B(r)}else if(_h.n.isInstanceOfType(n)){var i=n;var o=i.U;i.b.bG(o);t.F(o);t.dl(i.b);_js.Trace.logInfo(_a.a.a,"Updated context from update action. Context:{0}",t)}else if(_h.Q.isInstanceOfType(n)){var a=n;var l=a.f;t.F(l);_js.Trace.logInfo(_a.a.a,"Updated context from create response action. Context:{0}",t)}else if(_mcp.E.isInstanceOfType(n)){var v=n;var p=v.b.f;t.F(p);_js.Trace.logInfo(_a.a.a,"Updated context from create response from modern group action. Context:{0}",t)}else if(_c.u.isInstanceOfType(n)){var y=n;var h=y.f;t.F(h);_js.Trace.logInfo(_a.a.a,"Updated context from create approval response action. Context:{0}",t)}if(_h.p.isInstanceOfType(n)&&t.Z()){var c=n;var e=c.bv;var f=t.Z().dY();if(e&&f){var s=0;var w=this;f.q(function(n){var t=n;t.g(e[s]);s++});_js.Trace.logInfo(_a.a.a,"Attachment IDs have been updated.")}}},Y:function(){this.ba.b().a(this.ba,!1);_js.Trace.logInfo(_a.a.a,"Navigated away from compose")}};_mcp.o=function(n,t){this.j=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.t);this.h=Function.createDelegate(this,this.r);_mcp.o.initializeBase(this,[18,n]);this.e=t.c()};_mcp.o.a=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.o.prototype={e:!1,f:0,b:function(){return this.ec(_mcp.o.c)},m:function(n){this.eb(_mcp.o.c,n);return n},g:function(){if($a(this.b())){var n=this.e?[_mcp.o.a(_u.R.Vq,null)]:this.l(_fm.d,_mcp.o.a);if(n){this.m(new _fm.f(n));this.b().bx(new _C(this.h,this.bd()));this.b().n=this.i}}_mcp.bh.prototype.g.call(this)},bh:function(){this.b()&&this.m(null);this.f=0;_mcp.bh.prototype.bh.call(this)},a:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bh.UserEmailAddress&&!_h.j.e(n)){var t=_g.a.a().a().bf();if(!$a(t)){if(t.j(r))return;t.b()===1&&t.a(0)===""&&t.k(0)}var i=new(_a.fJ.$$(String));i.c(r);i.D(t);i.b()>_mcp.o.b&&i.k(i.b()-1);_g.a.a().a().cN(i);_h.h.a(_g.a.a().a().v,OwaApplication.a);this.p(r)}}},t:function(){if(this.e&&!this.f){this.f=1;_js.g.a().a(this.bd(),"SendAsContextMenu",this.j,2e3);var n=new _mcp.bd;var i=this,r=this,t=this;this.ba.X.a(n,function(t){_g.a.a().c().r(new(_a.fJ.$$(String))(n.b));_g.a.a().c().p(new(_a.fJ.$$(String))(n.c))},function(n){_js.Trace.logWarning(_a.a.a,"Fail to load alias list for consumer, use the alias list in userConfiguration instead.")},function(n){t.n()})}},p:function(n){if(!this.e&&this.b()){for(var r=_mcp.o.a(n,new _C(this.d(n),this.bd())),t=this.b().h,i=t.y.length-1;i>0;i--)if(_fm.j.isInstanceOfType(t.y[i])){t.u(i+1,r);var u=t.y.length-i-1;u>_mcp.o.b&&t.o(t.y.length-1);return}t.a(new _fm.j);t.a(r)}},r:function(){if(this.b()&&this.b().l){var f=this.b().l;var r=_g.a.a().a().bf();var e=r.p(f.j);if(e){for(var n=this.b().h,t=n.y.length-1;t>0;t--)if(n.y[t].j===f.j){n.o(t);var u=n.y.length;_fm.j.isInstanceOfType(n.y[u-1])&&n.o(u-1);break}var i=new(_a.fJ.$$(String));r.b()>0?i.D(r):i.c("");_g.a.a().a().cN(i);_h.h.a(_g.a.a().a().v,OwaApplication.a)}}},l:function(n,t){var i=new _ff.d;var r=_g.a.a().c().bh.UserEmailAddress;i.c(t(r,new _C(this.d(r),this.bd())));if(this.e){var e;this.o(e={val:i},t,r),i=e.val;var o;this.k(o={val:i},t),i=o.val}else{var u;this.k(u={val:i},t),i=u.val;var f;this.q(f={val:i},t),i=f.val}return i.h()},k:function(n,t){for(var u,r=_g.a.a().c().i(),f=$a(r)?0:r.b(),i=0;i<f;i++){u=r.a(i).EmailAddress;n.val.c(t(u,new _C(this.d(u),this.bd())))}},o:function(n,t,i){for(var u,r,s=_g.a.a().c().a(),c=$a(s)?0:s.b(),o=_g.a.a().c().b(),h=$a(o)?0:o.b(),f=0;f<c;f++){u=s.a(f);i!==u&&n.val.c(t(u,new _C(this.d(u),this.bd())))}for(var e=0;e<h;e++){r=o.a(e);i!==r&&n.val.c(t(r,new _C(this.d(r),this.bd())))}},q:function(n,t){var i=_g.a.a().a().bf();var r=$a(i)?0:i.b();if(r===1&&i.a(0)===""){i.k(0);r=0}if(r>0){var f;n.val.c(new _fm.j);for(var u=0;u<r;u++){f=i.a(u);n.val.c(t(f,new _C(this.d(f),this.bd())))}}},d:function(n){var t=this;return function(){_js.Trace.logInfo(_a.a.a,"User chose from={0}",n);t.bb.a.P().y(n,!0)}},n:function(){if(this.f===1){this.f=2;var n=this.l(_fm.d,_mcp.o.a);if(n&&this.b()&&this.b().h){this.b().h.g();this.b().h.n(n)}}}};_mcp.x=function(n,t,i,r,u){this.bm=Function.createDelegate(this,this.cw);this.bx=Function.createDelegate(this,this.cC);this.bC=Function.createDelegate(this,this.cG);this.bs=Function.createDelegate(this,this.cB);this.y=Function.createDelegate(this,this.cA);this.S=Function.createDelegate(this,this.cy);this.bi=Function.createDelegate(this,this.bV);this.bj=Function.createDelegate(this,this.bW);this.bD=Function.createDelegate(this,this.cI);this.bG=Function.createDelegate(this,this.cJ);this.J=Function.createDelegate(this,this.bH);this.bo=Function.createDelegate(this,this.X);this.bz=Function.createDelegate(this,this.cD);this.bA=Function.createDelegate(this,this.cF);_mcp.x.initializeBase(this,[7,n,i,r]);this.w=new _C(this.bA,this.bd());this.T=new _C(this.bz,this.bd());this.U=n.a.bs;this.bR=t;this.E=i;this.p=u};_mcp.x.prototype={U:null,T:null,bR:null,E:null,p:null,be:null,Z:null,H:!1,F:null,t:null,x:null,r:null,O:!1,Y:!1,o:null,G:null,i:function(){return this.o?this.o.c():null},w:null,a:function(){return this.w},d:function(n){this.w=n;return n},D:!1,j:function(){return this.D},b:function(){return this.H},u:function(n){if(n!==this.H){this.H=n;this.bk("IsSending");var t=this.bb.a;t.dn(_u.P.M);t.dm(n)}return n},l:function(){return this.W()&&this.Y},m:function(){return null},q:0,k:function(){return!1},W:function(){return this.E.a().bs().Enabled&&this.ba.bc.a()==="Mouse"&&!this.ba.bo()&&!this.bc.A()&&!!this.ba.bu&&!!this.ba.bE&&this.bc.l()!==3},cu:function(){return!!this.E&&this.E.a().b().Enabled},f:function(){return this.x},M:function(){if(this.ba.bG()&&!this.o){_js.Trace.logInfo(_a.a.a,"Setting send component override");this.o=this.ba.bF().e();var s=this.ba.ce();var u=this.ba.P();var o=u,e=u,f=u,n=u,r=s,i=s,t=s;this.o.d(this.ba.u(),this.bo,this.J,this.bG,this.bD,this.bj,this.bi,this.ba.X,this.bb.a.bL,o.n||(o.n=Function.createDelegate(o,o.i)),e.m||(e.m=Function.createDelegate(e,e.t)),f.l||(f.l=Function.createDelegate(f,f.r)),n.k||(n.k=Function.createDelegate(n,n.R)),r.b||(r.b=Function.createDelegate(r,r.f)),i.e||(i.e=Function.createDelegate(i,i.h)),t.a||(t.a=Function.createDelegate(t,t.d)));this.bk("InvalidRecipientsDialogViewModel")}},L:function(){if(this.o){this.o.a();this.o=null;this.bk("InvalidRecipientsDialogViewModel")}},g:function(){this.M();var n=this.ba.P();if(n){n.U(this.S);n.T(this.J);n.E(this.S);n.D(this.J)}_mcp.k.prototype.g.call(this)},bh:function(){this.u(!1);this.L();_mcp.k.prototype.bh.call(this)},e:function(){_js.Trace.logInfo(_a.a.a,"ResumeSend() called by external mail-compose component.");this.X()},bw:function(){return null},bv:function(){return null},br:function(){return null},X:function(){var i=this.ba;var n=this.bc;var t=i.d();i.cG().e();i.dg().a();if(t.b()){t.k(!0);_js.Trace.logInfo(_a.a.a,"Send deferred due to in progress save.")}if(n.g()||n.h()||n.D()){if(!t.h()){this.ba.P().j();_js.Trace.logInfo(_a.a.a,"Send without pending saves, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bh.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bh.ParentFolderId):"null");this.N()}}else{var r=n.b();_js.Trace.logInfo(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",r)}},N:function(){var t=this.ba;var r=this.bc;var n=t.bw.e(t,1);_js.Trace.logInfo(_a.a.a,"Submitting send action");var i=_g.j.a;_bc.k.isInstanceOfType(i)?_h.n.isInstanceOfType(n)?n.bD(this.y):_h.j.isInstanceOfType(n)&&n.be(this.y):this.bY();t.X.a(n,this.bW(),this.bV(),this.bs);_js.Trace.logInfo(_a.a.a,"Send action submitted")},bH:function(){var i=this.bb.a.O;var t=this.ba.P();var n=null;this.u(!1);if(t.f()){this.K();n=_js.l.b(_bc.x,65);this.p.a(_a.bE,new _a.bE(_u.R.cR))}if(t.h()){this.K();n=_js.l.b(_bc.x,66)}this.ba.Q();this.h();n=n||"CancelSend_UnknownError";this.n(n,null,null)},h:function(){var n=this;_js.g.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.D=!1},2e3)},cc:function(n){var t;var i=_a.b.l(n.t);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.cM(n.t,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:i==="ErrorAccountSuspendShowTierUpgrade"?98:i==="ErrorExceededMaxRecipientLimitShowTierUpgrade"?99:i==="ErrorExceededMessageLimitShowTierUpgrade"?100:_y.t.c(n.t,45,55,62,700,88,89,46,58))}return t},bW:function(){return this.be||this.bC},bV:function(){return this.Z||this.bx},cJ:function(n){this.be=n},cI:function(n){this.Z=n},cM:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.R.b(i)==="Value"&&_a.R.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.R.a(i))){t.val=48;return!0}}t.val=-1;return!1},cF:function(){if(this.o&&!this.o.e()){_js.Trace.logInfo(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.A.stPT(_a.a.a,"MailComposeSend",5);this.O=!0;this.t=_y.i.b(_a.a.a,"MailComposeSend",!0);_mcp.g.isInstanceOfType(this.ba)&&this.bc.gw(!0);if(this.W()){this.x=_y.i.b(_a.a.a,"MailComposeSendAsync",!0);if(_mcp.h.isInstanceOfType(this.ba)){var n=this.ba;_g.o.isInstanceOfType(this.bc.d())&&n.bk&&(this.r=_y.i.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_js.Trace.logInfo(_a.a.a,"SendStart:Context:{0}",this.bc);this.bI();this.bc.C()?this.cz():this.cf();this.ba.U().a("Send")},cz:function(){var n=this;var t=function(t){n.n(_js.l.b(_bc.x,t),null,null);n.bc.fS(null);n.bH();t!==-1&&n.dm(_u.R.LT,t)};if(this.bc.ff())this.ch(t);else{var i=this;this.ba.ce().i(13,function(n){if(i.bc.fS(n))i.ch(t);else{t(-1);_js.Trace.logWarning(_a.a.j,"The send is canceled due to unavailable cert.")}})}},ch:function(n){this.cL();var t=new _h.cP(200,this.bc.ff(),!0);var i=this,r=this;this.bb.a.X.a(t,function(){_js.Trace.logInfo(_a.a.j,"Retrieving certs info completed.");if(t.A.IsValid){i.V(null);i.cf()}else{_js.Trace.logWarning(_a.a.j,"Retrieving certs info determined the certificate is INVALID.");var r=t.A.ChainValidityStatus;i.V(r.toString());switch(r){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.a.j,"Retrieving certs info failed. "+t.t.message);r.V(t.D());n(743)},null)},cf:function(){_js.Trace.logInfo(_a.a.a,"User chose to send, start force resolve recipients");this.D=!0;this.ba.P().W(!0)},cy:function(){if(this.H){_js.Trace.logInfo(_a.a.a,"Skip send since another send is in progress");return}this.u(!0);this.D=!1;_js.g.a().i(_a.a.a,"MailComposeSend");_js.Trace.logInfo(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.cx(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.bf():this.u(!1);r=!1}finally{if(r){this.u(!1);_js.Trace.logWarning(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.n("SendFailure_UnhandledException",null,null)}}},bf:function(){this.bc.fM(!1);if(this.ba.N.R()){this.bc.co(new _cmc.R);this.bc.gz(this.bc.cI().b)}if(this.o)this.o.b();else{this.X();if(this.W()&&!this.bc.cN()){var n=this.bN();if(!n){_js.Trace.logInfo(_a.a.a,"Navigating away after submitting action for send via notification");this.bc.fM(!0);this.Y=!0;this.bZ();this.bY();this.ca()}}}},ca:function(){this.bS()},bS:function(){var n=this;this.ba.bu.a(function(){n.p.a(ISendEvent,new _mcp.bb(n.ba))})},bN:function(){var n=!1;if(this.ba.bE.c()){var i=this;this.ba.bE.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.ba.bu.c()){var t=this;this.ba.bu.a(function(t){t.a()>0&&(n=!0)})}return n},bY:function(){if(_mcp.h.isInstanceOfType(this.ba)&&_g.o.isInstanceOfType(this.bc.d())&&this.bc.cb()){var n=this.ba;if(n.bk&&n.bA){var u=this.bc.d();var r=_cmc.e.b(n.bk.bh,n.bA,this.bc.k()||this.bc.bp(),this.bc.bp(),"sentitems");var f="MC:"+r.InternetMessageId;this.p.a(_a.bS,new _a.bS(f,this.bc));_h.d.z(r,u.bh.InternetMessageId,n.bR?u:null);var i="OMC:"+n.bk.bh.ConversationId.Id;var t=n.ci.c[i];if(t)t.d.c(n.bA.bh.InternetMessageId);else{t=new _cmc.S(n.bA.bh.InternetMessageId);this.p.a(_a.bS,new _a.bS(i,t))}if(this.r){_y.i.a(this.r);this.r=null}}}},cx:function(n){n.val=!1;var h=this.bb;var i=h.a;var t=i.P();var o=i.T();var s=i.O;var c=h.b(23);if(this.U.a(i.N.b())){_js.Trace.logInfo(_a.a.a,"User had already discarded, skipping send.");this.n("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.h()){_js.Trace.logInfo(_a.a.a,"Not valid to send since sender's address is invalid");s.a(66,null);this.ba.Q();this.n("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!i.N.N()&&t.I()){_js.Trace.logInfo(_a.a.a,"Not valid to send since no recipients were specified");s.a(70,null);this.ba.Q();this.n("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.f()){_js.Trace.logInfo(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, HasInvalidRecipients={1}",t.h(),t.f());t.S();this.K();this.ba.Q();this.n("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_js.Trace.logInfo(_a.a.a,"Not valid to send since attachment is in progress");var f=i.W;f.i||f.a(0,_u.R.OJ,null,!1,null,null,null,f.v);this.n("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bh.MaxRecipientsPerMessage<t.u()){s.a(800,null);this.ba.Q();this.n("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.bk.a&&c.d()){_js.Trace.logInfo(_a.a.a,"Not valid to send since policy violation detected");var l=i.W;l.a(0,c.b(),null,!1,null,null,null,l.v);this.n("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.d.a(this.ba.N.v())){n.val=!0;var u=i.W;u.i||u.b(2,[_nbs.a.Qn],this.bm,!1,_nbs.a.Rp,_nbs.a.Hj,_nbs.a.Jg,u.v,null);return!1}else if(o&&o.a()&&this.ba.ca)if(this.F)return this.bL();else{n.val=!0;var r=this;this.ba.ca.a(function(n){r.F=n.a(r.ba.W,r.w);r.bL()?r.bf():r.u(!1)})}else if(this.bc.A())if(this.bc.M()){_a.F.a(_u.R.IP,0);this.n("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.H()){_a.F.a(_u.R.RH,0);this.n("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.bc.x()){var e=new _ff.d;var a=this;this.bc.x().q(function(n){_g.m.isInstanceOfType(n)||_g.x.isInstanceOfType(n)||_g.z.isInstanceOfType(n)||e.c(n.bh.Name)});if(e.d.length>0){_a.F.a(String.format(_u.R.aT,e.d.join(", ")),0);this.n("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bL:function(){var n=this.ba.T();try{if(this.F.a(this.ba.N,n.a().b())){this.n("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.F,this.ba.N,n.a().b())}return!0},cG:function(n){var s=this.bb;var i=s.a;var t=i.N;var r=n.I;_js.Trace.logInfo(_a.a.a,"Send action succeeded, ContextId={0}; Context:{1}",r,t);this.cH();var u=!1;var h=_g.j.a;_bc.k.isInstanceOfType(h)&&(u=!0);t.cg()&&!u&&this.ba.cd().a(t.k());if(t.eu&&t.eu.length>0){var c=this.bb.a.O;c.a(742,t.eu);_js.Trace.logInfo(_a.a.a,"Showing infobar message for Bcc forking failed");this.u(!1);i.X.d(n);this.n(_js.l.b(_bc.x,742),null,null)}else{if(r===t.b()){t.eK(null);if(this.bc.cb()){_js.Trace.logInfo(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.ba.bu.a(function(){f.p.a(ISendSucceededEvent,new _mcp.bM(i))});this.bc.fD()}else{_js.Trace.logInfo(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",r);this.bZ()}}else _js.Trace.logInfo(_a.a.a,"Context does not match, skipping navigating away from compose.");this.cg("MailSendSucceeded");var e=!i.T()||!i.T().a()?null:i.T().a().bB();var o=this.bT(t,null,e);this.ct(o)}this.p.a(_a.bE,new _a.bE(_nbs.a.CT))},bZ:function(){this.ba.b().a(this.ba,!0)},cC:function(n){var r=this.bb.a;var t=r.N;var e=n.I;_js.Trace.logInfo(_a.a.a,"Send action failed, ContextId={0}; Context:{1}",e,t);var i="SendFailure_UnknownError";var f="";if(_g.V.a(n.t)){i=_g.V.b(n.t);f=n.t.FaultMessage}if(e===t.b()){t.eu&&t.eu.length>0&&this.K();this.u(!1);_js.Trace.logInfo(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.cl(n);var u=this.cc(n);if(this.bc.cb()){_js.Trace.logInfo(_a.a.a,"Raise send failed event for send via notification");t.gv(u);var o=this;this.ba.bE.a(function(){o.p.a(ISendFailedEvent,new _mcp.bL(r))});t.fD()}(u===92||u===100)&&this.ba.d().a("AutoSave",null,null,!1)}else _js.Trace.logInfo(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.n(i,this.cv(n),f);r.X.d(n)},K:function(){var n=this.bb.a.O;var t=this.bb.a.P();if(this.cu()){n.b(97);n.a(97,t.J())}else n.a(65,null)},cB:function(n){this.bQ();this.cs()},cv:function(n){var t=null;_h.p.isInstanceOfType(n)&&n.E?t=n.E.correlationId:_h.n.isInstanceOfType(n)&&n.E&&(t=n.E.correlationId);return t},cD:function(){this.bb.a.dc()&&this.w.b&&this.w.a()},cH:function(){var t=this.ba.P();var n=this.ba.T();_js.Trace.logInfo(_a.a.a,"Check to see if we have attachments to set permissions for");n.a()&&n.a().r()&&n.a().bh(t.Q())},bT:function(n,t,i){var r;if(n){var e=n.e()==="HTML"?"html":"text";var f;f=n.a()===1||n.a()===2||n.a()===3?n.g()?"yes":"no":"na";var u=new _a.q;u.b("BT",e);u.b("U",f);n.eD!==-1&&u.a("S",n.eD);u.a("O",n.a());_js.d.a(t)||u.b("E",t);r=u.toString()}else r=null;r?i&&(r=r+"|"+i):r=i;return r},n:function(n,t,i){var r=this.bT(this.bc,i,null);if(this.t){_y.i.a(this.t,null,n,t,r);this.t=null}if(this.x){_y.i.a(this.x,null,n,t,r);this.x=null}this.bO(n,t,r);this.bQ()},ct:function(n){if(this.t){_y.i.a(this.t,null,null,null,n);this.t=null}this.bO(null,null,n)},bQ:function(){if(this.O){_a.A.endPT("MailComposeSend");this.O=!1}},cs:function(){this.ba.P().o("Send")},bO:function(n,t,i){if(this.r){if(this.bc.cb()){_js.Trace.logError(this.bd(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.i.a(this.r,null,n,t,i);this.r=null}},cw:function(n,t){n?this.bf():this.n("MissingSubject_NotSent",null,'No subject was specified, and user chose "Don\'t Send"')},cA:function(n){var i=this.bb;var r=i.a;var t=r.N;_h.j.isInstanceOfType(n)&&n.Z(this.y);_h.n.isInstanceOfType(n)&&n.bC(this.y);t.cg()&&this.ba.cd().a(t.k())},cL:function(){this.G=_a.d.b(_a.a.j,"SMIMEGetCertsInfo");this.G.j=this.cr()},V:function(n){this.G.k=n;_a.d.a(this.G)},cr:function(){var n=new _a.q;n.b("S","S");return n.toString()}};_mcp.bA=function(n){_mcp.bA.initializeBase(this,[27,n])};_mcp.bA.prototype={j:null,h:function(n,t){this.dm(n,t)},d:function(n){this.cb(n)},i:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.a.j,i.message);if(_a.M.b(i)){_a.M.c(i,n);e.cb(i);t(null)}else{_a.j.o(i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.j.p(!0,!0,!1,!1,!1);if(i)if(_a.M.d(i))this.cb(i);else throw i;_js.Trace.logInfo(_a.a.j,"S/MIME choosing a cert...");var r;var u=_g.a.a();r=u.bh.SmimeAdminSettings.AllowUserChoiceOfSigningCertificate&&u.a().bh.ManuallyPickCertificate?u.a().bh.SigningCertificateId:null;_js.Trace.logInfo(_a.a.j,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.j.b.f(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.M.a("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},f:function(n,t,i,r){_js.Trace.logInfo(_a.a.j,"Building S/MIME data package...");var u=this.q();this.t(u,t);try{var o=this.n();var e=this.p(t);var f=this;_a.j.b.i(u,o,e,this.bc.ff(),function(t){f.o(t,n,i,r)})}catch(s){this.l(s,r)}},t:function(n,t){var r=_g.a.a().bh.SmimeAdminSettings;var i=_g.a.a().a();var l=this.bc.a();var c=this.bc.l();var h=r.AlwaysSign;var o=r.AlwaysEncrypt;var u=i.bh.SmimeSign;var f=i.bh.SmimeEncrypt;var e=r.ClearSign;var s=r.TripleWrapSignedEncryptedMail;_js.Trace.logInfo(_a.a.j,"Admin.AlwaysEncrypt="+o);_js.Trace.logInfo(_a.a.j,"Admin.AlwaysSign="+h);_js.Trace.logInfo(_a.a.j,"Admin.IsClearSign="+e);_js.Trace.logInfo(_a.a.j,"Admin.TripleWrap="+s);_js.Trace.logInfo(_a.a.j,"User.AlwaysEncrypt="+f);_js.Trace.logInfo(_a.a.j,"User.AlwaysSign="+u);_js.Trace.logInfo(_a.a.j,"User.SigningCert="+i.bh.SigningCertificateSubject);_js.Trace.logInfo(_a.a.j,"User.SigningCertId="+i.bh.SigningCertificateId);_js.Trace.logInfo(_a.a.j,"Context.Encrypt="+this.bc.q());_js.Trace.logInfo(_a.a.j,"Context.Sign="+this.bc.C());this.j=_a.d.b(_a.a.j,"SMIMECreateSmimeFromMessage");this.j.j=this.m(n,t,l,c,h,o,u,f,e,s)},q:function(){var n;var t=_g.a.a().bh.SmimeAdminSettings;if(!this.bc.C()&&this.bc.q())n=6;else if(this.bc.C()&&!this.bc.q())n=t.ClearSign?11:10;else if(this.bc.C()&&this.bc.q())n=t.TripleWrapSignedEncryptedMail?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");return n},p:function(n){var t;if(n===2&&this.bc.q()){var r=this.ba.P();var u=r.i();var e=r.t();var f=r.r();var i=u+e;switch(this.bc.ew){case 0:t=this.bc.cV();break;case 1:t=this.bc.eJ(0,i);break;case 2:t=this.bc.eJ(i+this.bc.eH,1);break;case 3:t=this.bc.eJ(i,f);break;default:t=null;break}}else t=null;return t?JsonParser.serialize(t):null},n:function(){var n=new _g.o;n.cr(this.bc.fx());n.C().a()==="HTML"&&n.C().b(_a.E.f(n.C().bh.Value,!0));this.r(n,this.ba.T().a().b());n.cR(new _g.bg);n.bh.From.Mailbox=this.bc.cl();if(!n.bh.From.Mailbox){var t=_g.a.a().c();n.bh.From.Mailbox=new _g.d;n.bh.From.Mailbox.Name=t.bh.UserDisplayName;n.bh.From.Mailbox.EmailAddress=t.bh.UserEmailAddress||t.bh.LogonEmailAddress;n.bh.From.Mailbox.MailboxType="Mailbox";n.bh.From.Mailbox.RoutingType="SMTP"}n.cp(new(_a.fJ.$$(_g.d)));this.bc.i()&&n.k().g(this.bc.i().f());n.cA(new(_a.fJ.$$(_g.d)));this.bc.n()&&n.m().g(this.bc.n().f());_zz.d.f(n,!!this.bc.h(),this.bc.ev,this.bc.fe(),this.bc.es,this.bc.fa());n.bV(this.bc.t());n.dC(this.bc.ba());n.cQ(this.bc.z());n.iC(_a.c.a());n.cT(this.bc.bd());n.cS(this.bc.bb());if(n.fr(this.bc.bw())){n.ge(this.bc.fB());n.fo(this.bc.eZ());n.fm(this.bc.cF());n.fn(this.bc.cG())}return JsonParser.serialize(n.bh)},r:function(n,t){if(t&&t.y.length){var i=new(_a.fK.$$(_g.Attachment,_g.bz));var f=new _ff.d;var s=this;t.q(function(t){var o=t;var r=o.a();if(r.p){_js.Trace.logInfo(_a.a.j,"Skipping SmimeDataPackage.");return}if(!(_g.m.isInstanceOfType(r)||_g.x.isInstanceOfType(r)||_g.z.isInstanceOfType(r))){_js.Trace.logWarning(_a.a.j,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.bh.Name);return}if(n.C().a()==="HTML"&&r.b()&&n.C().bh.Value.indexOf(r.bh.ContentId)<0){_js.Trace.logInfo(_a.a.j,"Removing unreferenced inline attachment: {0}",r.bh.ContentId);f.c(o);return}if(_g.z.isInstanceOfType(r)){var e=r;var u=new _g.x;u.e(e.bh.Name);u.j(e.bh.ContentType||"message/rfc822");u.i(e.a());u.q(e.bh.MimeContent);i.c(u)}else i.c(r)});for(var u=f.d,e=u.length,r=0;r<e;++r){var o=u[r];this.ba.T().a().j(o,!1)}n.Y(i.b()>0?i:null)}},o:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.M.c(_a.M.a("Cannot encode the message.",u.ErrorCode),15);this.l(f,r)}else{_js.Trace.logInfo(_a.a.j,"S/MIME data package built successfully.");this.k(null);this.bc.gx(u.Data);i(t)}},l:function(n,t){_js.Trace.logWarning(_a.a.j,n.message);this.k(n.name.toString());if(_a.M.b(n))this.cb(n);else{_a.j.o(n,"Unknown error occurred when building data package.");n=_a.M.c(_a.M.a(n.message,11),15);this.cb(n)}t(n)},k:function(n){this.j.k=n;_a.d.a(this.j)},m:function(n,t,i,r,u,f,e,o,s,h){var c=new _a.q;c.a("ST",n);c.b("SC",_a.gh.toString(t));c.b("O",_y.n.toString(i));c.b("M",_y.dC.toString(r));c.c("AS",u);c.c("AE",f);c.c("UAS",e);c.c("UAE",o);c.c("CS",s);c.c("TW",h);return c.toString()}};_mcp.bz=function(n,t){_mcp.bz.initializeBase(this,[21,n]);this.a=t};_mcp.bz.prototype={a:null,g:function(){if(!this.c()&&this.a.a().a().e()===2&&this.a.k().c().a()){var n=this.bb.b(5);n&&n.a()&&n.d()&&n.a().bk()}_mcp.bh.prototype.g.call(this)}};_mcp.l=function(n,t,i,r,u){this.q=Function.createDelegate(this,this.y);this.r=Function.createDelegate(this,this.D);this.u=Function.createDelegate(this,this.w);_mcp.l.initializeBase(this,[11,n,i,r]);this.m=new _C(this.u,this.bd());this.n=t;this.l=_a.UserAgent.getInstance();this.h=_a.bc.a();this.d=u};_mcp.l.a=function(n,t){return t?n.bh.SignatureHtml:n.bh.SignatureText};_mcp.l.prototype={m:null,n:null,d:null,p:null,o:null,l:null,h:null,f:null,k:null,j:null,e:!1,b:function(){var t=this.bb.a.N;var n=t.e()==="HTML"&&this.n.a();return n?this.o:this.p},a:function(){return this.bb.a.N.cT()&&this.x()?!0:!1},g:function(){var n=_g.a.a().a();n.apcl("SignatureText",this.r);if(!this.c()){this.t();!this.d||this.o||this.p||this.d.apcl("CurrentStatus",this.q);_mcp.k.prototype.g.call(this)}},bh:function(){var n=_g.a.a().a();n.rpcl("SignatureText",this.r);this.d&&this.d.rpcl("CurrentStatus",this.q);_mcp.k.prototype.bh.call(this)},t:function(){var u=_g.a.a().a();var i=this.v(u,!0);if(_js.d.a(i)){_js.Trace.logInfo(_a.a.a,"No html signature.");this.o=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var n=_mcp.l.f+e+i.replace(_mcp.l.e," ")+f;_js.Trace.logInfo(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",i,n);this.bq.a().Z().Enabled&&(n=this.F(n));n=this.E(n);this.o=n}var t=this.v(u,!1);if(_js.d.a(t)){_js.Trace.logInfo(_a.a.a,"No plain text signature.");this.p=null}else{var r="\n"+t;_js.Trace.logInfo(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.p=r}},bw:function(){if(!this.ba.V()){this.f=new _fm.d(_nbs.a.Bt,null,this.m);this.f.bf(_nbs.a.Bt);this.f.a(!this.i());return[this.f]}return null},bv:function(){this.k=_mcp.k.a(this.m,_nbs.a.Bt);this.k.a(this.i());return[this.k]},br:function(){if(!OwaApplication.b){this.j=new _y.h(_nbs.a.Bt,this.m);this.e=!1;if(this.i()){this.e=!0;return[this.j]}}return null},bB:function(){this.f&&this.f.a(!this.i())},bE:function(){this.k&&this.k.a(this.i())},ce:function(){var n=this.ba.dx;if(n&&this.j)if(this.e&&!this.i()){n.t(this.j);this.e=!1}else if(!this.e&&this.i()){n.x(this.j);this.e=!0}},x:function(){var t=_g.a.a().a();if("Mouse"===_y.c.a.a()){var n=this.bc.a();var i=1===n||2===n||3===n||12===n;return i?t.bh.AutoAddSignatureOnReply:t.bh.AutoAddSignature}return this.l.c()?this.h.b("MOWA.IsSignatureChanged")==="true"?this.h.b("MOWA.AutoAddSignature")==="true":!0:t.bh.AutoAddSignatureOnMobile},v:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.l.a(n,t);if(this.l.c()){if(this.h.b("MOWA.IsSignatureChanged")==="true")if(this.h.b("MOWA.UseDesktopSignature")==="true")return _mcp.l.a(n,t);else{var r=this.h.b("MOWA.SignatureText")||"";return t?_a.u.b(r):r}return t?_a.u.b(_c.x.a(this.l)):_c.x.a(this.l)}if(n.bh.UseDesktopSignature)return _mcp.l.a(n,t);else{var i=n.bh.SignatureTextOnMobile||"";return t?_a.u.b(i):i}},i:function(){var t="Mouse"===_y.c.a.a()||_g.a.a().a().bh.UseDesktopSignature;var n=t?_g.a.a().a().bh.SignatureText:_g.a.a().a().bh.SignatureTextOnMobile;return!_js.d.b(n)},w:function(){var i=this.bb.a.N;var u=_g.a.a().a();i.cq(!0);var r=i.e()==="HTML"&&this.n.a();var t=!_js.d.a(this.b());if(t){var n=new _cmc.d(0,this.b(),r);n.l=!0;n.m=!1;this.ba.bn().a(n)}else _js.Trace.logInfo(_a.a.a,"Skip insert signature due to HasSignature={0};",t)},y:function(n,t){this.d.rpcl("CurrentStatus",this.q);if(this.d.a===2){this.t();if(this.bc.eB&&this.a()){var r=this.bc.e()==="HTML"&&this.n.a();var i=new _cmc.d(2,this.b(),r);this.bc.co(i)}}},F:function(n){return n.replace(_mcp.l.c,'<img class="'+_mcp.l.d+'" '+"$2"+"$3")},E:function(n){var e=n.match(_mcp.l.b);if(!e)return n;for(var u=$("<div>"),o=e,s=o.length,i=0;i<s;++i){var f=o[i];u.html(f+"</a>");var r=u.find("a");r&&r.length===1&&(r[0].id="LPNoLP");var t=u.html();t=t.substr(0,t.length-4);n=n.replace(f,t)}return n},D:function(n,t){this.t();this.bp()}};_mcp.bB=function(n){this.t=Function.createDelegate(this,this.p);this.r=Function.createDelegate(this,this.o);this.u=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.y);_mcp.bB.initializeBase(this,[10,n]);this.l=new _C(this.v,this.bd())};_mcp.bB.prototype={l:null,m:null,n:!1,q:!1,a:function(){return this.l},f:function(){return this.m},F:function(n){if(n!==this.m){this.m=n;this.bk("CloseConfirmDialogButtonData")}return n},h:function(){return this.n},j:function(n){if(n!==this.n){this.n=n;this.bk("IsCloseConfirmDialogShown")}return n},G:function(n){if(n!==this.q){this.q=n;this.bk("IsAppBarSetup")}return n},b:function(){_js.Trace.logInfo(_a.a.a,"Setup appbar menu. Context: {0}",this.bc);var n=new _ff.d;this.k(n,11);this.k(n,1);this.k(n,29);this.k(n,6);this.k(n,3);this.k(n,9);this.ba.dx.f(n.d);this.G(!0)},g:function(){_js.Trace.logInfo(_a.a.a,"InitTouchComponent:Context:{0}",this.bc);this.ba.bc.a()==="TouchNarrow"?this.D():this.ba.dx||this.z();this.bb.b(21);_mcp.bh.prototype.g.call(this)},i:function(n,t){if(this.ba.bi)return!1;else if(this.ba.be().f()){this.n||this.y();return!0}else if(this.ba.N.bn()&&!this.w()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.o();return!0}else{this.ba.G(!0);return!1}},A:function(){return OwaApplication.b?null:new _y.f(_y.b.bi(),_y.b.bj(),_u.P.h,this.ba.bg().b())},w:function(){return this.ba.e().b()},z:function(){var e=new _y.f(_y.b.z(),_y.b.A(),_u.P.W,this.ba.e().a());var o=_y.f.a(_nbs.a.Qy,this.l);var u=this.A();var r=this.C();var i=2;i+=u?1:0;i+=r?1:0;var n=new Array(i);var t=0;n[t++]=e;u&&(n[t++]=u);n[t++]=o;r&&(n[t++]=r);_js.Trace.logInfo(_a.a.a,"Creating appbar. ContextId={0}",this.bc.b());var f=_y.k.a(this.ba,n,null);f.L("TouchNarrow"===_y.c.a.a());this.ba.dP(f)},D:function(){var n=new _ms.b;if(_a.UserAgent.getInstance().b()){n.e(2);n.h(_nbs.a.XC);n.f(new _ms.a(_fm.a.a,_fm.a.a,this.l,_u.R.ba));n.g(new _ms.a(_fm.a.a,_fm.a.a,this.ba.e().a(),_u.R.LS));n.i.a(!0)}else{n.e(1);n.h(_nbs.a.Os);n.f(new _ms.a(_y.b.a(),_y.b.a(),this.l,""));n.n(new _ms.a(_fm.a.f,_fm.a.f,null,""));n.m(this.ba.bm().a());var t=this.ba.T().j();if(t&&t.d.length>0){if(t.d.length>1){n.g(new _ms.a(_y.b.B(),_y.b.B(),null,""));n.F(new _fm.f(t.d))}else{var i=t.d[0].k;n.g(new _ms.a(_y.b.B(),_y.b.B(),i,""))}n.l(new _ms.a(_y.b.p(),_y.b.p(),this.ba.e().a(),""))}else n.g(new _ms.a(_y.b.p(),_y.b.p(),this.ba.e().a(),""))}this.ba.dR(n)},y:function(){_js.Trace.logInfo(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",this.bc);if(this.w()){_js.Trace.logInfo(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.ba.be().f()){this.H();_js.Trace.logInfo(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.j(!0)}else if(this.bc.bn()){_js.Trace.logInfo(_a.a.a,"Removing unedited reply forward draft on close.");this.o()}else{_js.Trace.logInfo(_a.a.a,"Navigate away due to unmodified message.");this.x()}},p:function(){_js.Trace.logInfo(_a.a.a,"Hide close confirm dialog");this.j(!1)},H:function(){if($a(this.m)){_js.Trace.logInfo(_a.a.a,"Create close confirm dialog.");var n=new _js.f;OwaApplication.b||n.a(new _ff.f(new _C(this.u,this.bd()),_u.P.d,_nbs.a.mQ,!0));n.a(new _ff.f(new _C(this.r,this.bd()),_u.R.Ik,_u.R.VB,OwaApplication.b));n.a(new _ff.f(new _C(this.t,this.bd()),_bcs.D.A,_u.R.at));this.F(n)}},E:function(){_js.Trace.logInfo(_a.a.a,"User select save and close");this.p();this.ba.d().j().a()},o:function(){_js.Trace.logInfo(_a.a.a,"User select discard and close");this.p();this.ba.be().h();this.x()},x:function(){var n=this.ba;n.b().a(n,!1)},C:function(){if(this.bc.cc())return null;var n=new _ff.d;var o=this.ba.T();var t=o.o();if(t&&t.length>0)for(var r=t,e=r.length,i=0;i<e;++i){var u=r[i];n.c(u)}if(n.d.length===1){var f=n.d[0];return new _y.f(_y.b.Y(),_y.b.Z(),_u.P.P,f.a())}else return new _y.f(_y.b.Y(),_y.b.Z(),_u.P.P,null,n.d)},k:function(n,t){var r=null;var i=this.bb.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_js.Trace.logInfo(_a.a.a,"Getting app-bar items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.c());i.c()||i.g();r=i;n.i(r.z())}}};_mcp.bC=function(n,t,i){this.G=Function.createDelegate(this,this.N);this.D=Function.createDelegate(this,this.I);this.H=Function.createDelegate(this,this.T);this.E=Function.createDelegate(this,this.P);this.q=Function.createDelegate(this,this.J);this.F=Function.createDelegate(this,this.S);_mcp.bC.initializeBase(this,[12,n]);this.u=this.bb.a.bs;this.m=t;this.M=i};_mcp.bC.prototype={u:null,m:null,M:null,w:null,o:null,n:null,A:null,z:null,C:null,t:null,l:null,a:function(){this.t||(this.t=new _C(this.F,_a.a.a));return this.t},j:function(){var n=this.bb.a.N;return this.h()&&!n.S()},i:function(){var n=this.bb.a.N;return this.h()&&n.S()&&!this.l&&!n.D()},h:function(){return this.f()&&this.ba.V()&&!this.bc.A()},f:function(){var n=this.ba.N.a();return n===1||n===2||n===3},e:function(){return this.j()||this.i()},p:null,b:function(){return this.p},k:function(n){this.p=n;return n},g:function(){if(this.h()){var n=this.ba.N;if(n.S()&&n.D()){_js.Trace.logInfo(_a.a.U,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.x();this.ba.Q()}}_mcp.bh.prototype.g.call(this)},d:function(){_a.A.stPT(_a.a.a,"MailComposeUpgrade",3);this.o=_y.i.b(_a.a.a,"MailComposeUpgrade",!0);this.p=_y.i.b(_a.a.a,"MailComposeQuoteBody",!0);var i=this.bb.a;var n=i.N;var u=n.b();this.w=u;if(!n.g()){if(!this.h()){var f=this;_js.g.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.g()||n.D()||u!==f.w||f.y(i.O)},5e3)}var t;t=this.m.a()||n.e()!=="HTML"?n.e()==="Text"?_h.b.m():_h.b.c():_h.b.K();if(t===_h.b.c()||t===_h.b.K()){t.BlockExternalImages=n.d().bh.HasBlockedImages;t.FilterHtmlContent=n.d().bh.HasBlockedImages}var r=i.bw.c(n,t);n.a()===12&&(r.R=new _g.Q(new _g.A("internalsubmission")));r.bN(this.q);_js.Trace.logInfo(_a.a.U,"Begin upgrade, context:{0}; OriParentFolderId={1}",n,n.d()&&n.d().bh.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.d().bh.ParentFolderId):"null");r.g="MailComposeUpgrade";if(n.bl()){var e=new _mcp.E(r);i.X.a(e,this.E,this.H,null)}else i.X.a(r,this.D,this.G,null)}},P:function(n){var t=n;this.I(t.b)},T:function(n){var i=n;var t=i.b;t.bz(this.q);this.N(t);this.O(n.t,t.I,t.E?t.E.correlationId:null,this.bb.a.N)},I:function(n){var c=this.bb;var e=c.a;var r=e.N;var t=n;var h=e.be();var u=t.f;var i=n.I;var o=t.E?t.E.correlationId:null;var l=!!t.b;if(this.u.a(i)){_js.Trace.logInfo(_a.a.U,"Check upgrade callback, resume discard for context {0}",i);h.b(i,u)}else if(i===r.b()){r.F(u);_js.Trace.logInfo(_a.a.U,"Context match, updated the draft id. Context:{0}; ResponseMessageBodyType={1}",r,l&&t.b.C()?t.b.C().a():"null");var f=e.d();var s=e.e();if(!f.b()&&s.b()){_js.Trace.logInfo(_a.a.U,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.r("SkipUpgrade",o,"Skip upgrade since send is in progress");s.e();return}if(f.b()&&f.h()){_js.Trace.logInfo(_a.a.U,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.r("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.i();return}}if(t.b){_js.Trace.logInfo(_a.a.U,"Check upgrade, action has response message, call complete upgrade. context:{0}; ActionItemId={1}",r,_h.bh.a(u));this.J(n)}else if(n.I===r.b()){_js.Trace.logInfo(_a.a.U,"Check upgrade: action has id only, updated draft id. context:{0}; ActionItemId={1}",r,_h.bh.a(u));this.K()}},Q:function(n){n.db()&&this.bb.a.O.a(3050)},J:function(n){var o=this.bb;var r=o.a;var t=r.N;var i=n;var c=i.E?i.E.correlationId:null;var e=n.I;i.bz(this.q);if(e===t.b()){t.dl(i.b);this.l=i.b;t.gB(i.b.bx());try{if(this.h())if(t.S()){_js.Trace.logInfo(_a.a.U,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.v();this.bn("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.ba.Q()}else t.cs(!0);else this.v();i.b.S()&&t.bq(i.b.S().e);var s=r.T();s.u()}finally{t.g()&&r.O.b(3440);_js.Trace.logInfo(_a.a.U,"IsUpgraded for context is {0}",t.g())}this.Q(t);this.ba.Q();_js.Trace.logInfo(_a.a.U,"Complete upgrade context:{0}",t);var u=r.d();if(u.b())u.i();else if(_a.bk.a){var f=this.bb.b(23);var h=this;_js.g.a().c(_a.a.a,"TriggerPolicyTipsIfNeeded",function(){f&&f.a(32)})}r.S.a(_y.eb,new _mcp.bH(t.Z().bh.ItemId.Id,r))}else _js.Trace.logInfo(_a.a.U,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",e,t)},S:function(){this.n=_y.i.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.bb.a.N;n.dA(!0);if(this.l||n.Z()&&n.g()){this.l||(this.l=n.Z());_js.Trace.logInfo(_a.a.U,"user requests for quoted body, upgrade was successful, complete the body merge");this.v();this.bn("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.D()){_js.Trace.logInfo(_a.a.U,"user requests for quoted body, upgrade failed, show error message");this.bn("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.x();this.ba.Q();this.L()}else{_js.Trace.logInfo(_a.a.U,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bn("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},v:function(){var n=this.bb.a.N;var e=!1;if(this.m.b()){if(n.en()){n.et.a();n.K()===n.en().a()&&(e=!0)}else n.eN=!0;n.eM=!0}if(this.ba.V()&&this.h()&&this.l.C()&&n.e()!==this.l.C().a()&&this.m.a()){var f=this.l.C().bh.Value;if(n.e()==="HTML")n.eL(_a.u.b(f));else{var i;var o,r;r=_a.u.a(f,o={val:i}),i=o.val,r;n.eL(i);var h=this;n.eF=function(n){n.T().t(!1)}}}else if(this.m.a()||n.e()!=="HTML"){var u=this.l.C().bh.Value;n.eL(!this.m.b()&&n.e()==="Text"?_a.u.F(u):u)}else n.eL(this.l.by().bh.Value);if(_y.c.a.a()==="Mouse"||this.m.b()){var t=new _cmc.d(2,n.cR(),n.e()==="HTML");t.o=!1;t.t=!0;var c=this;t.u=function(){n.cs(!0)};this.ba.bn().a(t)}else n.cs(!0);if(e){n.et.a();n.en().r(n.K());var s=n.ep;s&&n.ep.r(n.K())}this.K()},N:function(n){var h=this.bb;var i=h.a;var u=i.N;var s=i.be();var r=n;var f=r.E?r.E.correlationId:null;r.bz(this.q);u.dU(!0);var t=n.I;if(this.u.a(t)){_js.Trace.logInfo(_a.a.U,"Resume discard for context {0}",t);s.b(t,r.f)}else if(t===u.b()){_js.Trace.logInfo(_a.a.U,"Recording on context upgrade failed");var e=i.d();var o=i.e();if(e.b()){if(e.h()){_js.Trace.logInfo(_a.a.U,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",t);this.r("SkipUpgrade",f,"Skip upgrade since saving is in progress");e.i();return}this.y(i.O)}else if(o.b()){_js.Trace.logInfo(_a.a.U,"Skipping upgrade for context {0} since send was triggered during upgrade",t);this.r("SkipUpgrade",f,"Skip upgrade since send is in progress");o.e();return}else this.y(i.O);if(this.h()&&u.S()){_js.Trace.logInfo(_a.a.U,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bn("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.x();this.ba.Q()}}n.t&&this.O(n.t,t,f,u)},O:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.V.a(n)){f=_g.V.b(n);u=n.FaultMessage}_js.Trace.logWarning(_a.a.U,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.r(f,i,u)},y:function(n){if(!this.h()){n.b(3440);n.a(3440,null);this.ba.Q()}},x:function(){var n=this.bb.a.O;n.b(3450);n.a(3450,null)},r:function(n,t,i){this.A=n;this.z=t;this.C=i;if(this.o){_y.i.a(this.o,null,n,t,i);this.o=null;_a.A.endPT("MailComposeUpgrade")}if(this.p){_y.i.a(this.p,null,n,t,i);this.p=null}this.L()},K:function(){if(this.o){_y.i.a(this.o);this.o=null;_a.A.endPT("MailComposeUpgrade")}this.R()},R:function(){if(this.n){_y.i.a(this.n);this.n=null}},L:function(){if(this.n){_y.i.a(this.n,null,this.A,this.z,this.C);this.n=null}}};_mcp.bs=function(n,t){this.h=Function.createDelegate(this,this.i);_mcp.bs.initializeBase(this,[17,n]);if(_a.cw.a){var i=this;t.a(function(t){i.d=t.a(n.b(1),n.a.O);i.d.d(i.h);if(i.e){i.d.b();i.e=!1}if(i.f){i.d.a();i.f=!1}})}};_mcp.bs.prototype={d:null,e:!1,f:!1,g:function(){if(!_a.cw.a){_mcp.bh.prototype.g.call(this);return}this.d?this.d.b():this.e=!0;_mcp.bh.prototype.g.call(this)},a:function(n){if(_a.cw.a){if(n===32){var r=this.bb;var i=r.a;var t=i.N;if(t.cM()){i.O.b(4400);i.O.a(4400);this.ba.Q()}if(!t.a()||t.a()===3||t.a()===11)return}this.c()||this.g();this.j()}},b:function(){if(_a.cw.a){this.c()||this.g();if(this.d){_js.Trace.logInfo(_a.a.a,"Remove MailTips for deleted recipients");this.d.c()}else _js.Trace.logInfo(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},j:function(){if(_a.cw.a)if(this.d){_js.Trace.logInfo(_a.a.a,"Prepares to submit mailtips action");this.d.a()}else{_js.Trace.logInfo(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},i:function(){_a.cw.a&&this.ba.Q()}};_mcp.bw=function(n,t){this.h=Function.createDelegate(this,this.i);_mcp.bw.initializeBase(this,[30,n]);if(t){var i=this;t.a(function(t){i.d=t.a(n.b(1),n.a.O);i.d.d(i.h);if(i.e){i.d.a();i.e=!1}if(i.f){i.d.b();i.f=!1}})}};_mcp.bw.prototype={d:null,e:!1,f:!1,g:function(){this.d?this.d.a():this.e=!0;_mcp.bh.prototype.g.call(this)},b:function(n){this.c()||this.g();this.j()},a:function(){this.d&&this.d.c(!0)},j:function(){if(this.d){_js.Trace.logInfo(_a.a.a,"Prepares to submit PeopleRecommendations action");this.d.b()}else{_js.Trace.logInfo(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.f=!0}},i:function(){this.ba.Q()}};_mcp.by=function(n,t){this.p=Function.createDelegate(this,this.x);this.o=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.u);this.l=Function.createDelegate(this,this.t);_mcp.by.initializeBase(this,[23,n]);if(_a.bk.a){var i=this;t.a(function(t){i.f=t.a(i.bb.b(1),i.bb.b(5),n.a.O);i.f.i(i.l);i.f.e(i.m);i.f.d(i.n);i.f.f(i.o);i.f.g(i.p);if(i.i){i.f.b();i.i=!1}if(i.j){i.a(i.k);i.j=!1}})}};_mcp.by.prototype={h:null,f:null,i:!1,j:!1,k:0,g:function(){if(!_a.bk.a){_mcp.bh.prototype.g.call(this);return}this.f?this.f.b():this.i=!0;_mcp.bh.prototype.g.call(this)},bl:function(){this.h&&(this.h=_js.g.a().b(this.h));_js.u.prototype.bl.call(this)},d:function(){if(!_a.bk.a)return!1;switch(this.q()){case 1:return!1;case 2:case 3:return $a(this.bb.a.N.bX())&&$a(this.bb.a.N.bW());case 4:case 5:return $a(this.bb.a.N.bW());default:return!1}},b:function(){if(!_a.bk.a)return"";switch(this.q()){case 2:case 3:return _u.P.O;case 4:case 5:return _u.P.Z;default:return""}},e:function(){if(_a.bk.a){if(!this.f){_js.Trace.logInfo(_a.a.E,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.h(!0);if(!$a(this.bb.a.N.bX())){var n=_a.d.b(_a.a.E,"DlpPolicyTipOverridden");_a.d.a(n)}}},a:function(n){this.r(n,0)},y:function(n,t,i){_js.Trace.logInfo(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.en()){u=_a.E.b(n.en().f());r=_a.E.b(n.en().a())}else{u=_a.E.b(n.t());r=_a.E.b(n.K())}this.f.c(i,n.x(),u,r,t)},r:function(n,t){if(_a.bk.a){if(!this.f){_js.Trace.logInfo(_a.a.E,"Remember to resume triggering policy tips once the handler is created");this.k=n;this.j=!0;return}var f=this.bb;var e=f.a;var r=e.N;this.c()||this.g();this.h&&(this.h=_js.g.a().b(this.h));var i=r.h();if(i){_bc.g.a(i)&&!_g.j.b&&(i=_g.j.a.q(i));if(_bc.g.a(i)){if(t<4){var u=this;this.h=_js.g.a().a(_a.a.E,"TriggerPolicyTipsIfNeeded",function(){u.r(n,t+1)},5e3)}}else this.y(r,n,i)}}},q:function(){this.c()||this.g();return this.f?this.f.a():0},t:function(){this.ba.Q()},u:function(n){var r=this.bb;var i=r.a;var t=i.N;t.dk(n)},v:function(n){var r=this.bb;var i=r.a;var t=i.N;t.dj(n)},w:function(){this.a(64)},x:function(n){var r=this.bb;var i=r.a;var t=i.N;t.di(n)}};_mcp.A=function(n,t){this.P=Function.createDelegate(this,this.bq);this.L=Function.createDelegate(this,this.bj);this.N=Function.createDelegate(this,this.bo);this.O=Function.createDelegate(this,this.bp);this.K=Function.createDelegate(this,this.bi);this.M=Function.createDelegate(this,this.bm);this.U=Function.createDelegate(this,this.bg);this.V=Function.createDelegate(this,this.bu);_mcp.A.initializeBase(this,[22,n]);this.F=!1;this.R=t;this.G=new _C(this.V,_a.a.h);this.G.c(!1)};_mcp.A.a=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 2;default:throw Error.argument();}};_mcp.A.prototype={H:null,I:0,F:!1,T:!1,E:null,R:null,Q:null,G:null,a:function(){return this.E},br:function(n){if(this.E!==n){this.E=n;this.bn("ExtensibilityViewModel","ShouldShowAppsButton")}return n},b:function(){return this.G},h:function(){return!!this.E&&this.E.d()&&this.G.b},D:function(){return this.E?this.E.b():!0},bs:function(n){if(n!==this.T){this.T=n;this.bk("RequestCloseComposeForm")}return n},g:function(){if(!OwaApplication.b&&!this.c()){var n=this;this.R.a(function(t){if(!n.E){n.Q=t;n.br(t.d(n,n.U));var i=n.bb.a.cb();n.E.q(i.a());var r=n.bb.a.S;r.b(_a.dk,n.M);n.E.f();i.apcl(i.b(),n.K);n.E.h(n.O);n.E.g(n.N);if(n.E.w()){n.G.c(n.E.a().b);n.S()}else n.E.a().k(n.L);n.E.apcl("ShowAppsButton",n.P);_mcp.bh.prototype.g.call(n);if(n.bc.eY()&&n.bc.eY().length>0){n.W(n.bc.eY());n.bc.df(null)}}})}},W:function(n){if(!this.H){var s;var i=null;var o;if(this.bb.a.N.g()){o=this.bb.b(5);i=o.a()}else _js.Trace.logInfo(_a.a.h,"Attachment not added - well not upgraded.");if(!i&&this.I<10){var u=this;this.H=_js.g.a().a(this.bd(),"MailComposeExtensibilityComponent - add attachments from context on delay",function(){u.I++;u.H=null;u.W(n)},100*this.I)}else for(var t=0;t<n.length;t++)if(n[t][0]==="file")this.X(i,n[t][2],n[t][1],!0);else if(n[t][0]==="item"){var r=new _g.z;r.q(new _g.g(n[t][2]));r.e(n[t][1]);var f,e;e=this.Y(i,r,f={val:s},!0),s=f.val,e}}},S:function(){this.bk("ShouldShowAppsButton");if(this.ba.de()){var n=this.bb.b(28);n.z(this.h())}},bq:function(n,t){this.S()},X:function(n,t,i,r){var f=this.Q.b(t,i);var u=n.O(f);u.z(r);return u},Y:function(n,t,i,r){i.val=0;var f=_y.J.b(t);var e=_a.d.b(_a.a.c,"AttachmentExtensibilityItemAttachments");var u=new _ff.d;n.x(f,u,e);if(!u.d.length){_js.Trace.logInfo(_a.a.h,"Attachment not added - max number exceeded.");i.val=9001;return null}u.d[0].z(r);return u.d[0]},bh:function(){if(this.c()){var n=this.bb.a.cb();n.rpcl(n.b(),this.K);this.E.o(this.O);this.E.n(this.N);this.E.k();var t=this.bb.a.S;t.c(_a.dk,this.M)}_mcp.bh.prototype.bh.call(this)},d:function(){return _y.c.a.a()==="Mouse"?this.bb.a.N.e():this.bb.a.N.cK()?"HTML":"Text"},t:function(){return this.bb.a.N.v()},z:function(n){this.bb.a.N.I(n)},r:function(n,t,i){i.val=0;var r=new _cmc.f(n);this.bb.a.N.cv(r);r.d&&(i.val=9016);t.val=r.e;return r.a},y:function(n,t,i){i.val=0;var r=new _cmc.i(n,!0,t);this.bb.a.N.cv(r);r.q?i.val=2006:r.r&&(i.val=9016)},o:function(){this.bs(!0);this.bk("RequestCloseComposeForm")},q:function(n){return this.ba.P().v(_mcp.A.a(n))},C:function(n,t){return this.Z(n,t,!1)},x:function(n,t){this.Z(n,t,!0)},m:function(n,t){return this.bf(n,t,!1)},bf:function(n,t,i){t.val=0;if(!this.bb.a.N.g()){_js.Trace.logInfo(_a.a.h,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.bb.b(5);if(r.a())return this.Y(r.a(),n,t,i);else{_js.Trace.logInfo(_a.a.h,"ComposeFormNotReadyForAttachments in mail module");t.val=9015;return null}},l:function(n,t,i){return this.be(n,t,i,!1)},be:function(n,t,i,r){i.val=0;if(!this.bb.a.N.g()){_js.Trace.logInfo(_a.a.h,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.bb.b(5);var u=f.a();if(u)return this.X(u,n,t,r);_js.Trace.logError(_a.a.h,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},k:function(){return this.bb.a.N.bj()?this.bb.a.N.bj().Id:null},i:function(n,t){var i=new _cmc.d(0,n,t);i.m=!0;i.l=!0;this.J(i)},j:function(n,t){var i=new _cmc.d(1,n,t);this.J(i)},v:function(n,t){var r=this,i=this;this.bb.a.d().d(function(t){n()},function(n){_js.Trace.logInfo(_a.a.h,"SaveActionFailed: Error: {0}",n.t.message);t()})},p:function(n){var t=new _cmc.u(n);this.bb.a.N.co(t);return t.a},w:function(n,t,i){i.val=0;var r=new _cmc.I(n,t);this.bb.a.N.co(r);r.c&&(i.val=2006)},bu:function(){this.E&&this.E.y()},bj:function(n,t){this.G.c(this.E.a().b);this.S()},bp:function(){if(_y.c.a.a()==="TouchWide"&&this.E.l()){var n=this.bb.a;n.dl(6)}},bo:function(){var n=this.bb.a;n.dl(4)},J:function(n){this.ba.bn().a(n)},f:function(){return this.bb.a.N.h()?this.bb.a.N.h().Id:null},e:function(){this.bb.a.N.L()||this.bb.a.N.dp(new _js.f);return this.bb.a.N.L()},u:function(){},A:function(){var n=new _cmc.h(null);this.J(n)},n:function(n){var t=new _cmc.h(n);this.J(t)},bl:function(){this.E.rpcl("ShowAppsButton",this.P);this.E.a().i(this.L);_js.u.prototype.bl.call(this)},Z:function(n,t,i){i&&this.ba.P().V(_mcp.A.a(n));var e=this.ba.P().v(_mcp.A.a(n));var u=t.d.length;if(u+e.y.length>500)return!1;n===2&&this.bb.a.P().q().a();for(var r=0;r<u;r++){var f=t.d[r];this.ba.P().F(f,_mcp.A.a(n))}return!0},bm:function(n){if(this.F){this.F=!1;this.E.e(!1)}},bg:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.bb.a.S;i.a(_a.dD,new _a.dD(!0));this.F=!0}}else if(n===2&&this.F){var t=this.bb.a.S;t.a(_a.dD,new _a.dD(!1));this.F=!1}this.ba.Q()},bi:function(n,t){var i=this.bb.a.cb();t===i.b()&&this.bv(i)},bv:function(n){this.E.q(n.a());n.a()&&this.E.e(!1)}};_mcp.bo=function(n){this.d=Function.createDelegate(this,this.h);this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_mcp.bo.initializeBase(this,[31,n])};_mcp.bo.prototype={a:function(n){n.b(this.f);n.a(this.e);n.c(this.d)},b:function(n){n.e(this.f);n.d(this.e);n.f(this.d)},h:function(n){var t=n.c();_zz.w.b(t,this.bc.es)},j:function(n){var t=n.c();var i=_zz.w.d(t);_zz.w.e(i,this.bc.es);_zz.w.c(t,this.bc.es)},i:function(n){var t=n.c();_zz.w.b(t,this.bc.es)}};_mcp.bi=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){_a.b.b(e,"nativeBridge");this.a=n;this.b=i;this.d=r;this.o=u;this.n=t;this.q=f;this.e=e;this.f=o;this.s=s;this.j=h;this.k=c;this.l=l;this.m=a;this.r=v;this.h=y;this.g=p;this.i=w;this.u=b;this.c=k;this.p=d;this.t=g};_mcp.bi.prototype={a:null,b:null,d:null,o:null,s:null,n:null,q:null,e:null,f:null,j:null,k:null,l:null,r:null,h:null,g:null,i:null,u:null,c:null,m:null,p:null,t:null,v:function(n,t){switch(n){case 0:return new _mcp.bq(this.a,this.d,this.h,!!this.f);case 1:return new _mcp.e(this.a,this.b,this.c);case 2:return new _mcp.r(this.a,this.d,this.b,this.c);case 3:return new _mcp.v(this.a,this.d,this.b,this.c);case 4:return new _mcp.f(this.a,this.i,this.g);case 5:return new _mcp.p(this.a,this.n,this.b,this.d,this.o,this.s,this.a.a.ct,this.m);case 6:return new _mcp.bp(this.a,this.d,this.b,this.c);case 7:return this.b&&this.b.a().bF().Enabled?new _mcp.w(this.a,this.d,this.b,this.c,this.a.a.S):new _mcp.x(this.a,this.d,this.b,this.c,this.a.a.S);case 8:return new _mcp.bg(this.a,this.q,this.d,this.b,this.c);case 9:return new _mcp.bt(this.a,this.f,this.b,this.c);case 10:if("Mouse"!==t)return new _mcp.bB(this.a);break;case 11:return new _mcp.l(this.a,this.d,this.b,this.c,this.t);case 12:return new _mcp.bC(this.a,this.d,this.b);case 13:if(this.e.b(this.e.d())&&this.e.d().a().a())return new _mcp.bx(this.a,this.e);break;case 20:if(this.e.b(this.e.d())&&this.e.d().a().c())return new _mcp.bv(this.a,this.e);break;case 14:return new _mcp.J(this.a,this.g);case 15:if("Mouse"===t)return new _mcp.bk(this.a,this.f,this.b,this.c);break;case 16:if("Mouse"===t)return new _mcp.y(this.a);else if("TouchNarrow"===t)return new _mcp.bl(this.a);break;case 18:return new _mcp.o(this.a,this.c);case 17:return new _mcp.bs(this.a,this.j);case 30:return new _mcp.bw(this.a,this.k);case 23:return new _mcp.by(this.a,this.l);case 19:return new _mcp.z(this.a);case 21:if(this.e.b(this.e.k()))return new _mcp.bz(this.a,this.e);break;case 22:return new _mcp.A(this.a,this.a.a.cv);case 24:if(this.d.a())return new _mcp.br(this.a,this.b,this.r);break;case 31:if(this.d.a()&&this.d.e())return new _mcp.bo(this.a);break;case 25:return t!=="Mouse"?new _mcp.bn(this.a):new _mcp.bm(this.a,this.f);case 27:return new _mcp.bA(this.a);case 28:if(this.b.a().f().Enabled&&t==="Mouse")return new _mcp.s(this.a,this.p,this.c);break;case 29:return new _mcp.bu(this.a,this.f,this.b,this.c)}return null}};_mcp.bD=function(){};_mcp.bD.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.mb;break;case"Personal":i=_nbs.a.TC;break;case"Private":i=_nbs.a.LB;break;case"Confidential":i=_nbs.a.s;break;default:i=_nbs.a.mb;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.q=function(n){_mcp.q.initializeBase(this,[n])};_mcp.q.prototype={a:null,j:function(){},i:function(){},m:function(n){},k:function(n){},l:function(n){},o:function(n){},n:function(n,t){t.val=3;this.a.a();return!0}};_mcp.c=function(){};_mcp.c.U=function(){return _fm.b.a(_fm.a.u,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.u=function(){return _fm.b.a(_fm.a.u,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.V=function(){return _fm.b.a(_fm.a.u,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.T=function(){return _fm.b.a(_fm.a.bp,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.h=function(){return _fm.b.a(_fm.a.bp,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.D=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.o=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.y=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.c.z=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.c.i=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.c.j=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.c.A=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.e,"ms-fcl-ns-b")};_mcp.c.B=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.e,"ms-fcl-nd-b")};_mcp.c.C=function(){return _fm.b.a(_fm.a.o,_fm.WebfontSizes.a.e,"ms-fcl-td-b")};_mcp.c.H=function(){return _fm.b.a(_fm.a.bt,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.J=function(){return _fm.b.a(_fm.a.bt,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.K=function(){return _fm.b.a(_fm.a.bt,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.c.I=function(){return _fm.b.a(_fm.a.bt,_fm.WebfontSizes.a.b,"ms-fcl-nta-b")};_mcp.c.E=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.f=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.S=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_mcp.c.g=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.G=function(){return _fm.b.a(_fm.a.b,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_mcp.c.M=function(){return _fm.b.a(_fm.a.E,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.N=function(){return _fm.b.a(_fm.a.E,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.s=function(){return _fm.b.a(_fm.a.E,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.O=function(){return _fm.b.a(_fm.a.E,_fm.WebfontSizes.a.h,"ms-fcl-tp-b")};_mcp.c.a=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.b=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.c.c=function(){return _fm.b.a(_fm.a.bB,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.c.p=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.q=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.r=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.c.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.c.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.c.F=function(){return _fm.b.a(_fm.a.cP,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.c.k=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.h,"ms-fcl-ns-b")};_mcp.c.m=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.h,"ms-fcl-nd-b")};_mcp.c.n=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.h,"ms-fcl-td-b")};_mcp.c.l=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.h,"ms-fcl-nta-b")};_mcp.c.P=function(){return _fm.b.a(_fm.a.bC,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.Q=function(){return _fm.b.a(_fm.a.bC,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.R=function(){return _fm.b.a(_fm.a.bC,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.c.v=function(){return _fm.b.a(_fm.a.f,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.c.w=function(){return _fm.b.a(_fm.a.f,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.c.x=function(){return _fm.b.a(_fm.a.f,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.c.t=function(){return _fm.b.a(_fm.a.f,"ms-fcl-ns-b")};_mcp.c.L=function(){return _fm.e.a("insertpicture.png")};_mcp.P=function(n){this.b=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.d);_mcp.P.initializeBase(this,[n]);this.a=!1;_y.c.a.o(this.c)};_mcp.P.prototype={a:!1,f:function(n){if(this.a!==n){this.a=n;this.bk("DisplayEllipsis")}return n},d:function(){var n=this;_js.g.a().c(_a.a.a,"MailComposeAggregatedRecipientWell.UpdateEllipsisState",function(){var i=n.x.childNodes&&n.x.childNodes.length>0?n.x.childNodes[0]:null;var t=i&&i.childNodes&&i.childNodes.length>1?i.childNodes[1]:null;var r=t&&t.childNodes&&t.childNodes.length>1?t.childNodes[1]:null;n.f(t?t.offsetWidth<r.offsetWidth:!1)})},K:function(){_js.b.prototype.K.call(this);this.d();if(this.E()&&_mcp.g.isInstanceOfType(this.E())){var n=this.E();n.P().apcl("ShowAggregatedHeader",this.b)}},bl:function(){if(this.E()&&_mcp.g.isInstanceOfType(this.E())){var n=this.E();n.P().rpcl("ShowAggregatedHeader",this.b)}_y.c.a.r(this.c);_js.b.prototype.bl.call(this)},e:function(n,t){this.d()}};_mcp.m=function(n){_mcp.m.initializeBase(this,[n])};_mcp.m.prototype={a:null,b:function(){this.a&&_rw.d.a(this.a.y,this.a.y)},K:function(){_js.b.prototype.K.call(this);this.a=this.F?this.F.a("FromPersona"):null}};_mcp.n=function(n,t,i,r,u,f,e,o,s){this.dS=Function.createDelegate(this,this.hb);this.dZ=Function.createDelegate(this,this.hc);this.ce=Function.createDelegate(this,this.gN);this.eW=Function.createDelegate(this,this.fO);this.dC=Function.createDelegate(this,this.fu);this.df=Function.createDelegate(this,this.ge);this.dg=Function.createDelegate(this,this.gf);this.dk=Function.createDelegate(this,this.gg);this.db=Function.createDelegate(this,this.gb);this.dd=Function.createDelegate(this,this.gd);this.dc=Function.createDelegate(this,this.gc);this.dl=Function.createDelegate(this,this.gh);this.eX=Function.createDelegate(this,this.fr);this.dj=Function.createDelegate(this,this.fq);this.de=Function.createDelegate(this,this.en);this.dM=Function.createDelegate(this,this.gU);this.fj=Function.createDelegate(this,this.eH);this.dq=Function.createDelegate(this,this.gA);this.dL=Function.createDelegate(this,this.gT);this.cB=Function.createDelegate(this,this.gS);this.cz=Function.createDelegate(this,this.gR);this.cy=Function.createDelegate(this,this.gQ);this.cx=Function.createDelegate(this,this.gP);this.dz=Function.createDelegate(this,this.gG);this.cv=Function.createDelegate(this,this.gH);this.cb=Function.createDelegate(this,this.es);this.cu=Function.createDelegate(this,this.et);this.dH=Function.createDelegate(this,this.fv);this.dO=Function.createDelegate(this,this.gW);this.dv=Function.createDelegate(this,this.gE);this.dB=Function.createDelegate(this,this.gJ);this.dP=Function.createDelegate(this,this.gX);this.dt=Function.createDelegate(this,this.gC);this.dD=Function.createDelegate(this,this.gK);this.dE=Function.createDelegate(this,this.gL);this.ed=Function.createDelegate(this,this.ew);this.ea=Function.createDelegate(this,this.he);this.dp=Function.createDelegate(this,this.gz);this.ds=Function.createDelegate(this,this.gB);this.dJ=Function.createDelegate(this,this.ev);this.dI=Function.createDelegate(this,this.gM);this.dK=Function.createDelegate(this,this.gO);this.du=Function.createDelegate(this,this.gD);this.dQ=Function.createDelegate(this,this.gZ);this.dR=Function.createDelegate(this,this.ha);this.ca=Function.createDelegate(this,this.fQ);this.cD=Function.createDelegate(this,this.hd);this.bh=Function.createDelegate(this,this.fm);this.da=Function.createDelegate(this,this.fR);this.fi=Function.createDelegate(this,this.gi);this.cw=Function.createDelegate(this,this.gI);this.dw=Function.createDelegate(this,this.gF);this.dA=Function.createDelegate(this,this.eu);this.eY=Function.createDelegate(this,this.fs);this.cC=Function.createDelegate(this,this.gY);this.fk=Function.createDelegate(this,this.fH);this.dN=Function.createDelegate(this,this.gV);this.dm=Function.createDelegate(this,this.gk);this.dn=Function.createDelegate(this,this.gy);this.bb={};_mcp.n.initializeBase(this,[n]);this.t=t;this.bd=i;this.eh=r;this.bo=u;this.bm=f;this.bI=e;this.ep=o;if(this.bo){this.cl=this.bo.a().k().Enabled;this.bR=this.bo.a().h().Enabled}this.bR&&this.bm.b(IAddHashtagEvent,this.dn);if(this.cl){this.bm.b(IAddAtMentionEvent,this.dm);this.bm.b(_rw.i,this.dN)}if(s){var h=this;s.a(function(n){h.by=n})}this.m={};_js.Trace.logInfo(_a.a.a,"View created with layout={0}",this.t)};_mcp.n.prototype={bx:!1,bd:null,eh:null,bo:null,q:null,Z:null,p:null,cn:null,u:null,bT:!1,cN:!1,cH:!1,cG:!1,bV:!1,cq:!1,cr:!1,bC:!1,cT:!1,co:!1,cm:!1,cI:!1,bS:!1,er:!1,bI:null,bm:null,ep:null,bQ:!1,by:null,cJ:!1,cl:!1,bR:!1,v:function(){return this.m?this.m.EditorControl:null},fn:function(){return this.bo.a().bl().Enabled},fS:function(){var n;n=this.t==="TouchNarrow"?50:100;return n},fT:function(){var t=this.t==="Mouse"||this.ej()?1:3;var i=this.E();if(i)if(i.V())t=2;else{var n=i.N;this.t==="Mouse"||this.ej()||n.g()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},bg:function(n){if(this.p!==n){this.hm(n,this.p);this.p=n;this.hn()}return n},fY:function(){return _y.c.a.h()||this.ek()?!1:this.cN},cS:function(n){if(this.cN!==n){this.cN=n;this.bk("IsToRecipientWellPeoplePickerButtonShown")}return n},fW:function(){return _y.c.a.h()||this.ek()?!1:this.cH},cP:function(n){if(this.cH!==n){this.cH=n;this.bk("IsCcRecipientWellPeoplePickerButtonShown")}return n},fV:function(){return _y.c.a.h()||this.ek()?!1:this.cG},cO:function(n){if(this.cG!==n){this.cG=n;this.bk("IsBccRecipientWellPeoplePickerButtonShown")}return n},ga:function(){var n=this.E();return n&&n.N&&n.bb()?n.N.R()&&n.bb().a():!0},m:null,t:0,ee:null,fc:function(){return!0},ey:function(n){if(this.cm!==n){this.cm=n;this.bk("IsReadyToShowContent")}return n},ez:function(n){if(this.bS!==n){this.bS=n;this.bk("IsReadyToShowEditor");this.bS&&this.eI()}return n},ex:function(n){if(this.cI!==n){this.cI=n;this.bk("IsReadyToShowAppBarContent")}return n},bs:function(n){if(this.bT!==n){this.bT=n;this.bk("ShouldPreventShiftTabDefault")}return n},hf:function(n){this.er=n;this.bk("IsTabAnchorNeeded");return n},ej:function(){return this.eh.b()},fZ:function(){return this.E()?this.E().bM:!1},em:function(){return this.m.SubjectTextBox.y},fX:function(){return this.bR||this.cl},fU:function(){return!this.bd.b()||this.t!=="TouchNarrow"},G:function(){return _a.a.a},ek:function(){return this.bo.a().f().Enabled&&this.t==="Mouse"},fx:function(n){if(this.bQ!==n){this.bQ=n;this.bW();this.bO()}return n},cF:function(){return 500},fo:function(){return 1500},eH:function(){this.cn?this.n(this.cn):this.hg()},hg:function(){if(!this.E()){_js.Trace.logInfo(_a.a.a,"No data context yet, skipping set initial focus");return}var n=this.E();if(this.hj()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to To well. Context:{0}",n.N);if(this.bd.b()||this.bd.d()){var r=this.m.ComposeViewContent;r.M(!1);this.eg();this.bb&&this.bb.ToRecipientWellControl&&this.bb.ToRecipientWellControl.removeAttr("disabled");this.n("ToRecipientWellControl")}else{var i=this;_js.g.a().a(_a.a.a,"SetFocusToRecipientWell",function(){i.n("ToRecipientWellControl")},this.cF())}}else if(this.hi()){_js.Trace.logInfo(_a.a.a,"Set initial focus to subject. Context: {0}",n.N);this.n("SubjectTextBox");if(this.bd.a()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to subject for IE. Context:{0}",n.N);var t=this;_js.g.a().a(_a.a.a,"SetFocusToSubject",function(){t.n("SubjectTextBox")},this.cF())}}else{_js.Trace.logInfo(_a.a.a,"Set initial focus to body. Context: {0}",n.N);if(this.bd.a()){_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus to body for IE. Context:{0}",n.N);_js.g.a().a(_a.a.a,"SetFocusToEditor",this.fk,this.fo())}else this.fH()}},hj:function(){var n=this.E();return n.P().i()<1},hi:function(){return _js.d.a(this.m.SubjectTextBox.y.val())},f:function(n){},d:function(n){this.cT=!this.E();if(this.cT)_js.Trace.logInfo(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.E();var i=t.bb();if(i.c()){this.co=!!this.m.EditorControl;this.co?this.P()?t.cc()&&!t.bI?t.apcl("IsReadyForViewInitialization",this.cC):this.cf():_js.Trace.logInfo(_a.a.a,"PostTransitionIn view not active yet. Context:{0}",t.N):_js.Trace.logInfo(_a.a.a,"PostTransitionIn template not applied yet. Context:{0}",t.N)}else this.fI(i,t.N);this.t==="Mouse"&&t.dq()}this.bC=!0},g:function(){this.bC=!1;_js.Trace.logInfo(_a.a.a,"PreTransitionOut view");var n=this.p;this.cn=n;if(n&&n in this.m)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.eg();this.bV=!0;var t=this.bb[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.a.a,"Blur from {0}",n);t.blur()}this.p=null;this.bV=!1;break;case"EditorControl":this.bV=!0;this.m.EditorControl.cy();this.p=null;this.bV=!1;break}else _js.Trace.logInfo(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},e:function(){_js.Trace.logInfo(_a.a.a,"PostTransitionOut view");this.cS(!0);this.cP(!1);this.cO(!1);this.fw();this.ey(!1);this.ez(!1);this.ex(!1)},V:function(){this.bp();return!0},i:function(){var n=this.E();return n.R.b(5).f()},h:function(n){var t=this.E();if(t){_cmc.e.e(n.a(),JsonParser.serialize(n))&&n.b(_cmc.e.c(n.a(),t.N.h()));t.T().w(n)}},c:function(n){var i=this.E();if(i){var t=i.T().a();t.H(n.c());t.I(n.b());t.G(n.a());t.bN(n.e());t.bM(n.d());t.k().a()}},bl:function(){_js.Trace.logInfo(_a.a.a,"Disposing view");if(this.cl){this.bm.c(IAddAtMentionEvent,this.dm);this.bm.c(_rw.i,this.dN)}this.bR&&this.bm.c(IAddHashtagEvent,this.dn);this.hl();this.ho();this.eJ();this.bb=null;this.m=null;this.p=null;_js.b.prototype.bl.call(this)},K:function(){_js.b.prototype.K.call(this);var n=this.F;var t=null;this.E()&&(t=this.E());if(n){this.m.SubjectTextBox=n.a("SubjectTextBox");this.m.FromFieldControl=n.a("FromFieldControl");this.m.ToRecipientWellControl=n.a("ToRecipientWellControl");this.m.CcRecipientWellControl=n.a("CcRecipientWellControl");this.m.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.m.EditorControl=i;this.m.ComposeViewContent=n.a("ComposeViewContent");i.fu=!t.V();i.dC=t.V()?0:2;this.m.CancelConfirmDialog=n.a("CancelConfirmDialog");this.m.MessageBox=n.a("MessageBox");this.m.ComposeDockPanel=n.a("ComposeDockPanel");this.m.ToRecipientButton=n.a("ToRecipientButton");this.m.CcRecipientButton=n.a("CcRecipientButton");this.m.BccRecipientButton=n.a("BccRecipientButton");this.m.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.m.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.m.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.m.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.m.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");if(this.t==="Mouse"){this.m.SendButton=n.a("SendButton");this.m.DiscardButton=n.a("DiscardButton");this.m.InsertButton=n.a("InsertButton");this.m.AppsButton=n.a("AppsButton");this.m.AffordanceMenuButton=n.a("AffordanceMenuButton");this.m.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.m.ComposeAppsPane=n.a("ComposeAppsPane");this.bx=t.N.e()==="HTML"}this.ee=new _C(this.eY,this.G());this.hh();if(this.bC&&!this.co){_js.Trace.logInfo(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:{0}",t?t.N:"null");this.d(null)}else _js.Trace.logInfo(_a.a.a,"Applying template. Context:{0}",!t||!t.N?"null":t.N.toString());this.m.EditorControl&&this.m.EditorControl.apcl("IsPlainTextContent",this.dA)}else{_js.Trace.logInfo(_a.a.a,"Applying null template. Context:{0}",t?t.N.toString():"null");this.m.SubjectTextBox=null;this.m.FromFieldControl=null;this.m.ToRecipientWellControl=null;this.m.CcRecipientWellControl=null;this.m.BccRecipientWellControl=null;this.m.EditorControl=null;this.m.CancelConfirmDialog=null;this.m.MessageBox=null;this.m.ComposeDockPanel=null;this.m.AttachmentWellViewWrapper=null}this.fJ()},bB:function(){var t=new _b.f(this.ep);t.i("ShowAddressBook");var r=this;t.k=new _C(function(){r.n("ToRecipientWellControl")},this.G());var n=new _fc.g;n.a([t]);var i=_js.c.prototype.bB.call(this);return i?i.concat(n):[n]},Q:function(){_js.c.prototype.Q.call(this);if(this.E()){var t=this.E();var i=t.N;var n=t.bb();i.apcl("IsUpgraded",this.dw);this.bx=i.e()==="HTML";if(this.cT)if(n.c()){_js.Trace.logInfo(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: {0}",t.N);this.d(null)}else this.fI(n,i);n.d()||n.apcl("IsSecondInitializationComplete",this.cw);t.P().X(this.fi)}else _js.Trace.logInfo(_a.a.a,"Updated DataContext to null")},J:function(){_js.b.prototype.J.call(this);if(this.bC&&this.E()&&this.co){var t=this.E();var n=t.bb();n.c()&&this.cf()}},O:function(){this.fw();_js.b.prototype.O.call(this)},ef:function(){var n=this.E();if(this.cr){_js.Trace.logInfo(_a.a.a,"Events already bound. Context:{0}",n.N);return}if(this.bd.b()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.da);var u=this;_js.g.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.da)},1e3)}this.q=new _ff.d;if(this.t==="Mouse"){this.q.c(new _mcp.n.a("DiscardButton",this.bh));this.q.c(new _mcp.n.a("InsertButton",this.bh));this.q.c(new _mcp.n.a("AppsButton",this.bh));this.q.c(new _mcp.n.a("AffordanceMenuButton",this.bh));this.q.c(new _mcp.n.a("OpenSeperateWindowButton",this.bh));this.q.c(new _mcp.n.a("ToRecipientButton",this.bh))}this.q.c(new _mcp.n.a("SubjectTextBox",this.bh));this.q.c(new _mcp.n.a("FromFieldControl",this.bh));this.q.c(new _mcp.n.a("ToRecipientWellControl",this.cD));this.q.c(new _mcp.n.a("CcRecipientWellControl",this.cD));this.q.c(new _mcp.n.a("BccRecipientWellControl",this.cD));this.q.c(new _mcp.n.a("AttachmentWellViewWrapper",this.bh));this.Z=new _ff.d;this.Z.c(new _mcp.n.a("FromFieldControl",this.ca));this.Z.c(new _mcp.n.a("ToRecipientWellControl",this.ca));this.Z.c(new _mcp.n.a("CcRecipientWellControl",this.ca));this.Z.c(new _mcp.n.a("BccRecipientWellControl",this.ca));if(n.cc()){n.bf.addEventListener("focusin",this.dR,!0);n.bf.addEventListener("focusout",this.dQ,!0)}else{for(var i=0;i<this.q.d.length;i++)this.m[this.q.d[i].a].y.bind("focusin",{uiComponent:this.q.d[i].a},this.q.d[i].b);for(var t=0;t<this.Z.d.length;t++)this.m[this.Z.d[t].a].y.bind("focusout",{uiComponent:this.Z.d[t].a},this.Z.d[t].b)}this.fl();this.m.CancelConfirmDialog.apcl("IsHidden",this.du);this.m.MessageBox.apcl("IsHidden",this.dK);this.bO();n.O.apcl("ActionPerformed",this.dI);n.O.apcl("Count",this.dJ);n.T().n(this.ds);if(!$a(this.m.ComposeAppsPane)){this.m.ComposeAppsPane.apcl("IsHidden",this.dp);_y.c.a.o(this.ea);_y.c.a.o(this.ed);_g.a.a().b().F(this.dE)}if(this.bI.b(this.bI.e())&&this.t==="TouchWide"){var r=n.bg().a();if(r){r.i(this.dD);r.r(this.dt)}}n.N.apcl("SelectedDataCallContext",this.dP);n.N.apcl("EditorCallContext",this.dB);n.bb().apcl("CanLoadPopoutSuccessfully",this.dv);n.bg().apcl("RequestCloseComposeForm",this.dO);this.m.FromFieldControl.apcl("IsHidden",this.dH);this.m.CcRecipientWellControl.apcl("IsHidden",this.cu);this.m.BccRecipientWellControl.apcl("IsHidden",this.cb);this.cr=!0},eJ:function(){var n=this.E();if(n){var o=n.bb();o.rpcl("IsInitialized",this.cv);o.rpcl("IsSecondInitializationComplete",this.cw);var h=n.N;h.rpcl("IsUpgraded",this.dw)}if(!this.cr){_js.Trace.logInfo(_a.a.a,"Events aren't bound. Context:{0}",n?n.N.toString():"null");return}if(this.m){"CancelConfirmDialog"in this.m&&this.m.CancelConfirmDialog.rpcl("IsHidden",this.du);"MessageBox"in this.m&&this.m.MessageBox.rpcl("IsHidden",this.dK);this.bW();this.m&&this.m.BccRecipientWellControl&&this.m.BccRecipientWellControl.rpcl("IsHidden",this.cb);this.m.CcRecipientWellControl&&this.m.CcRecipientWellControl.rpcl("IsHidden",this.cu);this.m.FromFieldControl&&this.m.FromFieldControl.rpcl("IsHidden",this.dH);if(n&&n.cc()){var f=n.bf;if(f&&!f.closed){f.removeEventListener("focusin",this.dR,!0);f.removeEventListener("focusout",this.dQ,!0)}}else{for(var t=0;t<this.q.d.length;t++)this.q.d[t].a in this.m&&this.m[this.q.d[t].a].y.unbind("focusin",this.q.d[t].b);for(var i=0;i<this.Z.d.length;i++)this.Z.d[i].a in this.m&&this.m[this.Z.d[i].a].y.unbind("focusout",this.Z.d[i].b)}"EditorControl"in this.m&&this.m.EditorControl.rpcl("IsPlainTextContent",this.dA)}if(n){_js.Trace.logInfo(_a.a.a,"Unbind view events on view model. Context:{0}",n.N);n.bm()&&n.bm().a()&&n.bm().a().rpcl("IsShown",this.dz);var r=n.bC();if(r){r.rpcl("DialogViewModel",this.cx);r.a()&&r.a().rpcl("IsShown",this.cy)}var u=n.bD();if(u){u.rpcl("DialogViewModel",this.cz);u.a()&&u.a().rpcl("IsShown",this.cB)}var s=n.P();s&&s.rpcl("IsPeoplePickerShown",this.dL);n.O.rpcl("ActionPerformed",this.dI);n.O.rpcl("Count",this.dJ);n.T().q(this.ds);n.rpcl("IsReadyForViewInitialization",this.cC);n.T().a()&&n.T().a().D(this.dq);if(this.bI.b(this.bI.e())&&this.t==="TouchWide"){var e=n.bg().a();if(e){e.p(this.dD);e.x(this.dt)}}n.N.rpcl("SelectedDataCallContext",this.dP);n.N.rpcl("EditorCallContext",this.dB);n.bb().rpcl("CanLoadPopoutSuccessfully",this.dv);n.bg().rpcl("RequestCloseComposeForm",this.dO)}if(this.m.ComposeAppsPane){this.m.ComposeAppsPane.rpcl("IsHidden",this.dp);_y.c.a.r(this.ea);_y.c.a.r(this.ed);_g.a.a().b().N(this.dE)}this.cr=!1},en:function(n){_js.Trace.logInfo(_a.a.a,"Focused in the RTE");this.p!=="EditorControl"&&this.bg("EditorControl")},fm:function(n){var i=n.data;var t=i.uiComponent;this.ei(t)},hd:function(n){this.fm(n);this.eo()},fQ:function(n){_js.Trace.logInfo(_a.a.a,"User blured from {0}",this.p);if(this.E()&&_mcp.d.isInstanceOfType(this.E())&&!this.bV&&!this.E().bi){var t=this.E().P();if(this.p==="FromFieldControl"&&t&&t.e()){var o=t.e().a();_js.d.a(o)||t.y(o,!0)}var i=null;var e=!0;switch(this.p){case"ToRecipientWellControl":i=this.m.ToReadWriteRecipientWellView;break;case"CcRecipientWellControl":i=this.m.CcReadWriteRecipientWellView;break;case"BccRecipientWellControl":i=this.m.BccReadWriteRecipientWellView;break;default:e=!1;break}if(e&&i&&t&&t.d()){var r=i.E();r&&r.v()&&!r.v().bd()&&t.d().f()}if(_a.cw.a){var u=this;_js.g.a().a(this.G(),"Delayed MailTips retrieval",function(){if(u.E()){var n=u.E().cB();n.a(1)}},100)}if(_a.bk.a){var f=this;_js.g.a().a(this.G(),"Delayed PolicyTips retrieval",function(){if(f.E()){var n=f.E().cG();n.a(1)}},100)}}},bp:function(){if(this.m&&this.P()&&this.bC&&this.p&&this.E()&&!this.E().bi){_js.Trace.logInfo(_a.a.a,"Restore focus to {0}",this.p);this.n(this.p)}else _js.Trace.logInfo(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.m?"non-null":"null",this.P(),this.bC,this.p,this.E()?"non-null":"null")},n:function(n){this.eg();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.bb&&this.bb[n]){this.bb[n].focus();this.bg(n);this.eo()}break;case"EditorControl":if(this.m&&this.m[n]){var t=this.m.EditorControl;t.bs(new _cmc.p(!1));this.bg(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":case"AttachmentWellViewWrapper":if(this.m&&this.r(n)){this.m[n].V();this.bg(n)}break}},eg:function(){if(this.bb&&!("SubjectTextBox"in this.bb)){this.bb.SubjectTextBox=this.m.SubjectTextBox.y;this.bb.FromFieldControl=this.m.FromFieldControl.y.find("input");this.bb.ToRecipientWellControl=this.m.ToRecipientWellControl.y.find("input");this.bb.CcRecipientWellControl=this.m.CcRecipientWellControl.y.find("input");this.bb.BccRecipientWellControl=this.m.BccRecipientWellControl.y.find("input")}},eu:function(n,t){this.fl();var i=this.E();this.bx=i.N.e()==="HTML";this.bx||this.fp();if(this.bd.a())this.eH();else{_js.Trace.logInfo(_a.a.a,"Queue task to set initial focus after EditorBodyType changed for non-IE browsers.");_js.g.a().a(_a.a.a,"ResetInitialFocusOnEditorBodyTypeChanged",this.fj,this.cF())}},fR:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},hh:function(){this.m.FromFieldControl.eC(this.dM)},gz:function(n,t){var i=this.m.ComposeAppsPane;if(this.bC){i.bv()?this.n("ToRecipientWellControl"):this.eI();this.ew()}},gE:function(n,t){this.bk("ShouldHideSpinner")},gX:function(n,t){var i=this.E();var u=this.p||this.cn;if(u==="SubjectTextBox"){i.N.u().c("subject");this.m.SubjectTextBox.r(i.N.u())}else if(u==="EditorControl"){if("EditorControl"in this.m){var r=this.m.EditorControl;if(r.Z)r.bs(i.N.u());else if(_cmc.f.isInstanceOfType(i.N.u()))i.N.u().a=r.ft;else if(_cmc.i.isInstanceOfType(i.N.u())){r.ft=i.N.u().n;r.bs(i.N.u())}}i.N.u().c("body")}else i.N.u().f(!0)},gW:function(n,t){var r=this.E();if(r){var u=r.R;var i=null;if(this.t==="Mouse"){var e=u.b(19);i=e.i()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.t==="TouchNarrow"&&r.bg().a().j()}},gJ:function(n,t){if("EditorControl"in this.m){var i=this.E();this.m.EditorControl.bs(i.N.cI())}},hl:function(){var n=this.m.FromFieldControl;var r=this.m.ToRecipientWellControl;var i=this.m.CcRecipientWellControl;var t=this.m.BccRecipientWellControl;n&&n.fE(this.dM)},gU:function(n){if(this.m.FromFieldControl===n){var t=n.y.find("input");t.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}},gi:function(){var n=this.m.FromFieldControl;n&&n.b()},eo:function(){var t=!0;switch(this.p){case"ToRecipientWellControl":this.cS(!0);this.cP(!1);this.cO(!1);break;case"CcRecipientWellControl":this.cP(!0);this.cS(!1);this.cO(!1);break;case"BccRecipientWellControl":this.cO(!0);this.cP(!1);this.cS(!1);break;default:t=!1;break}if(t){var n=this.E().P();n&&n.d()&&n.d().i()}},fs:function(){var n=!0;if(this.bT){switch(this.p){case"DiscardButton":this.n("SendButton");break;case"InsertButton":this.n("DiscardButton");n=!1;break;case"AppsButton":this.n("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.m.AppsButton;i&&!i.bv()?this.n("AppsButton"):this.n("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.n("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.E();if(t.P().K()||t.O.c.y.length)this.bs(!1);else{var u=this.m.ComposeAppsPane;if(u.bv()){this.n("OpenSeperateWindowButton");n=!1}else this.bs(!1)}break;case"ToRecipientWellControl":if(this.t==="Mouse"){this.n("ToRecipientButton");n=!1}else this.bs(!1);break;case"CcRecipientWellControl":this.n("CcRecipientButton");break;case"BccRecipientWellControl":this.n("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.n("SubjectTextBox");break}if(n){var r=this;_js.g.a().a(this.G(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.bs(!1)},100)}}},hn:function(){if(this.hk()){var n=this.E();switch(this.p){case"ToRecipientWellControl":n.P().b(1);n.P().b(2);break;case"CcRecipientWellControl":n.P().b(0);n.P().b(2);break;case"BccRecipientWellControl":n.P().b(0);n.P().b(1);break;default:n.P().b(0);n.P().b(1);n.P().b(2);break}}},gk:function(n){if(this.v()&&this.by&&n.a()&&n.b()&&(n.c()===this.v().by()||n.c()===this.em()[0])){var i=this.m.ToReadWriteRecipientWellView;var r=this.E();if(r&&i){this.by.b(n.a(),i);var t=r.N;t&&t.bo()&&this.by.a(n.a(),n.b(),t.bo())}}},gV:function(n){if(n.a&&this.by){var i=this.m.ToReadWriteRecipientWellView;var r=this.E();if(r&&i){var t=r.N;t&&t.bo()&&this.by.c(n.a,n.b,i,t.bo())}}},gy:function(n){if(this.v()&&this.by&&n.a()&&n.b()&&(n.c()===this.v().by()||n.c()===this.em()[0])){var i=this.E();if(i){var t=i.N;t&&t.cj()&&(t.cj()[n.b()]=n.a())}}},hk:function(){return this.t!=="Mouse"&&this.E()?!0:!1},gD:function(n,t){if(this.m.CancelConfirmDialog.bv()&&this.E()&&!this.E().bi){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.bp()}},gO:function(n,t){if(this.m.MessageBox.bv()){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message box.");this.bp()}},gH:function(n,t){var i=this.E();if(i.bb().c()){this.cJ&&i.bb().rpcl("IsInitialized",this.cv);_js.Trace.logInfo(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.d(null)}else _js.Trace.logInfo(_a.a.a,"InitializerComponent.IsInitialized = false.")},gF:function(n,t){var i=this.E();i.N.g()&&this.bk("EditorSizingMode")},gI:function(n,t){var i=this.E();i.bb().rpcl("IsSecondInitializationComplete",this.cw);this.t==="Mouse"&&i.bm()&&i.bm().a()&&i.bm().a().apcl("IsShown",this.dz);var u=i.bC();u.a()?u.a().apcl("IsShown",this.cy):u.apcl("DialogViewModel",this.cx);var r=i.bD();r.a()?r.a().apcl("IsShown",this.cB):r.apcl("DialogViewModel",this.cz);var f=i.P();f&&f.apcl("IsPeoplePickerShown",this.dL)},gG:function(n,t){var i=this.E();if(!i.bm().a().i){var u=i.bC();var r=i.bD();var f=this;_js.g.a().a(this.G(),"MailComposeView.OnContextMenuShownChanged",function(){var e=!u.a()||!u.a().i;var t=!r.a()||!r.a().i;var n=!i.W||!i.W.i;if(e&&n&&t){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of context menu");f.bp()}},100)}},gP:function(n,t){var r=this.E();var i=r.bC();i.rpcl("DialogViewModel",this.cx);i.a().apcl("IsShown",this.cy)},gQ:function(n,t){var r=this.E();var i=this;_js.g.a().a(this.G(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.bC().a().i){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of message options dialog");i.bp()}},100)},gR:function(n,t){var r=this.E();var i=r.bD();i.rpcl("DialogViewModel",this.cz);i.a().apcl("IsShown",this.cB)},gS:function(n,t){var r=this.E();var i=this;_js.g.a().a(this.G(),"MailComposeView.OnOmeOptionsShownChanged",function(){if(!r.bD().a().i){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of ome options dialog");i.bp()}},100)},gT:function(n,t){var i=this.E();if(!i.P().L()){_js.Trace.logInfo(_a.a.a,"Restore focus on hide of people picker");this.bp()}},gM:function(n,t){this.bp()},ev:function(n,t){this.fJ();this.eI()},fJ:function(){var a=this.F.a("InfoBarControl");if(a){var f=this.E();if(f.O.c.y.length>0){for(var l=new _y.cM,o=_nbs.a.Gz+". ",n,r=0;r<f.O.c.y.length;r++){n="";var t=f.O.c.y[r];if(_y.bZ.isInstanceOfType(t)){var h=t;h&&(n=h.c)}else if(_y.ca.isInstanceOfType(t)){var e=t;e&&(n=e.c)}else if(_y.bY.isInstanceOfType(t)){var i=t;if(i&&_y.ft.isInstanceOfType(i.c)){var u=i.c;u&&u.a()&&(n=u.a())}}if(n===""){var s=t;s&&(n=l.a(s.a,null))}o+=n+". "}var c=this.F.a("InfoBarControl").y;c.attr("aria-label",o)}}},gB:function(n){n.a().w(this.dq);this.fx(!n.a().m())},gA:function(n){if(n.bv()){n.bQ(!1);this.bg("EditorControl")}this.fx(!n.m());this.bp()},fI:function(n,t){if(this.cJ)_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:{0}",t);else{_js.Trace.logInfo(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:{0}",t);n.apcl("IsInitialized",this.cv);this.cJ=!0}},fP:function(){if(this.cq){_js.Trace.logWarning(this.G(),"Editor events were already bound.");return}var i=this.E().cz();var r=this.E().dd();if("EditorControl"in this.m&&this.m.EditorControl){var n=this.m.EditorControl;n.ia(this.de);n.gM(this.dj);n.mD(this.eX);n.eL(this.dl);n.kJ(this.dc);n.hZ(this.dd);n.b(this.db);n.gN(this.dk);n.mB(this.dg);n.mA(this.df);n.kK(this.dC);i&&i.j(n);r&&r.a(n)}if(this.bd.a()){var t=this.F.a("TabAnchor");t&&t.y.bind("focusin",this.eW)}this.cq=!0},ho:function(){if(!this.cq){_js.Trace.logWarning(this.G(),"Editor events weren't bound. No need to unbind.");return}var i=this.E().cz();var r=this.E().dd();if("EditorControl"in this.m&&this.m.EditorControl){var n=this.m.EditorControl;n.ip(this.de);n.fH(this.dj);n.ei(this.dl);n.kT(this.dc);n.io(this.dd);n.e(this.db);n.ha(this.dk);n.mO(this.dg);n.mN(this.df);n.kU(this.dC);i&&i.k(n);r&&r.b(n)}if(this.bd.a()){var t=this.F.a("TabAnchor");t&&t.y.unbind("focusin")}this.cq=!1},fO:function(n){var t=new _a.Q(n);this.n("EditorControl");t.b()},fq:function(n){_js.d.a(this.u)||this.n(this.u);n.a(!0)},fr:function(n){},bO:function(){this.u=null;this.bQ&&(this.u="AttachmentWellViewWrapper");var n=this.E();n.N.bC()||_js.d.a(this.u)&&this.r("SubjectTextBox")&&(this.u="SubjectTextBox");_js.d.a(this.u)&&this.r("BccRecipientWellControl")&&(this.u="BccRecipientWellControl");if(_js.d.a(this.u)&&this.r("CcRecipientWellControl")){this.u="CcRecipientWellControl";this.m.BccRecipientWellControl.rpcl("IsHidden",this.cb);this.m.BccRecipientWellControl.apcl("IsHidden",this.cb)}_js.d.a(this.u)&&this.r("ToRecipientWellControl")&&(this.u="ToRecipientWellControl");!_js.d.a(this.u)&&this.m&&this.m[this.u]?this.m[this.u].y.bind("keydown",this.ce):_js.Trace.logWarning(this.G(),"Compose form doesn't have any control preceeding editor")},bW:function(){!_js.d.a(this.u)&&this.m&&this.m[this.u]&&this.m[this.u].y.unbind("keydown",this.ce)},r:function(n){if(!this.m)return!1;var t=this.m[n];return!!t&&!t.bv()},es:function(n,t){this.r("BccRecipientWellControl")&&this.n("BccRecipientWellControl");this.bW();this.bO()},et:function(n,t){this.m.CcRecipientWellControl.rpcl("IsHidden",this.cu);this.r("CcRecipientWellControl")&&this.n("CcRecipientWellControl");this.bW();this.bO()},fv:function(n,t){},gh:function(n){var t=this.E();if(t){t.N.dP(n.f());t.N.dm(n.e());t.N.dx(n.c())}n.c()&&this.bk("ShouldHideSpinner")},gc:function(n){var i=this.E();if(i){var t=i.T().a().S();t.b(n.c());t.a(n.c())}},gd:function(n){var t=this.E();if(t){var i=t.T().a();i.t(n.c())}},gb:function(n){this.fp()},gg:function(n){var i=this.E();if(i){var f=i.R;switch(n.c()){case 0:var s=i.e();var u=s.a();u&&u.b&&u.a();break;case 1:this.bm&&this.bm.a(_y.em,new _y.em);break;case 2:var r=i.d().f();r&&r.b&&r.a();break;case 3:var t=null;if(this.t==="Mouse"){var o=f.b(19);t=o.a()}else{var e=f.b(10);t=e.a()}t&&t.b&&t.a();break;case 4:this.n("ToRecipientWellControl");break}}},gf:function(n){var i=this.E();if(i&&this.bR){var t=n.c().outerText;t=_js.d.a(t)?n.c().text:t;n.a(_zz.d.e(0,n.c().id,t,i.S))}},ge:function(n){var t=this.E();if(t){var i=n.c().textContent;n.a(_zz.d.e(0,n.c().id,i,t.S))}},fu:function(n){},eI:function(){var t=this.E();if(this.m&&t){var n;n=this.m.EditorControl;n&&n.Z&&t.bH&&this.cm&&this.bS&&n.eT()}},fw:function(){if(this.m&&this.m.EditorControl){var n=this.m.EditorControl;n.Z&&n.bs(new _cmc.c(!1))}},fp:function(){var t=this.E();if(this.bx&&this.m&&this.m.EditorControl){var n=this.m.EditorControl;if(n.Z&&!n.dq()){n.bs(new _cmc.Q);t.N.cy(n.bV.b)}}else t.N.cy(0)},gL:function(n,t){},he:function(){},ew:function(){var i=this.m.ToReadWriteRecipientWellView;var t=this.m.CcReadWriteRecipientWellView;var n=this.m.BccReadWriteRecipientWellView;this.eK(i);this.eK(t);this.eK(n)},eK:function(n){if(n&&_rw.b.isInstanceOfType(n.E())){var t=n.E();t.bz(!0);t.bz(!1)}},gK:function(){var n=this.m.QuotedBodyHtmlLabel;if(n){this.m.QuotedBodyHtmlLabel.y.on("touchstart",null,null,this.dZ);this.m.QuotedBodyHtmlLabel.y.on("touchend",null,null,this.dS)}},gC:function(){var n=this.m.QuotedBodyHtmlLabel;if(n){this.m.QuotedBodyHtmlLabel.y.off("touchstart",null,this.dZ);this.m.QuotedBodyHtmlLabel.y.off("touchend",null,this.dS)}},hb:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.bI.e().a(t);n.stopImmediatePropagation();n.preventDefault()}},hc:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},cf:function(){var n=this.E();var t=this.m.EditorControl;this.bd.g()&&this.m&&this.m.SubjectTextBox&&_zz.z.b(this.m.SubjectTextBox.x,null);this.fP();this.t==="TouchNarrow"?this.ex(!1):this.ex(!0);this.v().hc(this);this.ey(!0);this.ez(!0);_js.Trace.logInfo(_a.a.a,"PostTransitionIn active view. Context: {0}",n.N);this.eH();this.ef()},gY:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.cC);this.cf()},fH:function(){if(this.m&&this.m.EditorControl){var n=this.m.EditorControl;n.bs(new _cmc.p(!0));this.bg("EditorControl")}},ha:function(n){for(var t=0;t<this.q.d.length;t++){var r=this.q.d[t];var i=this.m[r.a];if(n.target===i.x||i.y.has(n.target).length){this.ei(r.a);this.eo();break}}return!0},gZ:function(n){for(var t=0;t<this.Z.d.length;t++){var r=this.Z.d[t];var i=this.m[r.a];if(n.target===i.x||i.y.has(n.target).length){r.b(null);break}}return!0},ft:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},gj:function(){return!!this.bo&&this.bo.a().cS().Enabled},hm:function(n,t){if(this.gj()&&!this.ft(n)&&this.ft(t)){var i=this;_js.g.a().a(this.G(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.E()){var t=i.E();if(t){var n=i.E().dg();n.b(1)}}},100)}},ei:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.bg(n);this.bs(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.p==="FromFieldControl"){var t=i.P();t&&t.w(!1)}}},fl:function(){var n=this.E();n&&this.hf(this.bd.a()&&n.N.e()==="Text"?!0:!1)},gN:function(n){var t=new _a.Q(n);var i=t.a();if(i===9&&!t.m()){this.n("EditorControl");this.hH(t)}}};_mcp.n.a=function(n,t){this.a=n;this.b=t};_mcp.n.a.prototype={a:null,b:null};_mcp.Q=function(n){this.g=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.o);this.b={};_mcp.Q.initializeBase(this,[n])};_mcp.Q.prototype={c:null,a:null,d:null,e:function(){this.b.PopoutButton.V();this.c="PopoutButton";_mcp.j.isInstanceOfType(this.a)&&(this.a.bH=!0)},K:function(){_js.b.prototype.K.call(this);this.b.ShowCcButton=this.F.a("ShowCcButton");this.b.ShowBccButton=this.F.a("ShowBccButton");this.b.PopoutButton=this.F.a("PopoutButton")},dT:function(){_js.c.prototype.dT.call(this);this.q()},O:function(){this.i();_js.b.prototype.O.call(this)},bl:function(){this.i();_js.b.prototype.bl.call(this)},j:function(n){if(!$a(this.b[n])){this.b[n].V();this.c=n}},q:function(){this.d=this.L;this.a=this.d.L;_mcp.m.isInstanceOfType(this.a)&&(this.a=this.a.L);_mcp.j.isInstanceOfType(this.a)&&this.a.hB(this);this.d.y.bind("focusout",this.f);this.d.y.bind("keydown",this.g)},h:function(n){if(!this.b)return!1;var t=this.b[n];return!!t&&!t.bv()},p:function(n){var t=new _a.Q(n);var i=t.a();if(i===9&&t.g())if(this.b.PopoutButton.gq()){this.c="PopoutButton";this.n()}else if(this.b.ShowBccButton.gq()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.gq()){this.c="ShowCcButton";this.l()}},n:function(){if(this.h("ShowBccButton")){this.j("ShowBccButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.bH=!0)}else this.h("ShowCcButton")&&this.k()},k:function(){if(this.h("ShowCcButton")){this.j("ShowCcButton");_mcp.j.isInstanceOfType(this.a)&&(this.a.bH=!0)}else this.l()},l:function(){this.c=null;this.a.hP();this.a.bH=!1},i:function(){this.m();this.d.y.unbind("focusout",this.f);this.d.y.unbind("keydown",this.g)},o:function(n){this.m()},m:function(){this.c=null;_mcp.j.isInstanceOfType(this.a)&&(this.a.bH=!1)}};_mcp.j=function(n,t,i,r,u,f,e,o,s){this.eN=Function.createDelegate(this,this.ht);this.eR=Function.createDelegate(this,this.hx);this.eP=Function.createDelegate(this,this.hv);this.eQ=Function.createDelegate(this,this.hw);this.eO=Function.createDelegate(this,this.hu);this.eM=Function.createDelegate(this,this.hs);this.eL=Function.createDelegate(this,this.hr);this.eS=Function.createDelegate(this,this.hy);this.eT=Function.createDelegate(this,this.hz);_mcp.j.initializeBase(this,[n,t,i,r,u,f,e,o,s]);this.bZ=f;this.ct=i;var h=this;this.eU=new _C(function(){h.fK().a(!h.v().dq())},this.G())};_mcp.j.prototype={bZ:null,ct:null,cW:!1,cU:!1,bL:null,z:null,bH:!1,o:null,hA:function(n){this.cU=n;this.bk("EnableRichTextOptions");return n},hq:function(){return this.ct.p()?_u.R.Gp:_u.R.Xp},eU:null,fK:function(){if(!this.o){var n=this.v();this.o=new _zz.bf;this.o.F=n.kM();this.o.t=new _C(n.iv,this.G());this.o.v=new _C(n.iw,this.G());this.o.w=new _C(n.ix,this.G());this.o.A=new _C(n.hf,this.G());this.o.D=new _C(n.hh,this.G());this.o.C=new _C(n.fI,this.G());this.o.E=new _C(n.hg,this.G());this.o.y=new _C(n.it,this.G());this.o.x=new _C(n.is,this.G());this.o.z=new _C(n.iu,this.G());var f=this;this.o.H=new _C(function(){n.cN()},this.G());var e=this;this.o.G=new _C(function(){n.da()},this.G());var o=this;this.o.n=function(t){n.ev(t)};var u=this;this.o.o=function(t){n.ew(t)};var t=this;this.o.m=function(t){n.fi(t)};var i=this;this.o.l=function(t){n.dv(t)};var r=this;this.o.r=function(t){n.eX(t)};this.o.apcl("IsShown",this.eT)}return this.o},a:function(){return"MailComposeViewOneCompose"},j:function(){return!0},k:function(){return 256},b:function(){return 2},l:function(n,t){t===1&&n.a===256&&this.o&&this.o.d&&this.o.a(!1)},cF:function(){return 0},fo:function(){return 0},hB:function(n){n&&(this.bL=n)},hP:function(){if(this.r("FromFieldControl"))this.n("FromFieldControl");else{this.cW=!0;this.n("ToRecipientWellControl")}},K:function(){_mcp.n.prototype.K.call(this);if(this.F){this.m.InlineComposeBottomEdge=this.F.a("InlineComposeBottomEdge");this.m.InlineComposeBody=this.F.a("InlineComposeBody");this.m.InsertPictureButton=this.F.a("InsertPictureButton");this.m.FormatButton=this.F.a("FormatButton");this.m.Emoji=this.F.a("Emoji");this.m.ShowOriginalMessage=this.F.a("ShowOriginalMessage");this.m.AggregatedReadOnlyHeader=this.F.a("AggregatedReadOnlyHeader");this.m.ReadWriteHeader=this.F.a("ReadWriteHeader");this.m.InlineComposeHeaderWrapper=this.F.a("InlineComposeHeaderWrapper");this.m.ComposeBodyContainer=this.F.a("ComposeBodyContainer")}else{this.m.InlineComposeBottomEdge=null;this.m.InlineComposeBody=null;this.m.InsertPictureButton=null;this.m.FormatButton=null;this.m.Emoji=null;this.m.ShowOriginalMessage=null;this.m.AggregatedReadOnlyHeader=null;this.m.ReadWriteHeader=null;this.m.InlineComposeHeaderWrapper=null;this.m.ComposeBodyContainer=null}},cf:function(){_mcp.n.prototype.cf.call(this);var i=this.m.InlineComposeBody;var t=this.m.InlineComposeBottomEdge;var n=this.m.InlineComposeHeaderWrapper;this.fM();var u=!!i&&!!this.v()&&!!n&&!!t;if(!u){var r="[MailInlineCompose: InitializeView] - One or more of inline compose control elements are null.";_js.Trace.logError(this.G(),r);return}this.bZ.a(IMailComposeViewInitializedEvent,new _mcp.bI(i.y,this.v().y,n.y,t.y))},ev:function(n,t){_mcp.n.prototype.ev.call(this,n,t);this.bZ.a(IInlineComposeInfobarItemsChangedEvent,new _mcp.bF)},O:function(){_mcp.n.prototype.O.call(this);this.o&&this.o.rpcl("IsShown",this.eT)},ht:function(n){this.p!=="InsertButton"&&this.bN(!0)},hx:function(n){this.p!=="InsertButton"&&this.bN(!0)},hr:function(n){this.bN(!1);this.n("ToRecipientWellControl")},bN:function(n){if(this.E()&&_mcp.g.isInstanceOfType(this.E())){var t=this.E();if(t.P().p()!==n){t.P().x(n);this.cV(0)}}},cV:function(n){var t=this.r("ReadWriteHeader")?"ReadWriteHeader":"AggregatedReadOnlyHeader";t&&this.bZ.a(_y.dr,new _mcp.T(n,this.m[t].x.clientHeight,0))},fL:function(n){var t=this.r("ReadWriteHeader")?"ReadWriteHeader":"AggregatedReadOnlyHeader";var i=this.m[t].x.clientHeight;t&&this.bZ.a(_y.dr,new _mcp.T(2,i,n))},eu:function(n,t){_mcp.n.prototype.eu.call(this,n,t);this.fM()},n:function(n){if(this.m)switch(n){case"Emoji":if(this.m[n]){this.m[n].V();this.bg(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":if(this.r(n)){this.m[n].V();this.bg(n)}break;case"EditorControl":var t=this.m.EditorControl;this.ct.a()&&t.dg()||t.bs(new _cmc.p(!1));this.bg(n);break;default:_mcp.n.prototype.n.call(this,n);break}},bO:function(){this.z=null;this.bQ&&(this.z="AttachmentWellViewWrapper");$a(this.z)&&this.r("BccRecipientWellControl")&&(this.z="BccRecipientWellControl");$a(this.z)&&this.r("CcRecipientWellControl")&&(this.z="CcRecipientWellControl");$a(this.z)&&this.r("ToRecipientWellControl")&&(this.z="ToRecipientWellControl");!_js.d.a(this.z)&&this.r(this.z)?this.m[this.z].y.bind("keydown",this.ce):_js.Trace.logWarning(this.G(),"Compose form doesn't have any control preceeding editor")},bW:function(){!_js.d.a(this.z)&&this.m&&this.m[this.z]&&this.m[this.z].y.unbind("keydown",this.ce)},en:function(n){_mcp.n.prototype.en.call(this,n);this.bN(!0)},fs:function(){this.bT&&this.hp()},fq:function(n){if(!_js.d.a(this.z)){this.bQ?this.cV(1):this.bN(!1);this.n(this.z);this.z!=="ToRecipientWellControl"||this.r("FromFieldControl")||this.bL.e()}n.a(!0)},fr:function(n){if(!$a(this.m.SendButton)){if(!this.ct.g()){this.m.ShowOriginalMessage.V();this.bg("ShowOriginalMessage")}n.a(!0)}},ei:function(n){_js.Trace.logInfo(_a.a.a,"Focused in {0}",n);this.bg(n);this.bs(n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl"||n==="AttachmentWellViewWrapper");if(this.E()&&_mcp.d.isInstanceOfType(this.E())){var i=this.E();if(this.p==="FromFieldControl"){var t=i.P();t&&t.w(!1)}}},fu:function(n){this.o&&this.fN(this.o,n.c())},ef:function(){_mcp.n.prototype.ef.call(this);var r=this.m.ShowOriginalMessage;$a(r)||r.y.bind("keydown",this.eS);var t=this.m.AggregatedReadOnlyHeader;if($a(t)){var u="[MailInlineCompose: BindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_js.Trace.logError(this.G(),u);return}t.y.bind("click",this.eL);t.apcl("IsHidden",this.eM);if(this.v()){this.v().kS(this);this.v().y.bind("keyup",this.eO)}var n=this.m.ComposeBodyContainer;if(n){n.y.bind("mouseover",this.eQ);n.y.bind("mouseout",this.eP)}var i=this.m.InlineComposeBottomEdge;if(i){i.y.bind("mouseup",this.eR);i.y.bind("keyup",this.eN)}},eJ:function(){_mcp.n.prototype.eJ.call(this);var r=this.m.ShowOriginalMessage;$a(r)||r.y.unbind("keydown",this.eS);var t=this.m.AggregatedReadOnlyHeader;if($a(t)){var u="[MailInlineCompose: UnbindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_js.Trace.logWarning(this.G(),u);return}t.y.unbind("click",this.eL);t.rpcl("IsHidden",this.eM);var n=this.m.ComposeBodyContainer;if(n){n.y.unbind("mouseover",this.eQ);n.y.unbind("mouseout",this.eP)}if(this.v()){this.v().ir(this);this.v().y.unbind("keyup",this.eO)}var i=this.m.InlineComposeBottomEdge;if(i){i.y.unbind("mouseup",this.eR);i.y.unbind("keyup",this.eN)}},es:function(n,t){_mcp.n.prototype.es.call(this,n,t);this.cV(0)},et:function(n,t){_mcp.n.prototype.et.call(this,n,t);this.cV(0)},fv:function(n,t){this.bW();this.bO();this.bN(!1)},fM:function(){this.hA(this.bx);this.hQ(!this.cU)},hQ:function(n){this.r("FormatButton")&&this.m.FormatButton.fF(n);this.r("InsertPictureButton")&&this.m.InsertPictureButton.fF(n);if(this.fn()){var t=this.m.Emoji;t&&!t.bv()&&t.fF(n)}},hy:function(n){var t=new _a.Q(n);var i=t.a();if(i===9&&!t.m()){this.n("SendButton");this.hH(t)}},hp:function(){if(!this.bH)switch(this.p){case"BccRecipientWellControl":this.n("BccRecipientButton");break;case"BccRecipientButton":this.r("CcRecipientWellControl")?this.n("CcRecipientWellControl"):this.r("FromFieldControl")?this.n("ToRecipientWellControl"):this.bL.e();break;case"CcRecipientWellControl":this.n("CcRecipientButton");break;case"CcRecipientButton":this.r("FromFieldControl")?this.n("ToRecipientWellControl"):this.bL.e();break;case"ToRecipientWellControl":this.cW?this.cW=!1:this.n("ToRecipientButton");break;case"ToRecipientButton":this.r("FromFieldControl")?this.bL.e():this.bs(!1);break;case"FromFieldControl":this.bH||this.bs(!1);break;case"ShowOriginalMessage":this.n("EditorControl");break;case"SendButton":this.n("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.bN(!1);this.r("FromFieldControl")?this.n("ToRecipientWellControl"):this.bL.e();break;default:this.bs(!1);break}},fN:function(n,t){n&&n.d&&t&&n.P(t)},hz:function(n,t){if(this.o&&this.o.d&&this.v()){var i=this.v().gR();this.fN(this.o,i)}},hv:function(n){this.eV(!1)},hw:function(n){this.eV(!0)},eV:function(n){var t=null;t=this.r("AggregatedReadOnlyHeader")?"ms-border-color-themeTertiary":n?"ms-border-color-neutralTertiary":"ms-border-color-neutralTertiaryAlt";this.hR(t)},hR:function(n){if(!_js.d.a(n)){for(var i=this.m.InlineComposeBottomEdge,f=i.x.className.split(" "),u=f,e=u.length,t=0;t<e;++t){var r=u[t];r.startsWith("ms-border-color")&&i.bu(r)}i.bi(n)}},hs:function(n,t){this.ew();this.eV(!1)},hu:function(n){var o=this.m.InlineComposeHeaderWrapper.x.getBoundingClientRect();var a=this.m.InlineComposeBottomEdge.x.getBoundingClientRect();var l=0;var c=document.documentElement.clientHeight;var e=o.bottom;var r=a.top;var u=2;if(this.bx){var f=this.v().fK();var t=f.a.a;var i=f.a.b;if(i>r&&i<=c){var s=i-r+u;this.fL(s)}else if(t<e&&t>l){var h=t-e-u;this.fL(h)}}}};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var p="IrmDialogView";new _A(p,function(){_mcp._TI.a[p]===undefined&&(_mcp._TI.a[p]=[[[-1,0,["Description"],[_mcp._TI.gb],null,"Text",null,_mcp._TI.i,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.ga],null,"Text",null,_mcp._TI.i,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.U,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a);var w="MailComposeView._tid1._tid3";new _A(w,function(){_mcp._TI.a[w]===undefined&&(_mcp._TI.a[w]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.c,_mcp._TI.H],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_u ms-font-weight-regular ms-font-color-black bidi");n.w("PersonaView.BasicDetailsPopup");n.Y("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var b="MailComposeView._tid1._tid4";new _A(b,function(){_mcp._TI.a[b]===undefined&&(_mcp._TI.a[b]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.c,_mcp._TI.cV],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.e(t.children[0],_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));n.Y("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var a="MailComposeView._tid1";new _A(a,function(){_mcp._TI.a[a]===undefined&&(_mcp._TI.a[a]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_b.d.a()],[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.NH],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.kF],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.W,_mcp._TI.R,_mcp._TI.y],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.c,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.A(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.c,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.A(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.c,_mcp._TI.H],null,"IsHidden",null,_mcp._TI.b,1,new _js.i([_mcp._TI.A(),_mcp._TI.d()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.c,_mcp._TI.cW],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.b(t.children[3]);u.w("MailComposeView._tid1._tid4");var f=new _js.b(t.children[2]);var r=new _js.b(t.children[1]);r.w("MailComposeView._tid1._tid3");var n=new _fc.b(t.children[0]);n.w("MailComposeView.FromButtonTemplate");n.d("ms-bg-color-neutralLighter");n.a("ms-bg-color-neutralLight");n.b("ms-font-color-white ms-bg-color-themePrimary");n.S("MailCompose.FromRecipientWellButton");n.C(0);var i=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));i.A(_E.a(["SendAsContextMenuComponent","Menu"],[_mcp._TI.W,_mcp._TI.R],null,"MenuDataContext",null,_mcp._TI.ba,1)).A(_E.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.W,_mcp._TI.R,_mcp._TI.y],_mcp._TI.bb,"IsShown",_mcp._TI.Y,_mcp._TI.Z,2,null,null,!1));i.a=3;i.b=1;n.H([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.d,_mcp.m,function(n){return new _mcp.m(n)},!1,!0,!1,0,_mcp._TI.a);var v="MailComposeView._tid9";new _A(v,function(){_mcp._TI.a[v]===undefined&&(_mcp._TI.a[v]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_u.P.Y]],[[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bl],null,"Text",null,_mcp._TI.i,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.t()],[-1,1,["HideSubjectAffordanceButton"],[_mcp._TI.fa],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]]]);var t=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.b(_B.a(t,[1,1]));var n=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));n.A(_E.a(["ContextMenuComponent","Menu"],[_mcp._TI.Q,_mcp._TI.O],null,"MenuDataContext",null,_mcp._TI.ba,1)).A(_E.a(["ContextMenuComponent","Menu","IsShown"],[_mcp._TI.Q,_mcp._TI.O,_mcp._TI.y],_mcp._TI.bb,"IsShown",_mcp._TI.Y,_mcp._TI.Z,2,null,null,!1));n.a=3;n.b=5;i.H([n]);var u=new _fc.a(_B.a(t,[1,0]));var r=new _fc.a(t.children[0]);return new _B(t,[r,u,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var y="MailComposeView._tidb._tidc";new _A(y,function(){_mcp._TI.a[y]===undefined&&(_mcp._TI.a[y]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.q,_mcp._TI.cS],_mcp._TI.cT,"DataContext",_mcp._TI.bF,_mcp._TI.f,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.q,_mcp._TI.bm],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.b(i.children[1],_js.a.Instance.a(_a.m));t.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.w("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.b(i.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.w("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.d,_b.j,function(n){return new _b.j(n)},!1,!0,!1,0,_mcp._TI.a);var nt="MailComposeView._tidb._tidd";new _A(nt,function(){_mcp._TI.a[nt]===undefined&&(_mcp._TI.a[nt]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.q,_mcp._TI.bm],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.b(t.children[0],_js.a.Instance.a(_a.m));n.j("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.w("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var tt="MailComposeView._tidb";new _A(tt,function(){_mcp._TI.a[tt]===undefined&&(_mcp._TI.a[tt]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_nbs.a.cX]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.dq,0,null,null,null,_u.R.Ow],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.q,_mcp._TI.bp],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.q,_mcp._TI.bp],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.b(_B.a(n,[1,1]));i.w("MailComposeView._tidb._tidd");var t=new _b.j(_B.a(n,[1,0]));t.w("MailComposeView._tidb._tidc");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var it="MailComposeView._tide";new _A(it,function(){_mcp._TI.a[it]===undefined&&(_mcp._TI.a[it]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.e,_mcp._TI.ds],null,"Text",null,_mcp._TI.i,1,null,null,null]],[[-1,0,["MeetingComponent","MeetingCalendarTimePeriod"],[_mcp._TI.q,_mcp._TI.cR],null,"Text",null,_mcp._TI.i,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.a(_B.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _B(n,[t,i])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var k="MailComposeView._tidf";new _A(k,function(){_mcp._TI.a[k]===undefined&&(_mcp._TI.a[k]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_u.P.H]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.q,_mcp._TI.cQ],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[9].cloneNode(!0);var n=new _js.b(_B.a(t,[1,0]));n.w("LocationView");n.R(!0);var i=new _fc.a(t.children[0]);return new _B(t,[i,n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var d="MailComposeView._tidg";new _A(d,function(){_mcp._TI.a[d]===undefined&&(_mcp._TI.a[d]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_b.d.b()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.p,0,null,null,null,_n.a.g()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.G,0,null,null,null,_n.a.g()],[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.iY],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.iY],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.M,_mcp._TI.dV],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.M,_mcp._TI.cZ],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.bn,0,null,null,null,_nbs.a.iY],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.M,_mcp._TI.cY],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _fce.g(t.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));n.a=0;n.C(-1);var i=new _fc.b(t.children[0]);i.C(0);return new _B(t,[i,n])},_mcp.d,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var g="MailComposeView._tidh";new _A(g,function(){_mcp._TI.a[g]===undefined&&(_mcp._TI.a[g]=[[[-1,0,["IsXOwaExtensibilityActive"],[_mcp._TI.fk],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]]]);var t=_mcp._TI._hf.childNodes[11].cloneNode(!0);var n=new _js.b(t.children[0]);n.w("XComposeExtensibilityView");return new _B(t,[n])},_y.fz,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var r="MailComposeView.FromButtonTemplate";new _A(r,function(){_mcp._TI.a[r]===undefined&&(_mcp._TI.a[r]=[[[-1,1,["Text"],[_mcp._TI.eC],null,"Text",null,_mcp._TI.i,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.eB],null,"Id",null,_mcp._TI.B,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var i=new _fc.d(n.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _B(n,[t,i]).R({Label:t,Image:i})},Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp._TI.a);var u="MailComposeView";new _A(u,function(){_mcp._TI.a[u]===undefined&&(_mcp._TI.a[u]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.F],null,"IsBusy",null,_mcp._TI.db,1,_mcp._TI.d(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp._TI.fb],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.eL],null,"_mcp_P",null,null,0,_mcp._TI.d(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.V,_mcp._TI.bA,_mcp._TI.bX],null,"_mcp_X",null,null,0,_mcp._TI.d(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp._TI.fb],null,"_mcp_O",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp._TI.eL],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.gc],null,"_mcp_K",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.S,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.dw],null,"BusyText",null,_mcp._TI.bn,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.bq],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.F],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.bH],null,"DataSource",null,_mcp._TI.de,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.o],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.bJ],null,"_mcp_T",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.eZ],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.e,_mcp._TI.by],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_u.R.Yc],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.SL],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.I,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.o],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.G,0,null,null,null,_mcp.c.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.fc],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.I,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.r,0,null,null,null,_nbs.a.Zh],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.I,_mcp._TI.U],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.I,_mcp._TI.T],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_u.R.MS],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.ga],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.o],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.G,0,null,null,null,_mcp.c.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.eq],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.r,0,null,null,null,_nbs.a.WC],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.U],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.T],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.e,_mcp._TI.cb],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_u.R.Hn],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_nbs.a.fz],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.o],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.g],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.G,0,null,null,null,_mcp.c.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.ep],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.w],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.ef],null,"_mcp_R",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.r,0,null,null,null,_nbs.a.Pq],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.U],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.c,_mcp._TI.s],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.T],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp._TI.bQ],null,"_mcp_R",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.bc],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.c()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.bG,_mcp._TI.fp],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.bG,_mcp._TI.bZ],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_n.a.bv()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.e,_mcp._TI.dL],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_n.a.bG()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.e,_mcp._TI.dK],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.cs,_mcp._TI.cc],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.e,_mcp._TI.ca],null,"Id",null,_mcp._TI.B,1,_mcp._TI.bW(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.t()],[-1,1,["HideSubjectAffordanceButton"],[_mcp._TI.fa],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"Placeholder",null,_mcp._TI.ck,0,null,null,null,_nbs.a.kl],[-1,0,["Context","Subject"],[_mcp._TI.e,_mcp._TI.bl],_mcp._TI.cN,"Text",_mcp._TI.bC,_mcp._TI.bE,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.e,_mcp._TI.dr],null,"MaxLength",null,_mcp._TI.bD,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.e,_mcp._TI.cK],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.bc],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.e,_mcp._TI.bc],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],null,[[-1,0,["Context","HasLocation"],[_mcp._TI.e,_mcp._TI.cI],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.E,_mcp._TI.bY,_mcp._TI.et],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.E,_mcp._TI.bY],_mcp._TI.fl,"DataContext",_mcp._TI.bF,_mcp._TI.f,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_nbs.a.Fr],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.J],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.J],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.dk,0,null,null,null,_nbs.a.Nd],[-1,1,["EditorSizingMode"],[_mcp._TI.dB],null,"SizingMode",null,_mcp._TI.dp,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp._TI.dA],null,"MinHeight",null,_mcp._TI.dn,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp._TI.F],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bS],null,"IsCopyRestricted",null,_mcp._TI.cm,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.J],null,"IsPrintRestricted",null,_mcp._TI.dm,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.e,_mcp._TI.cH],_mcp._TI.cM,"Content",_mcp._TI.dg,_mcp._TI.dj,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.e,_mcp._TI.cG],_mcp._TI.cL,"IsPlainTextContent",_mcp._TI.dh,_mcp._TI.dl,2,_mcp._TI.cD(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.dt,_mcp._TI.cO],_mcp._TI.cP,"CallContext",_mcp._TI.df,_mcp._TI.di,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.e,_mcp._TI.J],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.F],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.M,_mcp._TI.cX],null,"_mcp_J",null,null,0,_mcp._TI.d(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.eZ],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bS],null,"TextSelectionType",null,_mcp._TI.dd,1,_mcp._TI.fg(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.e,_mcp._TI.bS],null,"IsCopyRestricted",null,_mcp._TI.cm,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.ew],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.A(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.e,_mcp._TI.ew],null,"Html",null,_mcp._TI.eH,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.V,_mcp._TI.bA],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.bX],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.du],null,"DataContext",null,_mcp._TI.f,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.co,0,null,null,null,_nbs.a.Gn],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.eh,_mcp._TI.fu],null,"ButtonDataList",null,_mcp._TI.cn,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.eh,_mcp._TI.fv],_mcp._TI.fw,"IsShown",_mcp._TI.u,_mcp._TI.v,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.bG,_mcp._TI.fo],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.bv],_mcp._TI.bx,"IsShown",_mcp._TI.u,_mcp._TI.v,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bw],null,"DialogTitle",null,_mcp._TI.be,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bs],null,"CloseCommand",null,_mcp._TI.bf,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bt],null,"ContentDataContext",null,_mcp._TI.bB,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bu],null,"ButtonDataList",null,_mcp._TI.bd,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.dv,_mcp._TI.cU],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.bK],_mcp._TI.bL,"IsBusy",_mcp._TI.bM,_mcp._TI.bN,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.bv],_mcp._TI.bx,"IsShown",_mcp._TI.u,_mcp._TI.v,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bw],null,"DialogTitle",null,_mcp._TI.be,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bs],null,"CloseCommand",null,_mcp._TI.bf,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bt],null,"ContentDataContext",null,_mcp._TI.bB,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bu],null,"ButtonDataList",null,_mcp._TI.bd,1,null,null,null]],[[-1,0,["OmeComponent","DialogViewModel"],[_mcp._TI.eN,_mcp._TI.ey],null,"DataContext",null,_mcp._TI.f,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.bK],_mcp._TI.bL,"IsBusy",_mcp._TI.bM,_mcp._TI.bN,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.bv],_mcp._TI.bx,"IsShown",_mcp._TI.u,_mcp._TI.v,2,null,null,!1],[0,0,["Title"],[_mcp._TI.bw],null,"DialogTitle",null,_mcp._TI.be,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.bs],null,"CloseCommand",null,_mcp._TI.bf,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.bt],null,"ContentDataContext",null,_mcp._TI.bB,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.bu],null,"ButtonDataList",null,_mcp._TI.bd,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.ge],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var ei=new _js.c(n.children[9]);var dt=new _fce.m(n.children[8],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));dt.d("OmeExpirationView");var gt=new _fce.m(n.children[7],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));gt.d("MessageOptionsView");var ti=new _fce.m(n.children[6],_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));ti.d("IrmDialogView");var st=new _b.m(n.children[5],_js.a.Instance.a(_y.a),_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.b));st.g(!1);var ot=new _js.b(n.children[4]);ot.w("MessageBoxDefaultView");var vt=new _js.b(n.children[3]);vt.w("MailComposeView._tidh");var yt=new _b.o(_B.a(n,[2,1,3,0]),_js.a.Instance.a(_a.f));var ri=new _js.c(_B.a(n,[2,1,3]));var lt=new _js.b(_B.a(n,[2,1,2,1]));lt.w("MailComposeView._tidg");var t=_js.a.Instance.a(_js.M.$$(_zz.l)).a(_B.a(n,[2,1,2,0]));t.bH("_mcp_y ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.R(!0);t.C(-1);t.cv="0";var nr=new _js.c(_B.a(n,[2,1,2]));var ki=new _fc.a(_B.a(n,[2,1,1,7]));var e=new _js.b(_B.a(n,[2,1,1,6,0,0]));e.w("AttachmentWellViewWrapper");e.cp(!0);e.R(!0);var rr=new _js.c(_B.a(n,[2,1,1,6]));var pt=new _js.b(_B.a(n,[2,1,1,5,3]));pt.w("MailComposeView._tidf");var ct=new _js.b(_B.a(n,[2,1,1,5,2]));ct.w("MailComposeView._tide");var ht=new _js.b(_B.a(n,[2,1,1,5,1]));ht.w("MailComposeView._tidb");var bt=new _js.b(_B.a(n,[2,1,1,5,0]));bt.w("MailComposeView._tid9");var ai=new _js.c(_B.a(n,[2,1,1,5]));var v=new _cmc.j(_B.a(n,[2,1,1,4,0,5,0]));v.g("ms-font-color-neutralTertiary");v.C(0);var kt=new _fc.b(_B.a(n,[2,1,1,4,0,4]));var w=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));w.A(_E.a(["ContextMenuComponent","Menu"],[_mcp._TI.Q,_mcp._TI.O],null,"MenuDataContext",null,_mcp._TI.ba,1)).A(_E.a(["ContextMenuComponent","Menu","IsShown"],[_mcp._TI.Q,_mcp._TI.O,_mcp._TI.y],_mcp._TI.bb,"IsShown",_mcp._TI.Y,_mcp._TI.Z,2,null,null,!1));w.a=3;w.b=5;kt.H([w]);var ci=new _fc.d(_B.a(n,[2,1,1,4,0,3]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var li=new _fc.d(_B.a(n,[2,1,1,4,0,2]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var bi=new _fc.d(_B.a(n,[2,1,1,4,0,1]),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var pi=new _fc.b(_B.a(n,[2,1,1,4,0,0]));var yi=new _js.c(_B.a(n,[2,1,1,4]));var p=new _js.b(_B.a(n,[2,1,1,3,2,0]));p.w("ReadOnlyRecipientWellView");p.cp(!0);p.R(!0);var wi=new _js.c(_B.a(n,[2,1,1,3,2]));var y=new _js.b(_B.a(n,[2,1,1,3,1,1]));y.w("ReadWriteRecipientWellView");y.I(26);y.cp(!0);var b=new _fc.b(_B.a(n,[2,1,1,3,1,0,0]));b.l=!0;b.C(-1);b.N(!0);var ui=new _js.c(_B.a(n,[2,1,1,3,1,0]));var vi=new _js.c(_B.a(n,[2,1,1,3,1]));var f=new _fc.b(_B.a(n,[2,1,1,3,0]));f.d("ms-bg-color-neutralLighter");f.a("ms-bg-color-neutralLight");f.b("ms-font-color-white ms-bg-color-themePrimary");f.C(-1);var ni=new _js.c(_B.a(n,[2,1,1,3]));var h=new _js.b(_B.a(n,[2,1,1,2,2,0]));h.w("ReadOnlyRecipientWellView");h.cp(!0);h.R(!0);var ir=new _js.c(_B.a(n,[2,1,1,2,2]));var o=new _js.b(_B.a(n,[2,1,1,2,1,1]));o.w("ReadWriteRecipientWellView");o.cp(!0);o.I(26);o.R(!0);var l=new _fc.b(_B.a(n,[2,1,1,2,1,0,0]));l.l=!0;l.C(-1);l.N(!0);var tr=new _js.c(_B.a(n,[2,1,1,2,1,0]));var ur=new _js.c(_B.a(n,[2,1,1,2,1]));var r=new _fc.b(_B.a(n,[2,1,1,2,0]));r.d("ms-bg-color-neutralLighter");r.a("ms-bg-color-neutralLight");r.b("ms-font-color-white ms-bg-color-themePrimary");r.C(-1);var wt=new _js.c(_B.a(n,[2,1,1,2]));var et=new _js.b(_B.a(n,[2,1,1,1,2,0]));et.w("ReadOnlyRecipientWellView");et.R(!0);var di=new _js.c(_B.a(n,[2,1,1,1,2]));var s=new _js.b(_B.a(n,[2,1,1,1,1,1]));s.w("ReadWriteRecipientWellView");s.I(26);s.R(!0);var k=new _fc.b(_B.a(n,[2,1,1,1,1,0,0]));k.l=!0;k.C(-1);k.N(!0);var gi=new _js.c(_B.a(n,[2,1,1,1,1,0]));var hi=new _js.c(_B.a(n,[2,1,1,1,1]));var i=new _fc.b(_B.a(n,[2,1,1,1,0]));i.d("ms-bg-color-neutralLighter");i.a("ms-bg-color-neutralLight");i.b("ms-font-color-white ms-bg-color-themePrimary");i.C(0);var rt=new _mcp.m(_B.a(n,[2,1,1,0,0]));rt.w("MailComposeView._tid1");var ii=new _js.c(_B.a(n,[2,1,1]));var g=_js.a.Instance.a(_js.M.$$(_b.w)).a(_B.a(n,[2,1,0]));g.g="_mcp_B";g.C(0);var d=new _js.c(_B.a(n,[2,1]));d.C(-1);var at=new _fc.g;var ut=new _fc.c;ut.A(_E.a(["TouchComponent","CloseCommand"],[_mcp._TI.eh,_mcp._TI.ft],null,"Command",null,_mcp._TI.n,1));ut.i("ESC");var nt=new _fc.c;nt.A(_E.a(["SaveComponent","SaveCommand"],[_mcp._TI.bU,_mcp._TI.ch],null,"Command",null,_mcp._TI.n,1));nt.i("S");nt.j=2;var it=new _fc.c;it.A(_E.a(["SendComponent","AltSSendCommand"],[_mcp._TI.N,_mcp._TI.cq],null,"Command",null,_mcp._TI.n,1)).A(_E.a(["DoesSupportAltSForSend"],[_mcp._TI.cr],null,"PreventDefault",null,_mcp._TI.P,1,null,null,!1));it.i("S");it.j=4;var tt=new _fc.c;tt.A(_E.a(["SendComponent","SendCommand"],[_mcp._TI.N,_mcp._TI.X],null,"Command",null,_mcp._TI.n,1));tt.i("ENTER");tt.j=2;var a=new _fc.c;a.A(_E.a(["RecipientComponent","ResolveCommand"],[_mcp._TI.c,_mcp._TI.cf],null,"Command",null,_mcp._TI.n,1));a.i("K");a.j=2;var c=new _fc.c;c.D(_E.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.br],null,"Command",null,_mcp._TI.n,1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.K],null,"PreventDefault",null,_mcp._TI.P,1,null,null,!1)).D(_E.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.k,_mcp._TI.k,_mcp._TI.K],null,"StopPropagation",null,_mcp._TI.bo,1,null,null,!1));c.i("TAB");c.j=1;at.a([ut,nt,it,tt,a,c]);d.H([at]);var oi=new _fce.g(_B.a(n,[2,0]),_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));var si=new _fce.f(n.children[2],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));var fi=new _js.c(n.children[1]);var ft=new _fce.g(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));ft.a=0;ft.d("");return new _B(n,[ft,fi,si,oi,d,g,ii,rt,i,hi,gi,k,s,di,et,wt,r,ur,tr,l,o,ir,h,ni,f,vi,ui,b,y,wi,p,yi,pi,bi,li,ci,kt,v,ai,bt,ht,ct,pt,rr,e,ki,nr,t,lt,ri,yt,vt,ot,st,ti,gt,dt,ei]).R({ComposeViewContent:d,InfoBarControl:g,FromFieldControl:rt,ToRecipientButton:i,ToRecipientWellControl:s,CcRecipientWellControl:wt,CcRecipientButton:r,BccRecipientWellControl:ni,BccRecipientButton:f,SubjectTextBox:v,AttachmentWellViewWrapper:e,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:ot,CancelConfirmDialog:st})},_mcp.d,_mcp.n,function(n){return new _mcp.n(n,_js.a.Instance.a(_js.G),_js.a.Instance.a(_a.e),_js.a.Instance.a(_a.t),_js.a.Instance.a(_a.f),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_a.w),_js.a.Instance.a(_b.e),_js.a.Instance.a(_a.id.$$(IAtMentionsHandler)))},!1,!1,!1,0,_mcp._TI.a);var f="MailComposeAggregatedRecipientWellView._tidi1";new _A(f,function(){_mcp._TI.a[f]===undefined&&(_mcp._TI.a[f]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_u.R.OS]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dZ,0,null,null,null,_u.R.GX],[-1,0,["RecipientComponent","To","AggregatedRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.I,_mcp._TI.cp],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[52].cloneNode(!0);var t=new _rw.c(n.children[1]);t.w("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _B(n,[i,t])},_mcp.g,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var n="MailComposeAggregatedRecipientWellView._tidj1";new _A(n,function(){_mcp._TI.a[n]===undefined&&(_mcp._TI.a[n]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_u.R.Rh]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dZ,0,null,null,null,_u.R.Ej],[-1,0,["RecipientComponent","Cc","AggregatedRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.cp],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[53].cloneNode(!0);var i=new _rw.c(t.children[1]);i.w("ReadOnlyRecipientWellExpandCollapseView");var r=new _fc.a(t.children[0]);return new _B(t,[r,i])},_mcp.g,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var t="MailComposeAggregatedRecipientWellView._tidk1";new _A(t,function(){_mcp._TI.a[t]===undefined&&(_mcp._TI.a[t]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_u.R.OA]],[[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.dZ,0,null,null,null,_u.R.CS],[-1,0,["RecipientComponent","Bcc","AggregatedRecipientWellViewModel"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.cp],null,"DataContext",null,_mcp._TI.f,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[54].cloneNode(!0);var i=new _rw.c(n.children[1]);i.w("ReadOnlyRecipientWellExpandCollapseView");var r=new _fc.a(n.children[0]);return new _B(n,[r,i])},_mcp.g,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var i="MailComposeAggregatedRecipientWellView._tidl1";new _A(i,function(){_mcp._TI.a[i]===undefined&&(_mcp._TI.a[i]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.cs,_mcp._TI.cc],null,"IsHidden",null,_mcp._TI.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.e,_mcp._TI.ca],null,"Id",null,_mcp._TI.B,1,_mcp._TI.bW(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp._TI.B,0,null,null,null,_mcp.c.c()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.bG,_mcp._TI.bZ],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.m,0,null,null,null,_mcp.c.p()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.p,0,null,null,null,_mcp.c.q()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.G,0,null,null,null,_mcp.c.r()],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.j,0,null,null,null,_u.P.q],[-1,4,null,null,null,"Title",null,_mcp._TI.t,0,null,null,null,_nbs.a.GT],[-1,0,["NavigationComponent","OpenComposeWindowCommand"],[_mcp._TI.bT,_mcp._TI.ce],null,"ClickCommand",null,_mcp._TI.h,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[55].cloneNode(!0);var n=new _fc.b(t.children[2]);n.M(!1);n.a("ms-font-color-black");n.C(-1);var u=new _fc.d(t.children[1],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));var r=new _fc.d(t.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(t,[r,u,n])},_mcp.g,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var h="MailComposeAggregatedRecipientWellView";new _A(h,function(){_mcp._TI.a[h]===undefined&&(_mcp._TI.a[h]=[null,[[-1,0,["RecipientComponent","Cc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp._TI.c,_mcp._TI.D,_mcp._TI.cp,_mcp._TI.eA,_mcp._TI.cl],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.bV(),null,!0]],[[-1,0,["RecipientComponent","Bcc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp._TI.c,_mcp._TI.C,_mcp._TI.cp,_mcp._TI.eA,_mcp._TI.cl],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.bV(),null,!0]],[[-1,5,["DisplayEllipsis"],[_mcp._TI.gq],null,"_mcp_W4:hidden",null,null,1,null,null,null]],[[-1,5,["IsFirefox"],[_mcp._TI.o],null,"_mcp_15",null,null,0,null,null,null]]]);var n=_mcp._TI._hf.childNodes[56].cloneNode(!0);var u=new _js.b(_B.a(n,[0,2]));u.w("MailComposeAggregatedRecipientWellView._tidl1");var f=new _js.c(_B.a(n,[0,1]));var t=new _js.b(_B.a(n,[0,0,0,2]));t.C(-1);t.w("MailComposeAggregatedRecipientWellView._tidk1");var i=new _js.b(_B.a(n,[0,0,0,1]));i.C(-1);i.w("MailComposeAggregatedRecipientWellView._tidj1");var r=new _js.b(_B.a(n,[0,0,0,0]));r.C(-1);r.w("MailComposeAggregatedRecipientWellView._tidi1");return new _B(n,[r,i,t,f,u])},_mcp.g,_mcp.P,function(n){return new _mcp.P(n)},!1,!1,!1,0,_mcp._TI.a);var c="MessageOptionsView._tidm1";new _A(c,function(){_mcp._TI.a[c]===undefined&&(_mcp._TI.a[c]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.Ln],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.gh],_mcp._TI.gl,"IsChecked",_mcp._TI.bO,_mcp._TI.bP,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.gi],null,"IsEnabled",null,_mcp._TI.da,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.MS],[-1,0,["SmimeSignMessage"],[_mcp._TI.gj],_mcp._TI.gm,"IsChecked",_mcp._TI.bO,_mcp._TI.bP,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.gk],null,"IsEnabled",null,_mcp._TI.da,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[57].cloneNode(!0);var i=new _fc.i(n.children[1],_js.a.Instance.a(_ff.a));var t=new _fc.i(n.children[0],_js.a.Instance.a(_ff.a));return new _B(n,[t,i])},_mcp.F,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mcp._TI.a);var l="MessageOptionsView.SensitivityTemplate";new _A(l,function(){_mcp._TI.a[l]===undefined&&(_mcp._TI.a[l]=[[[-1,1,["DataContext"],[_mcp._TI.bF],null,"Text",null,_mcp._TI.i,1,_mcp._TI.es(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},Object,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a);var e="MessageOptionsView";new _A(e,function(){_mcp._TI.a[e]===undefined&&(_mcp._TI.a[e]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_nbs.a.Tg]],[[-1,0,["SensitivityOptions"],[_mcp._TI.eS],null,"Options",null,_mcp._TI.eE,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.eR],_mcp._TI.eX,"SelectedValue",_mcp._TI.eD,_mcp._TI.eF,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.WM],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.eP],_mcp._TI.eV,"IsChecked",_mcp._TI.bO,_mcp._TI.bP,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.eT],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.Za],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.eQ],_mcp._TI.eW,"IsChecked",_mcp._TI.bO,_mcp._TI.bP,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.eU],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.gg],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]]]);var n=_mcp._TI._hf.childNodes[58].cloneNode(!0);var i=new _js.b(n.children[4]);i.w("MessageOptionsView._tidm1");var u=new _fc.i(n.children[3],_js.a.Instance.a(_ff.a));var f=new _fc.i(n.children[2],_js.a.Instance.a(_ff.a));var t=new _fce.j(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,f,u,i])},_mcp.F,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a);var o="OmeExpirationView._tidn1";new _A(o,function(){_mcp._TI.a[o]===undefined&&(_mcp._TI.a[o]=[[[-1,4,null,null,null,"Title",null,_mcp._TI.t,0,null,null,null,_nbs.a.Tm],[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.Tm],[-1,4,null,null,null,"Data",null,_mcp._TI.eG,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_mcp._TI.t,0,null,null,null,_nbs.a.JR],[-1,4,null,null,null,"Text",null,_mcp._TI.l,0,null,null,null,_nbs.a.JR],[-1,4,null,null,null,"Data",null,_mcp._TI.eG,0,null,null,null,1],[-1,0,["IsOmeTimeExpirationEnabled"],[_mcp._TI.eY],null,"IsHidden",null,_mcp._TI.b,1,_mcp._TI.d(),null,!0]],[[-1,5,["IsOmeTimeExpirationEnabled"],[_mcp._TI.eY],null,"_mcp_j5",null,null,0,_mcp._TI.d(),null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp._TI.dd,0,null,null,0,2],[-1,0,["FirstTextBox","MaxLength"],[_mcp._TI.dx,_mcp._TI.ej],null,"MaxLength",null,_mcp._TI.bD,0,null,null,0],[-1,0,["FirstTextBox","TextInput"],[_mcp._TI.dx,_mcp._TI.el],_mcp._TI.em,"Text",_mcp._TI.bC,_mcp._TI.bE,2,null,null,null],[-1,0,["FirstTextBox","PlaceholderText"],[_mcp._TI.dx,_mcp._TI.ek],null,"Placeholder",null,_mcp._TI.ck,0,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp._TI.en],_mcp._TI.eo,"IsEnabled",_mcp._TI.dX,_mcp._TI.dY,2,null,null,!1],[-1,5,["FirstTextBox","IsYear"],[_mcp._TI.dx,_mcp._TI.ei],null,"_mcp_h5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp._TI.dd,0,null,null,0,2],[-1,0,["SecondTextBox","MaxLength"],[_mcp._TI.dy,_mcp._TI.ej],null,"MaxLength",null,_mcp._TI.bD,0,null,null,0],[-1,0,["SecondTextBox","PlaceholderText"],[_mcp._TI.dy,_mcp._TI.ek],null,"Placeholder",null,_mcp._TI.ck,0,null,null,null],[-1,0,["SecondTextBox","TextInput"],[_mcp._TI.dy,_mcp._TI.el],_mcp._TI.em,"Text",_mcp._TI.bC,_mcp._TI.bE,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp._TI.en],_mcp._TI.eo,"IsEnabled",_mcp._TI.dX,_mcp._TI.dY,2,null,null,!1],[-1,5,["SecondTextBox","IsYear"],[_mcp._TI.dy,_mcp._TI.ei],null,"_mcp_h5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp._TI.dd,0,null,null,0,2],[-1,0,["ThirdTextBox","MaxLength"],[_mcp._TI.dz,_mcp._TI.ej],null,"MaxLength",null,_mcp._TI.bD,0,null,null,0],[-1,0,["ThirdTextBox","PlaceholderText"],[_mcp._TI.dz,_mcp._TI.ek],null,"Placeholder",null,_mcp._TI.ck,0,null,null,null],[-1,0,["ThirdTextBox","TextInput"],[_mcp._TI.dz,_mcp._TI.el],_mcp._TI.em,"Text",_mcp._TI.bC,_mcp._TI.bE,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp._TI.en],_mcp._TI.eo,"IsEnabled",_mcp._TI.dX,_mcp._TI.dY,2,null,null,!1],[-1,5,["ThirdTextBox","IsYear"],[_mcp._TI.dz,_mcp._TI.ei],null,"_mcp_h5",null,null,0,null,null,null]]]);var n=_mcp._TI._hf.childNodes[60].cloneNode(!0);var u=new _fc.h(_B.a(n,[1,1,2]));var f=new _fc.h(_B.a(n,[1,1,1]));var e=new _fc.h(_B.a(n,[1,1,0]));var t=new _js.c(_B.a(n,[1,1]));var i=new _fce.i(_B.a(n,[1,0]));var r=new _fce.i(_B.a(n,[0,0]));return new _B(n,[r,i,t,e,f,u])},_mcp.N,_fce.h,function(n){return new _fce.h(n)},!1,!0,!1,0,_mcp._TI.a);var s="OmeExpirationView";new _A(s,function(){_mcp._TI.a[s]===undefined&&(_mcp._TI.a[s]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.i,0,null,null,null,_nbs.a.la]],[[-1,0,["SelectedOption"],[_mcp._TI.go],_mcp._TI.gp,"SelectedOptionData",_mcp._TI.fA,_mcp._TI.fB,2,null,null,null]],[[-1,0,["ErrorText"],[_mcp._TI.gn],null,"Text",null,_mcp._TI.i,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[61].cloneNode(!0);var i=new _fc.a(n.children[2]);i.M(!1);var t=new _fce.h(n.children[1]);t.w("OmeExpirationView._tidn1");var r=new _fc.a(n.children[0]);return new _B(n,[r,t,i])},_mcp.N,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mcp._TI.a)};_mcp._TI.fi=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_r ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_t'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_q'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> <button type='button' class='_mcp_v ms-font-m'></button> </div> </div><div> <span class='_mcp_p'></span> <span class='_mcp_p'></span> </div><div> <span class='_mcp_p'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_q'> <span class='_mcp_m _mcp_n _mcp_o ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_q'> <span class='_mcp_o ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_q'> <div class='_mcp_7'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_V _mcp_W'></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_E'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_G'> <div class='_mcp_H ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_N'></div> <div class='_mcp_L'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_M _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-regular ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_w'></div> </div> <div> <div class='_mcp_8 _mcp_w'></div> </div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-regular ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_w'></div> </div> <div> <div class='_mcp_8 _mcp_w'></div> </div> </div> <div class='_mcp_5 _mcp_Q _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-regular ms-font-color-black _mcp_D'></button> <div> <div class='_mcp_C'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_w'></div> </div> <div> <div class='_mcp_8 _mcp_w'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <div class='_mcp_q'> <button type='button' class='_mcp_v _mcp_l'></button> <span class='_mcp_v _mcp_k'></span> <span class='_mcp_v _mcp_k'></span> <span class='_mcp_v _mcp_k'></span> <button type='button' class='_mcp_v ms-font-xl'></button> <div class='_mcp_w'> <input autoid=\"_mcp_3\" class='_mcp_r _mcp_s ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_L ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_x'></div> <div class='_mcp_I ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_L ms-bg-color-white'> <span class='_mcp_z ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_F'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_A1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_o1'></button> <div class='_mcp_D1'></div> <div class='_mcp_l1'></div> <div class='_mcp_l1'></div> <div></div> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_w1'> <span autoid=\"_mcp_l\" class='_mcp_t1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_I1'></span> <span class='_mcp_I1'></span> </div><div> <span class='_mcp_I1'></span> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_w1'> <div> <span class='_mcp_I1 _mcp_H1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_J1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_w1'> <span autoid=\"_mcp_m\" class='_mcp_H1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black _mcp_u1'></span> <div class='_mcp_w1'> <div class='_mcp_h1'></div> </div> </div><div> <button autoid=\"_mcp_n\" type='button'></button> <div></div> </div><div> <span class='_mcp_q1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_p1'></span> </div><div> <iframe autoid=\"_mcp_s\" class='_mcp_42'></iframe> </div><div> <div class='_mcp_52'> <button type='button' class='_mcp_62 _mcp_N1 ms-font-weight-regular'></button> <span></span> </div> </div><div> <button type='button' class='_mcp_r1 ms-font-weight-semibold'></button> <button type='button' class='_mcp_r1 ms-font-weight-semibold'></button> </div><div> <div class='_mcp_c1 _mcp_82'></div> </div><div> <div></div> <div class='_mcp_X1'></div> <span class='_mcp_X1'></span> <div class='_mcp_61 ms-bg-color-white'> <div class='_mcp_32'></div> <div></div> <div class='_mcp_91'>  <span class='_mcp_b1'> <div class='_mcp_S1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_N1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_N1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_S1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_N1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_S1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_N1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_S1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_N1 ms-font-weight-regular _mcp_Q1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_N1 ms-font-weight-regular'></button> </span> <span class='_mcp_c1'> <button autoid=\"_mcp_b\" type='button' class='_mcp_N1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_a1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_Z'> <div class='_mcp_01 _mcp_31'></div> <div class='_mcp_01 _mcp_21'> <div class='_mcp_41 ms-bg-color-white customScrollBar'>  <div class='_mcp_d1 ms-font-weight-regular'></div> <div class='_mcp_f1 _mcp_k1 ms-border-color-neutralTertiary'></div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_r1 ms-font-weight-regular ms-font-color-black _mcp_12'></button> <div class='_mcp_w1 _mcp_y1 _mcp_x1'> <div class='_mcp_02'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div></div> <div autoid=\"_mcp_f\" class='_mcp_U1'></div> </div> <div class='_mcp_w1 _mcp_y1 _mcp_x1 _mcp_z1'> <div class='_mcp_U1'></div> </div>  </div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_r1 ms-font-weight-regular ms-font-color-black _mcp_12'></button> <div class='_mcp_w1 _mcp_y1 _mcp_x1'> <div class='_mcp_02'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_U1'></div> </div> <div class='_mcp_w1 _mcp_y1 _mcp_x1 _mcp_z1'> <div class='_mcp_U1'></div> </div>  </div> <div class='_mcp_f1 _mcp_i1 _mcp_k1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_r1 ms-font-weight-regular ms-font-color-black _mcp_12'></button> <div class='_mcp_w1 _mcp_y1 _mcp_x1'> <div class='_mcp_02'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_U1'></div> </div> <div class='_mcp_w1 _mcp_y1 _mcp_x1 _mcp_z1'> <div class='_mcp_U1'></div> </div>  </div> <div class='_mcp_f1'> <span class='_mcp_r1 ms-font-weight-semibold ms-font-color-black _mcp_v1 '></span> <span class='_mcp_r1 ms-font-weight-semibold ms-font-color-black _mcp_v1 '></span> </div> <div class='_mcp_f1 _mcp_g1 _mcp_k1 ms-border-color-neutralTertiary'> <div class='_mcp_w1'> <span class='_mcp_W1'></span> <span autoid=\"_mcp_i\" class='_mcp_V1'></span> <span autoid=\"_mcp_j\" class='_mcp_V1'></span> <span class='_mcp_V1'></span> <div class='_mcp_U1'> <input autoid=\"_mcp_k\" class='_mcp_A1 _mcp_B1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div class='_mcp_a2'> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> <div class='_mcp_j1'></div> </div> <div class='_mcp_F1 ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> <span></span> <span></span> <div class='_mcp_K1'></div> <div class='_mcp_72 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_Y1 ms-bg-color-white'></div> <div autoid=\"_mcp_o\"></div> <div autoid=\"_mcp_p\"></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_q\"></div> <div autoid=\"_mcp_r\"></div>      </div><div> <div class='_mcp_U2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_t\" type='button' class='ms-bg-color-neutralLighter _mcp_H2'></button> <div class='_mcp_X2'></div> <div class='_mcp_E2'></div> <div class='_mcp_E2'></div> <div></div> </div><div> <span class='_mcp_L2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_P2'> <span autoid=\"_mcp_z\" class='_mcp_M2 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_43'></span> <span class='_mcp_43'></span> </div><div> <span class='_mcp_43'></span> </div><div> <span class='_mcp_L2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_P2'> <div> <span class='_mcp_43 _mcp_33 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_53'></span> <div></div> </div> </div> </div><div> <span class='_mcp_L2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_P2'> <span autoid=\"_mcp_A\" class='_mcp_33 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_L2 ms-font-weight-semibold ms-font-color-black _mcp_N2'></span> <div class='_mcp_P2'> <div class='_mcp_u2'></div> </div> </div><div> <span class='ms-font-weight-semilight ms-font-color-neutralSecondary'></span> </div><div> <span class='_mcp_p2'></span> <span class='_mcp_p2'></span> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_p2'></button> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_p2'></button> <button type='button' class='_mcp_p2 ms-border-color-neutralTertiary _mcp_q2'></button> </div><div> <div class='_mcp_l2 _mcp_o2'></div> </div><div> <div class='_mcp_p3'></div> <span class='_mcp_p3'></span> <div class='_mcp_c2 _mcp_A2 ms-border-color-neutralLight'> <div class='_mcp_d2 _mcp_u3'></div> <div class='_mcp_d2 _mcp_e2 ms-bg-color-white'> <div class='_mcp_g2'> <div class='_mcp_m2 ms-font-weight-regular'></div> </div> <div> <div class='_mcp_f2 ms-bg-color-white customScrollBar _mcp_C2'>  <div class='_mcp_w2'> <div></div>  </div> <div> <div class='_mcp_r2 _mcp_s2 _mcp_A2 ms-border-color-neutralLight'></div> <div class='_mcp_r2 _mcp_v2'> <button autoid=\"_mcp_u\" type='button' class='_mcp_K2 ms-font-weight-regular _mcp_s3'></button> <div class='_mcp_P2 _mcp_Q2'> <div autoid=\"_mcp_v\" class='_mcp_m3'></div> </div> <div class='_mcp_P2 _mcp_Q2 _mcp_R2'> <div class='_mcp_m3'></div> </div> <div></div>  </div> <div class='_mcp_r2 _mcp_v2 _mcp_B2 ms-border-color-neutralLight'> <button type='button' class='_mcp_K2 ms-font-weight-regular _mcp_s3'></button> <div class='_mcp_P2 _mcp_Q2'> <div autoid=\"_mcp_w\" class='_mcp_m3'></div> </div> <div class='_mcp_P2 _mcp_R2'> <div class='_mcp_m3'></div> </div>  </div> <div class='_mcp_r2 _mcp_v2 _mcp_B2 ms-border-color-neutralLight'> <button type='button' class='_mcp_K2 ms-font-weight-regular _mcp_s3'></button> <div class='_mcp_P2 _mcp_Q2'> <div autoid=\"_mcp_x\" class='_mcp_m3'></div> </div> <div class='_mcp_P2 _mcp_R2'> <div class='_mcp_m3'></div> </div>  </div> <div class='_mcp_r2'> <span class='_mcp_K2 ms-font-weight-semibold ms-font-color-black _mcp_O2 '></span> <span class='_mcp_K2 ms-font-weight-semibold ms-font-color-black _mcp_O2 '></span> </div> <div class='_mcp_r2 _mcp_t2 _mcp_A2 ms-border-color-neutralTertiary'> <span class='_mcp_K2 ms-font-weight-semibold ms-font-color-black _mcp_O2'></span> <div class='_mcp_P2'> <div class='_mcp_m3'> <input autoid=\"_mcp_y\" class='_mcp_U2 _mcp_V2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_y2'></div> <div class='_mcp_y2'></div> <div class='_mcp_y2'></div> <div class='_mcp_y2'></div> </div> </div> <div class='_mcp_A2 ms-border-color-themeTertiary'></div> </div> <span></span> <span></span> <div class='_mcp_D2'> <div>  <div class='_mcp_Z2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_03 ms-border-color-neutralLight'></div> </div> <div class='_mcp_63'> <div></div> </div> <div class='_mcp_y3'> <button autoid=\"_mcp_B\" type='button' class='ms-font-s ms-font-weight-regular'></button> <div></div> </div> </div> </div> <div class='_mcp_g2 _mcp_B2 ms-bg-color-white'> <div class='_mcp_i2'>  <span> <div class='_mcp_k3'> <button autoid=\"_mcp_C\" type='button' class='_mcp_a3 ms-font-weight-regular _mcp_z2'></button> <button type='button' class='_mcp_93 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_D\" type='button' class='_mcp_a3 ms-font-weight-regular _mcp_b3 _mcp_z2'></button> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_E\" type='button' class='_mcp_e3'></button> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_F\" type='button' class='_mcp_e3 _mcp_z3'></button> </div> <div class='_mcp_k3'> <div></div> </div> <div class='_mcp_k3'> <span class='_mcp_e3 _mcp_A3 ms-font-color-neutralTertiaryAlt'></span> </div> <div class='_mcp_k3'> <button type='button' class='_mcp_e3'></button> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_G\" type='button' class='_mcp_e3'></button> </div> <div class='_mcp_k3'> <button autoid=\"_mcp_H\" type='button' class='_mcp_e3'></button> </div> </span> <span class='_mcp_l2'> <button autoid=\"_mcp_I\" type='button' class='_mcp_93 ms-font-weight-regular'></button> <div class='_mcp_B3'></div> </span> </div> <div class='_mcp_j2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_q3 ms-bg-color-white'></div> <div autoid=\"_mcp_J\"></div> <div></div> <div></div> <div autoid=\"_mcp_K\"></div> <div autoid=\"_mcp_L\"></div>  </div><div> <div class='_mcp_a4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_M\" type='button' class='_mcp_Y3'></button> <div class='_mcp_d4'></div> <div class='_mcp_V3'></div> <div class='_mcp_V3'></div> </div><div> <span class='_mcp_24 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_64'> <span autoid=\"_mcp_V\" class='_mcp_34 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_j4'></span> <span class='_mcp_j4'></span> </div><div> <span class='_mcp_j4'></span> </div><div> <span class='_mcp_24 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_64'> <div> <span class='_mcp_j4 _mcp_i4 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_k4'></span> <div></div> </div> </div> </div><div> <span class='_mcp_24 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_64'> <span autoid=\"_mcp_W\" class='_mcp_i4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_24 ms-font-weight-semibold ms-font-color-black _mcp_44'></span> <div class='_mcp_64'> <div class='_mcp_R3'></div> </div> </div><div> <button autoid=\"_mcp_X\" type='button'></button> <div></div> </div><div> <div class='_mcp_F4'></div> <span class='_mcp_F4'></span> <div class='_mcp_D3'> <div class='_mcp_E3 _mcp_L4'></div> <div class='_mcp_E3 _mcp_F3 ms-bg-color-white'> <div class='_mcp_G3 ms-bg-color-white customScrollBar'>  <div class='_mcp_N3 ms-font-weight-regular'></div> <div class='_mcp_P3 _mcp_U3 ms-border-color-neutralTertiary'></div> <div class='_mcp_P3 _mcp_S3 _mcp_U3 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_N\" type='button' class='_mcp_14 ms-font-weight-regular ms-font-color-black _mcp_J4'></button> <div class='_mcp_64 _mcp_84 _mcp_74'> <div class='_mcp_I4'> <button autoid=\"_mcp_O\" type='button'></button> </div> <div autoid=\"_mcp_P\" class='_mcp_C4'></div> </div> <div class='_mcp_64 _mcp_84 _mcp_74'> <div class='_mcp_C4'></div> </div>  </div> <div class='_mcp_P3 _mcp_S3 _mcp_U3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_14 ms-font-weight-regular ms-font-color-black _mcp_J4'></button> <div class='_mcp_64 _mcp_84 _mcp_74'> <div class='_mcp_I4'> <button type='button'></button> </div> <div autoid=\"_mcp_Q\" class='_mcp_C4'></div> </div> <div class='_mcp_64 _mcp_84'> <div class='_mcp_C4'></div> </div>  </div> <div class='_mcp_P3 _mcp_S3 _mcp_U3 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_14 ms-font-weight-regular ms-font-color-black _mcp_J4'></button> <div class='_mcp_64 _mcp_84 _mcp_74'> <div class='_mcp_I4'> <button type='button'></button> </div> <div autoid=\"_mcp_R\" class='_mcp_C4'></div> </div> <div class='_mcp_64 _mcp_84'> <div class='_mcp_C4'></div> </div>  </div> <div class='_mcp_P3'> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black _mcp_54 '></span> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black _mcp_54 '></span> </div> <div class='_mcp_P3 _mcp_Q3 _mcp_U3 ms-border-color-neutralTertiary'> <span class='_mcp_14 ms-font-weight-semibold ms-font-color-black _mcp_54'></span> <div class='_mcp_64'> <span class='_mcp_E4'></span> <span autoid=\"_mcp_S\" class='_mcp_D4'></span> <span autoid=\"_mcp_T\" class='_mcp_D4'></span> <span class='_mcp_D4'></span> <div class='_mcp_C4'> <input autoid=\"_mcp_U\" class='_mcp_a4 _mcp_b4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_T3'></div> <div class='_mcp_T3'></div> <div class='_mcp_T3'></div> <div class='_mcp_T3'></div> </div> </div> <span></span> <span></span> <div class='_mcp_l4 ms-bg-color-white'></div> <div class='_mcp_P4 ms-border-color-neutralTertiary'></div> <div class='_mcp_f4 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_g4 ms-bg-color-white'></div> <div class='_mcp_H3 ms-bg-color-white ms-border-color-neutralTertiary'> <div class='_mcp_J3'>  <span> <div class='_mcp_A4'> <button autoid=\"_mcp_Y\" type='button' class='_mcp_p4 _mcp_s4'></button> <button type='button' class='_mcp_o4 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_A4'> <button autoid=\"_mcp_Z\" type='button' class='_mcp_p4 _mcp_t4'></button> </div> <div class='_mcp_z4'> <button autoid=\"_mcp_01\" type='button' class='_mcp_o4 ms-font-weight-regular _mcp_x4'></button> </div> <button autoid=\"_mcp_11\" type='button' class='_mcp_o4 ms-font-weight-regular'></button> </span> <span class='_mcp_M3'> <div class='_mcp_A4'> <button autoid=\"_mcp_21\" type='button' class='_mcp_u4'></button> <button autoid=\"_mcp_31\" type='button' class='_mcp_u4'></button> </div> <button autoid=\"_mcp_41\" type='button' class='_mcp_o4 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_K3 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_G4 ms-bg-color-white'></div> <div autoid=\"_mcp_51\"></div> <div></div> <div></div> <div autoid=\"_mcp_61\"></div> <div autoid=\"_mcp_71\"></div> </div><div> <span class='_mcp_X4 _mcp_Y4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_T4'></div> </div><div> <span class='_mcp_X4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_U4'></div> </div><div> <span class='_mcp_X4 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_V4'></div> </div><div> <span class='_mcp_25'></span> <span class='_mcp_25'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_25 _mcp_35'></button> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_Z4'> <div class='_mcp_R4 _mcp_Q4'> <div class='_mcp_S4'>  <div class='_mcp_T4'></div>  <div class='_mcp_U4'></div>  <div class='_mcp_V4'></div> </div> </div> <span>\n                    ...\n                </span> <div class='_mcp_05'></div> </div> </div><div> <button autoid=\"_mcp_b1\" type='button' class='_mcp_75'></button> <button autoid=\"_mcp_c1\" type='button' class='_mcp_75'></button> </div><div> <span class='_mcp_55 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_81\" class='_mcp_65'></div> <button autoid=\"_mcp_91\" type='button' class='_mcp_75'></button> <button autoid=\"_mcp_a1\" type='button' class='_mcp_75'></button>  <div></div> <div class='_mcp_85'></div>  </div><div> <span class='_mcp_95 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_a5'></div> <button type='button' class='_mcp_b5'></button> <button type='button' class='_mcp_b5'></button>  </div><div> <div class='_mcp_e5'> <label></label> </div> <div class='_mcp_e5'> <label class='_mcp_k5'></label> <div class='_mcp_i5'> <input class='_mcp_g5'/> <input class='_mcp_g5'/> <input class='_mcp_g5'/> </div> </div> </div><div> <span class='_mcp_c5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_f5'></div> <span class='_mcp_d5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div>";_js.c.a().appendChild(n);return n};_mcp._TI.gb=function(n){return n.b};_mcp._TI.ga=function(n){return n.a};_mcp._TI.c=function(n){return n.P()};_mcp._TI.H=function(n){return _mcp.e.isInstanceOfType(n)?n.bi:null};_mcp._TI.cV=function(n){return n.e()};_mcp._TI.W=function(n){return n.cd()};_mcp._TI.R=function(n){return n.b()};_mcp._TI.y=function(n){return n.i};_mcp._TI.Y=function(n){return n.c()};_mcp._TI.cW=function(n){return n.O()};_mcp._TI.e=function(n){return n.N};_mcp._TI.bl=function(n){return n.v()};_mcp._TI.fa=function(n){return _mcp.n.isInstanceOfType(n)?n.fU():null};_mcp._TI.Q=function(n){return n.bm()};_mcp._TI.O=function(n){return n.a()};_mcp._TI.q=function(n){return n.dE()};_mcp._TI.cS=function(n){return n.e()};_mcp._TI.bF=function(n){return n.E()};_mcp._TI.bm=function(n){return n.a()};_mcp._TI.bp=function(n){return _mcp.f.isInstanceOfType(n)?n.k():null};_mcp._TI.ds=function(n){return _mcp.a.isInstanceOfType(n)?_u.P.N:null};_mcp._TI.cR=function(n){return n.d()};_mcp._TI.cQ=function(n){return n.b()};_mcp._TI.M=function(n){return n.bz()};_mcp._TI.dV=function(n){return n.a()};_mcp._TI.cZ=function(n){return n.j()};_mcp._TI.cY=function(n){return n.i()};_mcp._TI.fk=function(n){return n.c()};_mcp._TI.eC=function(n){return n.Z};_mcp._TI.eB=function(n){return n.u()};_mcp._TI.F=function(n){return n.cm};_mcp._TI.fb=function(n){return n.cI};_mcp._TI.eL=function(n){return OwaApplication.b};_mcp._TI.V=function(n){return n.bg()};_mcp._TI.bA=function(n){return n.a()};_mcp._TI.bX=function(n){return n.b()};_mcp._TI.gc=function(n){return n.ds()};_mcp._TI.dw=function(n){return n.ch};_mcp._TI.bq=function(n){return n.bN};_mcp._TI.eh=function(n){return n.D()};_mcp._TI.ft=function(n){return n.a()};_mcp._TI.bU=function(n){return n.d()};_mcp._TI.ch=function(n){return n.f()};_mcp._TI.N=function(n){return n.e()};_mcp._TI.cq=function(n){return _mcp.x.isInstanceOfType(n)?n.T:null};_mcp._TI.cr=function(n){return n.dc()};_mcp._TI.X=function(n){return n.a()};_mcp._TI.cf=function(n){return n.N()};_mcp._TI.k=function(n){return n.L};_mcp._TI.br=function(n){return _mcp.n.isInstanceOfType(n)?n.ee:null};_mcp._TI.K=function(n){return _mcp.n.isInstanceOfType(n)?n.bT:null};_mcp._TI.bH=function(n){return n.O};_mcp._TI.o=function(n){return n.dz()};_mcp._TI.bJ=function(n){return n.dA()};_mcp._TI.eZ=function(n){return n.ej()};_mcp._TI.by=function(n){return n.M()};_mcp._TI.I=function(n){return _mcp.e.isInstanceOfType(n)?n.bf:null};_mcp._TI.w=function(n){return n.T()};_mcp._TI.g=function(n){return n.dy()};_mcp._TI.s=function(n){return n.M()};_mcp._TI.fc=function(n){return n.fY()};_mcp._TI.ef=function(n){return n.dw()};_mcp._TI.U=function(n){return n.a};_mcp._TI.bQ=function(n){return _rw.a.isInstanceOfType(n)?n.dP():null};_mcp._TI.T=function(n){return n.b};_mcp._TI.D=function(n){return _mcp.e.isInstanceOfType(n)?n.be:null};_mcp._TI.eq=function(n){return n.fW()};_mcp._TI.cb=function(n){return n.Q()};_mcp._TI.C=function(n){return _mcp.e.isInstanceOfType(n)?n.bg:null};_mcp._TI.ep=function(n){return n.fV()};_mcp._TI.bc=function(n){return n.bx()};_mcp._TI.bG=function(n){return n.cb()};_mcp._TI.fp=function(n){return n.e()};_mcp._TI.bZ=function(n){return n.a()};_mcp._TI.dL=function(n){return n.C()};_mcp._TI.dK=function(n){return n.q()};_mcp._TI.cs=function(n){return n.dv()};_mcp._TI.cc=function(n){return n.a()};_mcp._TI.ca=function(n){return n.ba()};_mcp._TI.bC=function(n){return n.b};_mcp._TI.dr=function(n){return _mcp.a.isInstanceOfType(n)?255:null};_mcp._TI.cK=function(n){return n.bC()};_mcp._TI.cI=function(n){return n.ca()};_mcp._TI.E=function(n){return n.T()};_mcp._TI.bY=function(n){return n.a()};_mcp._TI.et=function(n){return n.m()};_mcp._TI.J=function(n){return _mcp.a.isInstanceOfType(n)?n.ge():null};_mcp._TI.bS=function(n){return _mcp.a.isInstanceOfType(n)?n.gd():null};_mcp._TI.cH=function(n){return n.K()};_mcp._TI.dg=function(n){return n.bW()};_mcp._TI.cG=function(n){return n.e()};_mcp._TI.dh=function(n){return n.dq()};_mcp._TI.dt=function(n){return n.bn()};_mcp._TI.cO=function(n){return n.b()};_mcp._TI.df=function(n){return n.bV};_mcp._TI.dB=function(n){return n.fT()};_mcp._TI.dA=function(n){return n.fS()};_mcp._TI.cX=function(n){return n.e()};_mcp._TI.ew=function(n){return n.cR()};_mcp._TI.du=function(n){return n.W};_mcp._TI.fu=function(n){return n.f()};_mcp._TI.fv=function(n){return n.h()};_mcp._TI.u=function(n){return n.c()};_mcp._TI.fo=function(n){return n.d()};_mcp._TI.bv=function(n){return n.i};_mcp._TI.bw=function(n){return n.p};_mcp._TI.bs=function(n){return n.j};_mcp._TI.bt=function(n){return n.q};_mcp._TI.bu=function(n){return n.h};_mcp._TI.dv=function(n){return n.bC()};_mcp._TI.cU=function(n){return n.a()};_mcp._TI.bK=function(n){return n.D};_mcp._TI.bM=function(n){return n.bZ};_mcp._TI.eN=function(n){return n.bD()};_mcp._TI.ey=function(n){return n.a()};_mcp._TI.ge=function(n){return n.bi};_mcp._TI.z=function(n){return n.dB()};_mcp._TI.bR=function(n){return _mcp.e.isInstanceOfType(n)?n.db:null};_mcp._TI.bj=function(n){return n.cz()};_mcp._TI.fs=function(n){return n.f()};_mcp._TI.fq=function(n){return n.a()};_mcp._TI.fr=function(n){return n.b()};_mcp._TI.cJ=function(n){return n.cd()};_mcp._TI.eJ=function(n){return _mcp.e.isInstanceOfType(n)?n.eg():null};_mcp._TI.ez=function(n){return n.q()};_mcp._TI.gf=function(n){return n.cH()};_mcp._TI.gx=function(n){return n.em()};_mcp._TI.gt=function(n){return n.fX()};_mcp._TI.fz=function(n){return n.m};_mcp._TI.gw=function(n){return n.ga()};_mcp._TI.ct=function(n){return n.bb()};_mcp._TI.cd=function(n){return n.a()};_mcp._TI.bg=function(n){return n.bv()};_mcp._TI.bI=function(n){return n.de()};_mcp._TI.eM=function(n){return n.C()};_mcp._TI.fn=function(n){return n.a()};_mcp._TI.gv=function(n){return n.fZ()};_mcp._TI.fm=function(n){return n.b()};_mcp._TI.bi=function(n){return _mcp.e.isInstanceOfType(n)?n.dZ():null};_mcp._TI.L=function(n){return n.be()};_mcp._TI.bz=function(n){return n.a()};_mcp._TI.eI=function(n){return _mcp.p.isInstanceOfType(n)?n.Q:null};_mcp._TI.dI=function(n){return n.cc()};_mcp._TI.ea=function(n){return _mcp.p.isInstanceOfType(n)?n.R:null};_mcp._TI.cF=function(n){return n.i()};_mcp._TI.eu=function(n){return n.a()};_mcp._TI.ex=function(n){return n.h()};_mcp._TI.gd=function(n){return n.dt()};_mcp._TI.bT=function(n){return n.b()};_mcp._TI.ce=function(n){return n.e()};_mcp._TI.dP=function(n){return n.D()};_mcp._TI.eO=function(n){return n.bM};_mcp._TI.dC=function(n){return n.v()};_mcp._TI.dW=function(n){return n.c};_mcp._TI.cl=function(n){return n.y.length};_mcp._TI.ed=function(n){return _mcp.e.isInstanceOfType(n)?n.ee():null};_mcp._TI.ee=function(n){return _mcp.e.isInstanceOfType(n)?n.eh():null};_mcp._TI.ec=function(n){return _mcp.e.isInstanceOfType(n)?n.dY():null};_mcp._TI.eb=function(n){return _mcp.e.isInstanceOfType(n)?n.dX():null};_mcp._TI.dJ=function(n){return n.ci()};_mcp._TI.er=function(n){return n.er};_mcp._TI.gu=function(n){return n.bS};_mcp._TI.eg=function(n){return n.cg};_mcp._TI.dM=function(n){return n.j()};_mcp._TI.dN=function(n){return n.k()};_mcp._TI.fV=function(n){return _mcp.z.isInstanceOfType(n)?n.m:null};_mcp._TI.fW=function(n){return _mcp.z.isInstanceOfType(n)?n.p:null};_mcp._TI.cE=function(n){return n.v};_mcp._TI.dU=function(n){return n.i()};_mcp._TI.dF=function(n){return n.c()};_mcp._TI.dG=function(n){return n.e()};_mcp._TI.dD=function(n){return n.a()};_mcp._TI.dE=function(n){return n.b()};_mcp._TI.dR=function(n){return n.e()};_mcp._TI.dQ=function(n){return n.d()};_mcp._TI.eK=function(n){return _mcp.B.isInstanceOfType(n)?n.D:null};_mcp._TI.cg=function(n){return n.p()};_mcp._TI.fj=function(n){return n.n()};_mcp._TI.gz=function(n){return n.hq()};_mcp._TI.fY=function(n){return _mcp.r.isInstanceOfType(n)?n.J:null};_mcp._TI.fU=function(n){return _mcp.p.isInstanceOfType(n)?n.z:null};_mcp._TI.ev=function(n){return n.f()};_mcp._TI.fd=function(n){return n.cU};_mcp._TI.gr=function(n){return n.v()};_mcp._TI.gs=function(n){return n.fn()};_mcp._TI.gA=function(n){return n.eU};_mcp._TI.fe=function(n){return _mcp.j.isInstanceOfType(n)?n.fK():null};_mcp._TI.fD=function(n){return n.y};_mcp._TI.fR=function(n){return n.d};_mcp._TI.fL=function(n){return n.c()};_mcp._TI.fZ=function(n){return _mcp.r.isInstanceOfType(n)?n.K:null};_mcp._TI.x=function(n){return n.a()};_mcp._TI.fy=function(n){return n.d()};_mcp._TI.ci=function(n){return n.e()};_mcp._TI.fx=function(n){return n.b()};_mcp._TI.cp=function(n){return n.d};_mcp._TI.eA=function(n){return n.a()};_mcp._TI.gq=function(n){return n.a};_mcp._TI.gh=function(n){return n.a};_mcp._TI.bO=function(n){return n.n()};_mcp._TI.gi=function(n){return n.i};_mcp._TI.gj=function(n){return n.b};_mcp._TI.gk=function(n){return n.j};_mcp._TI.eS=function(n){return n.r()};_mcp._TI.eR=function(n){return n.d};_mcp._TI.eD=function(n){return n.b()};_mcp._TI.eP=function(n){return n.e};_mcp._TI.eT=function(n){return!OwaApplication.b};_mcp._TI.eQ=function(n){return n.f};_mcp._TI.eU=function(n){return!OwaApplication.b};_mcp._TI.gg=function(n){return n.h};_mcp._TI.eY=function(n){return n.l()};_mcp._TI.dx=function(n){return n.c};_mcp._TI.ej=function(n){return n.d()};_mcp._TI.el=function(n){return n.a};_mcp._TI.ek=function(n){return n.e()};_mcp._TI.en=function(n){return n.d};_mcp._TI.dX=function(n){return n.u()};_mcp._TI.ei=function(n){return n.c};_mcp._TI.dy=function(n){return n.e};_mcp._TI.dz=function(n){return n.f};_mcp._TI.go=function(n){return n.a};_mcp._TI.fA=function(n){return n.a()};_mcp._TI.gn=function(n){return n.g};_mcp._TI.i=function(n,t){n.a(t)};_mcp._TI.f=function(n,t){n.X(t)};_mcp._TI.m=function(n,t){n.i(t)};_mcp._TI.l=function(n,t){n.h(t)};_mcp._TI.j=function(n,t){n.W(t)};_mcp._TI.ba=function(n,t){n.d(t)};_mcp._TI.bb=function(n,t){n.j(t)};_mcp._TI.Z=function(n,t){n.e(t)};_mcp._TI.b=function(n,t){n.M(t)};_mcp._TI.cT=function(n,t){n.f(t)};_mcp._TI.dq=function(n,t){n.a(t)};_mcp._TI.h=function(n,t){n.ba(t)};_mcp._TI.p=function(n,t){n.k(t)};_mcp._TI.G=function(n,t){n.r(t)};_mcp._TI.S=function(n,t){n.c(t)};_mcp._TI.bn=function(n,t){n.d(t)};_mcp._TI.B=function(n,t){n.a(t)};_mcp._TI.db=function(n,t){n.b(t)};_mcp._TI.n=function(n,t){n.k=t};_mcp._TI.P=function(n,t){n.m=t};_mcp._TI.bo=function(n,t){n.l=t};_mcp._TI.de=function(n,t){n.e(t)};_mcp._TI.r=function(n,t){n.W(t)};_mcp._TI.ck=function(n,t){n.i(t)};_mcp._TI.cN=function(n,t){n.I(t)};_mcp._TI.bE=function(n,t){n.c(t)};_mcp._TI.bD=function(n,t){n.a(t)};_mcp._TI.fl=function(n,t){n.r(t)};_mcp._TI.cm=function(n,t){n.gx(t)};_mcp._TI.dm=function(n,t){n.kW(t)};_mcp._TI.cM=function(n,t){n.G(t)};_mcp._TI.dj=function(n,t){n.cB(t)};_mcp._TI.cL=function(n,t){n.m(t)};_mcp._TI.dl=function(n,t){n.dj(t)};_mcp._TI.cP=function(n,t){n.a(t)};_mcp._TI.di=function(n,t){n.bs(t)};_mcp._TI.dk=function(n,t){n.cm=t};_mcp._TI.dp=function(n,t){n.ca(t)};_mcp._TI.dn=function(n,t){n.cV=t};_mcp._TI.dd=function(n,t){n.cd(t)};_mcp._TI.eH=function(n,t){n.a(t)};_mcp._TI.co=function(n,t){n.d(t)};_mcp._TI.cn=function(n,t){n.j(t)};_mcp._TI.fw=function(n,t){n.j(t)};_mcp._TI.v=function(n,t){n.a(t)};_mcp._TI.bx=function(n,t){n.g(t)};_mcp._TI.be=function(n,t){n.k(t)};_mcp._TI.bf=function(n,t){n.i(t)};_mcp._TI.bB=function(n,t){n.o(t)};_mcp._TI.bd=function(n,t){n.j(t)};_mcp._TI.bL=function(n,t){n.r(t)};_mcp._TI.bN=function(n,t){n.dp(t)};_mcp._TI.fC=function(n,t){n.a(t)};_mcp._TI.fE=function(n,t){n.I(t)};_mcp._TI.t=function(n,t){n.bw(t)};_mcp._TI.fT=function(n,t){n.o(t)};_mcp._TI.bh=function(n,t){n.ey(t)};_mcp._TI.bk=function(n,t){n.a=t};_mcp._TI.gy=function(n,t){n.ez(t)};_mcp._TI.dO=function(n,t){n.l(t)};_mcp._TI.fX=function(n,t){n.v(t)};_mcp._TI.dc=function(n,t){n.by(t)};_mcp._TI.dH=function(n,t){n.f(t)};_mcp._TI.dT=function(n,t){n.i(t)};_mcp._TI.dS=function(n,t){n.h(t)};_mcp._TI.fN=function(n,t){n.fs=t};_mcp._TI.cj=function(n,t){n.z(t)};_mcp._TI.da=function(n,t){n.o(t)};_mcp._TI.fQ=function(n,t){n.p=t};_mcp._TI.fO=function(n,t){n.u=t};_mcp._TI.fP=function(n,t){n.bo(t)};_mcp._TI.fG=function(n,t){n.h(t)};_mcp._TI.fI=function(n,t){n.G=t};_mcp._TI.fK=function(n,t){n.H=t};_mcp._TI.fJ=function(n,t){n.l(t)};_mcp._TI.fH=function(n,t){n.d(t)};_mcp._TI.fS=function(n,t){n.a(t)};_mcp._TI.fM=function(n,t){n.a(t)};_mcp._TI.fF=function(n,t){n.C(t)};_mcp._TI.dZ=function(n,t){n.W(t)};_mcp._TI.gl=function(n,t){n.p(t)};_mcp._TI.bP=function(n,t){n.m(t)};_mcp._TI.gm=function(n,t){n.q(t)};_mcp._TI.eE=function(n,t){n.c(t)};_mcp._TI.eX=function(n,t){n.o(t)};_mcp._TI.eF=function(n,t){n.d(t)};_mcp._TI.eV=function(n,t){n.m(t)};_mcp._TI.eW=function(n,t){n.n(t)};_mcp._TI.eG=function(n,t){n.m=t};_mcp._TI.em=function(n,t){n.f(t)};_mcp._TI.eo=function(n,t){n.j(t)};_mcp._TI.dY=function(n,t){n.l(t)};_mcp._TI.gp=function(n,t){n.n(t)};_mcp._TI.fB=function(n,t){n.b(t)};_mcp._TI.A=function(){_mcp._TI.cx||(_mcp._TI.cx=new _fc.m);return _mcp._TI.cx};_mcp._TI.d=function(){_mcp._TI.cu||(_mcp._TI.cu=new _fc.k);return _mcp._TI.cu};_mcp._TI.bW=function(){_mcp._TI.cA||(_mcp._TI.cA=new _n.t);return _mcp._TI.cA};_mcp._TI.cD=function(){_mcp._TI.cy||(_mcp._TI.cy=new _b.cs);return _mcp._TI.cy};_mcp._TI.fg=function(){_mcp._TI.cz||(_mcp._TI.cz=new _n.Y);return _mcp._TI.cz};_mcp._TI.bV=function(){_mcp._TI.cv||(_mcp._TI.cv=new _fce.s);return _mcp._TI.cv};_mcp._TI.ff=function(){_mcp._TI.cw||(_mcp._TI.cw=new _fce.F);return _mcp._TI.cw};_mcp._TI.fh=function(){_mcp._TI.cB||(_mcp._TI.cB=new _n.r);return _mcp._TI.cB};_mcp._TI.es=function(){_mcp._TI.cC||(_mcp._TI.cC=new _mcp.bD);return _mcp._TI.cC};MailComposeComponent.registerClass("MailComposeComponent",null,_a.ih);_mcp.H.registerClass("_mcp.H");_mcp.I.registerClass("_mcp.I");_mcp.u.registerClass("_mcp.u",_a.iX);_mcp.bf.registerClass("_mcp.bf",null,_h.ci,_h.fg);_mcp.E.registerClass("_mcp.E",_h.dj.$$(_gg.qG,_g.es));_mcp.bd.registerClass("_mcp.bd",_h.dX.$$(_gg.na));_mcp.be.registerClass("_mcp.be",_h.dX.$$(_gg.N),_a.fA);_mcp.C.registerClass("_mcp.C",null,IMailComposeActionFactory);_mcp.K.registerClass("_mcp.K",_mcp.C,IGroupInlineComposeActionFactory,IMailComposeActionFactory);_mcp.V.registerClass("_mcp.V",null,IMailComposeContextFactory);_mcp.X.registerClass("_mcp.X",null,IMailComposeViewModelFactory,_bc.bf);_mcp.Y.registerClass("_mcp.Y",_mcp.X,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bf);_mcp.S.registerClass("_mcp.S",_mcp.X,IGroupInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.bf);_mcp.U.registerClass("_mcp.U",_a.bx);_mcp.L.registerClass("_mcp.L",_js.u,_y.hk);_mcp.a.registerClass("_mcp.a",_a.iX,_g.lS,_y.eS,_bc.bl,IContext,_js.z,_g.ICalendarTimePeriod);_mcp.D.registerClass("_mcp.D",null,IMailComposeDiscardManager);_mcp.b.registerClass("_mcp.b",_a.dT);_mcp.d.registerClass("_mcp.d",_y.hO,_y.l,_y.A,_bc.u,_a.iT,_js.z,Sys.IDisposable,_y.du,_y.cE,_bc.j,_bc.p,_y.E,IMailComposeOverridable);_mcp.g.registerClass("_mcp.g",_mcp.d);_mcp.h.registerClass("_mcp.h",_mcp.d,IGroupInlineComposeViewModel,_y.l,_y.A,_bc.u,_a.iT,_js.z,Sys.IDisposable,_y.du,_y.cE,_bc.j,_bc.p);_mcp.i.registerClass("_mcp.i");_mcp.Z.registerClass("_mcp.Z",_a.bx,_y.hm);_mcp.ba.registerClass("_mcp.ba",null,IMailResponseViewModelFactory);_mcp.F.registerClass("_mcp.F",_a.bx);_mcp.N.registerClass("_mcp.N",_a.bx);_mcp.M.registerClass("_mcp.M");_mcp.O.registerClass("_mcp.O");_mcp.bJ.registerClass("_mcp.bJ");_mcp.bh.registerClass("_mcp.bh",_js.u,IMailComposeComponent,_js.z);_mcp.p.registerClass("_mcp.p",_mcp.bh,IMailComposeAttachmentComponent,IMailComposeComponent,_js.z,_y.gs,IMailComposeOverridable);_mcp.k.registerClass("_mcp.k",_mcp.bh,IMailComposeContextMenuProvider);_mcp.B.registerClass("_mcp.B",_mcp.k,IMailComposeSaveComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.bg.registerClass("_mcp.bg",_mcp.B,IMailComposeAutoSaveComponent,IMailComposeComponent,_js.z);_mcp.s.registerClass("_mcp.s",_mcp.bh,IMailComposeCommandingBarComponent,IMailComposeComponent,_js.z);_mcp.v.registerClass("_mcp.v",_mcp.k,IMailComposeComplianceComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.bj.registerClass("_mcp.bj");_mcp.bk.registerClass("_mcp.bk",_mcp.k,IMailComposeContentConversionComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.y.registerClass("_mcp.y",_mcp.bh,IMailComposeContextMenuComponent,IMailComposeComponent,_js.z);_mcp.bl.registerClass("_mcp.bl",_mcp.y,IMailComposeContextMenuComponent,IMailComposeComponent,_js.z);_mcp.x.registerClass("_mcp.x",_mcp.k,IMailComposeSendComponent,IMailComposeOverridable);_mcp.w.registerClass("_mcp.w",_mcp.x);_mcp.z.registerClass("_mcp.z",_mcp.bh,IMailComposeDiscardComponent,IMailComposeComponent,_js.z);_mcp.bm.registerClass("_mcp.bm",_mcp.bh,IMailComposeEditorComponent,IMailComposeComponent,_js.z);_mcp.bn.registerClass("_mcp.bn",_mcp.bm);_mcp.bp.registerClass("_mcp.bp",_mcp.k,IMailComposeImportanceComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.br.registerClass("_mcp.br",_mcp.bh,IMailComposeLinkPreviewComponent,IMailComposeComponent,_js.z);_mcp.J.registerClass("_mcp.J",_mcp.bh,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_js.z);_mcp.bq.registerClass("_mcp.bq",_mcp.bh,IMailComposeInitializerComponent,IMailComposeComponent,_js.z);_mcp.f.registerClass("_mcp.f",_mcp.bh,IMailComposeMeetingComponent,IMailComposeComponent,_js.z);_mcp.bt.registerClass("_mcp.bt",_mcp.k,IMailComposeMessageOptionsComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.r.registerClass("_mcp.r",_mcp.k,IMailComposeNavigationComponent);_mcp.bu.registerClass("_mcp.bu",_mcp.k,IMailComposeOmeComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.bv.registerClass("_mcp.bv",_mcp.bh,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_js.z);_mcp.bx.registerClass("_mcp.bx",_mcp.bh,IMailComposePhotoComponent,IMailComposeComponent,_js.z);_mcp.e.registerClass("_mcp.e",_mcp.k,_y.id,IMailComposeRecipientComponent,IMailComposeComponent,_js.z);_mcp.t.registerClass("_mcp.t",_js.u);_mcp.o.registerClass("_mcp.o",_mcp.bh,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_js.z);_mcp.bA.registerClass("_mcp.bA",_mcp.bh,IMailComposeSmimeComponent,IMailComposeComponent,_js.z);_mcp.bz.registerClass("_mcp.bz",_mcp.bh,IMailComposeShareAttachmentComponent,IMailComposeComponent,_js.z);_mcp.l.registerClass("_mcp.l",_mcp.k,IMailComposeSignatureComponent,IMailComposeComponent,_js.z,IMailComposeContextMenuProvider);_mcp.bB.registerClass("_mcp.bB",_mcp.bh,IMailComposeTouchComponent,IMailComposeComponent,_js.z);_mcp.bC.registerClass("_mcp.bC",_mcp.bh,IMailComposeUpgradeComponent,IMailComposeComponent,_js.z);_mcp.bs.registerClass("_mcp.bs",_mcp.bh,IMailComposeMailTipsComponent,IMailComposeComponent,_js.z);_mcp.bw.registerClass("_mcp.bw",_mcp.bh,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_js.z);_mcp.by.registerClass("_mcp.by",_mcp.bh,IMailComposePolicyTipsComponent,IMailComposeComponent,_js.z);_mcp.A.registerClass("_mcp.A",_mcp.bh,_y.gV,_y.gU,_y.gS,IMailComposeExtensibilityComponent,IMailComposeComponent,_js.z);_mcp.bo.registerClass("_mcp.bo",_mcp.bh,IMailComposeHashtagComponent,IMailComposeComponent,_js.z);_mcp.bD.registerClass("_mcp.bD",null,_js.T);_mcp.q.registerClass("_mcp.q",_js.c,_b.bT);_mcp.P.registerClass("_mcp.P",_js.b);_mcp.m.registerClass("_mcp.m",_js.b);_mcp.n.registerClass("_mcp.n",_js.b,_ff.n,_y.hW);_mcp.Q.registerClass("_mcp.Q",_js.b);_mcp.j.registerClass("_mcp.j",_mcp.n,_zz.bs);_mcp._TI.registerClass("_mcp._TI");MailComposeComponent.$$cctor();_mcp.a.bQ=new _H("ViewModelId",String,_mcp.a);_mcp.a.c=new _H("Operation",_y.n,_mcp.a);_mcp.a.j=new _H("Mode",_y.dC,_mcp.a);_mcp.a.bn=new _H("OriginalId",_g.g,_mcp.a);_mcp.a.bm=new _H("OriginalDocumentId",Number,_mcp.a);_mcp.a.bo=new _H("OriginalItem",_g.h,_mcp.a);_mcp.a.D=new _H("DraftId",_g.g,_mcp.a);_mcp.a.bK=new _H("StoreId",String,_mcp.a);_mcp.a.bL=new _H("Subject",String,_mcp.a,"");_mcp.a.by=new _H("SelectedDataCallContext",_h.dt,_mcp.a);_mcp.a.F=new _H("EditorCallContext",_h.dt,_mcp.a);_mcp.a.G=new _H("EditorContent",String,_mcp.a,"");_mcp.a.r=new _H("BodyType",String,_mcp.a);_mcp.a.m=new _H("ToRecipients",_js.w,_mcp.a);_mcp.a.l=new _H("SpeechResultRecipients",_js.w,_mcp.a);_mcp.a.bM=new _H("ToQueryString",String,_mcp.a);_mcp.a.g=new _H("CcRecipients",_js.w,_mcp.a);_mcp.a.s=new _H("CcQueryString",String,_mcp.a);_mcp.a.f=new _H("BccRecipients",_js.w,_mcp.a);_mcp.a.q=new _H("BccQueryString",String,_mcp.a);_mcp.a.k=new _H("AutoAddSignature",Boolean,_mcp.a,!0);_mcp.a.Q=new _H("Importance",String,_mcp.a,"Normal");_mcp.a.bv=new _H("QuotedBody",String,_mcp.a);_mcp.a.bD=new _H("SmimeContent",String,_mcp.a);_mcp.a.bF=new _H("SmimeErrorCode",Number,_mcp.a);_mcp.a.bG=new _H("SmimeRecipientCerts",Array,_mcp.a);_mcp.a.bH=new _H("SmimeSigningCert",String,_mcp.a);_mcp.a.n=new _H("AttachmentsToAdd",Array,_mcp.a);_mcp.a.V=new _H("IsComplete",Boolean,_mcp.a);_mcp.a.i=new _H("IsMeeting",Boolean,_mcp.a);_mcp.a.Z=new _H("IsMeetingForward",Boolean,_mcp.a);_mcp.a.bh=new _H("IsReplyAllOnBcc",Boolean,_mcp.a);_mcp.a.bl=new _H("Location",_g.w,_mcp.a);_mcp.a.M=new _H("HasLocation",Boolean,_mcp.a);_mcp.a.bw=new _H("Recurrence",_g.bi,_mcp.a);_mcp.a.bg=new _H("IsRecurringMaster",Boolean,_mcp.a);_mcp.a.bJ=new _H("Start",_a.c,_mcp.a);_mcp.a.H=new _H("End",_a.c,_mcp.a);_mcp.a.ca=new _H("IsAllDayEventProperty",Boolean,_mcp.a);_mcp.a.J=new _H("From",_g.bg,_mcp.a);_mcp.a.bz=new _H("Sender",_g.bg,_mcp.a);_mcp.a.bk=new _H("IsUpgraded",Boolean,_mcp.a);_mcp.a.X=new _H("IsFromShown",Boolean,_mcp.a);_mcp.a.T=new _H("IsCcShown",Boolean,_mcp.a);_mcp.a.S=new _H("IsBccShown",Boolean,_mcp.a);_mcp.a.br=new _H("ParentFolderNameToPost",String,_mcp.a);_mcp.a.bq=new _H("ParentFolderIdToPost",_g.n,_mcp.a);_mcp.a.e=new _H("AttachmentCollection",_js.f,_mcp.a);_mcp.a.o=new _H("AttachmentsToHide",Array,_mcp.a);_mcp.a.bP=new _H("UpgradeFailed",Boolean,_mcp.a);_mcp.a.p=new _H("Baseline",_mcp.b,_mcp.a);_mcp.a.L=new _H("HasBeenSavedByUser",Boolean,_mcp.a);_mcp.a.bN=new _H("UnpromotedEmojiCountProperty",Number,_mcp.a);_mcp.a.bO=new _H("UnpromotedInlineImageCountProperty",Number,_mcp.a);_mcp.a.bi=new _H("IsReplyForward",Boolean,_mcp.a);_mcp.a.E=new _H("Draft",_g.h,_mcp.a);_mcp.a.K=new _H("GroupEmailAddress",_g.d,_mcp.a);_mcp.a.bx=new _H("RightsManagementLicenseData",_g.cO,_mcp.a);_mcp.a.x=new _H("ComplianceId",String,_mcp.a);_mcp.a.U=new _H("IsClassified",Boolean,_mcp.a);_mcp.a.u=new _H("ClassificationGuid",String,_mcp.a);_mcp.a.w=new _H("Classification",String,_mcp.a);_mcp.a.t=new _H("ClassificationDescription",String,_mcp.a);_mcp.a.v=new _H("ClassificationKeep",Boolean,_mcp.a);_mcp.a.bB=new _H("Sensitivity",String,_mcp.a,"Normal");_mcp.a.W=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.a);_mcp.a.bf=new _H("IsReadReceiptRequested",Boolean,_mcp.a);_mcp.a.bE=new _H("SmimeEncryptMessage",Boolean,_mcp.a);_mcp.a.bI=new _H("SmimeSignMessage",Boolean,_mcp.a);_mcp.a.y=new _H("ConversationId",_g.g,_mcp.a);_mcp.a.bp=new _H("ParentConversationNodeId",String,_mcp.a);_mcp.a.bd=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.a);_mcp.a.bb=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.a);_mcp.a.be=new _H("IsPoppedOutFromReadingPane",Boolean,_mcp.a);_mcp.a.Y=new _H("IsLoadedDraft",Boolean,_mcp.a);_mcp.a.bR=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.a);_mcp.a.O=new _H("HideIncludeEntrypoint",Boolean,_mcp.a,!1);_mcp.a.bS=new _H("WasSavingBeforePopout",Boolean,_mcp.a,!1);_mcp.a.ba=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.a,!1);_mcp.a.bt=new _H("PerfContext",_a.bL,_mcp.a,null);_mcp.a.bs=new _H("PerfContextE2E",_a.bL,_mcp.a,null);_mcp.a.bT=new _H("WaterfallTraceStarted",Boolean,_mcp.a,null);_mcp.a.bZ=new _H("RichTextEditorSupported",Boolean,_mcp.a,null);_mcp.a.P=new _H("HtmlSupportedProperty",Boolean,_mcp.a,null);_mcp.a.C=new _H("DlpSenderOverride",String,_mcp.a,null);_mcp.a.B=new _H("DlpFalsePositive",String,_mcp.a,null);_mcp.a.A=new _H("DlpDetectedClassification",String,_mcp.a,null);_mcp.a.I=new _H("ExplicitLogonUser",String,_mcp.a,null);_mcp.a.R=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.a,!1);_mcp.a.h=new _H("ExtendedPropertyCollection",_js.f,_mcp.a,null);_mcp.a.bc=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.a,!1);_mcp.a.bj=new _H("IsResumingSendFailure",Boolean,_mcp.a,!1);_mcp.a.N=new _H("HasSentViaNotification",Boolean,_mcp.a,!1);_mcp.a.bA=new _H("SendFailureInfobarMessageId",_bc.x,_mcp.a,45);_mcp.a.bC=new _H("SentFromMailComposeInlineReply",Boolean,_mcp.a);_mcp.a.bu=new _H("PopoutPerfContext",_a.bL,_mcp.a);_mcp.a.z=new _H("DiagnosticContent",String,_mcp.a);_mcp.a.d="UseOverride";_mcp.a.bY=new RegExp("(\r)?\n","gi");_mcp.a.a=null;_mcp.a.$$cctor();_mcp.b.u=new _H("Subject",String,_mcp.b,"");_mcp.b.m=new _H("EditorContent",String,_mcp.b,"");_mcp.b.h=new _H("ToRecipients",_js.f,_mcp.b);_mcp.b.v=new _H("ToQueryString",String,_mcp.b);_mcp.b.e=new _H("CcRecipients",_js.f,_mcp.b);_mcp.b.k=new _H("CcQueryString",String,_mcp.b);_mcp.b.d=new _H("BccRecipients",_js.f,_mcp.b);_mcp.b.j=new _H("BccQueryString",String,_mcp.b);_mcp.b.o=new _H("Importance",String,_mcp.b,"Normal");_mcp.b.n=new _H("From",_g.d,_mcp.b);_mcp.b.l=new _H("ComplianceId",String,_mcp.b);_mcp.b.r=new _H("Sensitivity",String,_mcp.b,"Normal");_mcp.b.p=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.q=new _H("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.s=new _H("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.t=new _H("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.c=new _H("AttachmentCollection",_js.f,_mcp.b);_mcp.b.g=new _H("ExtendedPropertyCollection",_js.f,_mcp.b,null);_mcp.b.f=new _a.bs(_g.d);_mcp.b.$$cctor();_mcp.i.a=_a.a.a;_mcp.Z.a=_a.a.a;_mcp.p.a=new _H("AttachmentWellViewModel",_y.y,_mcp.p);_mcp.s.a=_a.a.eq;_mcp.v.a=new _y.h(_u.P.b,null,null);_mcp.y.a=new _H("Menu",_fm.f,_mcp.y);_mcp.w.a=[0,5,10,15,30];_mcp.J.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.f.c=new _H("FromDetailsViewModel",_bc.v,_mcp.f);_mcp.f.d=new _H("SenderDetailsViewModel",_bc.v,_mcp.f);_mcp.f.b=null;_mcp.f.a=null;_mcp.r.b=[84,85,86,87];_mcp.t.b=7;_mcp.t.a=1;_mcp.B.a=[60,40,43,1001,700,50,800,88,89];_mcp.o.b=10;_mcp.o.c=new _H("Menu",_fm.f,_mcp.o);_mcp.x.a=[62,45,46,47,700,55,70,65,97,66,75,800,88,80,48,89,90,91,92,93,94,98,99,100];_mcp.l.f="<P><BR></P>";_mcp.l.e=new RegExp("[\n\r]+","g");_mcp.l.c=new RegExp("(<img )([^>]*src=[\"']?data:image/[^<]+;base64,[a-zA-Z0-9+/=&#;]+[\"']?)([^>]*>)","gi");_mcp.l.b=new RegExp("(<[aA] [^>]*>)","gi");_mcp.l.d="EmojiInsert";_mcp._TI._hf=_mcp._TI.fi();_mcp._TI.cx=null;_mcp._TI.cu=null;_mcp._TI.cA=null;_mcp._TI.cy=null;_mcp._TI.cz=null;_mcp._TI.cv=null;_mcp._TI.cw=null;_mcp._TI.cB=null;_mcp._TI.cC=null;_mcp._TI.a={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
