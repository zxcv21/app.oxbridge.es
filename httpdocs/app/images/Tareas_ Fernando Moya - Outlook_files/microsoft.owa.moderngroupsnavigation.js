try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime();
Type.registerNamespace("_mgn");_mgn.r=function(){};_mgn.r.registerInterface("_mgn.r");_mgn.t=function(){};_mgn.t.prototype={none:0,groupHeader:1,groupReadCard:2,groupMemberList:3};_mgn.t.registerEnum("_mgn.t",!1);_mgn.u=function(n,t,i){_a.b.a(t,"sessionSettings");_a.b.a(n,"actionSubmitter");_a.b.a(i,"featureManager");this.a=n;this.f=t;this.c=i};_mgn.u.prototype={a:null,f:null,c:null,d:null,b:null,BeginGetGroup:function(n,t,i){this.b=_a.d.b(_a.a.n,"GetModernGroup",!0);_mgn.a.a(this.c)?this.k(n,t,i):this.i(n,t,i)},BeginGetGroups:function(n,t,i){this.d=_a.d.b(_a.a.n,"GetModernGroups",!0);_mgn.a.a(this.c)?this.l(n,t,i):this.j(n,t)},BeginGetHomeGroup:function(n,t){n(_g.P.a(this.f.bh.UserDisplayName,this.f.bh.UserEmailAddress))},BeginGetGroupUnseenData:function(n,t,i,r){var u=new _mgn.w(n,t);var e=this;u.w(function(){i(u.d)});var f=this;u.v(function(){r(u.t)});this.a.a(u)},BeginGetUnifiedGroupUnseenCount:function(n,t,i,r,u){var f=new _mgn.x(n,t,i);var o=this;f.w(function(){r(f.c)});var e=this;f.v(function(){u(f.t)});this.a.a(f)},l:function(n,t,i){var r=new _mgn.i(i,null,_mgn.a.b(this.c));var f=this;r.w(function(t){var e=t;var i=e.b;var u=e.e;n(i,u,null,!0);f.e(!0,null,r.C(),i?i.length:0,u?u.length:0)});var u=this;r.v(function(){t(r.t);u.e(!1,r.D(),r.C(),0,0)});this.a.b(r)},j:function(n,t){var i=new _mgn.v;var u=this;i.w(function(t){var r=t;var e=r.c;var f=r.d;var o=r.e;n(e,f,o,r.b);u.e(!0,null,i.C(),e?e.length:0,f?f.length:0)});var r=this;i.v(function(){t(i.t);r.e(!1,i.D(),i.C(),0,0)});this.a.b(i)},e:function(n,t,i,r,u){var e=null;var o=null;var s=null;if(n){if(r||u){var f=new _a.q;f.a("jgc",r);f.a("pgc",u);f.a("npvo",_g.a.a().a().P());f.c("npep",_g.a.a().a().bh.MailFolderPaneExpanded);o=f.toString()}}else s=t?t:"Failed";if(this.d){e=this.d;e.k=s;e.j=o;e.l=i;_a.d.a(e);this.d=null}},k:function(n,t,i){var r=new _mgn.h(n,0);var f=this;r.w(function(i){var r=i.b;var u=_g.P.a(r.DisplayName,r.SmtpAddress,r.UserGroupRelationship.IsMember,_mgn.l.a(r.AccessType));f.h(u,t,i.C(),n)});var u=this;r.v(function(t){u.g(i,t.t,t.C(),n)});this.a.b(r)},i:function(n,t,i){var r=new _mgn.g(n,1,0);var f=this;r.w(function(i){var r=i.A.Body.GeneralInfo;var u=_g.P.a(r.Name,r.SmtpAddress,r.IsMember,r.ModernGroupType);f.h(u,t,i.C(),n)});var u=this;r.v(function(t){u.g(i,t.t,t.C(),n)});this.a.b(r)},h:function(n,t,i,r){n.k(!1);n.unseenData=_g.dk.a();t(n);if(this.b){var u=this.b;u.l=i;u.o=r;_a.d.a(u);this.b=null}},g:function(n,t,i,r){n(t);if(this.b){var u=this.b;u.k=t?t.name.toString():"Failed";u.l=i;u.o=r;_a.d.a(u);this.b=null}}};_mgn.G=function(n,t){this.h=t||"";this.c=n||""};_mgn.G.prototype={c:null,h:null,f:function(){return _g.P.c(this.c)}};_mgn.d=function(n,t,i,r,u){_mgn.d.initializeBase(this,[n,t]);this.a=i;this.b=$a(r)?0:r;this.d=$a(u)?0:u};_mgn.d.prototype={a:0,b:0,d:0};_mgn.a=function(n,t,i,r,u,f,e,o,s,h){this.E=Function.createDelegate(this,this.Q);this.F=Function.createDelegate(this,this.R);this.G=Function.createDelegate(this,this.S);this.H=Function.createDelegate(this,this.T);this.I=Function.createDelegate(this,this.V);this.C=Function.createDelegate(this,this.N);this.D=Function.createDelegate(this,this.O);this.A=Function.createDelegate(this,this.M);_mgn.a.initializeBase(this);this.j=n;this.w=t;this.z=i;this.o=r;this.p=u;this.h=f;this.t=e;this.u=o;this.y=s;this.l=h;this.P();_mgn.a.a(this.l)&&this.U();this.h.b(_mgn.d,this.A);this.h.b(_y.bj,this.D);this.h.b(_mgn.n,this.C)};_mgn.a.a=function(n){return!!n&&!!n.a()&&!!n.a().m()&&n.a().m().Enabled};_mgn.a.d=function(n){return _mgn.a.a(n)&&!!n.a().bJ()&&n.a().bJ().Enabled};_mgn.a.e=function(n){return _mgn.a.d(n)&&!!n.a().bI()&&n.a().bI().Enabled};_mgn.a.b=function(n){return _mgn.a.a(n)&&!!n.a().bC()&&n.a().bC().Enabled};_mgn.a.c=function(){_a.l.a("ConversationDeepLink")};_mgn.a.prototype={t:null,o:null,h:null,w:null,z:null,j:null,p:null,u:null,y:null,l:null,g:null,i:null,m:null,q:!1,r:!1,n:null,d:function(n){this.bt("SelectedModernGroupChanged",n)},c:function(n){this.bt("ChangeCurrentModule",n)},a:function(){return this.i},J:function(n){if(this.i!==n){var t=!this.i||!n;this.i=n;if(this.r)return n;t?this.bX("ChangeCurrentModule",0):this.L()}return n},b:function(){return!!this.i},f:function(){return this.g},L:function(){this.bP("SelectedModernGroupChanged",this,null)},e:function(n){if(this.n){this.n(n);this.n=null;return}},P:function(){this.g=new _mgn.b(this.w,this.z,this.o,this.u,this.y,this.l);this.g.bv(this.I);this.g.bH(this.H);this.g.bF(this.G);this.g.bE(this.F);this.g.bG(this.E)},U:function(){var t=_a.d.b(_a.a.n,"GetUnifiedGroupsSettings",!0);var n=new _mgn.m;var i=this;n.w(function(n){var r=n;i.g.bC(!r.b);_a.d.a(t)});var r=this;n.v(function(n){t.k=n.D();_a.d.a(t)});this.j.a(n)},V:function(n){this.x();n&&n.k!==1?this.J(n.j):this.J(null)},S:function(n){_js.j.a(n,"group");this.K(n.bh.SmtpAddress,!0)},T:function(n){_js.j.a(n,"group");this.K(n.bh.SmtpAddress,!1)},K:function(n,t){if(_mgn.a.a(this.l)){var r=new _mgn.z(n,t);this.j.a(r)}else{var i=new _mgn.y(n,t);this.j.a(i)}},R:function(){if(!this.q){this.x();if(this.m)this.m.e();else{this.q=!0;var n=this;this.t.a(function(t){n.m=t;n.m.e();n.q=!1})}}},Q:function(){this.x();var n=this;this.k(function(){n.g.G(n.g.V)});var t=this;this.h.a(_y.v,new _y.v(2,function(){t.h.a(_y.ci,new _y.ci)},!0,!0,!0,!1,!0))},M:function(n){switch(n.a){case 2:this.g.bf(this.v(n,!0));break;case 3:var r=this;this.k(function(){r.g.bp(n.c)});break;case 9:this.g.bp(n.c);this.p.a(_a.X.a(0));this.i=null;break;case 1:var t=this;this.k(function(){t.g.bf(t.v(n,!0));t.g.bi(n.c);t.p.a(_a.X.b(n.c,0))});break;case 4:this.g.bR(n.c);break;case 5:var i=this;this.k(function(){var t=$a(n.b)?0:n.b;i.g.bq(i.v(n,!1));i.p.a(_a.X.b(n.c,t))});break}},v:function(n,t){return _g.P.a(n.h,n.c,t,n.d)},x:function(){this.o.a()!=="Mouse"&&this.h.a(_y.cg,new _y.cg(!1))},O:function(n){if(this.o.a()==="Mouse")n.d&&this.g.bi(n.a);else{var t=this;this.k(function(){t.n=n.g;t.g.bq(_g.P.e(n.a));t.bX("ChangeCurrentModule",n.b)})}},N:function(n){n.a&&_a.l.b(_a.a.n,"ConversationDeepLink",!0);if(this.g&&this.g.A&&this.g.A.j.bh.SmtpAddress===n.b)this.h.a(_mgn.j,new _mgn.j(n.a,n.c));else{var i=this;var t=function(){i.h.a(_y.bj,new _y.bj(0,n.b,null,n.a,n.c))};this.h.a(_y.v,new _y.v(0,t,!1,!0,!0,!0,!1))}},k:function(n){try{this.r=!0;n()}finally{this.r=!1}}};function ModernGroupsNavigationComponent(){}ModernGroupsNavigationComponent.$$cctor=function(){_a.r.a().a(ModernGroupsNavigationComponent)};ModernGroupsNavigationComponent.prototype={a:function(n,t,i){var e=this;n.b(_mgn.r,function(){return new _mgn.u(n.a(_h.df),n.a(_g.bd),n.a(_a.f))}).a();var o=this;n.b(_mgn.s,function(){return new _mgn.C(n.a(_g.bd),n.a(_y.a),n.a(_a.f))}).a();var s=this;n.b(_mgn.a,function(){return new _mgn.a(n.a(_a.s),n.a(_mgn.r),n.a(_mgn.s),n.a(_y.a),n.a(_a.bb),n.a(_ff.c),n.c(IModernGroupCardFacade),n.a(_pe.h),n.a(IInferenceTracker),n.a(_a.f))}).a();var r=this;n.b(IModernGroupsNavigationFactory,function(){return n.a(_mgn.a)}).a();var u=this;n.b(_mgn.e,function(){return new _mgn.e(n.a(IModernGroupsNavigationFactory),n.a(ICalendars))}).b(IModernGroupCalendarsProvider).a();var f=this;n.b(_mgn.b,function(){var t=n.a(_mgn.a);return t.g}).b(_y.cF)},b:function(){return[]}};_mgn.n=function(n,t,i){this.b=n;this.a=t;this.c=i};_mgn.n.prototype={b:null,a:null,c:null};_mgn.j=function(n,t){this.a=n;this.b=t};_mgn.j.prototype={a:null,b:null};_mgn.e=function(n,t){this.t=Function.createDelegate(this,this.K);this.o=Function.createDelegate(this,this.H);this.p=Function.createDelegate(this,this.I);this.q=Function.createDelegate(this,this.J);_mgn.e.initializeBase(this);this.n=t;this.i=n.g;this.G(_u.R.aU,_u.R.Wm,_u.R.In,_u.R.ce);this.R.n([this.y(),this.w(),this.z()]);if(this.i.E){this.E();this.bl(!0)}else{var r=null;var i=this;r=function(n,t){if(i.i.c()){i.i.h("IsReady",r);i.E()}i.bl(!0)};this.i.d("IsReady",r)}};_mgn.e.a=function(n,t,i,r,u){for(var e,f=0;f<n.y.length;f++){var o=i(n.y[f]);for(e=f;e<t.y.length;e++)if(o===r(t.y[e])){f!==e&&t.w(e,f,t.y[e]);break}u&&e>=t.y.length&&u(f,n.y[f])}};_mgn.e.prototype={n:null,i:null,a:function(){return this.i},k:null,b:function(){return this.k},j:null,c:function(){return this.j},l:null,d:function(){return this.l},u:null,e:function(){return this.u},f:function(n){return n.a()==="CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2"||n.a()==="6151B1C8-E005-4366-B4E2-2DBED40129CA"||n.a()==="78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF"||n.a()==="51978C8F-D6FE-48C6-9ADE-BBE39E935963"},y:function(){return this.k.b()},w:function(){return this.j.b()},z:function(){return this.l.b()},G:function(n,t,i,r){var e=_cc.j.a(n,"CA77EDED-A62C-4D6F-B4C6-55449CBDA8C2");this.u=e;var o=_cc.j.a(t,"6151B1C8-E005-4366-B4E2-2DBED40129CA");this.k=o;var u=_cc.j.a(i,"78A5C2BE-C0BF-438B-9AF7-9C7EFA4340AF");this.j=u;var f=_cc.j.a(r,"51978C8F-D6FE-48C6-9ADE-BBE39E935963");this.l=f},g:function(n){this.i.q(n)},h:function(n){this.i.v(n)},ed:function(){this.D();this.i.h("GroupsMoveInProgress",this.q);_a.iX.prototype.ed.call(this)},E:function(){this.m(this.k,0,this.i.y.f());this.m(this.j,0,this.i.x.f());this.m(this.l,0,this.i.z.f());this.C();this.i.d("GroupsMoveInProgress",this.q)},J:function(n,t){if(this.i.n())this.D();else{this.C();this.L()}},L:function(){var f=this;var n=function(n){return n.a()};var e=this;var t=function(n){return n.bh.ItemId.Id};var r=this;_mgn.e.a(this.i.y,this.y(),n,t,function(i,u){r.F(u,[r.w()],r.k,i,t,n)});var i=this;_mgn.e.a(this.i.x,this.w(),n,t,function(r,u){i.F(u,[i.y(),i.z()],i.j,r,t,n)});var u=this;_mgn.e.a(this.i.z,this.z(),n,t,function(n,t){u.m(u.l,n,[t])});this.v(this.k,this.i.y.y.length);this.v(this.j,this.i.x.y.length);this.v(this.l,this.i.z.y.length)},v:function(n,t){for(var i=t,r=n.b().y.length;i<r;i++)this.n.q(n.b().y[i],n)},F:function(n,t,i,r,u,f){for(var o,e,h=0,c=t.length;h<c;h++){e=t[h];var l=this;o=e.j(n,function(n,t){return f(n)===u(t)});if(o>=0){var s=e.y[o];e.z(o,s);i.b().E(r,s,s);return}}this.m(i,r,[n])},C:function(){this.i.y.d(this.p);this.i.x.d(this.o);this.i.z.d(this.t)},D:function(){this.i.y.e(this.p);this.i.x.e(this.o);this.i.z.e(this.t)},I:function(n,t){this.A(this.k,t)},H:function(n,t){this.A(this.j,t)},K:function(n,t){this.A(this.l,t)},A:function(n,t){switch(t.c){case 0:this.m(n,t.d,t.a);break;case 2:for(var i=0,u=t.b.length;i<u;i++){var r=n.b().y[t.d];this.n.q(r,n)}break;default:break}},m:function(n,t,i){for(var u,r=0,e=i.length;r<e;r++){u=i[r];var f=_g.s.a(u.j.bh.DisplayName,u.a(),!0,!1);this.n.I(f,n,t+r)}}};_mgn.q=function(){};_mgn.q.prototype={a:function(n,t){var i=n;return i>0?i>99?_u.R.PR:i.toString():""},b:function(n,t){throw Error.notImplemented();}};_mgn.l=function(){};_mgn.l.a=function(n){switch(n){case 1:return 1;case 3:return 3;case 2:return 2}return 0};_mgn.x=function(n,t,i){_mgn.x.initializeBase(this,[n]);_a.b.a(t,"lastVisitedTimeUtc");_a.b.c(i,"actionName");this.d=t;this.b=i};_mgn.x.prototype={d:null,c:0,b:null,u:function(n){var t=new _gg.xo(this.x);t.explicitLogonUser=this.i.Value;t.actionName=this.b;var i=new _gg.jD(this.y(),new _gg.jE(this.i,this.d.j()));n.cl(i,t,this.r,this.q)},cy:function(n,t,i){var r=n;r.Body&&r.Body.ResponseCode==="NoError"||i(Error.create("GetUnifiedGroupUnseenCountAction: group unseen count not be retrieved."));this.c=r.Body.UnseenCount;t()}};_mgn.h=function(n,t){_mgn.h.initializeBase(this,[n]);this.c=t};_mgn.h.prototype={c:0,b:null,d:function(){var n="GetUnifiedGroupDetailsAction-GI";_mgn.c.a().b(this.i.Value)&&(n=n+"-"+"NewGroup");_mgn.c.a().c(this.i.Value)&&(n=n+"-"+"Rip");return n},u:function(n){var t=new _gg.xb(this.x);t.explicitLogonUser=this.i.Value;t.actionName=this.d();var i=new _gg.jx(this.y(),new _gg.jy(this.i));i.Body.ResponseShape=this.c;n.ci(i,t,this.r,this.q)},cy:function(n,t,i){var r=n;r.Body&&r.Body.ResponseCode==="NoError"&&r.Body.GroupDetails||i(Error.create("GetUnifiedGroupDetailsAction: group details could not be retrieved."));this.b=r.Body.GroupDetails;t()}};_mgn.i=function(n,t,i){_mgn.i.initializeBase(this);this.d=n;this.c=t;this.f=i};_mgn.i.prototype={d:0,c:null,f:!1,b:null,e:null,u:function(n){var e=new _gg.xH(this.x);e.actionName=_mgn.i.a;var o=new _gg.jG(this.y());o.Body=new _gg.fd;if(_js.d.b(this.c))e.actionName+=":AU";else{o.Body.UserSmtpAddress=this.c;e.actionName+=":SU"}var t=null;switch(this.d){case 1:var s=new _gg.bB;s.FilterType=1;s.SortType=3;s.SortDirection="Descending";var f=new _gg.bB;f.FilterType=2;f.SortType=2;f.SortDirection="Descending";t=[s,f];break;case 2:var i=new _gg.bB;i.FilterType=0;i.SortType=4;i.SortDirection="Descending";t=[i];break;case 3:var u=new _gg.bB;u.FilterType=1;u.SortType=4;u.SortDirection="Descending";var r=new _gg.bB;r.FilterType=2;r.SortType=4;r.SortDirection="Descending";t=[u,r];break}t&&(o.Body.RequestedGroupsSets=t);n.cm(o,e,this.r,this.q)},cy:function(n,t,i){n.Body&&n.Body.GroupsSets&&n.Body.GroupsSets.length||i(Error.create("GetUserUnifiedGroupsAction: groups could not be retrieved."));for(var f=n.Body.GroupsSets,e=f.length,r=0;r<e;++r){var u=f[r];switch(u.FilterType){case 1:this.e=this.g(u.Groups);break;case 2:default:this.b=this.g(u.Groups);break}}t()},g:function(n){if(!n)return new Array(0);for(var i=new Array(n.length),t=0;t<n.length;t++){i[t]=_g.P.a(n[t].DisplayName,n[t].SmtpAddress,!0,_mgn.l.a(n[t].AccessType));i[t].k(n[t].IsFavorite);if(this.f&&n[t].LastVisitedTimeUtc){i[t].unseenData=_g.dk.a();i[t].unseenData.c(_a.c.b(n[t].LastVisitedTimeUtc))}}return i}};_mgn.c=function(){this.d={};this.a={}};_mgn.c.a=function(){_mgn.c.b||(_mgn.c.b=new _mgn.c);return _mgn.c.b};_mgn.c.c=function(n,t,i){n=n.toLowerCase();if(n in t){if(i(n,t)){delete t[n];return!1}return!0}return!1};_mgn.c.d=function(n,t){var i=_a.c.get_utcNow().g(t[n.toLowerCase()]);return i>9e5};_mgn.c.prototype={d:null,a:null,b:function(n){return _mgn.c.c(n,this.d,_mgn.c.d)},c:function(n){return _mgn.c.c(n,this.a,_mgn.c.d)},e:function(n){this.d[n.toLowerCase()]=_a.c.get_utcNow();var t=this;_mgn.c.c(n,this.a,function(n,t){return!0})},f:function(n){this.a[n.toLowerCase()]=_a.c.get_utcNow()}};_mgn.z=function(n,t){_mgn.z.initializeBase(this,[n]);this.c=t};_mgn.z.prototype={c:!1,b:null,d:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},u:function(n){var t=new _gg.DL(this.x);t.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.b=_a.d.b(_a.a.n,this.d(),!0);var i=new _gg.lF(this.y(),new _gg.lG(this.i,this.c));n.cO(i,t,this.r,this.q)},cy:function(n,t,i){t();if(this.b){var r=this.b;r.l=this.C();r.o=this.i.Value;_a.d.a(r);this.b=null}},Q:function(n){var i=OwaApplication.j().a(n);_js.d.a(i)&&(i="Failed");_h.dX.prototype.Q.call(this,n);if(this.b){var t=this.b;t.k=n.name.toString();t.m=i;t.l=this.C();t.o=this.i.Value;_a.d.a(t);this.b=null}}};_mgn.E=function(n,t){_mgn.E.initializeBase(this);_a.b.c(n,"groupIdentity");this.i=new _gg.dr;this.i.Type=0;$a(t)||(this.i.Type=t);this.i.Value=n};_mgn.E.prototype={i:null};_mgn.g=function(n,t,i){_mgn.g.initializeBase(this);_mgn.g.b(n);this.l=n;this.j=t;this.n=i};_mgn.g.b=function(n){if(!n)throw Error.argumentUndefined("smtpAddress","smtpAddress must be specified");};_mgn.g.prototype={l:null,j:0,n:0,R:function(){var n="GetModernGroup";(this.j&1)==1&&(n=n+"-"+_mgn.g.a);(this.j&2)==2&&(n=n+"-"+"ME");(this.j&4)==4&&(n=n+"-"+"OW");(this.j&8)==8&&(n=n+"-"+"ER");_mgn.c.a().b(this.l)&&(n=n+"-"+"NewGroup");return n},u:function(n){var t=new _gg.vv(this.x);t.explicitLogonUser=this.l;t.actionName=this.R();var r=this.m();var i=new _gg.eS(this.y(),r);n.bR(i,t,this.r,this.q)},cy:function(n,t,i){n.Body.GeneralInfo||n.Body.MembersInfo||n.Body.OwnerList||n.Body.ExternalResources||_js.Trace.logWarning(_a.a.C,"Modern group response is missing general info, members info, external resources, and owner list. RequestedResultSet= {0}",this.j);try{this.o(n,t)}catch(r){i(r)}},m:function(){var n=new _gg.iN(this.l,this.j);n.MembersPageRequest=new _g.T("Beginning");n.MembersPageRequest.Offset=0;n.MembersPageRequest.MaxEntriesReturned=100;n.MemberSortOrder=this.n;return n},o:function(n,t){t()}};_mgn.v=function(){_mgn.v.initializeBase(this)};_mgn.v.prototype={c:null,d:null,e:null,b:!1,u:function(n){var t=new _gg.vA(this.x);n.bS(t,this.r,this.q)},cy:function(n,t,i){this.c=_g.P.d(n.Body.JoinedGroups);this.d=_g.P.d(n.Body.PinnedGroups);this.e=_g.P.d(n.Body.RecommendedGroups,!0);this.b=$a(n.Body.IsModernGroupsAddressListPresent)?!0:n.Body.IsModernGroupsAddressListPresent;t()}};_mgn.w=function(n,t){_mgn.w.initializeBase(this);_a.b.c(n,"groupMailbox");this.c=n;this.b=t};_mgn.w.prototype={c:null,d:null,b:null,u:function(n){var t=new _gg.vD(this.x);t.explicitLogonUser=this.c;t.actionName=this.b;var i=new _gg.iO(this.y());i.Body=new _gg.eT;n.bT(i,t,this.r,this.q)},cy:function(n,t,i){try{this.d=n.Body.UnseenData;t()}catch(r){i(r)}}};_mgn.m=function(){_mgn.m.initializeBase(this)};_mgn.m.prototype={b:!1,u:function(n){var t=new _gg.xl(this.x);t.actionName=_mgn.m.a;n.ck(new _gg.jB(this.y()),t,this.r,this.q)},cy:function(n,t,i){var r=n;if(!r||!r.Body){i(Error.create("Unified group settings could not be retrieved"));return}this.b=r.Body.IsUnifiedGroupsAddressListPresent;t()}};_mgn.D=function(){_mgn.D.initializeBase(this)};_mgn.D.prototype={Group:null,IsMember:null,IsPinned:null,LastVisitedDate:null};_mgn.y=function(n,t){_mgn.y.initializeBase(this);_a.b.c(n,"smtpAddress");this.d=n;this.c=t};_mgn.y.prototype={d:null,c:!1,b:null,e:function(){return this.c?"PinModernGroup":"UnpinModernGroup"},u:function(n){var t=new _gg.Dq(this.x);t.actionName=this.c?"PinGroupAction":"UnpinGroupAction";this.b=_a.d.b(_a.a.n,this.e(),!0);n.cL(this.d,this.c,t,this.r,this.q)},cy:function(n,t,i){t();if(this.b){var r=this.b;r.l=this.C();r.o=this.d;_a.d.a(r);this.b=null}},Q:function(n){var i=OwaApplication.j().a(n);_js.d.a(i)&&(i="Failed");_h.dX.prototype.Q.call(this,n);if(this.b){var t=this.b;t.k=n.name.toString();t.m=i;t.l=this.C();t.o=this.d;_a.d.a(t);this.b=null}}};_mgn.F=function(){_mgn.F.initializeBase(this)};_mgn.F.prototype={UnseenData:null};_mgn.H=function(){};_mgn.H.registerInterface("_mgn.H");_mgn.I=function(){};_mgn.I.registerInterface("_mgn.I");_mgn.J=function(){};_mgn.J.registerInterface("_mgn.J");_mgn.s=function(){};_mgn.s.registerInterface("_mgn.s");_mgn.A=function(){};_mgn.A.prototype={e:0,b:null,a:function(){return"Exchange:GroupAssociation"},c:null,d:null,f:null};_mgn.B=function(){};_mgn.B.prototype={d:null,c:0,a:function(){return"Exchange:GroupUnseenItem"},b:null};_mgn.C=function(n,t,i){this.e=_a.I.a();_a.b.a(n,"sessionSettings");this.g=n;this.f=t;this.d=i};_mgn.C.prototype={g:null,f:null,d:null,b:function(){return!!this.d&&this.d.a().cI().Enabled},h:function(){return _mgn.a.b(this.d)},a:function(n,t){var i=null;if(Array.contains(n,"Exchange:GroupUnseenItem")){var u=t;i=this.j(u.i());var f=this;i.l(_a.a.x,"UnseenItemNotification",function(n){var i=n;var t=new _mgn.B;t.d=i.UnseenData;t.c=i.EventType;t.b=i.reason;u.l(t)},0)}else if(Array.contains(n,"Exchange:GroupAssociation")){var e=new _g.bc;i=this.i();var r=this;i.l(_a.a.x,"GroupAssociationNotification",function(n){var u=n;if(u.Group){var i=new _mgn.A;i.b=u.Group;i.e=u.EventType;if(r.b()){i.c=u.IsMember;i.d=u.IsPinned;r.h()&&(i.f=_a.c.b(u.LastVisitedDate))}t.l(i)}},0)}if(i){this.e.b(i.m,i);return i.m}return""},i:function(){var n=new _g.bc;n.NotificationType="GroupAssociationNotification";n.ChannelId=_a.V.a;return new _h.K(n)},j:function(n){var t=new _g.bc;t.ChannelId=_a.V.a;var i;if(this.b()){t.NotificationType=this.h()?"UnseenCountNotification":"UnseenItemNotification";t.MailboxId=n;i=new _h.K(t)}else{t.NotificationType="UnseenItemNotification";var r=this.f.a()==="TouchNarrow"||this.f.a()==="TouchWide";i=new _h.bD(t,null,null,n,this.g.bh.LogonEmailAddress,r)}return i},c:function(n){if(this.e.c(n)){this.e.a[n].t();this.e.e(n)}}};_mgn.b=function(n,t,i,r,u,f){this.bu=Function.createDelegate(this,this.L);this.Z=Function.createDelegate(this,this.bA);this.bs=Function.createDelegate(this,this.bM);this.br=Function.createDelegate(this,this.bL);this.bt=Function.createDelegate(this,this.bN);this.l=this.NotificationCallback;_mgn.b.resolveInheritance();this.d=this.apcl;this.h=this.rpcl;_mgn.b.initializeBase(this);_js.j.b(n,"groupsDataProvider");_js.j.b(t,"notificationDataProvider");_js.j.b(r,"groupViewModelFactory");_js.j.b(f,"featureManager");this.D=n;this.K=t;this.F=i;this.P=r;this.bm=u;this.S=f;var e=this,o=this;this.D.BeginGetHomeGroup(function(n){e.V=new _mgn.f(n,1,e,e.D,e.K,e.F,e.P,e.a(),e.ba());e.G(e.V)},function(n){_js.Trace.logWarning(_a.a.n,"Failed to Get groups: {0}",n)});this.x=new _js.f;this.y=new _js.f;this.z=new _js.f;this.I=new _js.f;this.T=new _js.f;this.C={};this.L();this.bl=new _C(this.bt,_a.a.n);this.Q=new _C(this.br,_a.a.n);this.R=new _C(this.bs,_a.a.n);this.x.d(this.Z);this.y.d(this.Z);this.z.d(this.Z);this.I.d(this.Z);this.K.a(["Exchange:GroupAssociation"],this)};_mgn.b.prototype={S:null,T:null,x:null,y:null,z:null,I:null,D:null,K:null,F:null,P:null,bm:null,V:null,A:null,W:!1,bl:null,Q:null,R:null,M:!1,C:null,bc:!1,bb:!1,bk:!1,J:!1,bh:!1,bg:!1,be:null,E:!1,O:!1,U:null,bd:0,N:!0,H:null,m:function(n){this.ef("GroupsCollectionChanged",n)},r:function(n){this.eg("GroupsCollectionChanged",n)},bv:function(n){this.ef("SelectedGroupChanged",n)},bH:function(n){this.ef("GroupUnpinned",n)},bF:function(n){this.ef("GroupPinned",n)},bG:function(n){this.ef("BrowseGroups",n)},bE:function(n){this.ef("CreateGroups",n)},j:function(){return this.x},k:function(){return this.y},b:function(){return this.T},bW:function(n){if(this.W!==n){this.W=n;this.ea("IsHomeSelected")}return n},G:function(n){var t=this.A!==n;if(t){var r=!!n&&n.k===1;this.J||this.ej("SelectedGroupChanging",this.A);this.A=n;OwaApplication.e().a(_y.ej,new _y.ej(n?n.a():null));this.ea("SelectedGroup");this.bW(r)}if(!this.J){(t||this.F.a()!=="Mouse")&&this.ej("SelectedGroupChanged",this.A);var u=!!n&&(n.k===2||n.k===3);if(t&&u){var i=0;this.F.a()==="Mouse"&&(i=this.T.x(n)?1:2);this.bm.P(this.A.j.bh.SmtpAddress,i,this.A.j.position,this.A.k===3,this.x.y.length,this.y.y.length,this.a())}}return n},p:function(){return!(!this.M&&this.E&&!this.O)},f:function(){return this.M},bS:function(n){if(this.M!==n){this.M=n;this.ee("HasGroups","IsWelcomeMessageHidden");this.M&&this.bo(!1)}return n},bU:function(n){if(this.bc!==n){this.bc=n;this.ea("HasPinnedAndUnpinnedGroups")}return n},bT:function(n){if(this.bb!==n){this.bb=n;this.ea("HasJoinedAndVisitedGroups")}return n},bC:function(n){if(this.N!==n){this.N=n;this.ea("HideBrowseGroups");if(!this.N&&this.H&&this.H.h.y.length===1){this.H.h.u(0,new _fm.d(_u.R.EP,null,this.Q));this.ea("GroupsHeaderContextMenuViewModel")}}return n},bV:function(n){if(this.bk!==n){this.bk=n;this.ea("HasRecommendedGroups")}return n},c:function(){return this.E},bD:function(n){if(this.E!==n){this.E=n;this.ee("IsReady","IsWelcomeMessageHidden");this.E&&this.bO()}return n},o:function(){return this.O},bo:function(n){if(this.O!==n){this.O=n;this.ee("InitialGroupsLoadFailed","IsWelcomeMessageHidden")}return n},e:function(){return this.R},n:function(){return this.J},X:function(n){if(this.J!==n){this.J=n;this.ea("GroupsMoveInProgress");this.J||this.bA(null,null)}return n},bw:function(){return this.F.a()!=="Mouse"},bK:function(){return $a(_g.a.a().e().bh.GroupCreationEnabled)?!1:!_g.a.a().e().bh.GroupCreationEnabled||this.bw()},a:function(){return _mgn.a.d(this.S)?_mgn.a.e(this.S)?3:2:1},ba:function(){return _mgn.a.b(this.S)},i:function(){if(this.F.a()!=="Mouse")return null;if(!this.H){this.H=new _fm.f(null);this.N||this.H.h.a(new _fm.d(_u.R.EP,null,this.Q));this.H.h.a(new _fm.d(_u.R.SH,null,this.R))}return this.H},t:function(){this.bd>0&&this.L()},L:function(){if(this.bh){this.bg=!0;return}this.bh=!0;if(this.U){_js.g.a().b(this.U);this.U=_js.g.a().b(this.U)}var n=this,t=this;this.D.BeginGetGroups(function(t,i,r,u){n.X(!0);var c=n.A&&!n.W?n.A.j.a():null;var e=n.C;n.C={};n.y.g();n.x.g();n.I.g();n.bj(r,e,5,n.I);n.bj(i,e,3,n.y);n.bj(t,e,2,n.x);for(var f=[],s=0;s<n.z.y.length;s++){var o=n.z.y[s];$a(n.C[o.j.a()])?n.C[o.j.a()]=o:f[f.length]=o}for(var h=0;h<f.length;h++)n.z.m(f[h],!0);_mgn.a.a(n.S)||n.bC(!u);n.bJ(e);_js.d.a(c)||n.bi(c);n.Y();n.X(!1);n.bo(!1);n.bd=0;n.bD(!0);n.bB()},function(n){_js.Trace.logWarning(_a.a.n,"Failed to Get groups: {0}",n);t.bD(!0);t.M||t.bo(!0);t.bB();if(t.bd<3){t.bd++;t.U=_js.g.a().e(_a.a.n,"GroupsViewModel",t.bu,6e4)}},this.a())},bf:function(n){var t=this.C[n.a()];var i=!1;if($a(t)){t=new _mgn.f(n,2,this,this.D,this.K,this.F,this.P,this.a(),this.ba());this.C[n.a()]=t;i=!0}else if(t.k===4){this.bQ(t);this.X(!0);var r=this.A?this.A.j.a():null;this.z.m(t,!0);t.y(2);_js.d.a(r)||r!==t.j.a()||this.bi(t.j.bh.SmtpAddress);i=!0}if(i){if(this.a()===1){this.x.u(0,t);this.Y()}else this.L();this.X(!1)}},bQ:function(n){n&&n.m&&n.m.bq()},bq:function(n){var t=this.w(n);this.G(t);return t},w:function(n){var t=this.C[n.a()];if(t)return t;t=new _mgn.f(n,4,this,this.D,this.K,this.F,this.P,this.a(),this.ba());this.z.u(0,t);this.C[n.a()]=t;this.Y();if(this.E){this.bz(n);return t}else{this.be=n;return t}},q:function(n){this.bn(n,!0)},v:function(n){this.bn(n,!1)},bp:function(n){var i=_g.P.c(n);var t=this.C[i];if(!$a(t)){t.j.f()?this.y.m(t,!0):this.x.m(t,!0);t.j.isMember=!1;t.dispose();delete this.C[i];this.Y()}},bR:function(n){var t=this.g(n);t&&t.S()},bi:function(n){var t=this.g(n);t&&this.G(t)},g:function(n){var t=_g.P.c(n);return this.bx(t)},bx:function(n){var t=this.C[n];return $a(t)?null:t},NotificationCallback:function(n){if(n.a()==="Exchange:GroupAssociation"){var t=n;if(this.K.b()&&!$a(t.c)){t.c?this.a()!==1?this.by(t.b):this.bf(_g.P.g(t.b)):$a(t.b.SmtpAddress)?this.L():this.bp(t.b.SmtpAddress);$a(t.d)||this.a()===2||this.bn(t.b.SmtpAddress,t.d);this.bP(t)}else switch(t.e){case"RowAdded":if(this.a()!==1)this.by(t.b);else{var i=_g.P.g(t.b);$a(this.C[i.a()])&&this.bf(i)}break;case"RowDeleted":case"Reload":case"RowModified":this.L();break;case"SetColumnDone":case"RestrictDone":case"SortDone":case"Error":case"QueryResultChanged":throw Error.invalidOperation();}}},bP:function(n){if(this.ba()){var u=n.b.SmtpAddress;var i=n.f;var t=this.g(u);if(t&&i.b(t.j.unseenData.b())>0){var r=this,f=this;this.D.BeginGetUnifiedGroupUnseenCount(t.j.a(),i,"LastVisitedDateChangedOnServer",function(n){r.bY(t.j.a(),i,n)},function(n){_js.Trace.logWarning(_a.a.n,"Failed to Get GroupUnseenCount: {0}",n)})}}},bY:function(n,t,i){var r=this.g(n);r&&r.M(t,i)},by:function(n){var t=null;n&&!$a(n.SmtpAddress)&&(t=this.C[n.SmtpAddress.toLowerCase()]);t&&t.k!==4||this.L()},bj:function(n,t,i,r){if(n){for(var o=[],s=n,h=s.length,e=0;e<h;++e){var f=s[e];var u=t[f.a()];if($a(u))u=new _mgn.f(f,i,this,this.D,this.K,this.F,this.P,this.a(),this.ba());else{u.y(i);u.j.o(f)}if(!(f.a()in this.C)){this.C[f.a()]=u;Array.add(o,u)}}r.n(o)}},bA:function(n,t){if(!this.J){this.bS(this.x.y.length>0||this.y.y.length>0||this.z.y.length>0);this.bU(this.x.y.length>0&&this.y.y.length>0);this.bT((this.x.y.length>0||this.y.y.length>0)&&this.z.y.length>0);this.bV(this.I.y.length>0);this.eh("GroupsCollectionChanged")}},bO:function(){if(this.be){this.bz(this.be);this.be=null}},bL:function(){var n=_a.d.b(_a.a.n,"ClickBrowseGroupsButton");this.eh("BrowseGroups");_a.d.a(n)},bM:function(){var n=_a.d.b(_a.a.n,"ClickCreateGroupButton");this.eh("CreateGroups");_a.d.a(n)},bN:function(){this.G(this.V)},bn:function(n,t){var o=_g.P.c(n);var i=this.C[o];if(!$a(i)&&t!==i.j.f()){var e=t?this.x:this.y;var r=t?this.y:this.x;var u=t?"GroupPinned":"GroupUnpinned";this.X(!0);try{var f=this.A===i;e.m(i,!0);this.a()===3&&t?r.a(i):r.u(0,i);i.y(t?3:2);this.ej(u,i.j);f&&this.G(i)}finally{this.X(!1)}this.Y()}},Y:function(){for(var n=0,r=0;r<this.y.y.length;r++)this.y.y[r].z(n++);for(var u=0;u<this.x.y.length;u++)this.x.y[u].z(n++);for(var t=0;t<this.z.y.length;t++)this.z.y[t].z(n++);for(var i=0;i<this.I.y.length;i++)this.I.y[i].z(n++);this.bX()},bX:function(){var n=this.bI();this.T.g();this.T.n(n.f())},bI:function(){var n=new _js.f;n.n(this.y.f());if(n.y.length>=10&&this.a()!==3)return n;for(var u=this.a()===3?Math.max(10-n.y.length,2):10-n.y.length,r=Math.min(u,this.x.y.length),t=0;t<r;t++)n.a(this.x.y[t]);if(n.y.length>=10)return n;r=Math.min(10-n.y.length,this.z.y.length);for(var i=0;i<r;i++)n.a(this.z.y[i]);return n},bz:function(n){if(n.c!==1){var i=this,t=this;this.D.BeginGetGroup(n.bh.SmtpAddress,function(t){n.o(t)},function(i){if(n.c!==1){var r=t.bx(n.a());if(r&&r.k===4){_js.Trace.logWarning(_a.a.n,"BeginGetGroup failed for group {0}: {1}",n.a(),i);delete t.C[n.a()];t.z.m(r,!0);t.Y()}}})}},bJ:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};$a(this.C[t.key])&&t.value.dispose()}},bB:function(){this.bh=!1;if(this.bg){this.bg=!1;this.L()}}};_mgn.f=function(n,t,i,r,u,f,e,o,s){this.I=Function.createDelegate(this,this.N);this.D=Function.createDelegate(this,this.R);this.G=Function.createDelegate(this,this.P);this.H=Function.createDelegate(this,this.Q);this.i=this.a;_mgn.f.initializeBase(this);_js.j.b(n,"group");_js.j.b(i,"groupsViewModel");_js.j.b(r,"groupsDataProvider");_js.j.b(u,"notificationProvider");this.p=f.a()==="Mouse"?49:9;this.r=r;this.v=u;this.t=i;this.j=n;this.y(t);this.j.position=65535;this.E=e;this.o=o;this.u=s;if(this.k!==1&&o!==2){this.A=new _C(this.H,_a.a.n);this.w=new _C(this.G,_a.a.n);this.C=new _fm.d(_u.R.ZE,null,this.A);this.x=new _fm.d(_u.R.FN,null,this.w);this.n=new _fm.f([this.C,this.x]);this.K()}this.j.unseenData||(this.j.unseenData=_g.dk.a());this.j.unseenData.apcl("UnseenCount",this.D);if(f.a()==="Mouse"&&t!==1){var c=_g.P.b(this.j);this.m=this.E.a(_h.l.a(c),2,!1,1);this.m.g(!0);var h=this.m.n()[0];this.m.g(!1);if(h){this.n||(this.n=new _fm.f([]));this.n.h.a(new _fm.d(_u.R.WR,null,h.k))}}};_mgn.f.prototype={j:null,m:null,E:null,w:null,A:null,o:0,u:!1,k:0,n:null,C:null,x:null,t:null,r:null,v:null,p:0,q:null,b:function(){return this.j},O:function(){return this.j.unseenData.bh.UnseenCount>0},y:function(n){if(this.k!==n){this.j.k(n===3);this.j.isMember=n===3||n===2;this.k=n;this.K();this.bU(["GroupType","CanPin","CanUnpin","CanJoin"])}return n},z:function(n){if(this.j.position!==n){this.j.position=n;this.k!==4&&this.k!==5&&this.k!==1&&(!this.F()&&this.j.position<=this.p?this.T():this.F()&&this.j.position>this.p&&this.L())}return n},a:function(){return this.j.a()},c:function(){return this.o!==2&&this.k===2},e:function(){return this.o!==2&&this.k===3},d:function(){return!1},f:function(){return this.w},h:function(){return this.A},g:function(){return null},F:function(){return!$a(this.q)},l:function(n){_js.j.b(n,"notification");switch(n.a()){case"Exchange:GroupUnseenItem":var t=n;t.c==="Reload"?this.J("Reload-"+t.b):this.N(t.d);break;default:throw Error.notImplemented();}},S:function(){this.j.unseenData.f()},M:function(n,t){this.j.unseenData.e(t);this.j.unseenData.c(n)},bl:function(){this.F()&&this.L();this.m&&this.m.T();this.j&&this.j.unseenData&&this.j.unseenData.rpcl("UnseenCount",this.D);_js.u.prototype.bl.call(this)},T:function(){this.u||this.J("SubscribeForNotifications");this.q=this.v.a(["Exchange:GroupUnseenItem"],this)},J:function(n){if(this.u){var t=this,r=this;this.r.BeginGetUnifiedGroupUnseenCount(this.j.a(),this.j.unseenData.b(),n,function(n){t.M(t.j.unseenData.b(),n)},function(n){_js.Trace.logWarning(_a.a.n,"Failed to Get GroupUnseenCount: {0}",n)})}else{var i=this;this.r.BeginGetGroupUnseenData(this.j.a(),n,this.I,function(n){_js.Trace.logWarning(_a.a.n,"Failed to Get GroupUnseenCount: {0}",n)})}},N:function(n){if(n){this.j.unseenData.g(n);this.bk("HasUnseenData")}},L:function(){this.v.c(this.q);this.q=null},K:function(){if(this.o!==2&&this.n){this.x.a(this.k!==2);this.C.a(this.k!==3)}},Q:function(){this.t.v(this.j.bh.SmtpAddress)},P:function(){this.t.q(this.j.bh.SmtpAddress)},R:function(n,t){this.bk("HasUnseenData")}};_mgn.k=function(){};_mgn.k.a=function(){return _fm.b.b(_fm.a.dh,null,["ms-fcl-tp-b"],[_fm.WebfontSizes.a.c],[_fm.WebfontSizes.a.e],[_fm.WebfontSizes.a.e],["ms-icon-flip-glyph"],null)};_mgn.k.b=function(){return _fm.b.b(_fm.a.c,null,["ms-fcl-tp-b"],[_fm.WebfontSizes.a.c],[_fm.WebfontSizes.a.e],[_fm.WebfontSizes.a.e],null,null)};_mgn.o=function(n){this.i=Function.createDelegate(this,this.m);_mgn.o.initializeBase(this,[n]);this.w("GroupsView");this.a={}};_mgn.o.prototype={d:null,c:null,b:null,e:null,a:null,g:function(){var t=this.E();if(!t)return null;var i=t.A;if(!i||t.W)return null;var n=null;switch(i.k){case 3:n=this.k()?this.k().by():null;break;case 2:n=this.j()?this.j().by():null;break;case 4:n=this.l()?this.l().by():null;break}return n},f:function(){!this.d&&this.F&&(this.d=this.F.a("scrollRegionId"));return this.d},k:function(){this.c=this.h(this.c,"pinnedGroupsListViewId");return this.c},j:function(){this.b=this.h(this.b,"joinedGroupsListViewId");return this.b},l:function(){this.e=this.h(this.e,"visitedGroupsListViewId");return this.e},J:function(){_js.b.prototype.J.call(this);$a(this.g())||_js.g.a().a(this.G(),"ConversationReadingPaneView set SelectedItem - trigger scroll to selected item",this.i,0)},m:function(){if(this.P()&&!this.bF&&this.f()&&!$a(this.g())){var t=this.g();var n=t.y[0].offsetTop;var i=t.y[0].offsetHeight;if(n+i>this.f().y[0].offsetHeight){this.a.scrollTop=n;this.f().y.animate(this.a,400)}}},h:function(n,t){if(n)return n;this.F&&(n=this.F.a(t));return n}};_mgn.p=function(n){_mgn.p.initializeBase(this,[n]);this.w("GroupView");this.bf(8197)};_mgn._TI=function(){};_mgn._TI.$$cctor=function(){var l="GroupsView._tid1";new _A(l,function(){_mgn._TI.a[l]===undefined&&(_mgn._TI.a[l]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.RI]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var a="GroupsView._tid2";new _A(a,function(){_mgn._TI.a[a]===undefined&&(_mgn._TI.a[a]=[[[-1,4,null,null,null,"BusyText",null,_mgn._TI.p,0,null,null,null,_u.R.LF]]]);var t=_mgn._TI._hf.childNodes[1].cloneNode(!0);var n=new _fce.g(t.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));n.a=0;n.b(!0);return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var h="GroupsView._tid3";new _A(h,function(){_mgn._TI.a[h]===undefined&&(_mgn._TI.a[h]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.OM]]]);var n=_mgn._TI._hf.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var c="GroupsView._tid4";new _A(c,function(){_mgn._TI.a[c]===undefined&&(_mgn._TI.a[c]=[null]);var t=_mgn._TI._hf.childNodes[2].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var v="GroupsView._tid5";new _A(v,function(){_mgn._TI.a[v]===undefined&&(_mgn._TI.a[v]=[null]);var t=_mgn._TI._hf.childNodes[3].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var w="GroupsView._tid6";new _A(w,function(){_mgn._TI.a[w]===undefined&&(_mgn._TI.a[w]=[null]);var t=_mgn._TI._hf.childNodes[4].cloneNode(!0);var n=new _fce.c(t.children[0]);return new _B(t,[n]).R({ListPanel:n})},_mgn.b,_fce.a,function(n){return new _fce.a(n,_js.a.Instance.a(_ff.a))},!1,!0,!1,0,_mgn._TI.a);var b="GroupsView._tid7._tid8";new _A(b,function(){_mgn._TI.a[b]===undefined&&(_mgn._TI.a[b]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.r,0,null,null,null,_mgn.k.a()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.EP]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var y="GroupsView._tid7";new _A(y,function(){_mgn._TI.a[y]===undefined&&(_mgn._TI.a[y]=[[[-1,0,["BrowseGroupsCommand"],[_mgn._TI.t],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[6].cloneNode(!0);var n=new _fc.b(t.children[0]);n.w("GroupsView._tid7._tid8");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var p="GroupsView._tid9._tida";new _A(p,function(){_mgn._TI.a[p]===undefined&&(_mgn._TI.a[p]=[[[-1,4,null,null,null,"Id",null,_mgn._TI.r,0,null,null,null,_mgn.k.b()]],[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.SH]]]);var n=_mgn._TI._hf.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.d(n.children[0],_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));return new _B(n,[t,i])},_mgn.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_mgn._TI.a);var i="GroupsView._tid9";new _A(i,function(){_mgn._TI.a[i]===undefined&&(_mgn._TI.a[i]=[[[-1,0,["IsTouchLayout"],[_mgn._TI.V],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.u],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var t=_mgn._TI._hf.childNodes[7].cloneNode(!0);var n=new _fc.b(t.children[0]);n.w("GroupsView._tid9._tida");return new _B(t,[n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var r="GroupsView.GroupsPanel";new _A(r,function(){_mgn._TI.a[r]===undefined&&(_mgn._TI.a[r]=[null]);var n=_mgn._TI._hf.childNodes[8].cloneNode(!0);var t=new _mgn.o(n.children[0]);return new _B(n,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var n="GroupsView.GroupFunctionsTemplate._tidb";new _A(n,function(){_mgn._TI.a[n]===undefined&&(_mgn._TI.a[n]=[[[-1,4,null,null,null,"ImageId",null,_mgn._TI.n,0,null,null,null,_mgn.k.a()],[-1,4,null,null,null,"AriaLabel",null,_mgn._TI.E,0,null,null,null,_u.R.FS],[-1,4,null,null,null,"Text",null,_mgn._TI.o,0,null,null,null,_u.R.EP],[-1,0,["BrowseGroupsCommand"],[_mgn._TI.t],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.b(i.children[0]);t.g("_mgn_e _mgn_i ms-font-color-themePrimary");t.f("_mgn_f");return new _B(i,[t])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var t="GroupsView.GroupFunctionsTemplate";new _A(t,function(){_mgn._TI.a[t]===undefined&&(_mgn._TI.a[t]=[[[-1,0,["HideBrowseGroups"],[_mgn._TI.v],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mgn._TI.n,0,null,null,null,_mgn.k.b()],[-1,4,null,null,null,"Text",null,_mgn._TI.o,0,null,null,null,_u.R.SH],[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.w],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0],[-1,0,["CreateGroupCommand"],[_mgn._TI.u],null,"ClickCommand",null,_mgn._TI.g,1,null,null,null]]]);var i=_mgn._TI._hf.childNodes[10].cloneNode(!0);var n=new _fc.b(i.children[1]);n.g("_mgn_e _mgn_i ms-font-color-themePrimary");n.f("_mgn_f");var r=new _js.b(i.children[0]);r.w("GroupsView.GroupFunctionsTemplate._tidb");return new _B(i,[r,n])},_mgn.b,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var u="GroupsView.NoGroups._tidc";new _A(u,function(){_mgn._TI.a[u]===undefined&&(_mgn._TI.a[u]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.RI]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cF,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var o="GroupsView.NoGroups._tidd";new _A(o,function(){_mgn._TI.a[o]===undefined&&(_mgn._TI.a[o]=[[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.OM]]]);var n=_mgn._TI._hf.childNodes[11].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _B(n,[t])},_y.cF,_js.b,function(n){return new _js.b(n)},!1,!0,!1,0,_mgn._TI.a);var s="GroupsView.NoGroups";new _A(s,function(){_mgn._TI.a[s]===undefined&&(_mgn._TI.a[s]=[[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.B],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,4,null,null,null,"BusyText",null,_mgn._TI.p,0,null,null,null,_u.R.LF],[-1,0,["IsReady"],[_mgn._TI.m],null,"IsBusy",null,_mgn._TI.F,1,_mgn._TI.d(),null,!1]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.A],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["IsReady"],[_mgn._TI.m],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]]]);var n=_mgn._TI._hf.childNodes[12].cloneNode(!0);var r=new _js.b(n.children[3]);r.w("GroupsView.GroupFunctionsTemplate");var u=new _js.b(n.children[2]);u.w("GroupsView.NoGroups._tidd");var t=new _fce.g(n.children[1],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a));t.a=0;var i=new _js.b(n.children[0]);i.w("GroupsView.NoGroups._tidc");return new _B(n,[i,t,u,r])},_y.cF,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_mgn._TI.a);var f="GroupsView";new _A(f,function(){_mgn._TI.a[f]===undefined&&(_mgn._TI.a[f]=[null,null,[[-1,1,["DataContext","IsHomeSelected"],[_mgn._TI.s,_mgn._TI.T],null,"IsSelected",null,_mgn._TI.J,1,null,null,!1],[-1,1,["DataContext","HomeSelectedCommand"],[_mgn._TI.s,_mgn._TI.R],null,"ClickCommand",null,_mgn._TI.N,1,null,null,null],[-1,0,["HomeGroup"],[_mgn._TI.Q],null,"DataContext",null,_mgn._TI.M,1,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mgn._TI.c,0,null,null,null,_u.R.Qr]],[[-1,0,["IsWelcomeMessageHidden"],[_mgn._TI.W],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsReady"],[_mgn._TI.U],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["InitialGroupsLoadFailed"],[_mgn._TI.S],null,"IsHidden",null,_mgn._TI.b,1,_mgn._TI.d(),null,!0]],[[-1,0,["PinnedGroups"],[_mgn._TI.Y],null,"DataSource",null,_mgn._TI.i,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.k],_mgn._TI.l,"SelectedItem",_mgn._TI.h,_mgn._TI.j,2,null,null,null]],[[-1,5,["HasPinnedAndUnpinnedGroups"],[_mgn._TI.P],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["JoinedGroups"],[_mgn._TI.X],null,"DataSource",null,_mgn._TI.i,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.k],_mgn._TI.l,"SelectedItem",_mgn._TI.h,_mgn._TI.j,2,null,null,null]],[[-1,5,["HasJoinedAndVisitedGroups"],[_mgn._TI.O],null,"_mgn_6",null,null,0,_mgn._TI.d(),null,null]],[[-1,0,["VisitedGroups"],[_mgn._TI.Z],null,"DataSource",null,_mgn._TI.i,1,null,null,null],[-1,0,["SelectedGroup"],[_mgn._TI.k],_mgn._TI.l,"SelectedItem",_mgn._TI.h,_mgn._TI.j,2,null,null,null]],null,[[-1,0,["HideBrowseGroups"],[_mgn._TI.v],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0]],[[-1,0,["IsGroupCreationDisabled"],[_mgn._TI.w],null,"IsHidden",null,_mgn._TI.b,0,null,null,!0]]]);var n=_mgn._TI._hf.childNodes[13].cloneNode(!0);var p=new _js.b(_B.a(n,[0,0,10,1]));p.w("GroupsView._tid9");var w=new _js.b(_B.a(n,[0,0,10,0]));w.w("GroupsView._tid7");var a=new _js.c(_B.a(n,[0,0,10]));a.x.parentNode.removeChild(a.x);var u=new _fce.a(_B.a(n,[0,0,9]),_js.a.Instance.a(_ff.a));u.bh("div");u.v("GroupView");u.w("GroupsView._tid6");u.x.parentNode.removeChild(u.x);var l=new _js.c(_B.a(n,[0,0,8]));l.x.parentNode.removeChild(l.x);var i=new _fce.a(_B.a(n,[0,0,7]),_js.a.Instance.a(_ff.a));i.bh("div");i.v("GroupView");i.w("GroupsView._tid5");i.x.parentNode.removeChild(i.x);var v=new _js.c(_B.a(n,[0,0,6]));v.x.parentNode.removeChild(v.x);var r=new _fce.a(_B.a(n,[0,0,5]),_js.a.Instance.a(_ff.a));r.bh("div");r.v("GroupView");r.w("GroupsView._tid4");r.x.parentNode.removeChild(r.x);var e=new _js.b(_B.a(n,[0,0,4]));e.w("GroupsView._tid3");e.x.parentNode.removeChild(e.x);var s=new _js.b(_B.a(n,[0,0,3]));s.w("GroupsView._tid2");s.x.parentNode.removeChild(s.x);var o=new _js.b(_B.a(n,[0,0,2]));o.w("GroupsView._tid1");o.x.parentNode.removeChild(o.x);var b=new _fc.a(_B.a(n,[0,0,1,0]));var h=new _js.c(_B.a(n,[0,0,1]));h.x.parentNode.removeChild(h.x);var c=new _mgn.p(_B.a(n,[0,0,0]));c.x.parentNode.removeChild(c.x);var t=new _fce.c(_B.a(n,[0,0]));var y=new _fce.f(n.children[0],_js.a.Instance.a(_js.h),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.c));t.a.a(c);t.a.a(h);t.a.a(o);t.a.a(s);t.a.a(e);t.a.a(r);t.a.a(v);t.a.a(i);t.a.a(l);t.a.a(u);t.a.a(a);return new _B(n,[y,t,c,h,b,o,s,e,r,v,i,l,u,a,w,p]).R({scrollRegionId:y,pinnedGroupsListViewId:r,joinedGroupsListViewId:i,visitedGroupsListViewId:u})},_mgn.b,_mgn.o,function(n){return new _mgn.o(n)},!1,!1,!1,0,_mgn._TI.a);var e="GroupView";new _A(e,function(){_mgn._TI.a[e]===undefined&&(_mgn._TI.a[e]=[[[-1,5,["ShowSelected"],[_mgn._TI.q],null,"ms-bg-color-themeLighter",null,null,1,null,null,null]],[[-1,0,["Group","DisplayName"],[_mgn._TI.ba,_mgn._TI.D],null,"Text",null,_mgn._TI.c,1,null,null,null]],[[-1,1,["ShowSelected"],[_mgn._TI.q],null,"IsHidden",null,_mgn._TI.b,1,null,null,!0],[-1,0,["UnseenData","UnseenCount"],[_mgn._TI.bb,_mgn._TI.C],null,"Text",null,_mgn._TI.c,1,_mgn._TI.y(),null,null]]]);var t=_mgn._TI._hf.childNodes[14].cloneNode(!0);var u=new _fc.a(_B.a(t,[0,1,0]));var r=new _fc.a(_B.a(t,[0,0,0]));var i=new _js.c(t.children[0]);var n=new _fce.e(_js.a.Instance.a(_fc.e),_js.a.Instance.a(_ff.c),_js.a.Instance.a(_ff.a),_js.a.Instance.a(_ff.b));n.A(_E.a(["ContextMenuViewModel"],[_mgn._TI.x],null,"MenuDataContext",null,_mgn._TI.I,1)).A(_E.a(["ContextMenuViewModel","IsShown"],[_mgn._TI.x,_mgn._TI.K],_mgn._TI.L,"IsShown",_mgn._TI.G,_mgn._TI.H,2,null,null,!1));n.a=2;n.b=5;i.H([n]);return new _B(t,[i,r,u])},_mgn.f,_mgn.p,function(n){return new _mgn.p(n)},!1,!1,!1,0,_mgn._TI.a)};_mgn._TI.z=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div><div> <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div><div> <div autoid=\"_mgn_1\"></div> </div><div> <div autoid=\"_mgn_2\"></div> </div><div> <div autoid=\"_mgn_3\"></div> </div><div> <span></span> <span></span> </div><div> <button autoid=\"_mgn_4\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <button autoid=\"_mgn_5\" type='button' class='_mgn_b ms-font-weight-regular ms-font-color-neutralPrimary _mgn_d newNodeBtn'></button> </div><div> <div></div> </div><div> <button autoid=\"_mgn_6\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div>  <div></div>  <button autoid=\"_mgn_7\" type='button' class='_mgn_c ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div><div> <span class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></span> </div><div>  <div class='_mgn_g'></div>  <div class='_mgn_8 ms-font-weight-regular ms-font-color-neutralSecondary region'></div>  <div></div>  <div class='_mgn_h'></div> </div><div> <div class='_mgn_2'> <div class='_mgn_3 ms-bg-color-white'> <div autoid=\"_mgn_0\" class='_mgn_4'></div> <div class='_mgn_5 ms-font-weight-regular ms-font-color-themePrimary'> <span></span> </div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_7'></div>  <div class='_mgn_j'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_j'></div> <div class='_mgn_9 ms-border-color-themeLighter'></div>  <div class='_mgn_j'></div>  <div class='_mgn_a'> <div></div> <div></div> </div> </div> </div>    </div><div> <div class='_mgn_k ms-font-weight-semilight ms-font-color-neutralPrimary'> <div class='_mgn_l'><span autoid=\"_mgn_8\"></span></div> <div class='_mgn_m'> <span autoid=\"_mgn_9\"></span> </div> <div class='_mgn_n'></div>  </div> </div>";_js.c.a().appendChild(n);return n};_mgn._TI.t=function(n){return n.Q};_mgn._TI.V=function(n){return n.bw()};_mgn._TI.u=function(n){return n.R};_mgn._TI.v=function(n){return n.N};_mgn._TI.w=function(n){return n.bK()};_mgn._TI.B=function(n){return n.p()};_mgn._TI.m=function(n){return n.c()};_mgn._TI.A=function(n){return n.o()};_mgn._TI.Q=function(n){return n.V};_mgn._TI.s=function(n){return n.E()};_mgn._TI.T=function(n){return _mgn.b.isInstanceOfType(n)?n.W:null};_mgn._TI.R=function(n){return _mgn.b.isInstanceOfType(n)?n.bl:null};_mgn._TI.W=function(n){return n.p()};_mgn._TI.U=function(n){return n.E};_mgn._TI.S=function(n){return n.O};_mgn._TI.Y=function(n){return n.y};_mgn._TI.k=function(n){return n.A};_mgn._TI.h=function(n){return n.Z()};_mgn._TI.P=function(n){return n.bc};_mgn._TI.X=function(n){return n.x};_mgn._TI.O=function(n){return n.bb};_mgn._TI.Z=function(n){return n.z};_mgn._TI.q=function(n){return n.n()};_mgn._TI.x=function(n){return n.n};_mgn._TI.K=function(n){return n.i};_mgn._TI.G=function(n){return n.c()};_mgn._TI.ba=function(n){return n.j};_mgn._TI.D=function(n){return n.bh.DisplayName};_mgn._TI.bb=function(n){return n.j.unseenData};_mgn._TI.C=function(n){return n.bh.UnseenCount};_mgn._TI.c=function(n,t){n.a(t)};_mgn._TI.p=function(n,t){n.d(t)};_mgn._TI.r=function(n,t){n.a(t)};_mgn._TI.g=function(n,t){n.ba(t)};_mgn._TI.b=function(n,t){n.M(t)};_mgn._TI.n=function(n,t){n.i(t)};_mgn._TI.E=function(n,t){n.W(t)};_mgn._TI.o=function(n,t){n.h(t)};_mgn._TI.F=function(n,t){n.b(t)};_mgn._TI.M=function(n,t){n.X(t)};_mgn._TI.J=function(n,t){n.l(t)};_mgn._TI.N=function(n,t){n.ba(t)};_mgn._TI.i=function(n,t){n.bm(t)};_mgn._TI.l=function(n,t){n.G(t)};_mgn._TI.j=function(n,t){n.bd(t)};_mgn._TI.I=function(n,t){n.d(t)};_mgn._TI.L=function(n,t){n.j(t)};_mgn._TI.H=function(n,t){n.e(t)};_mgn._TI.d=function(){_mgn._TI.e||(_mgn._TI.e=new _fc.k);return _mgn._TI.e};_mgn._TI.y=function(){_mgn._TI.f||(_mgn._TI.f=new _mgn.q);return _mgn._TI.f};_mgn.G.registerClass("_mgn.G");_mgn.d.registerClass("_mgn.d",_mgn.G);_mgn.a.registerClass("_mgn.a",_js.u,IModernGroupsNavigationFactory,_y.fH);ModernGroupsNavigationComponent.registerClass("ModernGroupsNavigationComponent",null,_a.ih);_mgn.n.registerClass("_mgn.n");_mgn.j.registerClass("_mgn.j");_mgn.e.registerClass("_mgn.e",_cc.dg,IModernGroupCalendarsProvider,_g.lQ,_js.z);_mgn.q.registerClass("_mgn.q",null,_js.T);_mgn.E.registerClass("_mgn.E",_h.dX.$$(_g.lt));_mgn.x.registerClass("_mgn.x",_mgn.E);_mgn.h.registerClass("_mgn.h",_mgn.E);_mgn.i.registerClass("_mgn.i",_h.dX.$$(_gg.xI));_mgn.z.registerClass("_mgn.z",_mgn.E);_mgn.g.registerClass("_mgn.g",_h.dX.$$(_gg.vy));_mgn.v.registerClass("_mgn.v",_h.dX.$$(_gg.vB));_mgn.w.registerClass("_mgn.w",_h.dX.$$(_gg.vE));_mgn.m.registerClass("_mgn.m",_h.dX.$$(_g.lt));_mgn.D.registerClass("_mgn.D",_a.hH);_mgn.D.prototype.toString=_a.hH.prototype.toString;_mgn.y.registerClass("_mgn.y",_h.dX.$$(_gg.Dr));_mgn.F.registerClass("_mgn.F",_a.hH);_mgn.F.prototype.toString=_a.hH.prototype.toString;_mgn.b.registerClass("_mgn.b",_a.bx,_mgn.J,_y.cF);_mgn.f.registerClass("_mgn.f",_js.u,_mgn.H,_mgn.J,_y.hb,_y.fG);_mgn.o.registerClass("_mgn.o",_js.b);_mgn.p.registerClass("_mgn.p",_fce.d);_mgn._TI.registerClass("_mgn._TI");ModernGroupsNavigationComponent.$$cctor();_mgn.i.a="OWA_GetUserUnifiedGroupsAction";_mgn.c.b=null;_mgn.g.a="GI";_mgn.m.a="OWA_GetUnifiedGroupsSettingsAction";_mgn._TI._hf=_mgn._TI.z();_mgn._TI.e=null;_mgn._TI.f=null;_mgn._TI.a={};_mgn._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupsnavigation.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupsnavigation.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
