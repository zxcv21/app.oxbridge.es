try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime();
function CalendarLocationWellComponent(){}CalendarLocationWellComponent.$$cctor=function(){_a.r.a().a(CalendarLocationWellComponent)};CalendarLocationWellComponent.prototype={a:function(n,t,i){var u=this,r=this;n.b(ILocationWellViewModelFactory,function(){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c(n.a(_a.f),n.d(IPlacePickerViewModelFactory),n.a(_y.a),n.a(_a.Y),n.a(_a.z),n.a(_a.cQ))}).a().c(function(t){t.g=n.a(_pe.e)})},b:function(){return[]}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.j=function(){};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.j.prototype={none:0,plainText:1,autosuggest:2,bingMap:3,addRoom:4};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.j.registerEnum("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.j",!1);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.initializeBase(this);n&&this.dW(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.prototype={d:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.d)},a:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.b)},c:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.c)},b:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.a)},e:function(){return this.d()?this.d():this.a()?this.a():this.c()?this.c():this.b()?this.b():""}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.initializeBase(this);n&&this.dW(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.prototype={a:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.a)},b:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.b)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.initializeBase(this);if(n){this.dW(n);this.b()==="s:PostalAddress"&&this.f(new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b(n))}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.$$cctor=function(){_a.i.d(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a,Object,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.prototype={b:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.e)},e:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.d)},a:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a)},f:function(n){this.eb(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a,n);return n},c:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.b)},d:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.c)||this.a().e()}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f=function(n){this.d=n};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.b=function(n){var i=new _pc.a(null,!0,null);i.dj(4);var r;i.cO(n.d());var u;u=n.b()==="s:LocalBusiness"?"Business":n.b()==="s:PostalAddress"?"Home":"Other";if(n.b()!=="s:BusinessEntityType"){var t;r=(t=new _g.u,t.v(u),t.j(n.a().d()),t.k(n.a().a()),t.o(n.a().c()),t.m(n.a().b()),t.n(null),t.i("LocationServices"),t.p(n.e()),t);if(n.c()){r.t(n.c().a());r.u(n.c().b())}i.bO(new(_bc.V.$$(_g.u)));i.O().h(r,"0")}return i};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.prototype={a:null,b:0,d:null,c:null,f:function(){var n={};this.a.c()&&(n.ul=String.format("{0},{1},{2}",this.a.a,this.a.b,this.a.e));n.mr=this.b;n.types=this.d;n.q=this.c;n.appId="9D33F208D8235F41FFEDA38FBCB2DFD324BA0664";return n},e:function(n,t,i,r){this.c=n;this.a=i;this.b=t;var u={};u.type="GET";u.url="https://platform.bing.com/geo/autosuggest/V1/";u.data=this.f();u.dataType="jsonp";u.jsonp="cb";var f=this;u.success=function(n,t,i){var u=f.g(n);r(u)};var e=this;u.error=function(n,t,i){_js.Trace.logWarning(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.a,"Bing Autosuggest Response timed out")};$.ajax(u)},g:function(n){var i=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e(n);var t=new _ff.d;var r=this;i.a().q(function(n){t.c(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.b(n))});return t}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.initializeBase(this);n&&this.dW(n)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.$$cctor=function(){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a.b(new _a.bs(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a))};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.prototype={a:function(){return this.ec(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.initializeBase(this);this.d=n;this.b=new _gg.rg(this.x);this.b.shouldPrecedeOfflineSyncActions=this.c();this.b.id=n.Id};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.prototype={d:null,b:null,c:function(){return!1},u:function(n){n.bi(this.d,this.b,this.f,this.e)}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.initializeBase(this,[n])};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.prototype={b:function(n){var i=_js.l.a(_bc.d,n.PersonaTypeString);var t=null;switch(i){case 4:var r=n.BusinessAddressesArray;t=n.BusinessAddressesArray[0].Value.LocationUri;break;case 1:t=_pc.l.prototype.b.call(this,n);break}return t}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d=function(){};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.f=function(){var n=new(_h.dT.$$(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g))(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.b);return _h.d.b(n,_h.g.a(),function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g(n)})};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.e=function(n,t){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a(n,6)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.d=function(n,t){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a(n,8)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.c=function(n){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a(n,1)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.a=function(n,t){var i=new _gg.bU;i.Query=n;i.Sources=t;return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a(i)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g=function(n){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.initializeBase(this,[n,null,!0,null])};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.prototype={bo:function(){return _a.a.eC},by:function(n){var t=n;this.h=!0;return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i(t.A)},F:function(n){return Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.c("")}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a=function(n,t){Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.initializeBase(this);this.e=n;this.d=t?t:new _js.f};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.prototype={e:null,d:null,b:function(){return this.d},c:function(){return"Default"},u:function(n){var t=new _gg.sE(this.x);t.owsVersion="V2_56";n.bp(this.e,t,this.r,this.q)},cy:function(n,t,i){try{for(var f=new Array(n.length),u=0;u<n.length;u++){var r=new _pc.a(null,!0,null);r.dW(n[u]);if($a(r.d())){r.dn(1);r.di(_h.l.f())}else r.dn(2);f[u]=r}this.d.g();f.length>0&&this.d.n(f);t()}catch(e){i(e)}}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b=function(n,t,i,r,u,f,e,o,s,h){this.E=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.Z);this.F=Function.createDelegate(this,this.Y);this.D=Function.createDelegate(this,this.U);this.L=Function.createDelegate(this,this.bb);this.H=Function.createDelegate(this,this.N);this.M=Function.createDelegate(this,this.T);this.t=new _a.bt;Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.initializeBase(this,[n,t,r,u,!1,null,!1,null,e,null,i,null,0,null,null,0,0,null]);this.d=_js.d.c(_lws.CalLWStrings.E,"");this.c=t;this.u=f;this.kz("");this.A=new _C(this.M,_a.a.Z);this.v=new _C(this.H,_a.a.Z);this.w=o;this.a=!0;this.apcl("QueryString",this.L);this.C=s;this.z=h;this.r=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f("address,business,place");s&&this.R(_lws.CalLWStrings.D)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.prototype={c:null,u:null,C:!1,v:null,A:null,b:!1,d:null,O:!0,a:!1,z:!1,j:null,w:null,r:null,ik:function(){return!1},gI:function(){return"https://go.microsoft.com/fwlink/?LinkId=260597"},gL:function(){return!this.c.bm.y.length},ib:function(){return this.b},x:function(n){if(this.b!==n){this.b=n;this.b&&this.cg(_lws.CalLWStrings.F);this.ea("IsLearnMoreButtonHighlighted")}return n},ig:function(){return this.v},ij:function(){return this.O},im:function(){return this.d},bd:function(n){if(this.d!==n){this.d=n;this.a&&this.cg(this.d);this.ea("UseThisLocationString")}return n},il:function(){return this.A},id:function(){return this.a},p:function(n){if(this.a!==n){this.a=n;this.a&&this.cg(this.d);this.ea("IsUseThisLocationButtonHighlighted")}return n},gJ:function(){return this.z?_lws.CalLWStrings.B:null},X:function(){return this.bN.a().U().Enabled},bx:function(n){n&&!this.ba(n)&&this.c.bm.a(n)},gF:function(n){var i;var u,r;if(n&&(r=this.P(n,u={val:i}),i=u.val,r)){this.c.bm.o(i);var t=new _gg.hm;n.d()&&n.d().Id&&!n.d().Id.startsWith("CLPID:")?t.EntityId=n.d().Id:t.Id=n.fQ();var f=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h(t);this.cw.a(f)}},ba:function(n){var r;var i,t;return t=this.P(n,i={val:r}),r=i.val,t},gU:function(){this.x(!1);this.cf(!1);this.bV(-1);this.bJ(-1);this.p(!0)},P:function(n,t){t.val=-1;if(_pc.a.isInstanceOfType(n))for(var u=n.fQ(),f=n.c(),i=0;i<this.c.bm.y.length;i++){var r=this.c.bm.y[i];if(u&&r.fQ()===u||r.c()===f){t.val=i;return!0}}return!1},de:function(n){var t=new _pe.f(n,_pe.c.e,!1,this.dD,this.fd,8,0,null,null);t.k(1,_cc.K.b,"");if($a(n.y()))return t;t.eI();return t},ir:function(){this.l(!1);this.bJ(-1);this.bV(-1)},hd:function(){return!1},gA:function(){if(this.a)return!0;if(!this.bz.y.length&&this.ck){this.cf(!1);this.p(!0);return!0}if(!this.cj){this.bV(-1);this.bJ(-1);this.p(!0);return!0}if(this.b){this.x(!1);this.cf(!0);return!0}return _fp.b.prototype.gA.call(this)},gz:function(){if(this.a){this.p(!1);if(!this.bz.y.length){this.cf(!0);return!0}this.bV(0);this.bJ(0);return!0}if(this.ck&&this.gL()){this.cf(!1);this.x(!0);return!0}return this.b?!0:_fp.b.prototype.gz.call(this)},ez:function(){return!1},ew:function(){this.a?this.T():this.b?this.N():_fp.b.prototype.ew.call(this)},gV:function(n,t){this.hc(this.co,this.D,t)},be:function(n,t){this.w.b(this.F,this.G);this.dl(!0);this.r.e(this.by,n,this.t.a,t)},V:function(n){for(var f=new _ff.d,u=this.co-this.j.d.length,s=this.j.d,h=s.length,t=0;t<h;++t){var i=s[t];i.bA.y()&&i.bA.y().bh.LocationUri&&f.c(i.bA.y().bh.LocationUri)}for(var o=n.d,c=o.length,r=0;r<c;++r){var e=o[r];if(!u)break;if(u>0&&!f.g(e.O().f(0).bh.LocationUri)){this.j.c(this.de(e));u--}}this.cy();this.bz.n(this.j.d);this.dl(!1);this.dZ()},U:function(n){if(this.X()&&n.d.length<this.co){this.j=n;this.be(this.co,this.E)}else{this.cy();this.bz.n(n.d)}},Y:function(n){this.t=n},Z:function(n){},N:function(){this.u.a(this.gI(),null,null)},T:function(){this.l(!1)},bb:function(n,t){this.bd(_js.d.c(_lws.CalLWStrings.E,this.by))}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.Q=Function.createDelegate(this,this.bk);this.R=Function.createDelegate(this,this.bl);this.S=Function.createDelegate(this,this.bm);this.U=Function.createDelegate(this,this.bo);this.P=Function.createDelegate(this,this.bj);this.N=Function.createDelegate(this,this.bh);this.O=Function.createDelegate(this,this.bi);this.T=Function.createDelegate(this,this.bn);this.M=Function.createDelegate(this,this.be);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.initializeBase(this);_a.b.b(u,"owaShell");_a.b.b(s,"clientSettings");this.t=new _C(this.M,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a);this.y=new _C(this.T,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a);this.L=[new _fm.d(_lws.CalLWStrings.G,null,this.t)];this.G=i;this.H=t;this.x=r;this.o=u;this.q=f;this.z=e;this.E=o;this.D=s;this.F=h;this.p=c;this.A=l;this.bd();this.br();this.bg(n);this.apcl("Placeholder",this.O)};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.prototype={E:null,D:null,p:!1,t:null,y:null,L:null,H:null,G:null,z:null,o:null,r:null,A:!1,l:null,j:null,i:null,F:null,x:null,k:null,q:null,n:!1,w:null,m:0,bc:function(n){this.ef("OnPlacePickerClosed",n)},bp:function(n){if(n!==this.w){this.w=n;this.ea("Placeholder")}return n},I:function(n){if(this.l!==n){this.l=n;this.ea("PersonaViewModel")}return n},a:function(){return this.j},Y:function(n){if(this.j!==n&&!this.j.bv(n)){this.j=n;this.ea("Location")}return n},e:function(){return this.n},X:function(n){if(this.n!==n){this.n=n;this.ea("IsLocationDirty")}return n},v:function(){return _g.a.a().bh.PolicySettings.PlacesEnabled},bS:function(){return this.q},ba:function(n){this.q=n;return n},W:function(){return this.x.a().U().Enabled},bn:function(){if(!this.v())throw Error.invalidOperation("Places must be enabled to use the place picker");if($a(this.l)&&!_js.d.b(this.i.by)){this.i.l(!1);this.i.k(!1);var n=this;this.V(function(t){t.b(n.i.by,null);n.q.d(t)})}},h:function(n){this.k?n(this.k):this.V(n)},C:function(n){_js.d.a(n.y().bh.LocationUri)||this.bf(n);this.Y(n.fp());this.J(n)},bf:function(n){if(this.W()&&!_js.d.a(n.y().bh.LocationUri)){var t;var r=(t=new _gg.bU,t.Id=n.y().bh.LocationUri,t.MaxResults=1,t.Sources=8,t);var i=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a(r);i.z(this.N);this.i.cw.a(i)}},bh:function(n){var i=n;if(!i.t&&i.d.y.length===1){var t=i.d.y[0];t.y().bh.Latitude&&t.y().bh.Longitude&&this.C(t)}},b:function(){if(this.n){if($a(this.l)){if(!$a(this.j)&&this.j.a().a()==="Resource"&&this.j.bh.DisplayName===this.i.by)return;this.bb()}else if(!$a(this.j)&&!this.i.ch){this.j.i(this.i.by);this.ea("Location")}this.X(!1)}},g:function(n,t){var i=n.r();this.f(i)},f:function(n){if(!this.j.bv(n)){var t=n||_g.w.c();this.j=t.o();this.J(_pc.a.f(this.j));this.i.bp(!1);this.ea("Location")}},d:function(n){if(n&&n.bh.DisplayName){n.a().a()==="Resource"&&(this.m=4);if(this.m){this.r=_a.d.b(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a,"LocationSelection",!1);this.r.j=String.format("Location sourced from {0} and selected from {1}. The annotation was {2}used",n.a().a(),_js.l.b(Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.j,this.m),_js.d.a(n.bh.Annotation)?"not ":"");_a.d.a(this.r);this.r=null}(this.m===1||n.k()&&n.a().a()!=="Resource")&&this.i.bx(_pc.a.f(n))}},bd:function(){var n;n=this.W()?Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.d:Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.e;this.i=new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b(n,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.f(),this.x,this.o,this.D,this.E,this.z,this.F,this.p,this.A);this.i.bu("PlaceDetailedView");if(this.v()){this.i.W();this.i.bI(!0)}else this.i.bI(!1);this.i.J(!1);this.i.y(!1);this.i.K(0);this.i.bv(100)},V:function(n){if(this.k){n(this.k);return}var t=this;this.G.a(function(i){t.k=i.a(9,t.H);t.k.h(t.P);t.o.a()!=="Mouse"||t.o.c()||t.k.e(function(){t.k.b(t.k.c(),t.k.a())});t.k.f(t.U);t.ea("PlacePickerViewModel");n(t.k)})},bo:function(){this.eh("OnPlacePickerClosed")},br:function(){this.i.iG(this.t);this.i.hr(this.S);this.i.q(this.R);this.i.apcl("QueryString",this.Q);if(this.v()&&this.A){this.i.iB(this.y);this.i.iA(this.y)}else this.i.iB(null)},bk:function(n,t){this.X(!0)},Z:function(n){this.i.h(n);this.n=!1},bg:function(n){this.j=n?n.o():_g.w.c();this.j.f(this.j.bh.DisplayName||"");this.J(_pc.a.f(this.j))},J:function(n){if(this.j.a().a()==="Resource"){var i=this.j.bh.DisplayName;if(!_js.d.a(this.j.bh.Annotation)){var t=new(_a.eB.$$(String));t.b(this.j.bh.DisplayName);t.b(this.j.bh.Annotation);i=_cc.bU.a(t)}this.K(i)}else n.b()!==4||n.Y()?this.j.k()?this.bq(n):this.K(this.j.j()):this.K(this.j.j())},K:function(n){this.i.bI(!1);this.Z(n);this.I(null);this.i.bI(this.v())},bq:function(n){this.i.R(_lws.CalLWStrings.A);this.i.bI(!1);this.Z(this.j.bh.Annotation||"");this.n=!1;this.I(_cc.K.a(n,this.z,this.o,2,this.L,!0))},bi:function(n,t){this.i.R(this.p?this.w:"")},be:function(){this.i.R(this.p?this.w:"");this.I(null);this.bb();this.i.bp(!1)},bm:function(n,t){this.i.bY||this.b()},bb:function(){this.i.bI(this.v());this.Y(_g.w.a(this.i.by));this.m=1},bl:function(n,t){if(!$a(this.i.i())){this.m=2;this.C(this.i.i().a())}},bj:function(n){if(!$a(n)){this.m=3;this.C(n)}}};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c=function(n,t,i,r,u,f){this.d=n;this.h=t;this.f=i;this.c=r;this.b=u;this.e=f};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.c.prototype={h:null,f:null,c:null,b:null,e:null,d:null,g:null,a:function(n,t,i,r,u){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a(n,t,this.h,this.d,this.f,i,this.g,this.c,this.b,this.e,r,u)}};Type.registerNamespace("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a=function(n,t){this.m=Function.createDelegate(this,this.bd);this.t=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.Z);this.k=Function.createDelegate(this,this.bb);this.l=Function.createDelegate(this,this.o);this.p=_lws.CalLWStrings.D;Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.initializeBase(this,[n]);this.w("LocationWellView");this.a=t;this.d=this.a.a()==="Mouse";this.q=this.a.a()!=="Mouse";this.n=this.a.a()==="Mouse"?2:0};Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.prototype={q:!1,n:0,b:null,f:null,c:null,i:null,e:null,d:!1,h:!1,a:null,g:null,bm:function(n){n=n||"";if(this.p!==n){this.p=n;this.E().bp(n);this.bk("Placeholder")}return n},bo:function(n){if(this.d!==n){this.d=n;this.bk("SingleLineMode")}return n},bh:function(n){if(this.h!==n){this.h=n;this.bk("ExpandedPortraitLayout")}return n},cs:function(){return this.g},Y:function(n){if(this.g!==n){this.g=n;this.bk("AriaLabelledBy")}return n},o:function(){var t=this.E();if(this.d&&!$a(this.F)&&!$a(t))if($a(t.l)){this.b.M(!0);this.c.y.hide()}else{this.b.M(!1);var i=this.y.outerWidth(!0);this.b.y.width(this.f.y.outerWidth()+10);this.c.y.show();this.c.y.css("display","table-cell");var n=this.i.y.outerWidth();this.c.y.width(n);this.e.y.hide();var u=this.b.y.outerWidth();var r=i-u-n;r<258&&this.b.y.width((i-n)/2);this.e.y.show()}},K:function(){_js.b.prototype.K.call(this);this.F?this.u():this.bg()},J:function(){_js.b.prototype.J.call(this);if(!_g.a.a().bh.PolicySettings.PlacesEnabled){this.a.a()==="Mouse"&&this.c.y.hide();return}if(this.d&&this.a.a()==="Mouse"){this.o();this.a.i(this.l)}if(this.a.m()&&this.E()){var n=this;_js.g.a().d(this.G(),"OnActivate",function(){n.E().apcl("PlacePickerViewModel",n.k);n.f.apcl("DataContext",n.j)})}this.a.a()==="TouchWide"&&this.L.apcl("IsInExpandedComposeLayoutInPortraitOrientation",this.r);this.e.y.keydown(this.t)},O:function(){if(this.a.m()&&this.E()&&this.E()){this.E().rpcl("PlacePickerViewModel",this.k);this.E().rpcl("PersonaViewModel",this.j)}this.d&&this.a.a()==="Mouse"&&this.a.j(this.l);_js.b.prototype.O.call(this)},bl:function(){this.P()&&this.O();_js.b.prototype.bl.call(this)},bb:function(n,t){this.E().bc(this.m)},Z:function(n,t){this.a.a()==="Mouse"&&this.o();_js.g.a().a(_a.a.Z,"RestoreFocus",this.m,0)},z:function(n){(n.which===13||n.which===27)&&n.stopImmediatePropagation()},bd:function(){this.E()&&this.E().l?this.b.V():this.e.V()},v:function(n,t){this.bh(this.y.width()<600)},u:function(){this.b=this.F.a("resolvedLocation");this.f=this.F.a("personaView");this.c=this.F.a("separatorCell");this.i=this.F.a("separatorText");this.e=this.F.a("findPlaceView")},bg:function(){this.b=null;this.f=null;this.c=null;this.i=null;this.e=null}};Type.registerNamespace("_lw");_lw._TI=function(){};_lw._TI.$$cctor=function(){var t="LocationWellView";new _A(t,function(){_lw._TI.a[t]===undefined&&(_lw._TI.a[t]=[[[-1,5,["SingleLineMode"],[_lw._TI.t],null,"_lw_a",null,null,1,null,null,null],[-1,5,["UseUnifiedForms"],[_lw._TI.o],null,"_lw_3",null,null,0,null,null,null],[-1,5,["ExpandedPortraitLayout"],[_lw._TI.r],null,"_lw_b",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw._TI.e],null,"IsHidden",null,_lw._TI.i,1,_lw._TI.k(),null,!0]],[[-1,0,["PersonaViewModel"],[_lw._TI.e],null,"DataContext",null,_lw._TI.h,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_lw._TI.w,0,null,null,null,_lws.CalLWStrings.C],[-1,4,null,null,null,"ImageId",null,_lw._TI.v,0,null,null,null,_n.a.a()],[-1,1,["ShowDeleteButton"],[_lw._TI.s],null,"IsHidden",null,_lw._TI.i,1,_lw._TI.j(),null,!0],[-1,0,["DeletePlace"],[_lw._TI.d],null,"ClickCommand",null,_lw._TI.u,1,null,null,null]],null,[[-1,4,null,null,null,"FormatString",null,_lw._TI.x,0,null,null,null,_pecs.d.W]],[[-1,1,["AnchorSpacing"],[_lw._TI.p],null,"TypedownAnchorSpacing",null,_lw._TI.z,1,null,null,0],[-1,1,["AriaLabelledBy"],[_lw._TI.q],null,"AriaLabelledBy",null,_lw._TI.y,1,null,null,null],[-1,0,["FindPlaceViewModel"],[_lw._TI.n],null,"DataContext",null,_lw._TI.h,1,null,null,null],[0,5,["UseUnifiedForms"],[_lw._TI.m],null,"_lw_3",null,null,0,null,null,null]]]);var n=_lw._TI._hf.childNodes[0].cloneNode(!0);var i=new _fp.e(_B.a(n,[0,2,0]),_js.a.Instance.a(_y.a),_js.a.Instance.a(_ff.c));i.l(!0);i.k(!0);var c=new _b.ba(_B.a(n,[0,1,0]));var h=new _fc.z(_B.a(n,[0,1]));var s=new _fc.b(_B.a(n,[0,0,1]));var l=new _fc.g;var o=new _fc.c;o.A(_E.a(["DeletePlace"],[_lw._TI.d],null,"Command",null,_lw._TI.f,1));o.i("ENTER");l.a([o]);s.H([l]);var u=new _pe.b(_B.a(n,[0,0,0]),_js.a.Instance.a(_a.m));u.w("PersonaView.LocationBasicDetailsPopup");var r=new _fc.z(_B.a(n,[0,0]));var a=new _fc.g;var e=new _fc.c;e.A(_E.a(["DeletePlace"],[_lw._TI.d],null,"Command",null,_lw._TI.f,1));e.i("DELETE");var f=new _fc.c;f.A(_E.a(["PersonaViewModel","EnterKeyCommand"],[_lw._TI.e,_lw._TI.A],null,"Command",null,_lw._TI.f,1));f.i("ENTER");a.a([e,f]);r.H([a]);var v=new _js.c(n.children[0]);return new _B(n,[v,r,u,s,h,c,i]).R({resolvedLocation:r,personaView:u,deleteButton:s,separatorCell:h,separatorText:c,findPlaceView:i}).b(i)},Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a,function(n){return new Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a(n,_js.a.Instance.a(_y.a))},!1,!1,!1,0,_lw._TI.a);var n="PlaceDetailedView";new _A(n,function(){_lw._TI.a[n]===undefined&&(_lw._TI.a[n]=[[[-1,5,["ShowSelectedOrIsTouched"],[_lw._TI.g],null,"ms-bg-color-themeLight",null,null,1,null,null,null]]]);var i=_lw._TI._hf.childNodes[1].cloneNode(!0);var t=new _pe.b(i.children[0],_js.a.Instance.a(_a.m));t.j("_lw_e ms-font-weight-semilight ms-font-color-neutralPrimary bidi");t.bC("_lw_f ms-font-weight-semilight ms-font-color-neutralSecondary bidi");t.w("PersonaView.DisplayPictureTwoLinesDetailsCustomStyle");return new _B(i,[t])},_pe.f,_fce.d,function(n){return new _fce.d(n)},!1,!1,!1,0,_lw._TI.a)};_lw._TI.l=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_lw_2 ms-bcl-nta ms-bcl-nsa-h'> <span class='_lw_4 ms-fwt-r ms-bg-color-neutralLight'> <span class='_lw_5 ms-fwt-r ms-font-color-neutralSecondary-hover'></span> <button type='button' class='_lw_c ms-bg-color-neutralLight'></button>  </span>  <span class='_lw_6'> <span class='_lw_7 ms-font-s'></span> </span> <span class='_lw_8'> <div class='_lw_9 ms-font-s'></div> </span> </span> </div><div> <span class='_lw_d'></span> </div><div> <span class='_lw_g'></span> </div>";_js.c.a().appendChild(n);return n};_lw._TI.t=function(n){return n.d};_lw._TI.o=function(n){return n.p};_lw._TI.r=function(n){return n.h};_lw._TI.e=function(n){return n.l};_lw._TI.d=function(n){return n.t};_lw._TI.A=function(n){return n.K()};_lw._TI.s=function(n){return n.q};_lw._TI.n=function(n){return n.i};_lw._TI.p=function(n){return n.n};_lw._TI.q=function(n){return n.cs()};_lw._TI.m=function(n){return n.C};_lw._TI.g=function(n){return n.cn()};_lw._TI.i=function(n,t){n.M(t)};_lw._TI.f=function(n,t){n.k=t};_lw._TI.h=function(n,t){n.X(t)};_lw._TI.w=function(n,t){n.bw(t)};_lw._TI.u=function(n,t){n.ba(t)};_lw._TI.v=function(n,t){n.i(t)};_lw._TI.x=function(n,t){n.c(t)};_lw._TI.z=function(n,t){n.o(t)};_lw._TI.y=function(n,t){n.Y(t)};_lw._TI.k=function(){_lw._TI.c||(_lw._TI.c=new _fc.m);return _lw._TI.c};_lw._TI.j=function(){_lw._TI.b||(_lw._TI.b=new _fc.k);return _lw._TI.b};CalendarLocationWellComponent.registerClass("CalendarLocationWellComponent",null,_a.ih);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b",_a.dT);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c",_a.dT);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a",_a.dT);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e",_a.dT);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.h",_h.fL);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.i",_pc.l);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.g",_fp.j);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.Actions.a",_h.dX.$$(Array),_pc.n,_pc.x);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.b",_fp.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a",_a.bx,_bc.u,_a.iT,_js.z,Sys.IDisposable,ILocationWellViewModel);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a.registerClass("Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Views.a",_js.b);_lw._TI.registerClass("_lw._TI");CalendarLocationWellComponent.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.d=new _H("s:streetAddress",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.b=new _H("s:addressLocality",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.e=new _H("b:addressSubregion",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.c=new _H("s:addressRegion",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.a=new _H("s:addressCountry",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.a=new _H("s:latitude",Number,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.b=new _H("s:longitude",Number,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.e=new _H("@type",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.d=new _H("s:url",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.c=new _H("s:name",String,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.b=new _H("s:geo",Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.c,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.a=new _H("s:address",Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.b,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.a.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.f.a=_a.a.dA;Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.a=new _H("@graph",_js.f,Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e);Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.e.$$cctor();Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.Models.d.b=new _g.n("PlaceItemQueryTable");Microsoft.Exchange.Clients.Owa2.Client.Calendar.LocationWell.ViewModels.a.a=_a.a.Z;_lw._TI._hf=_lw._TI.l();_lw._TI.c=null;_lw._TI.b=null;_lw._TI.a={};_lw._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.locationwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
