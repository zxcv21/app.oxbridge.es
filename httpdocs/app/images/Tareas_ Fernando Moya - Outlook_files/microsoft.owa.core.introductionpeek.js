try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.introductionpeek.js'] = (new Date()).getTime();
function IntroductionPeekComponent(){}IntroductionPeekComponent.$$cctor=function(){_a.r.a().a(IntroductionPeekComponent)};IntroductionPeekComponent.prototype={a:function(n,t,i){var u=this;n.b(IIntroductionPeekContentViewModelFactory,function(){return new _ip.d(n.d(IModuleHelpProvider),n.a(_y.a))});var r=this;n.b(IIntroductionControllerFactory,function(){return new _ip.c(n.a(_ff.a),n.a(_g.f),n.a(IInferenceTracker),n.a(_a.s),n.a(_ff.c),n.a(IIntroductionPeekContentViewModelFactory))})},b:function(){return[]}};Type.registerNamespace("_ip");_ip.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.t=Function.createDelegate(this,this.M);this.r=Function.createDelegate(this,this.L);this.q=Function.createDelegate(this,this.K);this.v=Function.createDelegate(this,this.P);this.w=Function.createDelegate(this,this.Q);this.x=Function.createDelegate(this,this.R);this.E=Function.createDelegate(this,this.O);_ip.b.initializeBase(this);_a.b.a(n,"layoutSettings");_a.b.a(t,"userOptions");_a.b.a(i,"inferenceTracker");_a.b.a(u,"eventAggregator");_a.b.a(r,"actionManager");_a.b.a(f,"introductionPeekContentViewModelFactory");_a.b.c(e,"peekContentTitle");_a.b.c(o,"peekContentDescription");_a.b.b(s,"helpId");this.G=n;this.f=t;this.j=i;this.y=r;this.i=u;this.T(new _C(this.E,_a.a.ch));this.n=e;this.m=o;this.l=s;this.o=h;this.p=c;this.h=l;if(!_js.d.a(a)){this.C=!0;this.D=a}this.N(f)};_ip.b.prototype={f:null,G:null,j:null,i:null,y:null,n:null,m:null,l:0,o:null,p:null,D:"",C:!1,h:0,g:null,F:null,z:!1,A:!1,c:function(){return this.g},J:function(n){if(this.g!==n){this.g=n;this.ea("IntroductionPeekContentViewModel")}return n},T:function(n){this.F=n;this.ea("EnterKeyCommand");return n},I:function(n){if(this.z!==n){this.z=n;this.eh("CanShowIntroduction")}return n},d:function(n){this.ef("CanShowIntroduction",n)},e:function(n){this.eg("CanShowIntroduction",n)},b:function(){if(this.g){this.g.a(_y.j.b(this.h));this.g.b()&&this.j.w(this.h);return this.g.b()}return!1},a:function(n){if(this.g.b()){if(n){this.j.v(this.h);this.k(n)}else this.g.a(!1);return!this.g||!this.g.b()}return!1},ed:function(){this.A&&this.V();this.h===6&&this.g.rpcl("IsPeekContentShownAndClosedInTNarrow",this.x);_a.iX.prototype.ed.call(this)},O:function(){this.b()},N:function(n){if(_y.j.b(this.h)){var u=this;var r=new _C(function(){u.H()},_a.a.ch);var t=null;if(this.o){var i=this;t=new _C(function(){i.S();i.o.d()},_a.a.ch)}this.C?this.J(n.b(this.n,this.m,this.l,this.D,r,t,this.p,this.w,this.v,this.h)):this.J(n.a(this.n,this.m,this.l,r,t,this.p,this.w,this.v,this.h));this.h===6&&this.g.apcl("IsPeekContentShownAndClosedInTNarrow",this.x);this.I(!0);this.U();this.A=!0}},H:function(){this.j.v(this.h);this.k(!0)},k:function(n){if(this.g){this.g.a(!1);this.I(!1);if(n){switch(this.h){case 0:this.f.z(this.f.y()|1);_y.j.i(!0);break;case 2:this.f.z(this.f.y()|8);break;case 3:this.f.z(this.f.y()|16);break;case 6:this.f.z(this.f.y()|128);break;case 4:this.f.z(this.f.y()|32);break;case 8:this.f.z(this.f.y()|2);_y.j.k(!0);break;case 9:this.f.z(this.f.y()|512);break;case 10:this.f.z(this.f.y()|1024);_y.j.j(!0);break;case 12:this.f.z(this.f.y()|4096);break;case 13:this.f.z(this.f.y()|8192);break;case 14:this.f.z(this.f.y()|16384);break;case 15:this.f.z(this.f.y()|32768);break;case 16:this.f.z(this.f.y()|65536);break}_h.h.a(this.f.v,this.y)}}},Q:function(){this.j.w(this.h)},R:function(n,t){this.H()},S:function(){this.j.bm(this.h);this.k(!0)},P:function(){this.j.bl(this.h);this.k(!1)},U:function(){this.i.b(_y.df,this.q);this.i.b(_y.cg,this.r);this.i.b(_y.Q,this.t)},V:function(){this.i.c(_y.df,this.q);this.i.c(_y.cg,this.r);this.i.c(_y.Q,this.t)},K:function(n){this.a(!1)},L:function(n){this.a(!1)},M:function(n){this.a(!1)}};_ip.c=function(n,t,i,r,u,f){_a.b.a(t,"userConfiguration");this.f=n;this.g=t.a();this.d=i;this.c=u;this.b=r;this.e=f};_ip.c.prototype={g:null,f:null,d:null,c:null,b:null,e:null,a:function(n,t,i,r,u,f){return new _ip.b(this.f,this.g,this.d,this.b,this.c,this.e,n,t,i,r,u,f)}};_ip.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_ip.a.initializeBase(this);this.h=n;this.v=t;this.j=h;this.k=s;this.n=i;this.d=r;this.e=u;this.i=c;this.r=f;this.o=e;this.q=o;var v=this;this.t=new _C(function(){v.C()},_a.a.ch);this.m=this.y()?this.i===6?315:275:300;this.l=300;if(l){_a.b.c(a,"VideoPlayerUrl cannot be null when showVideoPlayer is true");this.w=l;this.x=a;this.l=600;this.m=700}};_ip.a.prototype={h:null,r:null,t:null,o:null,q:null,x:"",n:null,d:null,e:0,w:!1,i:0,l:0,m:0,c:!1,k:null,j:null,v:null,A:function(){return _js.d.a(this.q)?_nbs.a.ij:this.q},z:function(){return!this.o&&this.e!==-1},f:function(){return this.l},g:function(){return this.m},p:function(){return!_js.d.a(this.n)&&!_js.d.a(this.d)},b:function(){return this.c},a:function(n){if(this.c!==n){this.c=n;this.c&&this.k&&this.k();!this.c&&this.y()&&this.ea("IsPeekContentShownAndClosedInTNarrow");this.ea("IsShown")}return n},y:function(){return this.v.a()==="TouchNarrow"},C:function(){if(this.h){var n=this;this.h.a(function(t){t.a(n.e)})}this.j&&this.j()}};_ip.d=function(n,t){_a.b.a(n,"helpProvider");this.c=n;this.d=t};_ip.d.prototype={d:null,c:null,a:function(n,t,i,r,u,f,e,o,s){return new _ip.a(this.c,this.d,n,t,i,r,u,f,e,o,s)},b:function(n,t,i,r,u,f,e,o,s,h){return new _ip.a(this.c,this.d,n,t,i,u,f,e,o,s,h,!0,r)}};_ip._TI=function(){};_ip._TI.$$cctor=function(){var i="IntroductionPeekContentView._tid1";new _A(i,function(){_ip._TI.a[i]===undefined&&(_ip._TI.a[i]=[[[-1,0,["LearnMoreLinkText"],[_ip._TI.l],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["LearnMoreLinkText"],[_ip._TI.l],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]]]);var t=_ip._TI._hf.childNodes[0].cloneNode(!0);var n=new _fc.a(t.children[0]);n.C(0);return new _B(t,[n])},_ip.a,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ip._TI.a);var t="IntroductionPeekContentView._tid2";new _A(t,function(){_ip._TI.a[t]===undefined&&(_ip._TI.a[t]=[[[-1,0,["TryFeatureCommandText"],[_ip._TI.n],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["TryFeatureCommandText"],[_ip._TI.n],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]]]);var i=_ip._TI._hf.childNodes[0].cloneNode(!0);var n=new _fc.a(i.children[0]);n.C(0);return new _B(i,[n])},_ip.a,_fc.f,function(n){return new _fc.f(n)},!1,!0,!1,0,_ip._TI.a);var n="IntroductionPeekContentView";new _A(n,function(){_ip._TI.a[n]===undefined&&(_ip._TI.a[n]=[[[-1,0,["IsModernGroupsInTNarrow"],[_ip._TI.k],null,"IsHidden",null,_ip._TI.d,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_ip._TI.s,0,null,null,null,_n.a.cA()],[-1,4,null,null,null,"HoveredImageId",null,_ip._TI.r,0,null,null,null,_n.a.cB()],[-1,4,null,null,null,"AriaLabel",null,_ip._TI.q,0,null,null,null,_u.R.CC],[-1,0,["DismissCommand"],[_ip._TI.u],null,"ClickCommand",null,_ip._TI.j,1,null,null,null]],[[-1,0,["Title"],[_ip._TI.h],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["Title"],[_ip._TI.h],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]],[[-1,0,["Description"],[_ip._TI.g],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["Description"],[_ip._TI.g],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]],[[-1,0,["ShowVideoPlayer"],[_ip._TI.x],null,"IsHidden",null,_ip._TI.d,1,_ip._TI.i(),null,!0]],[[-1,0,["VideoPlayerUrl"],[_ip._TI.y],null,"Source",null,_ip._TI.t,1,null,null,null]],[[-1,0,["ShowLearnMoreLink"],[_ip._TI.w],null,"IsHidden",null,_ip._TI.d,1,_ip._TI.i(),null,!0],[-1,0,["LearnMoreCommand"],[_ip._TI.v],null,"ClickCommand",null,_ip._TI.j,1,null,null,null]],[[-1,0,["TryFeatureCommand"],[_ip._TI.m],null,"IsHidden",null,_ip._TI.d,1,_ip._TI.o(),null,!0],[-1,0,["TryFeatureCommand"],[_ip._TI.m],null,"ClickCommand",null,_ip._TI.j,1,null,null,null]],[[-1,0,["IsModernGroupsInTNarrow"],[_ip._TI.k],null,"IsHidden",null,_ip._TI.d,1,_ip._TI.i(),null,!0],[-1,5,["IsModernGroupsInTNarrow"],[_ip._TI.k],null,"_ip_9",null,null,0,null,null,null]],[[-1,0,["Title"],[_ip._TI.h],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["Title"],[_ip._TI.h],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]],[[-1,0,["Description"],[_ip._TI.g],null,"Text",null,_ip._TI.b,1,null,null,null],[-1,0,["Description"],[_ip._TI.g],null,"AriaLabel",null,_ip._TI.c,1,null,null,null]]]);var t=_ip._TI._hf.childNodes[1].cloneNode(!0);var o=new _fc.a(_B.a(t,[1,0,1]));o.C(0);var s=new _fc.a(_B.a(t,[1,0,0]));s.C(0);var a=new _js.c(t.children[1]);var c=new _fc.f(_B.a(t,[0,2,1]));c.w("IntroductionPeekContentView._tid2");var h=new _fc.f(_B.a(t,[0,2,0]));h.w("IntroductionPeekContentView._tid1");var i=new _b.L(_B.a(t,[0,1,2,0]));i.x.parentNode.removeChild(i.x);var r=new _fce.c(_B.a(t,[0,1,2]));var e=new _fc.a(_B.a(t,[0,1,1]));e.C(0);var u=new _fc.a(_B.a(t,[0,1,0]));u.C(0);var f=new _fc.b(_B.a(t,[0,0]));f.C(0);var l=new _js.c(t.children[0]);r.a.a(i);return new _B(t,[l,f,u,e,r,i,h,c,a,s,o])},_ip.a,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_ip._TI.a)};_ip._TI.p=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div> <button autoid=\"_ip_0\" type='button' class='_ip_8'></button>  <div class='_ip_2'> <span autoid=\"_ip_1\" class='_ip_3 ms-font-weight-semilight ms-font-color-black'></span> <span autoid=\"_ip_2\" class='_ip_4 ms-font-weight-regular'></span> <div> <iframe class='_ip_7'></iframe> </div> </div>  <div class='_ip_5'> <a autoid=\"_ip_3\" class='_ip_6 ms-font-weight-regular ms-font-color-themePrimary'></a> <a class='_ip_6 ms-font-weight-regular ms-font-color-themePrimary'></a> </div> </div> <div>  <div class='_ip_2'> <span class='_ip_3 ms-font-weight-semilight ms-font-color-black'></span> <span class='_ip_4 ms-font-weight-regular'></span> </div> </div> </div>";_js.c.a().appendChild(n);return n};_ip._TI.l=function(n){return _u.R.Bt};_ip._TI.n=function(n){return n.A()};_ip._TI.k=function(n){return n.i===6};_ip._TI.u=function(n){return n.r};_ip._TI.h=function(n){return n.n};_ip._TI.g=function(n){return n.d};_ip._TI.x=function(n){return n.w};_ip._TI.y=function(n){return n.x};_ip._TI.w=function(n){return n.z()};_ip._TI.v=function(n){return n.t};_ip._TI.m=function(n){return n.o};_ip._TI.b=function(n,t){n.a(t)};_ip._TI.c=function(n,t){n.W(t)};_ip._TI.d=function(n,t){n.M(t)};_ip._TI.j=function(n,t){n.ba(t)};_ip._TI.s=function(n,t){n.i(t)};_ip._TI.r=function(n,t){n.k(t)};_ip._TI.q=function(n,t){n.W(t)};_ip._TI.t=function(n,t){n.a(t)};_ip._TI.i=function(){_ip._TI.e||(_ip._TI.e=new _fc.k);return _ip._TI.e};_ip._TI.o=function(){_ip._TI.f||(_ip._TI.f=new _fc.m);return _ip._TI.f};IntroductionPeekComponent.registerClass("IntroductionPeekComponent",null,_a.ih);_ip.b.registerClass("_ip.b",_a.bx,_y.hf);_ip.a.registerClass("_ip.a",_a.bx,_y.fA,_a.iT,_js.z,Sys.IDisposable);_ip._TI.registerClass("_ip._TI");IntroductionPeekComponent.$$cctor();_ip._TI._hf=_ip._TI.p();_ip._TI.e=null;_ip._TI.f=null;_ip._TI.a={};_ip._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.introductionpeek.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.introductionpeek.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
