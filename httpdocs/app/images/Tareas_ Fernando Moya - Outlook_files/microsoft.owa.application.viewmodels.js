try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.application.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_r");function ApplicationViewModelsComponent(){}ApplicationViewModelsComponent.$$cctor=function(){_a.r.a().a(ApplicationViewModelsComponent)};ApplicationViewModelsComponent.prototype={a:function(n,t,i){var e=this;n.b(_r.d,function(){return new _r.d(n.a(_y.a),n.a(_a.f),n.a(_h.o),n.a(_ff.c),n.a(_a.s),n.a(_pcf.a),n.a(_g.a),n.a(_ph.K),n.a(_a.w),n.a(_a.z),n.a(_a.e))}).a();var o=this;n.b(_r.a,function(){return new _r.a(n.a(_y.a),n.a(_r.d),n.a(_rw.g),n.a(_a.f),n.a(_ff.c),i.a()==="TouchNarrow"?n.a(_y.bW):null)}).b(IOwaOptionRichPeoplePickerViewModelFactory);var s=this;n.b(_d.bb,function(){return new _d.bb(n.a(_y.a),n.a(_g.f),n.a(_ff.c),n.a(IInferenceTracker),n.a(_h.o),n.d(IMailErrorHandler),n.c(IExtendedListViewModelFactory),n.a(_y.r),n.a(_a.f))}).a();var r=this;n.b(_d.bi,function(){return new _d.bJ(n.a(_y.a),n.a(_a.f))}).a();var u=this;n.b(_r.b,function(){return new _r.b(n.a(_y.a),n.a(ReadingPaneViewModelBase),n.a(_g.cJ),n.a(_d.bb),n.a(_g.f),n.a(_d.bi),n.a(_ff.c),n.a(_a.f),n.a(_bc.b))}).b(ITasksModuleViewModel);var f=this;n.b(_r.BposDiagnosticsViewModelFactory,function(){return new _r.BposDiagnosticsViewModelFactory(n.a(_g.bd),n.a(_a.s))})},b:function(){return null}};_r.c=function(n,t){this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.k);_r.c.initializeBase(this);this.d=t;if(!$a(n)){this.e=n.bh.IsBposUser;this.h=n.bh.UserDisplayName}if(this.e){this.a("Retrieving Office 365 data...");this.i()}else this.a("This user is not an Office 365 user.")};_r.c.prototype={d:null,e:!1,h:null,b:null,c:null,l:function(n){this.b=n;$a(this.b)?this.a("The retrieved Office 365 data is null."):this.a("The Office 365 data was retrieved successfully.");this.ea("BposNavBarData");return n},a:function(n){if(this.c!==n){this.c=n;this.ea("StatusMessage")}return n},i:function(){var n=new _h.dp;n.w(this.g);n.v(this.f);this.d.a(n)},j:function(n){this.a("Failed to get the Office 365 data.")},k:function(n){var t=null;$a(n)||(t=n.b);this.l(t)}};_r.BposDiagnosticsViewModelFactory=function(n,t){this.d=n;this.c=t};_r.BposDiagnosticsViewModelFactory.prototype={c:null,d:null,b:function(n,t,i){return new _r.c(this.d,this.c)},a:function(n,t,i){return new _r.c(this.d,this.c)}};_r.f=function(n,t,i,r,u,f,e,o,s,h,c,l){_r.f.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l])};_r.f.prototype={cs:null,cr:null,ct:null,dm:function(n,t,i,r,u){var f=this.F;f.bE=n;f.bh=t;f.C=i;f.J=r;f.x=u},en:function(n){return new _d.bE(n,this.H,this.cV(),this.ca(),this.cW())},dj:function(){var n=this.F;n.bE?this.E.bB.b(1):n.bh&&!this.bk?this.E.bB.b(2):_ph.a.prototype.dj.call(this)},dh:function(n){var t=this.F;t.C?n.b=_fp.a.i():t.J?n.b=_fp.a.p():_ph.a.prototype.dh.call(this,n)},bh:function(n){var t=this.F;t.C?this.bs(this.cs):t.J?this.bs(this.cr):t.x?this.bs(this.ct):_ph.a.prototype.bh.call(this,n)},cY:function(){_ph.a.prototype.cY.call(this);var i=new _ff.h(_nbs.a.nx,0);var t=new _ff.h(_nbs.a.kH,1);var n=new _ff.h(_nbs.a.GW,2);this.cs=[t];this.cr=[n];this.ct=[i,t,n]}};_r.e=function(n,t,i,r,u,f,e,o,s){this.v=Function.createDelegate(this,this.D);this.u=Function.createDelegate(this,this.A);_r.e.initializeBase(this);this.p=f;this.r=new _fm.i(n,_u.R.dY,_y.d.i(),0,null,null,!1,!1,!1);this.g=new _fm.i(t,_u.R.an,_y.d.g(),0,null,null,!1,!1,!1);this.j=new _fm.i(s,_u.R.OL,null,0,null,null,!1,!1,!1);this.d=new _fm.m(_u.R.eL,this.u,0,null,!1,!1,null,!1);this.h=new _fm.i(o,_u.R.eu,null,0,null,null,!1,!1,!1);this.i=new _fm.i(e,_u.R.dA,null,0,null,null,!1,!1,!1);this.k=new _fm.i(o,_u.R.dW,null,0,null,null,!1,!1,!1);var l=new _fm.d(_u.R.YD,_y.d.m(),i);var a=new _fm.d(_u.R.YD,null,i);var h=new _fm.d(_u.R.GP,null,r);var c=new _fm.d(_u.R.Ba,null,u);this.l=new _fm.p([a,h,c],l)};_r.e.a=function(n,t,i,r,u){t.val=i.val=r.val=u.val=0;for(var e=0;e<n.y.length;e++){var f=n.y[e];f.bs()===4?f.v()?r.val+=1:t.val+=1:f.bq().a()==="Complete"?u.val+=1:i.val+=1}};_r.e.prototype={p:null,q:null,t:null,r:null,g:null,h:null,i:null,k:null,l:null,j:null,d:null,o:0,c:null,n:null,a:null,b:null,f:null,e:!1,m:function(n){if(this.a!==n){this.a=n;this.bk("CommandingBar")}return n},z:function(n){this.f=n.f()},C:function(n,t,i,r){this.n=this.m(new _fm.o);this.a.H(2);this.o=n.y.length;this.z(n);this.q=t;this.a.b(this.r);this.a.b(this.g);this.a.b(this.l);this.a.b(this.j);this.a.b(this.d);this.a.b(this.i);this.a.b(this.k);this.a.b(this.h);this.x(i,n,r);this.e=_g.a.a().c().bh.IsUserCultureRightToLeft},x:function(n,t,i){this.a.q(0);var u=this.e?15:i;var r=this.e?i:15;if(_y.l.isInstanceOfType(this.b)){this.a.S(u);this.a.G(r)}else if(_y.cV.isInstanceOfType(this.b)){var f=this.b;if(f.b()){this.a.S(u);this.a.G(r)}else this.y(n,t)}else this.y(n,t);this.a.q(1)},y:function(n,t){_js.j.a(n,"folder");_js.j.a(t,"selectedItems");this.o=t.y.length;this.z(t);this.l.a(!1);this.g.a(!1);this.j.a(!1);this.d.a(!1);this.i.a(!1);this.h.a(!1);this.k.a(!1);if(t.y.length>0){var u;var f;var i;var r;var s,h,e,o;_r.e.a(t,s={val:u},h={val:f},e={val:i},o={val:r}),u=s.val,f=h.val,i=e.val,r=o.val;this.d.a(!0);this.g.a(!0);f+r!==1||u+i||this.l.a(!0);r+i||this.i.a(!0);u+i+f||this.h.a(!0);u+f+r||this.k.a(!0);n.a()!=="todosearch"&&this.j.a(!0)}},E:function(n,t){this.b=n;if(_y.l.isInstanceOfType(this.b)){var u=this.b;var i=u.h();i.S(this.e?15:t);i.G(this.e?t:15);this.m(i)}else if(_y.cV.isInstanceOfType(this.b)){var r=this.b;r.b()?this.m(r.q(this.d)):this.m(this.n)}else this.m(this.n)},bl:function(){this.a.dispose();_js.u.prototype.bl.call(this)},A:function(n){if(this.c)n(this.w());else{this.t=n;this.q(this.f,this.v)}},w:function(){var n=this.c.a();n.a(this.c.f(this.f),this.f.length,null,!0,this.f);var t=this.c.b();t.c(this.c.b().b);n.h.a(new _fm.j);n.h.a(new _fm.d(_u.R.jB,null,t));n.h.a(new _fm.d(_u.R.Wy,null,this.p));return n},D:function(n){this.c=n;this.t(this.w())}};_r.b=function(n,t,i,r,u,f,e,o,s){this.bj=Function.createDelegate(this,this.bR);this.bh=Function.createDelegate(this,this.bO);this.bk=Function.createDelegate(this,this.bS);this.bl=Function.createDelegate(this,this.bT);this.bg=Function.createDelegate(this,this.bN);this.bm=Function.createDelegate(this,this.bU);this.bf=Function.createDelegate(this,this.bM);this.bo=Function.createDelegate(this,this.bY);this.bn=Function.createDelegate(this,this.bX);this.bi=Function.createDelegate(this,this.bP);this.bq=Function.createDelegate(this,this.cg);this.bp=Function.createDelegate(this,this.cc);this.C=Function.createDelegate(this,this.bH);this.D=Function.createDelegate(this,this.bI);this.F=Function.createDelegate(this,this.bL);this.A=Function.createDelegate(this,this.bv);this.K=Function.createDelegate(this,this.ca);this.J=Function.createDelegate(this,this.bZ);this.L=Function.createDelegate(this,this.cb);this.G=Function.createDelegate(this,this.bQ);this.I=Function.createDelegate(this,this.bV);_r.b.initializeBase(this,[_u.R.Um,e,new _y.g(n.a())]);this.k=n;this.w=i;this.be=r;this.d=t;this.j=u;this.bb=f;this.v=o;this.l=s;this.P=!!o&&o.a().e().Enabled;this.i=!!o&&o.a().f().Enabled;this.M=this.i?40:0;this.N=this.i?25:0;this.Q=this.i?0:65};_r.b.prototype={v:null,bb:null,k:null,w:null,m:null,e:null,c:null,o:null,h:0,be:null,d:null,p:null,x:null,V:!1,t:null,ba:null,R:null,y:null,Z:null,Y:null,U:null,X:null,W:null,S:null,n:null,q:null,z:null,j:null,f:null,g:0,l:null,bd:function(){return"tasks"},bD:function(){return"favicon_tasks.ico"},cd:function(n){if(this.p!==n){this.p=n;this.ea("CategoryManagementDialog")}return n},b:function(n){if(this.h!==n){this.h=n;this.bW();this.ea("PivotSelectedOptionIndex")}return n},br:function(){this.z||(this.z=this.bb.a(this,this.c));return this.z},i:!1,P:!1,M:0,N:0,Q:0,ce:function(n){if(this.g!==n){this.g=n;this.ea("ListViewWidth")}return n},bc:function(){this.bw();this.c.dl(this.w.nameToId("todosearch"));this.c.cz(_g.l.a("todosearch"),null);return this},bv:function(){if(this.c){var n=null;n=this.c.dz?this.c.dz.bh.FolderId:this.c.eu;var t=this;this.d.v(function(i){i.c(function(i){if(i){_a.l.b(_r.b.a,"TasksCompose.New");t.d.cb(n)}})})}},bE:function(){this.m.b&&this.m.a()},ed:function(){this.e.a.rpcl("SelectedTreeNode",this.I);this.d.f().rpcl("Top",this.G);if(this.k.a()==="Mouse"){this.c.rpcl("SelectionState",this.L);this.c.rpcl(this.c.C(),this.d.E);this.c.rpcl("CurrentTableLoaded",this.d.Q);this.c.rpcl("SelectedItem",this.J);this.i&&this.c.rpcl("SelectedItemsCount",this.K)}this.f&&this.f.dispose();_y.dH.prototype.ed.call(this)},bw:function(){this.m=new _C(this.A,_r.b.a);this.q=new _c.bA;this.e=new _d.q(this.H,this.q,this.v);this.c=this.be.j();var n=this.j.b().g(this.w.nameToId("todosearch"));this.br().b(n);this.bF();this.bx();this.bB(this.c);this.bA();this.bG()},bF:function(){this.o=[new _ff.h(_nbs.a.Rk,"All"),new _ff.h(_nbs.a.cU,"TaskActive"),new _ff.h(_nbs.a.RV,"TaskOverdue"),new _ff.h(_nbs.a.ec,"TaskCompleted")];this.h=1;var i=this,n=this,t=this;this.X=new(_d.bo.$$(Number))(this.h,function(n){return i.h===n},function(){n.cf();return n.h},function(n){t.b(n)});return this.o},bB:function(n){var f=this,u=this;n.bn(this.F,this.A,this.D,function(){},this.C,function(){});n.cI=new _C(this.bp,_r.b.a);n.Y(this.o[this.h].a);if(this.k.a()==="Mouse"){n.fb=1;n.bt(2);n.apcl("SelectionState",this.L);n.apcl(n.C(),this.d.E);n.apcl("CurrentTableLoaded",this.d.Q);n.apcl("SelectedItem",this.J);this.i&&n.apcl("SelectedItemsCount",this.K);if(this.k.a()==="Mouse"){this.g=this.j.b().D().a;this.g===-1&&(this.g=350)}}var t=this,i=this,r=this;this.W=new(_d.bo.$$(_a.bP))(null,function(n){return t.c.dH||t.c.w()===1?t.c.dy.y.length>=2?!1:t.c.dH===n:!0},function(){i.bs(i.c);return i.c.dH},function(n){r.c.m(n)})},bA:function(){this.q.k();this.e.e=new _C(this.F,_r.b.a);this.e.g(_y.c.a.a()==="Mouse");this.n=new _d.L(this.q,this.v);this.e.k();this.e.a.apcl("SelectedTreeNode",this.I);var i=this,n=this,t=this;this.S=new(_d.bo.$$(_d.l))(null,function(n){return i.e.a.a===n},function(){var t=n.e.a.c();if(t){n.c.cz(t,null);n.r()}return n.e.a.a},function(n){t.e.a.q(n);t.e.a.a.p(!0)})},bx:function(){this.x=new _C(this.C,_r.b.a)},bH:function(){if(this.k.a()==="Mouse"){this.by();this.p.I()}},by:function(){if(!this.V){this.cd(new _y.W(this.j.f(),this.bq));this.V=!0}},bz:function(){if(this.i){this.f=new _r.e(this.m,this.t,this.Z,this.Y,this.U,this.x,this.c.bT,this.c.eZ,this.y);this.f.C(this.c.dy,this.c.kA,this.c.dz,this.g);var n=this;this.apcl("ListViewWidth",function(t,i){n.r()})}},cg:function(n,t,i){var r=new _h.bT(n,t,i,null);var u=this;r.w(function(){u.j.f().c(r.b)});OwaApplication.a.a(r)},bG:function(){var n=this;this.d.v(function(t){t.k(n.bi);t.m(n.bn);t.n(n.bo);n.t=new _C(n.bf,_r.b.a);n.ba=new _C(n.bm,_r.b.a);n.R=new _C(n.bg,_r.b.a);n.y=new _C(n.D,_r.b.a);n.Z=new _C(n.bl,_r.b.a);n.Y=new _C(n.bk,_r.b.a);n.U=new _C(n.bh,_r.b.a);t.t(n.x);n.d.x().f(!0);n.d.x().d(n.ba,n.t,n.R,n.y,null,null,null,null);n.bz();n.d.f().apcl("Top",n.G);n.d.f().o=n.bj})},bR:function(n){this.f&&_y.l.isInstanceOfType(n)&&n.m(!0)},bQ:function(n,t){this.bu()},bL:function(){switch(this.k.a()){case"Mouse":case"TouchWide":this.e.g(!this.e.b);break;case"TouchNarrow":throw Error.notImplemented();}},bV:function(n,t){var i=this;this.d.v(function(n){i.S.e(n)})},bZ:function(n,t){this.bt();this.r()},bt:function(){var n=this;this.d.v(function(t){n.W.e(t)})},ca:function(n,t){this.r()},r:function(){this.f&&this.f.x(this.c.dz,this.c.dy,this.g)},bu:function(){if(this.f){this.f.E(this.d.f().a(),this.g);this.r()}},bs:function(n){if(this.c.dH)this.d.z(this.c.dH);else{this.c.dw.a().y.length||this.c.X(1);this.d.Y(n)}},cb:function(n,t){this.bt()},bP:function(n,t){t&&this.c.dw.bc();this.bs(this.c)},bX:function(n,t){this.c&&this.c.eI.a()},bY:function(n,t){this.bu()},bW:function(){if(this.c){var n=this;this.d.v(function(t){n.X.e(t)})}},cf:function(){if(this.c){var n=this.o[this.h].a;if(n!==this.c.ex){this.c.Y(n);this.c.U(2)}}},bM:function(){this.c&&this.c.eI.a()},bU:function(){this.c&&this.c.hA.a()},bN:function(){this.c&&this.c.bT.a()},bI:function(){var n=this;this.d.v(function(t){t.c(function(t){t&&n.bJ()})})},bJ:function(){if(this.c.dz.a()!=="todosearch"&&this.e.a.a){var n=this;var t=new _C(function(){if(n.n.a.c()){n.c.y(n.n.a.c().bh.FolderId);n.bK()}},_r.b.a);this.n.A(t,this.c.dy.y.length===1?_u.R.UF:String.format(_u.R.k,this.c.dy.y.length),_u.R.JA,this.c.dz.bh.FolderId)}},bK:function(){this.c.hv.a()},cc:function(){var n=this;this.d.v(function(n){n.r()})},a:function(n){var t=this.j.b().g(this.c.dz.bh.FolderId);t.k(n.b().a());t.l(n.a()==="Ascending"?0:1);this.j.b().E(t);_h.h.a(this.j.b().c(),OwaApplication.a);this.H.a(_h.bN,new _h.bN(this.c.dz))},bT:function(){if(this.c.dy.y.length!==1)throw Error.invalidOperation("OnReplyToSelectedItem should only be called in date view single selection");if(this.d.d()&&this.d.d().a()&&this.d.d().a().d()){var n=this.d.d().a().d();n.g()?n.e.a():this.l.a(0,String.format(_u.R.Gx,_u.R.YD),null)}},bS:function(){if(this.c.dy.y.length!==1)throw Error.invalidOperation("OnReplyAllToSelectedItem should only be called in date view single selection");if(this.d.d()&&this.d.d().a()&&this.d.d().a().d()){var n=this.d.d().a().d();n.f()?n.c.a():this.l.a(0,String.format(_u.R.Gx,_u.R.GP),null)}},bO:function(){if(this.c.dy.y.length!==1)throw Error.invalidOperation("OnForwardSelectedItem should only be called in date view single selection");if(this.d.d()&&this.d.d().a()&&this.d.d().a().d()){var n=this.d.d().a().d();n.h()?n.b.a():this.l.a(0,String.format(_u.R.Gx,_u.R.Ba),null)}}};_r.d=function(n,t,i,r,u,f,e,o,s,h,c){_r.d.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_r.d.prototype={m:!1,n:!1,q:!1,o:!1,p:!1,r:function(){var n=new _r.f(this.h,this.g,this.d,this.b,this.i,this.l,this.j,this.e,this.f,this.c,this.k,!1);n.dm(this.m,this.n,this.q,this.o,this.p);return n},a:function(n,t,i,r,u){this.m=n;this.n=t;this.q=i;this.o=r;this.p=u}};_r.a=function(n,t,i,r,u,f){this.n=Function.createDelegate(this,this.q);this.j=n;this.e=t;this.k=i;this.h=r;this.g=u;this.m=f;this.r()};_r.a.d=function(){if(!_r.a.a){_r.a.a={};_r.a.a[_d.a.toString(0)]=_nbs.a.Qh;_r.a.a[_d.a.toString(1)]=_nbs.a.t;_r.a.a[_d.a.toString(2)]=_nbs.a.t;_r.a.a[_d.a.toString(3)]=_nbs.a.Qh;_r.a.a[_d.a.toString(4)]=_nbs.a.fn;_r.a.a[_d.a.toString(6)]=_nbs.a.IO;_r.a.a[_d.a.toString(5)]=_nbs.a.NS;_r.a.a[_d.a.toString(7)]=_nbs.a.y;_r.a.a[_d.a.toString(8)]=_nbs.a.MR;_r.a.a[_d.a.toString(9)]=_nbs.a.jS;_r.a.a[_d.a.toString(10)]=_nbs.a.jS;_r.a.a[_d.a.toString(11)]=_nbs.a.jS}return _r.a.a};_r.a.prototype={j:null,e:null,k:null,d:null,c:!1,f:0,l:null,i:!1,h:null,g:null,m:null,b:function(n,t,i){return this.o()},a:function(n,t,i){return this.o()},p:function(n,t,i){this.s(this.e,i);var r=new _d.by(this.j,this.e,this.k,n,t,this.c,this.h,this.g,this.m,this.i);r.a(this.n);return r},o:function(){return this.p(_d.I.b(this.d),this.l,this.f)},q:function(n){var i=new _js.f;!this.c&&n.y.length>1?i.a(n.y[0]):i=n;var r={};r.Properties=_d.I.d(i);var t=window.dialogArguments;if($a(t)){t=window.top.dialogArguments;$a(t)&&!$a(_ph.f.a())&&(t=_ph.f.a().dialogArguments);if(!$a(t)){t.value=JsonParser.serialize(r);$a(t.callback)||t.callback()}}else{t.value=JsonParser.serialize(r);window.close()}},s:function(n,t){switch(t){case 3:case 9:n.a(!1,!1,!0,!1);break;case 4:n.a(!1,!0,!1,!1,!0);break;case 6:case 10:n.a(!1,!0,!0,!1);break;case 5:case 7:case 8:n.a(!1,!0,!1,!1);break;case 11:case 0:case 1:case 2:default:n.a(!1,!1,!1,!1);break}},r:function(){window.resizeTo(_r.a.c,_r.a.b);window.moveTo(window.screen.width/2-_r.a.c/2,window.screen.height/2-_r.a.b/2);var n=window.dialogArguments;if($a(n)){n=window.top.dialogArguments;$a(n)&&!$a(_ph.f.a())&&(n=_ph.f.a().dialogArguments);this.i=!$a(n)}if(!$a(n)){this.d=JsonParser.deserialize(n.value);var t=JsonParser.deserialize(this.d.Metadata);this.f=t.PickerCallerType;this.l=_r.a.d()[_d.a.toString(this.f)];this.c=t.AllowMultipleSelection}}};ApplicationViewModelsComponent.registerClass("ApplicationViewModelsComponent",null,_a.ih);_r.c.registerClass("_r.c",_a.bx);_r.BposDiagnosticsViewModelFactory.registerClass("_r.BposDiagnosticsViewModelFactory",null,_bc.bf);_r.f.registerClass("_r.f",_ph.q);_r.e.registerClass("_r.e",_js.u);_r.b.registerClass("_r.b",_y.dH,ITasksModuleViewModel);_r.d.registerClass("_r.d",_ph.S);_r.a.registerClass("_r.a",null,IOwaOptionRichPeoplePickerViewModelFactory,_bc.bf);ApplicationViewModelsComponent.$$cctor();_r.e.b=_a.a.bv;_r.b.a=_a.a.bv;_r.a.c=1200;_r.a.b=700;_r.a.a=null;
window.scriptsLoaded['microsoft.owa.application.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.application.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
