try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.be=function(n,t,i,r){_at.be.initializeBase(this);this.b=n;this.e=t;this.c=i;this.d=r};_at.be.prototype={e:null,c:null,d:null,b:null,f:null,u:function(n){var t=new _gg.ql(this.x);n.bc(this.b,this.e,this.c,this.d,t,this.r,this.q)},cy:function(n,t,i){try{_a.b.c(n,"result");this.f=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.r.a().a(AttachmentsComponent)};AttachmentsComponent.prototype={a:function(n,t,i){if(t.a()){var o=this;n.b(_at.u,function(){var t=_bc.k.isInstanceOfType(_g.j.a)?_g.j.a:null;return new _at.d(n.a(_a.w),t?t.d().j():null,t?t.j():null)}).a()}else{var s=this;n.b(_at.u,function(){return new _at.bb}).a()}var h=this;n.b(IAttachmentViewModelFactory,function(){return new _at.W(n.a(IInferenceTracker),n.a(_y.a),n.a(_at.u),n.a(_a.e),n.a(_a.w),n.d(IAttachmentProviderItemViewModelFactory),n.a(_a.f),n.d(IAttachmentPreviewViewModelFactory),n.d(IItemStoreGetterFactory),n.a(IUriFileAttachmentViewModelFactory),n.c(ISmimeCommandFactory),n.a(_a.bG),n.a(_a.s),n.a(_a.cE),n.a(_at.r),n.a(_g.a).bh.AttachmentPolicy,n.c(IImportCalendarEventViewModelFactory),n.a(_ff.c),n.a(_at.n))}).a();var e=this;n.b(_at.H,function(){return new _at.H(n.a(_a.cE),n.a(_a.s),n.a(IInferenceTracker),n.a(_a.f),n.d(IAttachmentPreviewViewModelFactory),n.d(IItemStoreGetterFactory),n.c(ISmimeCommandFactory),n.a(_a.bG),n.a(_g.a).bh.AttachmentPolicy,n.a(_a.w),n.c(IImportCalendarEventViewModelFactory),n.a(_ff.c),n.a(_at.n))}).b(IUriFileAttachmentViewModelFactory).a();var r=this;n.b(_at.r,function(){return new _at.r(n.a(_a.f).a().bU().Enabled,n.a(_g.a).i().bh.DownloadTokenRefreshMinutes,n.a(_g.a).i().bh.DownloadUrlBase,n.a(_g.a).c().bh.UserEmailAddress,n.a(_g.a).i().bh.FirstDownloadToken,n.a(_a.s))}).b(IAttachmentDownloadUrlFactory).a();var u=this;n.b(_at.n,function(){return new _at.n(i.c())}).a();var f=this;n.b(_at.s,function(){return new _at.s}).b(IFileReader)},b:function(){return null}};_at.q=function(n){this.i=Function.createDelegate(this,this.w);_at.q.initializeBase(this,[n])};_at.q.prototype={b:null,c:0,j:!1,f:!1,o:function(n){if(this.f!==n){this.f=n;this.bk("ImageLoadSucceeded")}return n},n:function(n){if(n!==this.b){this.b=n;this.k()}return n},p:function(n){if(n!==this.c){this.c=n;this.k()}return n},h:function(n){this.y.unbind("error",this.e);this.a(_y.c.a.p(_y.d.a().b));this.u();this.j=!0},T:function(){_b.Y.prototype.T.call(this);this.y.bind("load",this.i);this.k();this.t()},bl:function(){this.y.unbind("load",this.i);_js.c.prototype.bl.call(this)},w:function(n){this.o(!this.j)},t:function(){var t=_a.d.b(_a.a.c,"AttachmentExternalImage");var n=new _a.q;n.c("L",!0);this.b?n.c("U",this.b.b):n.c("N",!0);t.j=n.toString();_a.d.a(t)},u:function(){var t=_a.d.b(_a.a.c,"AttachmentExternalImage");var n=new _a.q;n.c("E",!0);this.b?n.c("U",this.b.b):n.c("N",!0);t.j=n.toString();_a.d.a(t)},k:function(){if(this.b&&this.c){this.a(this.b.a);this.v(this.x)}},v:function(n){var f=n;if(_at.q.a){f=window.document.createElement("img");f.src=n.src}var i=f.naturalHeight;i||(i=f.height);var r=f.naturalWidth;r||(r=f.width);i||(i=this.b.c);r||(r=this.b.d);if(!i||!r){_js.Trace.logWarning(_a.a.c,"Stopping processing image since either imageHeight or width is 0");return}var y=0;var c=1;var w=0;var p=1;var t=this.b.e;if(t&&t.b()>=4)if(t.a(0)<t.a(2)&&t.a(1)<t.a(3)){_js.Trace.logInfo(_a.a.c,"Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));var h=255;y=t.a(0)/h;w=t.a(1)/h;c=t.a(2)/h;p=t.a(3)/h}else _js.Trace.logWarning(_a.a.c,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));else _js.Trace.logWarning(_a.a.c,"Using default value as the salient regions");var g=r/i;var o;var s;var b,l;_at.A.a(this.c,b={val:s},l={val:o}),s=b.val,o=l.val;var nt=o/s;var e;var a=0,v=0;if(g>nt){e=s/i;a=this.m(e,r,o,(w+p)/2)}else{e=o/r;v=this.m(e,i,s,(y+c)/2)}var tt=Math.round(r*e);var it=Math.round(i*e);var k=a*-1;var d=v*-1;var u={};u.width=tt.toString()+"px";u.height=it.toString()+"px";u.top=d.toString()+"px";u[_fc.l.a()]=k.toString()+"px";this.x.style.cssText="width: "+u.width+"; "+"height"+": "+u.height+"; "+"top"+": "+u.top+"; "+_fc.l.a()+": "+u[_fc.l.a()]+"; "+"position"+": "+"absolute"+";"},m:function(n,t,i,r){var o=.5;var e=t*n;var u=(e-i)/e;var f;f=r-o>=u/2?Math.round(e*u):o-r>=u/2?0:Math.round((r-o+u/2)*e);return f}};_at.A=function(){};_at.A.a=function(n,t,i){switch(n){case 2:i.val=120;t.val=90;break;case 3:i.val=160;t.val=120;break;case 4:i.val=200;t.val=150;break;default:i.val=50;t.val=50;break}};_at.B=function(n){_at.B.initializeBase(this,[n])};_at.B.prototype={J:function(){_js.c.prototype.J.call(this);var n=this.E();if(n&&n.Y&&n.eW()){var i=_a.bh.a(n.Y.bh.Name).replace(".","");var t=SuiteExtensionsControlFactory.CreateControl(i,0);t.Render(this.x)}}};_at.c=function(n){this.bb=Function.createDelegate(this,this.bo);this.Z=Function.createDelegate(this,this.bx);this.bg=Function.createDelegate(this,this.bL);this.bh=Function.createDelegate(this,this.bN);this.bd=Function.createDelegate(this,this.bC);_at.c.initializeBase(this,[n]);this.a("about:blank");this.C(-1);this.y.load(this.bd)};_at.c.prototype={b:null,c:null,e:0,m:!1,h:null,g:0,j:null,k:!1,q:null,l:function(){return this.ec(_at.c.c)},u:function(n){this.eb(_at.c.c,n);return n},i:function(){return this.ec(_at.c.e)},z:function(n){this.eb(_at.c.e,n);return n},w:function(n){n||(this.e=-1);this.eb(_at.c.g,n);return n},by:function(){return this.ec(_at.c.d)},v:function(n){this.eb(_at.c.d,n);return n},r:function(){return this.ec(_at.c.b)},F:function(n){this.eb(_at.c.b,n);return n},bp:function(n){if(this.q===n)return n;this.q=n;this.bk("UploadAndShareAttachmentCommand");return n},bA:function(){return this.ec(_at.c.f)},K:function(n){this.eb(_at.c.f,n);return n},o:function(n){this.h=n;this.bk("Error");return n},n:function(n){this.g=n;this.bk("AttachmentError");return n},p:function(n){this.j=n;this.bk("SuccessResponse");return n},Q:function(){_js.c.prototype.Q.call(this);this.eb(_at.c.b,new _C(this.bh,_at.c.a));this.bp(new _C(this.bg,_at.c.a))},bC:function(n){if(this.e){if(this.e===2){_js.Trace.logInfo(_at.c.a,"Response received.");var t="";try{t=this.y[0].contentWindow.document.body.innerText}catch(u){if(!(_a.UserAgent.getInstance().E&&u.number===-2146828218)){_js.Trace.logException(_at.c.a,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.m)_js.d.a(t)&&this.t(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.i.c(t,this.l(),this.i(),_g.j.a,function(n){_js.Trace.logInfo(_at.c.a,"HandleCreateAttachmentResponse completed.");r.t(n,null,0)},function(n,t){_js.Trace.logInfo(_at.c.a,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.l().b()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.h.d(t)||_at.h.a(n);i.t(null,f,r)})}}}else{_js.Trace.logInfo(_at.c.a,"Initializing.");this.e=1;this.bH();_js.g.a().a(_at.c.a,"ExecuteOpenFilePicker",this.Z,0)}},t:function(n,t,i){this.p(n);this.o(t);this.n(i);this.e=3;this.bA().a();this.k=!1},bH:function(){var n=this.y[0];n.contentWindow.document.body.innerHTML="";this.b=n.contentWindow.document.createElement("form");this.b.method="POST";this.b.encType="multipart/form-data";this.b.encoding="multipart/form-data";this.bs(this.b);this.c=$(n.contentWindow.document.createElement("input"));this.c.attr("type","file");this.c.attr("name","fileInput");var t=this;this.c.change(function(n){t.bo()});_a.UserAgent.getInstance().E&&this.c[0].attachEvent("onchange",this.bb);this.b.appendChild(this.c[0])},bs:function(n){this.y[0].contentWindow.document.body.appendChild(n)},bo:function(){if(!this.k){this.k=!0;var n=this.c[0].value;if(!_js.d.a(n)){this.l().e(this.bI(n));this.by().a()}}},bI:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},bx:function(){this.c[0].click()},bN:function(){this.m=!1;this.b.action=_g.S.f();this.bm()},bL:function(){this.m=!0;this.b.action=_g.S.j();this.f("subscriptionId",this.E().m());this.bm()},bm:function(){_js.Trace.logInfo(_at.c.a,"Uploading attachment via form submit.");this.f("parentItemId",this.i().Id);this.f("parentChangeKey",this.i().ChangeKey);this.f("isInline",this.l().b().toString());this.f("cancellationId",this.E().br());this.f(_a.x.c(),_a.x.d());this.b.submit();this.e=2},f:function(n,t){var i=$(this.b.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.b.appendChild(i[0])}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.bg=function(){};_at.U=function(){_at.U.initializeBase(this)};_at.U.prototype={u:function(n){var t=new _gg.tl(this.x);n.ef(t,this.r,this.q)},cy:function(n,t,i){_js.d.b(n)?i(Error.create("Download token is missing or empty.")):t()}};_at.r=function(n,t,i,r,u,f){this.i=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.j);this.c=i;this.e=r;this.d=u;this.g=f;this.f=n&&!_js.d.b(this.c)&&!_js.d.b(this.e)&&!_js.d.b(this.d);t<1&&(t=1);if(this.f){this.j();_js.g.a().e(_at.r.a,"AttachmentDownloadUrlFactory",this.h,6e4*t)}};_at.r.prototype={f:!1,c:null,e:null,g:null,d:null,j:function(){var n=new _at.U;n.w(this.i);this.g.a(n)},k:function(n){this.d=n.A},a:function(n,t,i){if(!n||!n.Id||n.Id.startsWith("smime-"))return null;i||(i=_g.S.a());var r=String.format(i,encodeURIComponent(n.Id));t&&(r+=_g.S.d());if(!this.f)return r;if(_js.d.a(this.c)){_js.Trace.logError(_at.r.a,"Attachment download URL is not properly configured.");return r}var u;u=_a.bU.a()?this.c+r+"&token="+this.d:this.c+this.e+"/"+r+"&token="+this.d;return u},b:function(n,t){return String.format(_g.S.n(),n,t)}};_at.f=function(n,t){this.c=n||_at.f.g();this.e=t;this.d=this.e?this.c.DirectFileAccessOnPublicComputersEnabled:this.c.DirectFileAccessOnPrivateComputersEnabled;if(this.d){this.f=_at.f.d(this.c.BlockedFileTypes,this.c.ForceSaveFileTypes,this.c.AllowedFileTypes);this.g=_at.f.d(this.c.BlockedMimeTypes,this.c.ForceSaveMimeTypes,this.c.AllowedMimeTypes)}this.h=_at.f.f(this.c.ActionForUnknownFileAndMIMETypes)};_at.f.a=function(){_at.f.b||(_at.f.b=new _at.f(_g.a.a().bh.AttachmentPolicy,_g.a.a().X()));return _at.f.b};_at.f.f=function(n){var t;try{t=_js.l.a(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.f.d=function(n,t,i){var r={};_at.f.c(r,i,3);_at.f.c(r,t,2);_at.f.c(r,n,1);return r};_at.f.c=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.f.g=function(){var n=new _g.gn;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true}')};_at.f.e=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.f.prototype={e:!1,d:!1,h:0,c:null,f:null,g:null,b:function(){return $a(this.c.WacEditableFileTypes)?0:this.c.WacEditableFileTypes.length},a:function(n,t,i,r){$a(i)&&(i=!0);$a(n)||(n=n.toLowerCase());var f;f=this.d?this.i(n,t):1;var u=!1;var o=!1;var e=!1;if(i&&!r){this.k(n)&&(u=!0);o=this.j(this.e,u);u&&this.c.WacEditableFileTypes&&n&&(e=_at.f.e(this.c.WacEditableFileTypes,n))}return new _at.E(this.d,f,u,o,e)},i:function(n,t){var r=this.f[n]||0;if(r===1)return 1;var i=this.g[t]||0;return i===1?1:r===2||i===2?2:r===3||i===3?3:this.h},k:function(n){var t=this.e?this.c.WacViewingOnPublicComputersEnabled:this.c.WacViewingOnPrivateComputersEnabled;return t&&this.l(n)},j:function(n,t){return t?n?this.c.ForceWacViewingFirstOnPublicComputers:this.c.ForceWacViewingFirstOnPrivateComputers:!1},l:function(n){return _at.f.e(this.c.WacViewableFileTypes,n)}};_at.E=function(n,t,i,r,u){!n;this.d=n;this.b=t;this.a=i;this.e=r;this.c=u};_at.E.prototype={b:0,d:!1,e:!1,a:!1,c:!1,toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, ForceBrowserView: {3}, WacEdit: {4}",this.b,this.d,this.a,this.e,this.c)}};_at.s=function(){this.g=new FileReader};_at.s.prototype={g:null,h:null,c:function(){return this.g.error},d:function(){return this.h},b:function(){return this.g.result},f:function(n){this.g.onloadend=n;return n},e:function(n){if(_h.cH.isInstanceOfType(n)){var i=n;this.g.readAsDataURL(i.d)}else if(_h.bb.isInstanceOfType(n)){var t=n;this.g.readAsDataURL(t.g)}},a:function(n,t,i,r,u){var f=this;this.g.onloadend=function(){if(!f.g.error&&f.g.result){var l=f.g.result.indexOf(",");var c=f.g.result.substring(l+1,f.g.result.length);var h=null;var e=0,o=0;if(u&&f.g.result.length>10&&f.g.result.substring(0,10)==="data:image")try{var s=document.createElement("canvas");var a=s.getContext("2d");var n=new Image;n.src=f.g.result;if(n.height<n.width){o=50;n.height&&(e=o*n.width/n.height)}else{e=50;n.width&&(o=e*n.height/n.width)}_js.Trace.logInfo(r,"Attachments canvas width={0}, height={1}",e,o);if(e&&o){s.width=e;s.height=o;a.drawImage(n,0,0,e,o);h=s.toDataURL()}}catch(v){_js.Trace.logError(r,"Failed to get thumbnail with error {0}, ",v)}_js.Trace.logInfo(r,"No error - Reading the file.");f.g.result.substring(0,l).indexOf("base64")!==-1?t(c,h,e,o):t(_a.be.b(c),h,e,o)}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",f.g.error);i()}};try{this.e(n)}catch(e){this.h=e;_a.UserAgent.getInstance().F&&e.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",e.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+e.message);i()}}};_at.F=function(){};_at.F.prototype={a:function(){return new _at.s}};_at.l=function(){this.a={}};_at.l.a=function(){_at.l.b||(_at.l.b=new _at.l);return _at.l.b};_at.l.prototype={b:!0,c:function(n,t){this.a[n]=t;if(this.b){var i=this;_js.g.a().a(_a.a.c,"WacAttachmentTypeCache.ClearCacheItems",function(){i.e();i.b=!0},36e5);this.b=!1}},e:function(){this.a={}},d:function(n){return n in this.a?this.a[n]:null}};_at.J=function(n){_at.J.initializeBase(this);this.b=n};_at.J.prototype={b:null,u:function(n){var t=new _gg.pn(this.x);n.U(this.b,t,this.r,this.q)},cy:function(n,t,i){n?t():i(null)}};_at.K=function(n){_at.K.initializeBase(this);this.b=new _gg.gN;this.b.cancellationId=n};_at.K.prototype={b:null,u:function(n){var t=new _gg.pr(this.x);n.V(this.b,t,this.r,this.q)},cy:function(n,t,i){n?t():i(null)}};_at.L=function(n){_at.L.initializeBase(this);this.b=new _gg.gO;this.b.cancellationId=n};_at.L.prototype={b:null,u:function(n){var t=new _gg.ps(this.x);n.W(this.b,t,this.r,this.q)},cy:function(n,t,i){n?t():i(null)}};_at.M=function(n){_at.M.initializeBase(this);this.b=n};_at.M.prototype={b:null,u:function(n){var t=new _gg.pt(this.x);n.dj(this.b,t,this.r,this.q)},cy:function(n,t,i){n?t():i(null)}};_at.N=function(n,t,i,r){_at.N.initializeBase(this);this.c=new _gg.gU;this.c.subscriptionId=i;this.c.ewsAttachmentId=n;this.c.itemId=t;this.c.channelId=_a.V.a;this.c.cancellationId=r;this.b=n.Id};_at.N.prototype={c:null,b:null,u:function(n){var t=new _gg.qc(this.x);n.Y(this.c,t,this.r,this.q)},cy:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.O=function(n,t,i,r,u){_at.O.initializeBase(this);this.b=new _gg.gV;this.b.ewsAttachmentId=n.Id;this.b.emailId=t;this.b.subscriptionId=i;this.b.channelId=_a.V.a;this.b.cancellationId=u;this.b.fullPathLocation=r;this.c=n.Id};_at.O.prototype={b:null,c:null,u:function(n){var t=new _gg.qd(this.x);n.Z(this.b,t,this.r,this.q)},cy:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.i=function(n,t,i,r,u,f,e,o){_at.i.initializeBase(this);this.d=n;this.c=t;this.f=i;this.i=r;this.h=e;this.b=o;this.e=u;this.g=f};_at.i.c=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.i.a,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.g(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.i(e.Size||0);t.j(e.ContentType);t.b()&&t.m(e.ContentId);u(o)}}else{_js.Trace.logError(_at.i.a,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.i.a,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_js.Trace.logError(_at.i.a,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.i.b=function(n,t,i,r){n.Attachments.length>0&&t.g(n.Attachments[0].AttachmentId);if(!n.IsCancelled&&r){t.b()&&t.m(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.i(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}};_at.i.prototype={g:!1,d:0,c:null,f:null,j:null,i:null,h:0,b:0,e:null,n:function(){if(this.t||!this.E||!this.E.response){_js.Trace.logInfo(_at.i.a,"No success response because there's an error, or action is not complete.  Error: {0}",this.t);return null}return this.E.response.result},u:function(n){this.j=this.l();if(this.i){var t=new _gg.qk(this.x);this.g&&(t.explicitLogonUser=this.e);t.clientStoreItem=this.d;t.isQueued=!1;t.palContext=new _g.fE(!1);n.bb(this.j,t,this.r,this.q)}else{var i=new _gg.mM(this.x);this.g&&(i.explicitLogonUser=this.e);i.clientStoreItem=this.d;i.isQueued=!1;i.palContext=new _g.fE(!1);n.c(this.j,i,this.r,this.q)}},cp:function(n){this.m(n)},m:function(n){_at.i.b(n,this.c,this.f,this.b<=this.h+1)},l:function(){var i=new _g.g(this.f.Id);i.ChangeKey=this.f.ChangeKey;var t=this.c.w();var n=new _gg.eo(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.i;if(this.b!==1){n.SliceNumber=this.h;n.TotalSlices=this.b}return new _gg.en(this.y(),n)}};_at.P=function(n,t,i,r,u,f){_at.P.initializeBase(this,[n,t,i,r,u,f,0,1]);var e=t.c;this.k=e};_at.P.prototype={k:null,u:function(n){var u=this.l();var t=new _gg.mM(this.x);this.g&&(t.explicitLogonUser=this.e);t.clientStoreItem=this.d;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.fE(!0);t.dataFile=this.k.h();n.c(u,t,this.r,this.q)},cp:function(n){this.m(n)}};_at.Q=function(n,t,i){_at.Q.initializeBase(this);this.e=n;this.c=t;this.b=i;this.d=t.bh.AttachmentId||t.bh.TemporaryId};_at.Q.prototype={e:0,c:null,d:null,b:null,cp:function(n){this.b.Id=n.RootItemId.RootItemId;this.b.ChangeKey=n.RootItemId.RootItemChangeKey;this.c.bh.TemporaryId&&this.c.g(this.c.bh.TemporaryId)},u:function(n){var r=new _gg.es;r.ClientSupportsIrm=!0;var i=new _gg.qW(this.x);i.itemContexts=new Array(1);var t=new _gg.GW;t.clientStoreItem=this.e;t.parentItemId=new _g.g(this.b.Id);t.parentItemId.ChangeKey=this.b.ChangeKey;r.AttachmentIds=[new _g.by(this.d.Id)];var u=new _gg.hg(this.y());u.Body=r;i.itemContexts[0]=t;n.n(u,i,this.r,this.q)}};_at.R=function(n){_at.R.initializeBase(this);this.c=n};_at.R.prototype={c:null,b:null,u:function(n){var t=new _gg.sX(this.x);n.bq(this.c,t,this.r,this.q)},cy:function(n,t,i){if(_js.d.b(n))i(Error.create("AddIns is null or empty."));else{this.b=n;t()}}};_at.v=function(n,t){_at.v.initializeBase(this);this.b=_a.d.b(_at.v.a,"DownloadAttachment");this.d=n;this.e=t};_at.v.prototype={d:null,c:null,b:null,e:!1,u:function(n){var i=new _g.jL(this.x);var t=new _gg.id(this.y());t.Body.AttachmentIds=[new _g.by(this.d)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.b.W();if(this.e){t.Header.ManagementRole=new _g.dQ;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.bs(t,i,this.r,this.q)},cp:function(n){var t=null;var u=n.Attachments.length;u!==1&&(t="GetAttachment response length = "+u);var r=n.Attachments[0];r||(t="GetAttachment response contained null attachment");var i=_a.i.b(_g.x,r);this.c=i.t();this.c||(t="GetAttachment response contained null item");t?_js.Trace.logWarning(_a.a.c,t):_js.Trace.logInfo(_a.a.c,"GetAttachment succeeded for '{0}' on '{1}'",i.bh.Name,this.c.bh.Subject);if(this.b){this.b.k=this.D();this.b.m=t}_a.d.a(this.b);this.b=null}};_at.S=function(n,t){_at.S.initializeBase(this);this.c=n;this.b=t;this.d=t.bh.AttachmentId||t.bh.TemporaryId;if(!_g.m.isInstanceOfType(t)&&!_g.x.isInstanceOfType(t)&&!_g.z.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.S.prototype={c:null,b:null,d:null,O:function(){if(_g.m.isInstanceOfType(this.b)){var n=this.b;if(_a.fz.isInstanceOfType(n.c)){var u=n.c;var r=new _at.F;var f=r.a();var t=this,i=this;f.a(u,function(i,r,u,f){n.q(t.e(i));t.J(null)},function(){var t=String.format("Unable to read content of file {0}.",n.bh.Name);_js.Trace.logWarning(i.c,t);i.J(Error.create(t))},this.c,!1);return 1}else return this.f()}else return _g.x.isInstanceOfType(this.b)?this.f():_h.fK.prototype.O.call(this)},cy:function(n,t,i){var r=this.b;if(_js.d.a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.bh.ItemId.Id)));else{r.A(this.e(n));t()}},u:function(n){var t=new _g.g(this.b.bh.ItemId.Id);n.bQ(t,null,this.r,this.q)},f:function(){var t=new XMLhttpsRequest;var i=String.format(_g.x.isInstanceOfType(this.b)?_g.S.a():_g.S.e(),encodeURIComponent(this.d.Id));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.e(t.responseText);_g.m.isInstanceOfType(n.b)?n.b.q(r):_g.x.isInstanceOfType(n.b)&&n.b.q(r);n.J(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.d.Id,t.responseText,t.statusText);_js.Trace.logError(n.c,i);n.J(Error.create(i))}};t.open("GET",i,!0);_a.j.K(t);t.send(null);return 1},e:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};_at.m=function(n){_at.m.initializeBase(this);this.b=n};_at.m.b=function(n){if(_js.d.a(n)){_js.Trace.logInfo(_a.a.c,"An invalid identifier was passed in as an argument.");return null}return!_at.m.a||!(n in _at.m.a)?null:_at.m.a[n]};_at.m.prototype={b:null,c:null,u:function(n){var t=new _gg.tj(this.x);t.explicitLogonUser=this.b;n.bw(t,this.r,this.q)},cy:function(n,t,i){var r=this.b||"PersonalOneDriveKey";_at.m.a||(_at.m.a={});_at.m.a[r]=n;this.c=n;t()}};_at.g=function(n){_at.g.initializeBase(this);this.c=n};_at.g.d=function(n){var t=_at.g.b(n);return t?t.FolderName:null};_at.g.c=function(n){var t=_at.g.b(n);return t?t.FolderId:null};_at.g.b=function(n){if(_js.d.a(n)){_js.Trace.logInfo(_a.a.c,"An invalid key was passed in as an argument.");return null}if(!_at.g.a||!(n in _at.g.a)){_js.Trace.logInfo(_a.a.c,String.format("No response objects were cached with the given key: {0}",n));return null}return _at.g.a[n]};_at.g.prototype={c:null,d:null,b:null,u:function(n){var t=new _gg.tk(this.x);t.explicitLogonUser=this.c;n.bx(t,this.r,this.q)},cy:function(n,t,i){if(!n){i(Error.create("Failed to get valid properties of the default upload folder."));return}var r=this.c||"PersonalOneDriveKey";_at.g.a||(_at.g.a={});this.b=n.FolderName;this.d=n.FolderId;_at.g.a[r]=n;t()}};_at.T=function(n,t,i,r,u,f,e,o){_at.T.initializeBase(this,[n,t,i,r,u,f,e]);this.b="GetSuiteExtensionsAttachmentInfo";this.k=_js.d.b(o)?null:o};_at.T.prototype={k:null,u:function(n){var t=new _gg.tm(this.x);switch(this.i){case 0:this.b+="ClasicReadingPane";break;case 1:this.b+="ModernMail";break;case 2:this.b+="ModernGroup";t.explicitLogonUser=this.f;break}this.b+=this.h?"Cloudy":"Classic";this.b+=this.d?"Edit":"Preview";t.actionName=this.b;this.g&&(t.isDiscovery=!0);n.eg(this.e,this.d,this.j,t,this.r,this.q,this.k)},cy:function(n,t,i){this.c=n;if(this.c)if(this.c.Status){var u=Error.create("GetAttachmentInfo was not successful.");i(u)}else{this.d||_at.l.a().c(this.e,this.c);t()}else{var r=new _g.fX;r.Status=1;r.WacUrl="";this.c=r;i(Error.create("Server unavailable."))}}};_at.bf=function(n,t,i,r,u,f,e){_at.bf.initializeBase(this);this.e=n;this.d=t;this.j=i;this.h=r;this.i=u;this.f=f;this.g=e};_at.bf.prototype={c:null,b:"GetAttachmentInfo",e:null,d:!1,j:null,h:!1,i:0,f:null,g:!1};_at.C=function(n,t,i,r,u,f,e){_at.C.initializeBase(this,[n,t,i,r,u,f,e]);this.b="GetWacAttachmentInfo"};_at.C.prototype={u:function(n){var t=new _gg.xK(this.x);switch(this.i){case 0:this.b+="ClasicReadingPane";break;case 1:this.b+="ModernMail";break;case 2:this.b+="ModernGroup";t.explicitLogonUser=this.f;break}this.b+=this.h?"Cloudy":"Classic";this.b+=this.d?"Edit":"Preview";t.actionName=this.b;this.g&&(t.isDiscovery=!0);n.cn(this.e,this.d,this.j,t,this.r,this.q,null)},cy:function(n,t,i){this.c=n;if(this.c)if(this.c.Status){this.d||this.c.Status!==9||_at.l.a().c(this.e,this.c);var u=Error.create("GetWacAttachmentInfo was not successful.");i(u)}else{this.d||_at.l.a().c(this.e,this.c);t()}else{var r=new _g.fX;r.Status=1;r.WacUrl="";this.c=r;i(Error.create("Server unavailable."))}}};_at.D=function(n,t,i){_at.D.initializeBase(this);this.b=new _gg.kS;this.b.subscriptionId=i;this.b.ewsAttachmentId=n;this.b.channelId=_a.V.a;this.b.itemId=t};_at.D.prototype={b:null,u:function(n){var t=new _gg.BQ(this.x);n.cC(this.b,t,this.r,this.q)},cy:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.bj=function(){};_at.bj.registerInterface("_at.bj");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.u=function(){};_at.u.registerInterface("_at.u");_at.bi=function(){};_at.bi.registerInterface("_at.bi");_at.n=function(n){this.b=_a.I.a();this.d=n};_at.n.prototype={d:!1,b:null,c:function(){return this.d?this.a(_g.bb.toString(1)):this.a(_g.bb.toString(0))},a:function(n){if(this.b.c(n))return this.b.a[n];var t=this.e(n);t&&this.b.b(n,t);return t},e:function(n){if(n===_g.bb.toString(0))return new _at.Z(_u.R.eo);if(n===_g.bb.toString(1))return new _at.Y(_u.R.aP);if(n===_g.bb.toString(2))return new _at.X(_u.R.bf);_js.Trace.logError(_a.a.c,"Unsupported data provider type {0}",n);return null}};_at.j=function(n,t,i,r,u){this.b=_js.d.a(n)?"#":n;this.d=t;this.a=i;this.c=r;this.f=u;this.e=u?_nbs.a.Ra:_nbs.a.fq;_js.Trace.logInfo(_a.a.c,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.c,this.d,this.e,this.b)};_at.j.d=function(){_at.j.a||(_at.j.a=new _at.j("#",!0,null,!0,!1));return _at.j.a};_at.j.c=function(n,t,i){_a.b.a(n,"viewModel");_a.b.a(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.j.e(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.j.b(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.b.isInstanceOfType(n)){var a=n;a.bs.a()&&(r=!0)}return new _at.j(f,r,u,!1,t)};_at.j.b=function(n,t,i,r){var u=!1;if(_at.b.isInstanceOfType(n)){var f=n;u=f.bs.a()}if(!n.be.d||u||n.be.e||n.Y.bh.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.bz;return}switch(n.be.b){case 3:i.val=!1;t.val=n.bh;r.val=n.fB;break;case 2:i.val=!0;r.val=n.bz;t.val=n.bh;break;case 1:i.val=!0;t.val="#";r.val=n.bz;break;case 0:default:i.val=!0;t.val="#";r.val=n.bz;break}};_at.j.e=function(n,t,i,r){if(n.Y.bh.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.bz;return}switch(n.bb()){case 5:i.val=!0;t.val="#";r.val=n.fn;break;case 3:i.val=!0;t.val="#";r.val=n.bR;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.be.b===3?new _C(function(){n.Z&&n.Z.bW(n)},_a.a.c):n.bz;break;default:_at.j.b(n,t,i,r);break}};_at.j.prototype={d:!1,b:null,a:null,e:null,c:!1,f:!1};_at.p=function(n,t,i,r,u){this.a=n;this.e=t;this.d=i;this.c=r;this.b=u};_at.p.prototype={a:null,b:!1,e:null,d:0,c:0};_at.V=function(n,t,i,r,u){_at.V.initializeBase(this,[1,"AttachmentUploadDatapoint"]);this.a.S=n;this.a.T=t.toString();this.a.E=i;this.a.X=r;this.a.Z=u.toString()};_at.y=function(n){_at.y.initializeBase(this);this.e=n;var t=this;this.d=new _C(function(){t.a(!1)},_a.a.c)};_at.y.prototype={c:!1,e:!1,d:null,b:function(){return this.c},a:function(n){if(this.c===n)return n;this.c=n;this.ea("IsShown");return n},f:function(){return 600},g:function(){return 300},p:function(){return!0}};_at.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){this.gm=Function.createDelegate(this,this.ir);this.gn=Function.createDelegate(this,this.is);this.gk=Function.createDelegate(this,this.ip);this.gl=Function.createDelegate(this,this.iq);this.gp=Function.createDelegate(this,this.iv);this.gq=Function.createDelegate(this,this.iw);this.ew=Function.createDelegate(this,this.ij);this.gj=Function.createDelegate(this,this.hB);this.ex=Function.createDelegate(this,this.iu);this.ev=Function.createDelegate(this,this.hC);this.fY=Function.createDelegate(this,this.hn);this.fZ=Function.createDelegate(this,this.ho);this.eu=Function.createDelegate(this,this.hw);this.dm=Function.createDelegate(this,this.ci);this.dn=Function.createDelegate(this,this.dv);this.gg=Function.createDelegate(this,this.hz);this.gh=Function.createDelegate(this,this.hA);this.ge=Function.createDelegate(this,this.gD);this.go=Function.createDelegate(this,this.it);this.gf=Function.createDelegate(this,this.hy);this.et=Function.createDelegate(this,this.eI);this.gy=Function.createDelegate(this,this.iR);this.gu=Function.createDelegate(this,this.iz);this.gz=Function.createDelegate(this,this.iS);this.gd=Function.createDelegate(this,this.hv);this.fX=Function.createDelegate(this,this.hl);this.gt=Function.createDelegate(this,this.iy);this.ga=Function.createDelegate(this,this.hp);this.gc=Function.createDelegate(this,this.hu);this.gb=Function.createDelegate(this,this.ht);this.gw=Function.createDelegate(this,this.iB);this.gv=Function.createDelegate(this,this.gV);this.gs=Function.createDelegate(this,this.dL);this.gx=Function.createDelegate(this,this.iM);this.gi=Function.createDelegate(this,this.dw);this.gr=Function.createDelegate(this,this.ix);this.dz=new _at.F;_at.a.initializeBase(this);this.bx=f;this.bc=h;this.dq=c;this.eL=l;this.fj=a;this.fp=v;this.eF=d;this.dy=g;this.eR=nt;this.df(n);this.bj=t;this.bg=e;this.by=p;this.bB=s;this.cy=o;this.cx=k;this.cV=!1;this.dh=!1;_g.m.isInstanceOfType(n)&&(this.bm=n.bh.Content);this.bp=i;this.bt=r;this.bF=w;this.bE=b;this.ft(!this.bp);this.gW(_a.bh.a(n.bh.Name));this.ha(_at.f.a().a(this.bi,this.Y.bh.ContentType,_y.H.e(this.bj,this.bg),this.cv()));this.Y&&this.Y.bh.AttachmentId&&this.dR(this.be.a);this.cE();this.cn();this.ep();this.fM();this.dk();this.ff=!!this.bc&&this.bc.a().r().Enabled;this.fe=!!this.bc&&this.bc.a().cw().Enabled;this.fd=!!this.bc&&this.bc.a().b().Enabled;this.fg=!!this.bc&&this.bc.a().bn().Enabled;this.eT=!!this.bc&&this.bc.a().bn().Enabled&&!this.fd;this.bz=new _C(this.gr,_at.a.a);this.dx=new _C(this.gi,_at.a.a);this.fB=new _C(this.gx,_at.a.a);this.fn=new _C(this.gs,_at.a.a);this.bR=new _C(this.gv,_at.a.a);this.fs=new _C(this.gw,_at.a.a);this.eM=new _C(this.gb,_at.a.a);this.eN=new _C(this.gc,_at.a.a);this.eJ=new _C(this.ga,_at.a.a);this.fh=new _C(this.gt,_at.a.a);this.eE=new _C(this.fX,_at.a.a);this.eO=new _C(this.gd,_at.a.a);this.fR=new _C(this.gz,_at.a.a);this.fo=new _C(this.gu,_at.a.a);this.gZ(u);this.ce=new _y.bR;this.fC=y;this.eq()};_at.a.f=function(){return"AttachmentViewModelSaveToCloudNotification"+(_a.c.a().h()+_ff.q.a(0,1e6)).toString()};_at.a.e=function(n,t,i){if(n.bh.IsSmimeDecoded){t.val=6;return!1}var r=!1;$a(i)&&(i=_a.bh.a(n.bh.Name));$a(i)||(r=_at.a.c.g(i.toLowerCase()));if(!r){t.val=6;return!1}var u=_g.k.isInstanceOfType(n);_js.Trace.logInfo(_at.a.a,"Attachment Type: {0}",u?"Cloudy":"Local");t.val=7;return!0};_at.a.prototype={bc:null,ff:!1,fe:!1,fg:!1,by:null,eF:null,bz:null,dx:null,fB:null,fn:null,bR:null,fs:null,eE:null,eM:null,eN:null,eJ:null,ct:null,db:null,dc:null,fh:null,eO:null,fR:null,fo:null,eT:!1,ce:null,bp:!1,bt:!1,fd:!1,bj:null,bg:null,cx:null,bn:null,dq:null,bx:null,bB:null,cy:null,dy:null,Y:null,bh:null,dY:null,bq:0,bw:0,bk:0,bl:0,cj:!1,cb:!1,eK:!1,dr:!1,fP:!1,fm:!1,be:null,Z:null,gS:!1,bT:!1,cC:null,dX:null,cr:0,bG:null,bX:0,cF:null,bM:null,ck:!1,bf:!1,bV:!1,bv:0,eH:null,cW:!1,dJ:!1,cV:!1,dh:!1,bi:null,cz:null,bI:null,cc:!1,dT:!1,dU:!1,cT:null,cd:null,cH:null,cX:!1,bm:null,bU:null,cq:null,bC:null,bA:null,dN:null,dt:null,du:null,bD:!1,cI:null,eP:null,bd:null,fq:2,bK:!1,eL:null,fp:null,di:null,fC:null,cU:!1,bJ:!1,ds:null,ch:null,bW:0,cm:1,bQ:!1,bH:null,bF:null,eR:null,bE:null,da:!1,dM:null,dK:!1,cZ:null,cY:null,bZ:0,bY:0,cl:null,ca:null,cG:null,bu:null,fj:null,er:null,fF:!1,cD:!1,fD:function(){_js.Trace.logInfo(_at.a.a,"Starting attachment upload.");var t=this,n=this;_g.j.a.B("CreateAttachment",this.gy,this.hx(),function(n){_js.Trace.logInfo(_at.a.a,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.a.a,"Enqueueing upload attachment failed: {0}",t.message);n.cg(1,_at.h.a(t),!0);n.dp(null)})},eC:!1,ez:null,eB:!1,ey:null,G:function(n){this.ef("OnUploadCompleteEvent",n)},y:function(n){this.eg("OnUploadCompleteEvent",n)},eD:function(n){this.ef("OnUploadFailedEvent",n)},S:function(n){this.eg("OnUploadFailedEvent",n)},E:function(n){this.ef("OnDeleteCompleteEvent",n)},Q:function(n){this.eg("OnDeleteCompleteEvent",n)},F:function(n){this.ef("OnDownloadCompleteEvent",n)},R:function(n){this.eg("OnDownloadCompleteEvent",n)},D:function(n){this.ef("OnCancelCompleteEvent",n)},iA:function(n){this.eg("OnCancelCompleteEvent",n)},dg:function(n){if(n!==this.cl){this.cl=n;this.cD=!1;this.ei(["ThumbnailInfo","IsThumbnailImage","ShowDefaultImage","IsSuiteExtensionIconSupported","ShouldShowThumbnailPlaceholder"])}return n},bS:function(n){if(this.bq!==n){this.bq=n;this.ei(["ShouldShowSaveToCloudLabel","SaveFileToCloudStatus","SaveToCloudLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},fw:function(n){if(this.bw!==n){this.bw=n;this.ei(["ShouldShowAddToCalendarLabel","AddToCalendarLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},ib:function(){return this.cb&&!!this.bq&&this.bq!==1},hW:function(){return this.bw===2||this.bw===1},ii:function(){return this.ba()?this.i()?this.i().j():"":""},hJ:function(){return this.ba()?this.i()?this.i().c():"":""},gJ:function(){switch(this.bq){case 1:return String.format(_nbs.a.lw,this.Z.g());case 2:return String.format(_nbs.a.Hr,this.Z.g(),this.Z.l());case 3:return String.format(_nbs.a.cG,this.Z.l());case 4:return String.format(_nbs.a.Ha,this.Z.l());case 5:return _nbs.a.mH;default:return null}},hF:function(){if(this.bw===2)return _nbs.a.Db;else if(this.bw===1)return _nbs.a.Ke;return null},hV:function(){return this.bq===2||this.bw===1||this.cP()},hU:function(){var n=!1;(this.cV||this.Y&&$a(this.Y.bh.AttachmentId))&&(n=!0);if(n!==this.dh){this.dh=n;this.fL()}return this.dh},cP:function(){return this.bk===2||this.bk===4||this.bl===2||this.bl===4},fI:function(n){this.cV=n;this.ea("ShouldShowActivityIndicator")},he:function(){this.ei(["ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline","ShouldAffordanceMenuBeHidden","ShouldSizeBeHidden","ShowDeleteButton","ShowCancelButton","IsConvertAttachmentInProgress"]);this.dk()},n:function(n){if(this.bk!==n){this.bk=n;this.fM();this.ee("ShouldShowConvertLocalToRefAttachmentLabel","ConvertLocalToRefAttachmentLabel");this.he()}return n},j:function(n){if(this.bl!==n){this.bl=n;this.ee("ShouldShowConvertRefToLocalAttachmentLabel","ConvertRefToLocalAttachmentLabel");this.he()}return n},gF:function(){if(this.bk){if(this.bk===3)return String.format(_nbs.a.Ha,this.Z.l());else if(this.bk===2)return String.format(_nbs.a.Dh,this.Z.g(),this.Z.l());else if(this.bk===4)return _nbs.a.FY}else return null;return String.format(_nbs.a.WL,this.Z.g())},gG:function(){if(this.bl){if(this.bl===3)return _u.R.dj;else if(this.bl===2)return _u.R.SX;else if(this.bl===4)return _nbs.a.FY}else return null;return _u.R.M},hY:function(){return this.dB()&&!!this.bk&&this.bk!==1},hZ:function(){return this.dC()&&!!this.bl&&this.bl!==1},dB:function(){return!!this.bc&&!!this.Z&&this.bc.a().bf().Enabled&&!this.Z.i()&&!_g.k.isInstanceOfType(this.Y)&&this.bb()!==4&&!this.Y.b()&&this.Z.z()&&!this.Z.c()&&!_js.d.a(this.Z.g())&&!this.cO()},dC:function(){return!!this.bc&&!!this.Z&&this.bc.a().bf().Enabled&&!this.Z.i()&&_g.k.isInstanceOfType(this.Y)&&!this.Y.t()&&this.bb()!==4&&this.Z.z()&&!this.Z.c()&&!_js.d.a(this.Z.g())&&!this.im()&&!this.cO()},U:function(){this.dt=_a.d.b(_a.a.c,"ConvertLocalAttachmentToReferenceAttachment")},V:function(){this.du=_a.d.b(_a.a.c,"ConvertRefToLocalAttachment")},I:function(){_a.d.a(this.dt);this.dt=null},J:function(){_a.d.a(this.du);this.du=null},hT:function(){this.cb&&this.bq&&this.bq!==1&&(this.da=!0);return this.da},iG:function(n){if(n!==this.da){this.da=n;this.ea("IsViewHovered")}return n},p:function(n){this.cq=n;return n},bb:function(){this.cr||(this.cr=this.dH());return this.cr},a:function(){return this.Y},df:function(n){var t=this.Y;if(t!==n){$a(t)||t.s(this.et);this.Y=n;var i=$a(n);if(!i){n.B(this.et);_js.Trace.logInfo(_a.a.c,"Attachment: {0}",n.bh.Name)}this.gM(i?null:n.bh.AttachmentId);this.ea("Attachment");this.ea("ReferenceAttachment");this.ea("ReferenceAttachmentProviderTypeInfo");this.dk();this.fL();this.ea("ShouldShowActivityIndicator")}return n},P:function(){return this.dK?this.ba()?this.ba().A():0:this.fq},A:function(n){this.dK?this.ba()&&this.ba().A()!==n&&this.ba().r(n):this.fq=n;this.dk();return n},ba:function(){return _g.k.isInstanceOfType(this.Y)?this.Y:null},hG:function(){var n=null;if(this.ba())n=this.gI();else{var t=new _b.V;n=t.a(this.Y.a(),null)}return String.format("{0} {1}",this.Y.bh.Name,n)},gI:function(){return this.ba()&&this.ba().bh.ProviderType?this.i()?this.i().e():this.bu:""},i:function(){return this.ba()?this.eR.a(this.ba().bh.ProviderType):null},bo:function(){return this.Y&&this.Y.bh.AttachmentId?this.Y.bh.AttachmentId.Id:null},eV:function(){return!!this.ba()&&this.dE()},dE:function(){return this.bb()===1||this.bb()===2},hR:function(){return this.eV()&&this.bg.c()},cA:function(n){this.gS=n;this.ea("IsSelected");return n},hS:function(){if(this.be.a||!this.bc||!this.bc.a().O().Enabled)return!1;if(this.Y&&!(this.cZ!=null)){var n=_a.bh.a(this.Y.bh.Name).replace(".","");this.cZ=!!SuiteExtensionsControlFactory.CreateControl(n,1)}return this.cZ!=null?this.cZ:!1},eW:function(){if(this.be.a||this.M()||!this.bc||!this.bc.a().O().Enabled)return!1;if(this.Y&&!(this.cY!=null)){var n=_a.bh.a(this.Y.bh.Name).replace(".","");this.cY=!!SuiteExtensionsControlFactory.CreateControl(n,0)}return this.cY!=null?this.cY:!1},dO:function(n){if(this.bh!==n){this.bh=n;_js.Trace.logInfo(_at.a.a,"Attachment download URL: {0}",this.bh);this.ea("DownloadUrl")}return n},N:function(){return this.cj},T:function(n){if(this.cj!==n){this.cj=n;this.ea("IsTriggeredPolicyTip")}return n},ft:function(n){this.eK=n;this.ee("CanDelete","ShowDeleteButton");return n},cp:!1,z:function(n){this.cp=n;return n},q:function(n){this.dr=n;this.ee("AttachmentWellPendingRefresh","ShowDeleteButton");return n},fb:function(){return(this.eK||this.dr)&&!this.cP()},id:function(){return this.bk===2&&this.bk!==4||this.bl===2&&this.bl!==4},fA:function(n){this.bp||this.dA()||this.ft(!n);this.fP=n;this.ea("UploadInProgress");return n},eZ:function(){return this.fm},dR:function(n){this.fm=n;this.ea("OpenDocumentInBrowserLinkVisible");return n},ha:function(n){this.be=n;this.cr=this.dH();this.gL();return n},O:function(){return this.Z},gZ:function(n){if(n!==this.Z){this.Z=n;this.Z&&this.ik();this.ea("ParentWell")}return n},b:function(){return this.bT},cB:function(n){if(this.bT!==n){this.bT=n;this.Z&&this.Z.bC(this);this.ea("ShouldBeHidden")}return n},fx:function(n){if(this.ck!==n){this.ck=n;this.ea("PendingNonHtml5Upload")}return n},cS:function(){this.cb&&this.bq&&this.bq!==1&&(this.cc=!0);this.dB()&&this.bk&&this.bk!==1&&(this.cc=!0);this.dC()&&this.bl&&this.bl!==1&&(this.cc=!0);this.bw&&(this.cc=!0);return this.cc},iI:function(n){if(this.cc!==n){this.cc=n;this.ea("ShouldSizeBeHidden")}return n},ia:function(){return this.bk===3||this.bl===3||this.bq===4||this.bw===3},hX:function(){return this.bq===3||this.bw===2},gK:function(){return this.bw===1||this.cb&&this.bq===2||(this.dB()||this.dC())&&this.cP()||this.cV||!this.Y||!this.Y.bh.AttachmentId||!this.cK()||!this.cK().h.y.length},iH:function(n){if(this.bu!==n){this.bu=n;this.ea("ReferenceAttachmentOpenUrl")}return n},bP:function(){return!1},fa:function(){return!1},hb:function(n){if(this.dT!==n){this.dT=n;this.ea("ShowEditPermissionsInCompose")}return n},hc:function(n){if(this.dU!==n){this.dU=n;this.ea("ShowViewPermissionsInCompose")}return n},gW:function(n){if(this.bi!==n){this.bi=n;this.ea("FileExtension")}return n},fy:function(n){this.cC=n;this.ea("SubmitUploadFormCommand");return n},iJ:function(n){this.dX=n;this.ea("SubmitUploadAndShareFormCommand");return n},m:function(){this.dY||(this.dY=_at.a.f());return this.dY},o:function(){return this.bz},k:function(){return this.ct},fv:function(n){this.bG=n;_js.Trace.logWarning(_at.a.a,"Attachment form upload error: {0}",this.bG);this.ea("FormUploadError");return n},fu:function(n){this.bX=n;_js.Trace.logWarning(_at.a.a,"Attachment form upload error code: {0}",this.bX);this.ea("FormUploadAttachmentError");return n},dS:function(n){this.cF=n;this.ea("UploadSuccessResponse");return n},eY:function(){return!1},l:function(){return this.bf},K:function(){return this.bv},g:function(){return this.bI},e:function(n){this.bI=n;return n},bO:function(){var n=this.bF.a(this.Y.bh.AttachmentId,this.bt,_g.S.h());_js.Trace.logInfo(_at.a.a,"Image preview URL: {0}",n);return n},dG:function(){return this.ba()&&this.bu?this.bu:null},cM:function(){var n=this.bF.a(this.Y.bh.AttachmentId,this.bt,_g.S.a());_js.Trace.logInfo(_at.a.a,"Image preview URL: {0}",n);return n},cQ:function(){var n=this.bF.a(this.Y.bh.AttachmentId,this.bt,_g.S.a());_js.Trace.logInfo(_at.a.a,"Media URL: {0}",n);return n},cN:function(){return this.bF.a(this.Y.bh.AttachmentId,this.bt,_g.S.g())},hQ:function(){return this.bg.e()},hN:function(){return this.bg.g()},cu:function(){return this.bb()!==2&&this.bb()!==1||this.Y.b()?!1:this.be.b===3},iK:function(n){if(this.cD!==n){this.cD=n;this.ee("ThumbnailLoadSucceeded","ShouldShowThumbnailPlaceholder")}return n},ic:function(){return this.M()&&!this.cD},M:function(){return this.cl?this.be.b===3:!1},ie:function(){return!this.M()&&!this.eW()},hK:function(){return this.bb()!==2&&this.bb()!==4},hL:function(){return!this.Y.bh.IsSmimeDecoded&&this.dE()},eU:function(){if(this.cT)return this.cT;var n;n=OwaApplication.b&&this.bb()===5?!1:this.bN()?this.bb()===5||!this.cR()&&(!this.bt||this.bt&&this.bb()!==3):this.bb()===5||this.bj.a()==="Mouse"&&this.bb()!==3;_js.Trace.logInfo(_at.a.a,"IconLinkViewModel preview = {0}",n);this.cT=_at.j.c(this,n,this.bj);return this.cT},ig:function(){if(this.cd)return this.cd;if(this.bj.a()!=="Mouse"){this.cd=_at.j.d();return this.cd}var t=!1;var n=!1;if(this.Y.bh.IsSmimeDecoded){n=_g.x.isInstanceOfType(this.Y);t=n}else switch(this.bb()){case 3:n=!1;t=this.dD();break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:if(OwaApplication.b){t=!1;n=!1}else n=!0;break;case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.a.a,"TextLinkViewModel is hidden");this.cd=_at.j.d()}else{_js.Trace.logInfo(_at.a.a,"TextLinkViewModel preview = {0}",t);this.cd=_at.j.c(this,t,this.bj)}return this.cd},cK:function(){if(!this.cH){var n=new Array(0);this.cH=new _fm.f(n)}return this.cH},iE:function(n){this.cH=n;this.ea("ContextMenu");return n},hI:function(){return this.bj.a()!=="Mouse"},L:function(){return this.bn},ih:function(){var n=this.bb();switch(n){case 4:return _nbs.a.ak;case 1:case 2:return _nbs.a.KO;case 6:case 3:return this.Y.bh.Name;case 5:return OwaApplication.b?this.Y.bh.Name:_nbs.a.KO;default:break}return""},dP:function(n){if(this.cX!==n){this.cX=n;this.cn()}return n},x:function(){return this.cW},gY:function(n){if(this.cW!==n){this.cW=n;this.ea("IsDeleted")}return n},hM:function(){if(this.ba())if(_js.d.b(this.bu)){if(this.ba().bh.AttachLongPathName)return this.Y.bh.Name+"\n \n"+this.ba().bh.AttachLongPathName}else return this.Y.bh.Name+"\n \n"+this.bu;return this.Y.bh.Name},iF:function(n){this.bJ!==n&&(this.bJ=n);return n},gX:function(n){if(this.cU!==n){this.cU=n;this.ea("IsCancelling")}return n},cL:function(){_a.b.d(this.bb()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.Y.A()},dD:function(){return!!this.bc&&this.bc.a().bA().Enabled},hP:function(){return!!this.bc&&!!this.bE&&this.bc.a().w().Enabled&&this.bE.AttachmentDataProviderAvailable},bN:function(){return this.dD()&&!this.fF&&this.bj.a()!=="TouchNarrow"&&(this.be.a||this.dF()||this.hS()||this.bb()===1||this.bb()===2||this.bb()===7)&&!this.cv()&&!this.hR()&&!this.bg.d()},cR:function(){return this.bg.d()||this.bg.b()||this.bj.a()==="TouchNarrow"||!this.bp&&this.bj.a()==="TouchWide"||!!this.bc&&this.bc.a().cs().Enabled},iD:function(n){if(this.bU!==n){this.bU=n;this.ea("AttachmentPreviewViewModel")}return n},f:function(){return this.bD},v:function(n){this.bD=n;n&&this.dR(!1);return n},dQ:function(n){if(this.bK!==n){this.bK=n;this.ea("IsOpenedInLightBox");this.ea("IsComposedInLightBox");this.cO()&&this.ft(!1);this.Z.i()||this.dj()}return n},cO:function(){_js.Trace.logInfo(_a.a.a,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.Z,this.bK,this.Z.i(),this.be.c,this.Y?this.Y.bh.Name:"null",this.bK&&!this.Z.i()&&this.be.c);return this.Z?this.bK&&!this.Z.i()&&this.be.c:!1},br:function(){!this.ds&&this.dA()&&(this.ds=(+new Date).toString());return this.ds},dF:function(){return this.gH()},gH:function(){return this.fe&&this.bb()===6&&!!this.bi&&_at.a.d.g(this.bi.toLowerCase())},iL:function(n){if(this.er!==n){this.er=n;this.ea("WacStaticAssetsPreloadUrl")}return n},dA:function(){var n=!!this.bc&&this.bc.a().bA().Enabled;return!n||this.bg.c()||this.bg.r()?!1:!this.Z.c()||!!this.by&&this.by.a(this.Z.c(),"AttachmentUploadCancellation")},cJ:function(){var n=!!this.Y.bh.AttachmentId;var i=n?this.Y.bh.AttachmentId.Id:null;var t=i?_bc.g.b(i):!1;var r=this.be.b===1;_js.Trace.logInfo(_at.a.a,"UpdateUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.be.toString());return n&&!r&&!t&&!this.Y.n()},d:function(){return this.bZ},t:function(n){this.bZ=n;return n},c:function(){return this.bY},r:function(n){this.bY=n;return n},cw:function(){return!this.Z.d()||this.Z.d().g()!==1||!this.ff},ik:function(){this.bn=this.Z.P();this.dK=this.io();this.cb=this.hs();this.cn();if(!!this.Z){this.ct=new _C(this.gf,_at.a.a);this.db=new _C(this.go,_at.a.a);this.dc=new _C(this.ge,_at.a.a)}this.dj();this.gU()},hH:function(){_js.Trace.logInfo(_at.a.a,"Attachment class: {0}",this.cr);var n;switch(this.bb()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.a.a,"Embedded item class: {0}",this.cL());switch(this.cL()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.a.a,"Can open: {0}",n);return n},cv:function(){return this.Y.bh.IsSmimeDecoded||this.Y.n()},hO:function(){return!!this.bc&&this.bc.a().dl().Enabled},cn:function(){this.Z?this.cB(this.cX||this.Y.b()&&this.Z.bt()&&!_g.k.isInstanceOfType(this.Y)):this.cB(this.cX||this.Y.b());this.cB(this.bT||this.Y.p)},im:function(){return this.Y&&!_js.d.a(this.Y.bh.Name)?this.Y.bh.Name.endsWith(".one")||this.Y.bh.Name.endsWith(".onepkg"):!1},it:function(){_js.Trace.logInfo(_at.a.a,"File selected.");this.dP(!1);this.Z&&this.Z.bF(this)},fN:function(){_js.Trace.logInfo(_at.a.a,"submitting upload to server");this.bf=!1;if(_g.m.isInstanceOfType(this.Y)){var n=this.Y;this.fO(n)}else(_g.z.isInstanceOfType(this.Y)||_g.x.isInstanceOfType(this.Y)||_g.k.isInstanceOfType(this.Y))&&this.fD()},fE:function(){_js.Trace.logInfo(_at.a.a,"submitting delete to server");this.bf=!1;if(!this.Z.a()){_js.Trace.logError(_at.a.a,"ParentItemId is null when deleting attachment.");this.gQ(null,"ParentItemId is null");return}var n=new _at.Q(2,this.Y,this.Z.a());n.v(this.gh);n.z(this.gg);OwaApplication.a.a(n)},fc:function(){var i=this.Y;var r=i.c;var n=this.dz.a();var t=this;n.f(function(){if(n.c())_js.Trace.logWarning(_at.a.a,"HTML5 file reader attach failed with error code {0}",n.c());else{var r=n.b().indexOf(",");var i=n.b().substring(r+1,n.b().length);t.bm=n.b().substring(0,r).indexOf("base64")!==-1?i:_a.be.b(i);t.ej("OnUploadCompleteEvent",t)}});try{n.e(r)}catch(u){this.bg.e()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.a.a,"Firefox: failed to read an attachment. Exception: {0}",u.message):_js.Trace.logException(_at.a.a,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},fr:function(){this.bm=null;this.ej("OnDeleteCompleteEvent",this);if(this.bd){this.bd.j=this.cs(1);_a.d.a(this.bd);this.bd=null}},fG:function(){this.bA=_a.d.b(_a.a.c,"AttachmentUploadQueue")},dZ:function(n){if(this.bA){this.bA.k=n;this.bA.j=this.eQ(!1);_a.d.a(this.bA);this.bA=null}},fH:function(){if(this.bA){this.bA.j=this.eQ(!1);_a.d.a(this.bA);this.bA=null}this.cq&&(this.bC=_a.d.b(_a.a.c,this.cq))},en:function(){if(this.bC){var n="";this.bf&&(n=this.eH);this.bC.k=n;this.bC.j=this.eQ(!0);_a.d.a(this.bC);var i=this.bC.n.j&1024?+new Date:this.bC.n.k;var t=new _at.V(this.bC.d(),i-this.bC.n.l,n,this.bi,this.Y.a());_a.k.c.a(t);this.bC=null}},H:function(){_js.Trace.logInfo(_at.a.a,"Getting attachment content from server");this.bf=!1;var n=new _at.S(_at.a.a,this.Y);var i=this;n.z(function(){i.ej("OnDownloadCompleteEvent",i);i.dR(!1)});var t=this;n.v(function(){_js.Trace.logWarning(_at.a.a,"Download failed with error: {0}",n.t.message);t.bf=!0;t.bD||t.dv(n)});OwaApplication.a.a(n)},hB:function(n,t){n&&this.dw()},dI:function(n){if(_g.z.isInstanceOfType(this.Y)||_g.x.isInstanceOfType(this.Y)){_js.Trace.logInfo(_at.a.a,"Uploading item or id attachment.");this.iQ()}else if(_g.m.isInstanceOfType(this.Y)){var t=this.Y;if(this.bm){_js.Trace.logInfo(_at.a.a,"Uploading file attachment with pasted image from clipboard.");this.de(this.bm)}else if(t.bh.Content){_js.Trace.logInfo(_at.a.a,"Uploading file attachment with content.");this.de(null)}else if(t.b()&&_a.bX.isInstanceOfType(this.Y.c)&&_at.b.isInstanceOfType(this)){_js.Trace.logInfo(_at.a.a,"Uploading inline PAL image with content.");this.hh()}else if(this.bg.n()){_js.Trace.logInfo(_at.a.a,"Uploading HTML5 file attachment.");this.bH=t.c;this.hf(!t.b()&&this.hO())}else{_js.Trace.logInfo(_at.a.a,"Uploading Non-HTML5 file attachment.");this.fQ()}}else if(_g.k.isInstanceOfType(this.Y)){this.dJ=!0;if(this.bg.n()){_js.Trace.logInfo(_at.a.a,"Uploading HTML5 reference attachment.");var i=this.Y;this.bH=i.c;this.hf(!1)}else{_js.Trace.logInfo(_at.a.a,"Uploading Non-HTML5 reference attachment.");this.fQ()}}else{_js.Trace.logError(_at.a.a,"Unsupported upload type.");n(null)}},dH:function(){var n=0;if(_g.m.isInstanceOfType(this.Y))if(this.be.a)n=3;else{var r,u;if(u=_y.H.c(this.Y,r={val:n}),n=r.val,!u)if(this.be.b===1)n=4;else{var t,i;(i=_at.a.e(this.Y,t={val:n}),n=t.val,i)||(n=6)}}else n=_g.x.isInstanceOfType(this.Y)?5:_g.z.isInstanceOfType(this.Y)?0:4;return n},cE:function(){if(!this.bF){_js.Trace.logError(_a.a.c,"DownloadUrlFactory is NULL.");return}this.cJ()?this.dO(this.bF.a(this.Y.bh.AttachmentId,this.bt,null)):this.dO(null)},dv:function(n){this.cg(1,_at.h.c(n),!0)},hw:function(n){this.bW<this.cm-1&&!this.bJ&&this.hg()},cg:function(n,t,i){this.bf=!0;this.fI(!1);if(this.bJ)_js.Trace.logInfo(_at.a.a,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.br(),n,t);else{_js.Trace.logWarning(_at.a.a,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.br(),n,t);this.bv=n;this.eH=t;if(this.Z&&this.Z.o(this.bn)){this.Z.j(this,!1);this.cp&&this.Z.F()}}this.ej("OnUploadFailedEvent",this)},ci:function(n){if(_at.i.isInstanceOfType(n)){var t=n;if(t.h<t.b-1)return}this.dp(n)},ep:function(){this.fx(!this.bp&&this.bg.r()&&$a(this.Y.bh.AttachmentId)&&!_g.z.isInstanceOfType(this.Y))},eI:function(n,t){if(t==="Thumbnail"){this.gL();return}t==="ProviderType"&&this.ei(["EditPermissionsText","ViewPermissionsText","ReferenceAttachmentProviderTypeInfo","DataProviderInfo"]);if(t==="ContentType"||t==="Name"||t==="AttachmentId"||t==="ProviderType"){t==="Name"&&this.gW(_a.bh.a(this.Y.bh.Name));if(t==="ContentType"||t==="Name"){this.ha(_at.f.a().a(this.bi,this.Y.bh.ContentType,this.bj.a()==="Mouse"||this.bg.m(),this.cv()));this.cn()}if(t==="AttachmentId"){this.gM(this.Y.bh.AttachmentId);this.ep();this.fL()}this.cE();this.dj()}},de:function(n){var f=this.Y;if(n){f.q(n);if(this.bW===this.cm-1&&this.Y.b()){var i=0;var t=0;var u,r;_at.e.c(this.Y.bh.ContentType,n,u={val:i},r={val:t}),i=u.val,t=r.val;this.bZ=i;this.bY=t;this.bI=this.Z.bE(this.Y.bh.Name,this.bZ,this.bY)}}this.iC(f)},fQ:function(){this.cC.a()},gD:function(){_js.d.a(this.bG)||this.cg(this.bX,this.bG,!1);this.dp(null)},bL:function(n){this.dy.a(_a.n,new _a.n([n],1,null,0,!1,_nbs.a.S,null,null))},fO:function(n){this.fD()},hh:function(){_js.Trace.logInfo(_at.a.a,"Submitting action for PAL attachment upload.");var n=new _at.P(2,this.Y,this.Z.a(),this.br(),this.Z.c(),this.cw());n.v(this.dn);n.z(this.dm);OwaApplication.a.a(n)},eS:function(n){_js.Trace.logInfo(_at.a.a,"Not a PAL file attachment.")},fl:function(n,t){this.gR(n,t)},fi:function(n,t){this.bM=t;this.gU();_js.Trace.logInfo(_at.a.a,"Attachment ID: {0}",this.bM?this.bM.Id:"null")},gR:function(n,t){_js.Trace.logWarning(_at.a.a,"Opening attachment with URL {0}",n);this.bx&&this.Z&&this.Z.a()&&this.bx.b(this.Z.a(),"Downloaded",this.bi,!!this.ba());if(this.bg.c())if(this.cx.b(this.cx.e())&&this.cx.e().b().a()){_js.Trace.logInfo(_at.a.a,"Launch URL from nativeBridge");this.cx.e().a(n)}else{_js.Trace.logInfo(_at.a.a,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var r=document.createElement("a");r.href=n;var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!1,!1,window.self,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);r.dispatchEvent(i)}else t?this.ce.a(n,"_self"):this.ce.a(n,"_blank")},dj:function(){var n=new _fm.f(new Array(0));this.hP()&&this.ba()&&!this.bp&&this.i()&&n.h.a(new _fm.d(this.i().a(),null,this.fh));if(this.dC()){this.j(1);n.h.a(new _fm.d(this.gG(),null,this.eN))}if(this.dB()){this.n(1);n.h.a(new _fm.d(this.gF(),null,this.eM))}if(this.bb()===4||this.be.b===2||this.cR()){if(this.cR()){this.gA(n);this.gB(n)}}else{this.gB(n);this.gA(n)}if(this.cb){this.bq=1;n.h.a(new _fm.d(this.gJ(),null,this.fs))}if(this.fg&&this.ba()){n.h.a(new _fm.d(_nbs.a.DM,null,this.eO));this.i()&&this.i().f()&&n.h.a(new _fm.d(this.i().h(),null,this.fR))}this.gH()&&n.h.a(new _fm.d(_nbs.a.Hh,null,this.eE));this.iE(n)},gB:function(n){this.bN()&&n.h.a(new _fm.d(_nbs.a.KF,null,this.bR))},gA:function(n){if(this.bg.c())n.h.a(new _fm.d(_nbs.a.Su,null,this.dx));else{(!this.ba()||this.eT)&&n.h.a(new _fm.d(_nbs.a.fq,null,this.dx));this.ba()&&n.h.a(new _fm.d(_nbs.a.Ra,null,this.fo))}},iy:function(){this.Z.bH(this)},iC:function(n){_js.Trace.logInfo(_at.a.a,"Submitting server action for file attachment with content.");var t=new _at.i(2,n,this.Z.a(),this.br(),this.Z.c(),this.cw(),this.bW,this.cm);t.v(this.dn);t.w(this.eu);t.z(this.dm);OwaApplication.a.a(t)},w:function(n){this.dM=n;return n},hy:function(){if(!this.bp&&!this.gN(0)){_js.Trace.logInfo(_at.a.a,"Deleting attachment.");this.bd=_a.d.b(_a.a.c,"AttachmentDeleteAttachment");this.gY(!0);var n="";var i=!!this.Y.bh.AttachmentId&&!!this.Y.bh.AttachmentId.Id&&!this.Y.bh.AttachmentId.Id.startsWith("smime-");if(i){_js.Trace.logInfo(_at.a.a,"Deleting attachment from server.");this.Z.j(this,!1);this.Z.bJ(this)}else if(this.fP)if(this.dA())this.hm();else{_js.Trace.logError(_at.a.a,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");this.bd.j=this.cs(0);this.bd.k=n="DeleteInProcess";_a.d.a(this.bd);this.bd=null}else{if(_g.m.isInstanceOfType(this.Y)){var t=this.Y;this.eS(t)}else _js.Trace.logInfo(_at.a.a,"Not a file attachment.");this.Z.j(this,!0);if(this.bd){this.bd.j=this.cs(0);_a.d.a(this.bd);this.bd=null}n="DeletedWhileInQueue"}this.bA&&this.dZ(n)}},hm:function(){if(!this.cU){_js.Trace.logInfo(_at.a.a,"Cancel attachment with cancellationId {0}",this.br());this.bV=!1;this.gX(!0);var n=new _at.J(this.br());n.w(this.fZ);n.v(this.fY);OwaApplication.a.a(n)}},iR:function(n,t,i){this.fA(!0);if(this.cW){_js.Trace.logInfo(_at.a.a,"Attachment skipped because it's been deleted while it was pending.",this.Y.bh.Name);t(null);return}var u=n;var r=u.Body.ParentItemId;this.Z.a().Id=r.Id;this.Z.a().ChangeKey=r.ChangeKey;this.cz=t;this.dI(t)},hf:function(n){this.cI=this.dz.a();this.bQ=n;var r=!0;var u=!0;if(!_js.d.a(this.Z.c())){r=!!this.by&&this.by.a(this.Z.c(),"SlicedAttachments");u=!!this.by&&this.by.a(this.Z.c(),"ClassicSlicedAttachments")}var i=!!this.bc&&!!this.bc.a();var f=_g.k.isInstanceOfType(this.Y)&&r&&i&&this.bc.a().bi().Enabled;var e=!_g.k.isInstanceOfType(this.Y)&&u&&i&&this.bc.a().bE().Enabled;if((f||e)&&this.bg.n()&&this.br()){this.bW=-1;this.cm=Math.ceil(this.bH.a()/1048576);_g.k.isInstanceOfType(this.Y)||this.fI(!0);this.hg()}else{var t=this;this.cI.a(this.bH,function(n,i,r,u){t.bQ&&i&&t.dg(new _at.p(i,null,r,u,!1));t.de(n)},this.ev,_at.a.a,this.bQ)}},hg:function(){if(!this.Z||!this.Z.h()){_js.Trace.logInfo(_at.a.a,"The attachment upload seems to have been stopped. Aborting further uploads.");return}if(this.bQ&&this.cm>1){this.eP=this.dz.a();this.hD();this.bQ=!1}var t=this.bH;this.bW++;var i=1048576*this.bW;var r=Math.min(i+1048576,t.g.size);var u=t.g.slice(i,r,t.g.type);var n=this;this.cI.a(new _h.cH(u),function(t,i,r,u){n.bQ&&i&&n.dg(new _at.p(i,null,r,u,!1));n.de(t)},this.ev,_at.a.a,this.bQ)},hD:function(){if(this.bH.a()<=10485760){var n=this,t=this;this.eP.a(this.bH,function(t,i,r,u){i&&n.dg(new _at.p(i,null,r,u,!1))},function(){},_at.a.a,this.bQ)}},hC:function(){this.cg(2,_at.h.f(this.cI),!1);this.dp(null)},iQ:function(){_js.Trace.logInfo(_at.a.a,"Submitting action for item or id attachment.");var n=new _at.i(2,this.Y,this.Z.a(),this.br(),this.Z.c(),this.cw(),0,1);n.v(this.dn);n.z(this.dm);OwaApplication.a.a(n)},hx:function(){var t=this.Z.a();var n=new _g.g(t.Id);n.ChangeKey=t.ChangeKey;var i=new _gg.eo(n);return new _gg.en(null,i)},dp:function(n){var r=this.bf?_y.bm.toString(this.bv):"";_js.Trace.logInfo(_at.a.a,"Attachment create completed. Status: {0} CancellationId: {1}",r,this.br());this.fI(!1);if(!this.bJ){if(this.cz){n&&this.dS(n.n());this.cz(this.cF)}this.fA(!1);this.dR(!this.bf&&this.be.a);this.dj();if(_g.x.isInstanceOfType(this.Y)){this.Z.j(this,!1);this.df(n.c);this.cE();this.Z.N(this)}if(this.iN()){_js.Trace.logInfo(_at.a.a,"Incrementing parent well size.");(!n||this.Z.o(this.bn))&&this.Z.bD(this.Y.a());this.fM()}if(_g.k.isInstanceOfType(this.Y)){var t=this.Y.c;if(_y.z.isInstanceOfType(t)){var i=t;!_js.d.a(i.g())&&this.eV()&&this.dg(new _at.p(i.g(),null,200,150,!0))}}}this.ej("OnUploadCompleteEvent",this)},iN:function(){if(this.bf||this.bJ)return!1;if(this.bg.r()||_g.z.isInstanceOfType(this.Y)||_g.k.isInstanceOfType(this.Y))return!0;if(_g.m.isInstanceOfType(this.Y)){var n=this.Y.c;if(_y.co.isInstanceOfType(n))return!0;if(_y.z.isInstanceOfType(n))return n.j()}return!1},ho:function(n){_js.Trace.logInfo(_at.a.a,"Cancel attachment succeeded with cancellationId {0}",this.br());this.fA(!1);this.Z&&this.Z.o(this.bn)&&this.Z.j(this,!1);this.gC(n)},hn:function(n){_js.Trace.logWarning(_at.a.a,"cancel failed with error: {0} and cancellationId: {1}",n&&n.t?n.t.message:"N/A",this.br());this.bV=!0;this.gC(n)},gC:function(n){this.cz&&this.cz(null);this.gX(!1);this.iF(!this.bV);this.ej("OnCancelCompleteEvent",this);if(this.bd){this.bd.k=this.bV?n.D():null;this.bd.j=this.cs(2);this.bd.l=n?n.C():null;_a.d.a(this.bd);this.bd=null}},hA:function(n){this.gQ(n,"")},gQ:function(n,t){_js.Trace.logWarning(_at.a.a,"delete failed with error: {0}",n?n.t.message:t);this.bf=!0;this.gY(!1);this.Z.o(this.bn)&&!this.bD&&this.Z.N(this);if(this.bd){this.bd.k=n?n.D():t;this.bd.j=this.cs(1);this.bd.l=n?n.C():null;_a.d.a(this.bd);this.bd=null}},hz:function(n){this.ej("OnDeleteCompleteEvent",this);if(this.bd){this.bd.j=this.cs(1);this.bd.l=n?n.C():null;_a.d.a(this.bd);this.bd=null}},iM:function(){_y.bP.a=this.bj.a()==="Mouse"&&this.bj.c()&&!this.bP();this.bx&&this.Z&&this.Z.a()&&this.bx.b(this.Z.a(),"Downloaded",this.bi,!!this.ba())},ix:function(){(this.bp||this.Y.bh.AttachmentId)&&(this.gN(1)||(this.bN()&&!this.cR()?this.gV():this.dw()))},gN:function(n){if(this.dr&&this.dM){_js.Trace.logInfo(_at.a.a,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.q(!1);this.dM(this.Y,n);return!0}return!1},dw:function(){this.dD()&&(_y.bP.a=this.bj.a()==="Mouse"&&this.bj.c()&&!this.bP());var n=this.bp&&!this.ba();if(this.Y.bh.AttachmentId)if(OwaApplication.b){_js.Trace.logInfo(_at.a.a,"GenericMailMode, always download the attachment.");this.dd(this.bh,n)}else if(_g.x.isInstanceOfType(this.Y))this.dL();else if(_g.m.isInstanceOfType(this.Y))this.dd(this.bh,n);else if(_g.z.isInstanceOfType(this.Y)){var t=this.Y;t.bh.ItemId?this.dL():t.bh.IsAttachmentItemAttachment?this.dL():this.dd(this.bh,n)}else this.dd(this.bh,n)},dL:function(){if(!this.hH()){_js.Trace.logInfo(_at.a.a,"Unsupported item.");this.bL(_nbs.a.CF);return}this.bx&&this.Z&&this.Z.a()&&this.bx.b(this.Z.a(),"Downloaded",this.bi,!!this.ba());if(this.Y.n()){var n=this;this.gE(function(t){t.a();n.gT()})}else this.gT()},hl:function(){this.cG=_a.d.b(_at.a.a,"AddIcsToCalendarFromDropDownMenu",!0);if(this.ca)this.gO();else{var n=this;this.eF.a(function(t){n.ca=t.a();n.gO()})}},gO:function(){this.ca.e(this.Y.bh.Name);this.ca.a(this.Y.bh.AttachmentId.Id);this.ca.b(this.ex);this.fw(1);this.ca.c()},iu:function(n){if(_js.d.a(n)){this.fw(2);_a.d.a(this.cG)}else{this.fw(3);this.cG.m=n;_a.d.a(this.cG)}this.ca.d(this.ex)},gT:function(){var n={};n.AttachmentItemID=this.Y.bh.AttachmentId.Id;this.bt&&(n.IsDiscovery="1");_js.Trace.logInfo(_at.a.a,"Opening item attachment in pop-out window.");this.bj.v(IItemAttachmentPopOutFactory,null,n,_bc.c.a())},dd:function(n,t){this.iP();this.Y?this.Y.bh.AttachmentId?_js.Trace.logInfo(_at.a.a,"SafeOpenAttachment: Name={0}, ID={1}",this.Y.bh.Name,this.Y.bh.AttachmentId.Id):_js.Trace.logWarning(_at.a.a,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.a.a,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.a.a,"SafeOpenAttachment: Policy={0}",this.be.toString());if(this.be.e){_js.Trace.logInfo(_at.a.a,"Attachment policy forces browser viewing.");this.bj.a()==="Mouse"?this.bL(_nbs.a.Vq):this.bL(_nbs.a.gT);return}if(!this.be.d){this.bL(_nbs.a.Qt);return}if(this.be.b===1){this.bL(_nbs.a.Tl);return}if(this.cv()){var i=this;this.gE(function(n){i.bx&&i.Z&&i.Z.a()&&i.bx.b(i.Z.a(),"Downloaded",i.bi,!!i.ba());n.c()});return}if(this.be.b===2){this.iO();return}this.Y&&this.cJ()&&this.fl(n,t)},iO:function(){if(this.bj.a()==="Mouse"){_js.Trace.logInfo(_at.a.a,"Attachment policy forces save.");this.bg.a()?this.bL(_nbs.a.XH):this.bL(_nbs.a.iI)}else{_js.Trace.logInfo(_at.a.a,"Attachment policy forces save, but device doesn't support download.");this.bL(_nbs.a.Qz)}},gV:function(){if(this.Y){this.bx&&this.Z&&this.Z.a()&&this.bx.b(this.Z.a(),"Previewed",this.bi,!!this.ba());if(this.il(this.Y.bh.Name)&&this.Y.a()>10485760){this.dy.a(_a.n,new _a.n([_nbs.a.gA],1,this.gj,1,!1,_nbs.a.fq,_nbs.a.n,_nbs.a.Kg));return}if(this.bU){this.bU.a()&&this.Z.v(this.Y.bh.AttachmentId);this.bU.b();return}if(this.dq){var n=this;this.dq.a(function(t){if(!n.Z){_js.Trace.logError(_a.a.c,"Preview: Parent well is null.");return}if(!n.Y){_js.Trace.logInfo(_a.a.c,"Preview: Attachment is null.");return}n.iD(t.a(n,n.Z.d(),n.eL,n.fj,n.fp));n.bU.a()&&n.Z.v(n.Y.bh.AttachmentId);n.bU.b()})}}},iw:function(n){_js.Trace.logInfo(_at.a.a,"Save to cloud action succeeded with Id:{0}.",this.bo())},iv:function(n){_js.Trace.logInfo(_at.a.a,"Failed to save attachment with Id:{0} to Cloud.",this.bo());this.bS(4);this.hd()},ij:function(n){var t=n;if(t){if(t.ResultCode){_js.Trace.logError(_a.a.c,String.format("Saving attachmentID: {0} failed with ResultCode: {1}. Exception: {2}",this.bo(),t.ResultCode,t.Exception));this.bS(4)}else this.bS(3);this.hd()}else _js.Trace.logError(_a.a.c,String.format("Received NULL payload while saving attachment: {0} to cloud",this.bo()))},hd:function(){_a.d.a(this.dN);this.dN=null;_y.H.b(this.cy,this.m(),this.ew)},iB:function(){if(this.cb){_js.Trace.logInfo(_at.a.a,"Saving attachment with Id:{0} to Cloud.",this.bM);this.dN=_a.d.b(_a.a.c,"SaveSingleAttachmentToCloud");this.bS(2);_y.H.a(this.cy,this.m(),this.ew,"AttachmentViewModel",String.format("NotificationHandler is NULL for AttachmentID:{0}",this.bM));var n=new _at.D(this.bo(),null,this.m());n.w(this.gq);n.v(this.gp);this.bB.a(n)}},ht:function(){if(this.Z){this.ch=(_a.c.a().h()+_ff.q.a(0,1e6)).toString();this.Z.bm(this,this.ch)}},hu:function(){if(this.Z&&this.Y&&this.ba()){this.ch=(_a.c.a().h()+_ff.q.a(0,1e6)).toString();this.Z.bn(this,this.ba().bh.AttachLongPathName,this.ch)}},hp:function(){this.ba()?this.hr():this.hq()},hq:function(){if(this.bo()){_js.Trace.logInfo(_a.a.c,"Canceling convert local to reference attachment. Attachment Id: {0}.",this.bo());var n=new _at.K(this.ch);n.w(this.gl);n.v(this.gk);this.bB.a(n);this.n(4);this.ea("ShowCancelButton")}},iq:function(n){_js.Trace.logInfo(_a.a.c,"Cancel convert local to reference action succeeded for attachment id {0}.",this.bo())},ip:function(n){_js.Trace.logInfo(_a.a.c,"Cancel convert local to reference action failed for attachment id {0}.",this.bo())},hr:function(){if(this.bo()){_js.Trace.logInfo(_at.a.a,"Canceling convert reference to local attachment. Attachment Id:{0}.",this.bo());var n=new _at.L(this.ch);n.w(this.gn);n.v(this.gm);this.bB.a(n);this.j(4);this.ea("ShowCancelButton")}},is:function(n){_js.Trace.logInfo(_a.a.c,"Cancel convert reference to local action succeeded for attachment id {0}.",this.bo())},ir:function(n){_js.Trace.logInfo(_a.a.c,"Cancel convert reference to local action failed for attachment id {0}.",this.bo())},hv:function(){window.clipboardData?window.clipboardData.setData("Text",this.bu):prompt(_nbs.a.Ci,this.bu)},iS:function(){var n=this.bu;var t=n.lastIndexOf("/");t>=1&&(n=n.substr(0,t));this.gR(n,!1)},gM:function(n){var t=this.bM;t!==n&&this.fi(t,n)},fM:function(){this.iI(this.ck||_g.z.isInstanceOfType(this.Y)&&!this.Y.a()||_g.m.isInstanceOfType(this.Y)&&_y.co.isInstanceOfType(this.Y.c)&&!this.Y.a()||_g.m.isInstanceOfType(this.Y)&&_y.z.isInstanceOfType(this.Y.c)&&!this.Y.a())},dk:function(){if(this.ba())if(!this.Y.bh.AttachmentId||this.bk===3||this.bl===3||this.cP()){this.hb(!1);this.hc(!1)}else{this.hb(this.P()===2);this.hc(this.P()===1)}},iP:function(){if(!this.cv()&&this.eY()){var n=_g.j.a.q(this.Y.bh.AttachmentId);this.Y.bh.AttachmentId.Id!==n.Id&&this.Y.g(n)}},eQ:function(n){var t=new _a.q;if(this.ba()){var i=this.ba().q?this.ba().q:this.ba().c?this.ba().c.a():0;t.a("S",i)}else t.a("S",this.Y.a());t.a("W",this.Z.c()?1:0);t.a("C",this.bJ?1:0);t.b("E",this.bi);t.b("DP",this.ey);if(n){t.c("H",this.eC);t.b("P",this.ez);t.c("O",this.eB)}return t.toString()},cs:function(n){var t=new _a.q;t.a("S",this.Y.a());var i="A";_at.o.isInstanceOfType(this)?i="C":this.bb()===5?i="T":this.Y.b()&&(i="I");t.b("T",i);t.a("O",n);t.a("W",this.Z.c()?1:0);this.cq&&t.b("Q",this.cq);t.b("E",this.bi);return t.toString()},fL:function(){this.ea("ShouldAffordanceMenuBeHidden")},gE:function(n){if(this.cv()){_js.Trace.logInfo(_a.a.j,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.fC.a(function(i){if(!t.di){_js.Trace.logInfo(_a.a.j,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.di=i.e();t.di.b(t.Y)}_js.Trace.logInfo(_a.a.j,"[AttachmentViewModel] Executing smime operation.");n(t.di)})}},hs:function(){return!!this.bc&&this.bc.a().bG().Enabled&&this.Z.z()&&!_g.k.isInstanceOfType(this.Y)&&!this.Y.b()&&this.bb()!==4&&this.Z.i()&&(!this.Z.d()||this.Z.d().c()!==2)&&!_js.d.a(this.Z.g())},io:function(){return!!this.bc&&this.bc.a().bH().Enabled&&(!this.Z.c()||!!this.by&&this.by.a(this.Z.c(),"PersistAttachmentPermission"))},gL:function(){if(this.Y){var t=null;if(this.eV()&&!_js.d.a(this.Y.bh.AttachmentThumbnailUrl))t=new _at.p(this.Y.bh.AttachmentThumbnailUrl,null,200,150,!0);else if(!_js.d.a(this.Y.bh.Thumbnail)&&this.dE()){var i="data:"+this.Y.bh.ThumbnailMimeType+";base64,"+this.Y.bh.Thumbnail;var n=this.Y;if(!n){_js.Trace.logWarning(_at.a.a,"Attachment should be FileAttachment while there is thumbnail");return}if(n.A()<=0||n.t()<=0){_js.Trace.logWarning(_at.a.a,"Thumbnail width and Height should be bigger than zero");return}t=new _at.p(i,n.D(),n.A(),n.t(),!1);_js.Trace.logInfo(_at.a.a,"FileAttachment ThumbnailHeight={0}, ThumbnailWidth={1}",n.t(),n.A())}this.dg(t)}},gU:function(){if(this.bM&&this.dD()&&this.be&&this.be.a){if(this.Y&&this.Y.bh.Name&&!_g.k.isInstanceOfType(this.Y)&&this.bE&&this.bE.WacPreloadMappings&&this.bE.WacPreloadMappings.length>0){if(!_at.a.b){_at.a.b={};for(var t=0;t<this.bE.WacPreloadMappings.length;t++)_at.a.b[this.bE.WacPreloadMappings[t][0]]=this.bE.WacPreloadMappings[t][1]}var i=_a.bh.a(this.Y.bh.Name);if(i in _at.a.b){var o=_at.a.b[i];delete _at.a.b[i];this.iL(o)}}var e=this.bM.Id;var f=this;var r=function(n){if(n&&n.Status===9){f.fF=!0;f.dj()}};var u=_at.l.a().d(e);if(u){r(u);return}var n=this;_js.g.a().d(_a.a.c,"AttachmentViewModel.PreloadWacAttachmentInfo",function(){if(n.Z&&n.Z.d()){var t=new _at.C(e,!1,null,!!n.ba(),n.Z.d().c(),n.Z.c(),n.bt);t.v(function(n){r(t.c)});n.bB.a(t)}})}},il:function(n){var t=_a.bh.a(n).toLowerCase();switch(t){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},iz:function(){this.dd(this.bu,!1)}};_at.W=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.y=_at.a;_a.b.a(t,"owaShell");_a.b.a(i,"palDownloadManager");_a.b.a(r,"userAgent");_a.b.a(u,"nativeBridge");_a.b.a(s,"itemStoreGetterFactory");this.o=n;this.c=t;this.t=i;this.d=r;this.r=u;this.b=f;this.g=e;this.e=o;this.p=s;this.v=h;this.u=c;this.q=l;this.i=a;this.s=v;this.m=y;this.k=p;this.j=w;this.n=b;this.l=k};_at.W.prototype={c:null,i:null,s:null,d:null,t:null,r:null,g:null,e:null,p:null,j:null,o:null,q:null,b:null,h:null,y:null,v:null,u:null,m:null,k:null,n:null,l:null,a:function(n,t,i,r,u,f,e){if(this.x()&&(_g.k.isInstanceOfType(n)||_g.m.isInstanceOfType(n)&&_y.z.isInstanceOfType(n.c))){if(!this.h&&this.b){var o=this;this.b.a(function(n){o.h=n})}_a.b.b(this.h,"attachmentProviderItemViewModelFactory");return this.h.a(n,this.c,t,i,r,this.d,u,f,e)}else if(_g.m.isInstanceOfType(n)&&_y.co.isInstanceOfType(n.c)){_a.b.b(this.v,"uriFileAttachmentViewModelFactory");return this.v.a(n,this.c,t,i,r,this.d,u,f,e)}else return new _at.b(n,this.c,t,i,r,this.t,this.o,this.r,this.d,this.s,this.i,this.g,this.e,this.p,u,f,e,this.u,this.q,this.m,this.k,this.j,this.n,this.l)},f:function(n,t,i,r,u,f,e,o){if(this.x()&&this.b&&(_g.k.isInstanceOfType(n)||_g.m.isInstanceOfType(n)&&_y.z.isInstanceOfType(n.c))){var s=this;var c=function(h){var c=h.a(n,s.c,t,i,r,s.d,f,e,o);u(c)};this.b.a(c)}else{this.b||_js.Trace.logError(_a.a.c,"attachmentProviderItemViewModelFactoryLazy is null");_g.k.isInstanceOfType(n)&&_js.Trace.logWarning(_a.a.c,"We shall not construct PALAttachmentViewModel for ReferenceAttachment.");var h=new _at.b(n,this.c,t,i,r,this.t,this.o,this.r,this.d,this.s,this.i,this.g,this.e,this.p,f,e,o,this.u,this.q,this.m,this.k,this.j,this.n,this.l);u(h)}},A:function(n,t,i,r,u,f,e,o,s){if(this.b&&_g.k.isInstanceOfType(t)){var h=this;var c=function(c){var l=c.b(t,h.c,i,r,u,h.d,n,e,o,s);f(l)};this.b.a(c)}},z:function(n,t,i,r,u,f,e,o){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.w(n,0,new Array(0),t,i,r,u,f,e,o)},w:function(n,t,i,r,u,f,e,o,s,h){var c=this;this.f(n[t],r,u,f,function(l){Array.add(i,l);t<n.length-1?c.w(n,t+1,i,r,u,f,e,o,s,h):e(i)},o,s,h)},x:function(){return this.g?this.g.a().w().Enabled:!1}};_at.t=function(n){this.a=n};_at.t.prototype={a:null};_at.X=function(n){_at.X.initializeBase(this,[n])};_at.X.prototype={f:function(){return!1},h:function(){return""},j:function(){return""},c:function(){return""},n:function(){return""},m:function(){return _nbs.a.KK},d:function(){return""},b:function(){return""},g:function(){return""},i:function(){return""},a:function(){return""},e:function(){return String.format(_nbs.a.PK,this.k)}};_at.Y=function(n){_at.Y.initializeBase(this,[n])};_at.Y.prototype={f:function(){return!1},h:function(){return""},j:function(){return _nbs.a.OB},c:function(){return _nbs.a.bJ},n:function(){return _nbs.a.dI},m:function(){return _nbs.a.KK},d:function(){return _nbs.a.h},b:function(){return _nbs.a.Qr},g:function(){return _nbs.a.ZN},i:function(){return _nbs.a.Xp},a:function(){return _nbs.a.Cd}};_at.Z=function(n){_at.Z.initializeBase(this,[n])};_at.Z.prototype={l:function(){return _nbs.a.YV},f:function(){return!0},h:function(){return String.format(_nbs.a.MC,_nbs.a.YV)},j:function(){return _nbs.a.FW},c:function(){return _nbs.a.hc},n:function(){return _nbs.a.LK},m:function(){return _nbs.a.Ht},d:function(){return _nbs.a.DC},b:function(){return _nbs.a.eH},g:function(){return _nbs.a.Bw},i:function(){return _nbs.a.mM},a:function(){return _nbs.a.LY}};_at.h=function(){};_at.h.c=function(n){var r;if(n){if(_h.bO.isInstanceOfType(n)&&(r=n.a())){var i=r.responseCode;if(i&&i!=="NoError")return i;var t=r.response;if(t){var f=t.fault;if(f){var u=_at.h.d(f);if(u)return u}if(t.statusCode)return"https_"+t.statusCode}}if(n.t)return _at.h.a(n.t)}return"UnknownError_Action"};_at.h.a=function(n){if(n){var t;if((t=n.responseCode)&&t!=="NoError")return t.toString();if(t=n.StackTrace)return _at.h.e(t.toString());if(t=n.ErrorCode)return"https_"+t;if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.h.d=function(n){if(n){if(n.ResponseCode&&n.ResponseCode!=="NoError")return n.ResponseCode;if(n.StackTrace)return _at.h.e(n.StackTrace);if(n.ErrorCode)return"https_"+n.ErrorCode}return null};_at.h.e=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.h.f=function(n){var i=n.c();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.h.b.length?_at.h.b[t]:_at.h.a(i)}return n.d()?_at.h.a(n.d()):"UnknownError_FileReader"};_at.o=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){this.C=Function.createDelegate(this,this.iU);this.cf=Function.createDelegate(this,this.iT);_at.o.initializeBase(this,[n,t,i,r,u,s,f,e,o,h,c,l,a,v,y,p,k,w,b,d,g,nt])};_at.o.a=function(n){if(n){if(n.ResultCode===10)return 5;if(n.ResultCode===17)return 6;if(n.ResultCode===15)return 7}return 1};_at.o.prototype={W:function(){_y.H.a(this.cy,this.m(),this.cf,this.co(),"NULL NotificationHandler passed in from ExternalSourceAttachmentViewModel.")},fU:function(){_y.H.b(this.cy,this.m(),this.cf)},ci:function(n){this.fU();_at.a.prototype.ci.call(this,n)},iU:function(n){this.dv(n);this.ci(null)},iT:function(n){var i=null;var t=n;i=n?_js.d.a(t.Exception)?this.dl(t.Response):String.format("Exception from Server: "+t.Exception):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.cg(_at.o.a(t),i,!0)}else this.fT(t);this.ci(null)},fT:function(n){},dl:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.Y.i(i.Attachments[0].Size);_at.i.b(i,this.Y,this.Z.a(),!0);if(_g.k.isInstanceOfType(this.Y)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.Y.D(t.AttachLongPathName);this.Y.I(t.ProviderType);this.Y.H(t.ProviderEndpointUrl);this.Y.m(t.ContentId);this.Y.G(t.AttachmentThumbnailUrl);this.Y.F(t.AttachmentPreviewUrl)}if(!$a(t.PermissionType)){this.Y.r(t.PermissionType);this.dk()}this.Y.e(t.Name)}}else r="The response message received is null";return r}};_at.bh=function(n){this.k=n};_at.bh.prototype={k:null,l:function(){return this.k},s:function(){return String.format(_nbs.a.MU,this.k)},p:function(){return String.format(_nbs.a.aT,this.k)},o:function(){return String.format(_nbs.a.DU,this.k)},q:function(){return String.format(_nbs.a.OC,this.k)},r:function(){return String.format(_nbs.a.Nt,this.k)},e:function(){return String.format(_nbs.a.PK,this.l())}};_at.e=function(){};_at.e.c=function(n,t,i,r){var u=_a.d.b(_a.a.c,"MailComposeImageSizeDecode");i.val=r.val=0;if(!t){u.k="EmptyContent";_a.d.a(u);return}if(n==="image/png")_at.e.n(t,i,r,u);else if(n==="image/jpeg")_at.e.m(t,i,r,u);else if(n==="image/gif")_at.e.l(t,i,r,u);else if(n==="image/bmp")_at.e.k(t,i,r,u);else{u.k="UnsupportedImage";u.m=String.format("Image type {0} is not supported.",n);_a.d.a(u)}};_at.e.n=function(n,t,i,r){var p=n.length>100?100:n.length;var w=n.substring(0,p);var s=_at.e.b(_a.be.a(w));if(s.length>24){for(var h=0,f=0,y=new Array(8),u=0;u<8;u++)y[u]=s[u];if(_at.e.a(y,_at.e.j)){for(var o=16,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.e.d(v);f=_at.e.d(a);if(h<=0||f<=0){_js.Trace.logWarning(_a.a.c,"Width and height of a png image have to be > 0.");r.k="IllegalDimensions";r.m="png";h=f=0}}else{_js.Trace.logWarning(_a.a.c,"The png image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="png"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="png"}_a.d.a(r)};_at.e.l=function(n,t,i,r){var p=n.length>20?20:n.length;var w=n.substring(0,p);var s=_at.e.b(_a.be.a(w));if(s.length>10){for(var h=0,f=0,a=new Array(6),u=0;u<6;u++)a[u]=s[u];if(_at.e.a(a,_at.e.h)||_at.e.a(a,_at.e.i)){for(var o=6,e=2,y=new Array(e),l=0;l<e;l+=1){y[l]=s[o];o+=1}for(var v=new Array(e),c=0;c<e;c+=1){v[c]=s[o];o+=1}h=_at.e.e(y);f=_at.e.e(v);if(h<=0||f<=0){_js.Trace.logWarning(_a.a.c,"Width and height of a gif image have to be > 0.");r.k="InvalidDimensions";r.m="gif";h=f=0}}else{_js.Trace.logWarning(_a.a.c,"The gif image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="gif"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="gif"}_a.d.a(r)};_at.e.k=function(n,t,i,r){var p=n.length>50?50:n.length;var w=n.substring(0,p);var s=_at.e.b(_a.be.a(w));if(s.length>26){for(var h=0,f=0,y=new Array(2),u=0;u<2;u++)y[u]=s[u];if(_at.e.a(y,_at.e.g)){for(var o=18,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.e.f(v);f=_at.e.f(a);if(h<=0||f<=0){_js.Trace.logWarning(_a.a.c,"Width and height of a bmp image have to be > 0.");r.k="InvalidDimensions";r.m="bmp";h=f=0}}else{_js.Trace.logWarning(_a.a.c,"The bmp image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="bmp"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="bmp"}_a.d.a(r)};_at.e.m=function(n,t,i,r){for(var f=_at.e.b(_a.be.a(n)),c=f.length,l=!1,a=!1,u=0,o=0,s=0;!l&&!a&&u+1<c;){u+=1;var h=f[u];u+=1;var e=0;switch(h){case 216:case 217:e=0;break;case 221:e=2;break;default:if(u+2<c){var y=f[u];u+=1;var v=f[u];u+=1;e=(y<<8|v)-2}else{_js.Trace.logWarning(_a.a.c,"Malformed jpeg.");r.k="MalformedJpeg";_a.d.a(r);return}break}h===217&&(a=!0);if(e>0){if(h===192){if(u+4<c){o=f[u+3]<<8|f[u+4];s=f[u+1]<<8|f[u+2]}else{_js.Trace.logWarning(_a.a.c,"Malformed segment in jpeg.");r.k="MalformedJpeg";_a.d.a(r);return}l=!0}u+=e}}if(o<=0||s<=0){if(l){_js.Trace.logWarning(_a.a.c,"Width and height of a jpeg image have to be > 0.");r.k="InvalidDimensions";r.m="jpeg"}else{_js.Trace.logWarning(_a.a.c,"Image dimension segment not found for jpeg image.");r.k="MissingDimension";r.m="jpeg"}o=s=0}t.val=o;i.val=s;_a.d.a(r)};_at.e.b=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;t++)r[t]=n.charCodeAt(t);return r};_at.e.d=function(n){for(var i=0,t=0;t<4;t++)i=(i<<8)-0+n[t];return i};_at.e.e=function(n){for(var i=0,t=1;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.e.f=function(n){for(var i=0,t=3;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.e.a=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(n[i]!==t[i])return!1;return!0};_at.G=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){_at.G.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,null,k,d,g])};_at.G.a=function(){return"UriFileAttachmentNotification"+(_a.c.a().h()+_ff.q.a(0,1e3)).toString()};_at.G.prototype={h:null,m:function(){this.h||(this.h=_at.G.a());return this.h},co:function(){return"UriFileAttachmentViewModel"},dA:function(){return!1},dI:function(n){if(_g.m.isInstanceOfType(this.Y)&&_y.co.isInstanceOfType(this.Y.c)){_js.Trace.logInfo(_a.a.h,"Uploading attachment from URL");var i=this.Y.c;this.W();var t=new _at.be(this.Z.a(),i.d(),i.b(),this.m());t.v(this.C);this.bB.a(t)}else{_js.Trace.logError(_a.a.h,"Unsupported upload type detected in addFileAttachment");n(null)}},ep:function(){this.fx(!1)}};_at.H=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.k=n;this.b=t;this.i=i;this.h=r;this.e=u;this.l=e;this.d=s;this.j=h;this.c=c;this.g=l;this.f=a};_at.H.prototype={k:null,b:null,i:null,h:null,m:null,e:null,j:null,c:null,g:null,f:null,l:null,d:null,a:function(n,t,i,r,u,f,e,o,s){return new _at.G(n,t,i,r,u,f,this.k,this.b,this.i,this.h,this.e,e,o,s,this.l,this.m,this.d,this.j,this.c,this.g,this.f)}};_at.ba=function(n){this.g=n;this.c={};this.a=new _ff.d};_at.ba.prototype={g:null,c:null,a:null,b:function(n){_a.b.c(n,"attachmentId");return n in this.c},h:function(n){this.d(n);if(!this.b(n.a)){this.a.c(n);this.c[n.a]=""}},e:function(n,t){this.d(t);if(!this.b(t.a)){this.a.k(n,t);this.c[t.a]=""}},i:function(){if(this.a.d.length>0){var n=this.a.d[0];this.f(n);return n}else return null},f:function(n){this.d(n);if(this.b(n.a)){delete this.c[n.a];for(var i=-1,t=0;t<this.a.d.length;t++)if(this.a.d[t].a===n.a){i=t;break}i!==-1&&this.a.j(i)}},d:function(n){_a.b.a(n,"parameter");_a.b.a(n.a,"AttachmentId")}};_at.k=function(){};_at.k.e=function(n,t,i,r,u,f,e){_a.b.a(n,"initNativeBridge");_a.b.a(t,"initClientStore");_a.b.a(i,"initAttachmentInfoRecord");_a.b.c(r,"initMimeType");_a.b.c(u,"fileName");_a.b.a(f,"initOnOpenAttachmentSuccess");_a.b.a(e,"initOnOpenAttachmentError");if(_at.k.b){_js.Trace.logInfo(_at.k.a,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.k.a,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.k.b=!0;n.e().f(i.DataID,r,u,function(n){_at.k.d(n,i,t,f,e)});t.l(i.AttachmentId,function(n){},null)};_at.k.c=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.a.fr;break;case 2:t=_nbs.a.RS;break;default:break}_js.Trace.logInfo(_at.k.a,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.k.d=function(n,t,i,r,u){_at.k.b=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.g(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.k.a,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.k.a,"OnOpenDocument succeeded");r()}};_at.d=function(n,t,i){this.r=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.w);_a.b.a(n,"initNativeBridge");var r=t?t.j():null;this.l=n;this.q=i;this.k=n.q().a(r);this.v(t)};_at.d.prototype={k:!1,g:null,f:null,h:null,m:0,j:null,l:null,q:null,n:null,a:function(){if(!this.k&&_g.j.a){var n=_bc.k.isInstanceOfType(_g.j.a)?_g.j.a:null;this.k=this.l.q().a(n?n.e():null);this.v(n?n.d().j():null)}return this.k},d:function(n,t){_a.b.c(n,"attachmentId");_a.b.a(t,"callbacks");if(this.a()){this.j[n]=t;this.y(n,t)}else _js.Trace.logInfo(_at.d.a,"PAL does not support download.")},b:function(n){_a.b.c(n,"attachmentId");this.a()&&n in this.j&&delete this.j[n]},c:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_a.b.a(n.e,"DownloadUrl");_js.Trace.logInfo(_at.d.a,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.a()){if(!(n.a in this.j))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.C(n);if(_js.d.a(t)){if((!this.f||this.f.a!==n.a)&&!this.g.b(n.a)){_js.Trace.logInfo(_at.d.a,"Starting download for {0}",n);if(n.h){this.g.e(0,n);if(this.f){this.u();this.g.e(1,this.h);this.i(this.h,2)}else{this.i(n,2);this.p()}}else{this.g.h(n);this.i(n,2);this.p()}}}else this.x(n,t)}},e:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_js.Trace.logInfo(_at.d.a,"Cancel download for parameters {0}",n);if(this.a())if(this.g.b(n.a)){this.g.f(n);_js.Trace.logInfo(_at.d.a,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.g.a.d.length);this.i(n,1)}else if(this.f&&this.f.a===n.a){_js.Trace.logInfo(_at.d.a,"Current Download was canceled. {0}",this.f);this.u();this.i(this.h,1)}},z:function(n){var t=null;switch(n){case 0:break;case 7:break;case 8:break;case 9:t=_nbs.a.iu;break;case 2:t=_nbs.a.In;break;default:break}return t},v:function(n){if(this.k){this.n=n;this.g=new _at.ba(_at.d.a);this.j={};this.h=null;this.f=null;this.m=0}},u:function(){_js.Trace.logInfo(_at.d.a,"CancelCurrentDownload, canceling the current download");this.l.m().d();this.h=this.f;this.f=null},p:function(){_js.Trace.logInfo(_at.d.a,"Inside StartDownloadInternal");if(this.h)_js.Trace.logInfo(_at.d.a,"Still waiting for the canceled download to get canceled.");else if(this.f)_js.Trace.logInfo(_at.d.a,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.d.a,"StartDownloadInternal, pending items in queue {0}",this.g.a.d.length);this.f=this.g.i();this.m=0;if(this.f){_js.Trace.logInfo(_at.d.a,"Starting download {0}",this.f);this.i(this.f,3);var n=this;this.q.c(this.n,this.l,this.t,function(t){_js.Trace.logWarning(_at.d.a,"Scheduled cleanup failed due to error {0}",t);n.w()})}else _js.Trace.logInfo(_at.d.a,"Download queue is empty.")}},w:function(){_js.Trace.logInfo(_at.d.a,"Starting the download now for {0}",this.f);if(this.h){this.h=null;this.p()}else this.l.m().e(this.f.e,1,this.f.f,this.f.b,this.s,this.r)},B:function(n){if(this.f){this.m+=n;var t=this;this.o(this.f,function(n){n.W(t.m)})}},i:function(n,t){var i=this;this.o(n,function(n){n.h(t)})},x:function(n,t){var i=this;this.o(n,function(i){_js.Trace.logWarning(_at.d.a,"Raising OnError event with error {0} for attachment {1}",t,n);i.X(t)})},o:function(n,t){var i=this.j[n.a];i&&t(i)},A:function(n,t,i){_js.Trace.logInfo(_at.d.a,"OnDownloadComplete with errorCode = {0} httpstatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.f);if(this.h)this.h=null;else if(n||t!==200){var f=this.z(n);_js.d.a(f)||this.x(this.f,f);this.i(this.f,1)}else{var r=this.f;var u=new AttachmentInfoRecord(this.f.a,i,this.f.d,_a.c.get_utcNow().h(),this.f.g,0,_a.c.bJ(_a.c.get_utcNow()),!0);var e=this,s=this;this.n.r(u,function(n){_js.Trace.logInfo(_at.d.a,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.d.a,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.i(r,4);var o=this;this.o(r,function(n){_js.Trace.logInfo(_at.d.a,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.C(u)})}this.f=null;this.p()},C:function(n){var t=null;if(_bc.g.b(n.a)){_js.Trace.logInfo(_at.d.a,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.a.Jc}else if(_js.d.a(n.g)){_js.Trace.logInfo(_at.d.a,"Attachment is a quick message {0}",n);t=_nbs.a.Jc}else if(_js.d.a(n.b)){_js.Trace.logInfo(_at.d.a,"Attachment does not have content type set. {0}",n);t=_nbs.a.In}else if(_js.d.a(n.f)){_js.Trace.logInfo(_at.d.a,"Attachment does not have a valid file name {0}.",n);t=_nbs.a.In}else if(this.g.a.d.length===10){_js.Trace.logInfo(_at.d.a,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.a.NX,10)}return t},y:function(n,t){if(this.f&&n===this.f.a){_js.Trace.logInfo(_at.d.a,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.h(3)}else if(this.g.b(n)){_js.Trace.logInfo(_at.d.a,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.h(2)}else{var r=this,i=this;this.n.q(n,function(i){if(i){_js.Trace.logInfo(_at.d.a,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.h(4);t.C(i)}else{_js.Trace.logInfo(_at.d.a,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.h(1)}},function(i){_js.Trace.logWarning(_at.d.a,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.h(1)})}}};_at.w=function(){};_at.w.b=function(n){_a.b.a(n,"viewModel");_a.b.a(n.bh,"DownloadUrl should not be empty");var t=null;n.Z&&n.Z.a()&&(t=n.Z.a().Id);return _at.w.a(n.Y,n.Y.bh.Name,n.Y.bh.ContentType,n.bh,t,!1)};_at.w.a=function(n,t,i,r,u,f){_a.b.a(n,"attachment");_a.b.a(n.bh.AttachmentId,"attachmentId");_a.b.a(r,"downloadUrl");_a.b.a(r,"destinationFileName");var e=new _at.w;e.a=n.bh.AttachmentId.Id;e.d=n.a();e.c=t;e.f=_a.bh.a(e.c);e.b=i;e.e=_a.Uri.a(r);e.g=u;e.h=f;_js.d.a(e.b)&&!_a.UserAgent.getInstance().H&&(e.b="fakeMimeType");return e};_at.w.prototype={b:null,c:null,f:null,a:null,g:null,e:null,d:0,h:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.c,this.d,this.b,this.a)}};_at.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it){_at.b.initializeBase(this,[n,t,i,r,u,e,s,h,c,l,a,y,p,w,b,k,d,g,o,nt,tt,it]);_a.b.b(f,"palDownloadManager");_a.b.b(o,"nativeBridge");_a.b.b(v,"itemStoreGetter");this.bs=f;this.cf=o;this.es=v;this.Y&&this.hj(null,this.Y.bh.AttachmentId)};_at.b.prototype={cf:null,bs:null,es:null,fS:null,co:0,dl:null,fV:function(n){this.co=n;this.ea("PALAttachmentDownloadStatus");return n},iT:function(n){this.dl=n;this.ea("PALAttachmentCurrentDowloadedBytes");return n},eY:function(){return _at.a.prototype.eY.call(this)||_g.m.isInstanceOfType(this.Y)&&_a.bX.isInstanceOfType(this.Y.c)},bN:function(){var n=_at.a.prototype.bN.call(this);if(n&&this.cf&&this.cf.b(this.cf.e())){var t=this.cf.j(_a.ft,2);_js.Trace.logInfo(_at.b.a,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},fa:function(){return this.bg.c()&&this.bp},fU:function(){return this.bN()&&!this.cR()?!1:this.bs.a()&&this.bp},fT:function(){return!this.be.d||this.bs.a()||this.be.e||this.Y.bh.IsSmimeDecoded?!0:!1},fW:function(){this.iU()},h:function(n){_js.Trace.logInfo(_at.b.a,"Got attachment status {0}",n);this.fV(n)},W:function(n){this.iT(String.format(_nbs.a.Mc,this.hi(n,1),this.hi(this.Y.a(),0)))},X:function(n){_js.Trace.logWarning(_at.b.a,"Unable to download attachment with name {0} and error is {1}",this.Y.bh.Name,n);this.bL(n)},C:function(n){_js.Trace.logInfo(_at.b.a,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.fS=n},fO:function(n){_a.bX.isInstanceOfType(n.c)?n.b()?this.fD():this.hh():_at.a.prototype.fO.call(this,n)},eS:function(n){if(_a.bX.isInstanceOfType(n.c)){_js.Trace.logInfo(_at.b.a,"Deleting file attachment via PAL.");var t=n.c;this.cf.g().a(t.d())}else _at.a.prototype.eS.call(this,n)},fl:function(n,t){if(this.bs.a()){_js.Trace.logInfo(_at.b.a,"Will use PAL to open attachment.");this.hk()}else _at.a.prototype.fl.call(this,n,t)},fi:function(n,t){this.hj(n,t);_at.a.prototype.fi.call(this,n,t)},hk:function(){_js.Trace.logInfo(_at.b.a,"OpenAttachmentUsingPAL, download status={0}",this.co);if(!this.Z.o(this.bn)){_js.Trace.logWarning(_at.b.a,"The context has changed from "+this.bn+" to "+this.Z.P()+", opening attachment using PAL has been skipped.");return}if(this.Z.T()||!this.bp){_js.Trace.logInfo(_at.b.a,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.Z.T(),this.bp);return}this.iV();var t=_at.w.b(this);_js.Trace.logInfo(_at.b.a,"PAL attachment download parameters: {0}",t.toString());switch(this.co){case 0:case 1:this.W(0);_js.Trace.logInfo(_at.b.a,"Starting PAL attachment download.");this.bs.c(t);break;case 3:case 2:_js.Trace.logInfo(_at.b.a,"Canceling PAL attachment download.");this.bs.e(t);break;case 4:_js.Trace.logInfo(_at.b.a,"PAL attachment download complete.");var n=this;this.es.a(function(){var i=n.es.b().a(_g.a.a().a().bh.TimeZone);_at.k.e(n.cf,i.j(),n.fS,t.b,t.c,function(){_js.Trace.logInfo(_at.b.a,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.b.a,"Attachment open failed with errorCode {0}",t);t===2&&n.fV(1);var i=_at.k.c(t);n.bL(i)})});break;default:break}},hj:function(n,t){if(this.bs)if(_g.x.isInstanceOfType(this.Y)){_js.Trace.logInfo(_at.b.a,"ItemAttachment for PAL status:Downloaded");this.fV(4)}else if(this.bs.a()){!$a(n)&&n.Id&&this.bs.b(n.Id);!$a(t)&&t.Id&&this.bs.d(t.Id,this)}},iU:function(){if(this.bs.a()&&this.Y&&this.Y.bh.AttachmentId&&!_g.x.isInstanceOfType(this.Y)){_js.Trace.logInfo(_at.b.a,"Unsubscribing for attachment with name {0} and id {1}",this.Y.bh.Name,this.Y.bh.AttachmentId);this.bs.b(this.Y.bh.AttachmentId.Id)}},hi:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.R.TH}else if(n>=1048576){r/=1048576;i=_u.R.en}else if(n>=1024){r/=1024;i=_u.R.Da}else i=_u.R.QB;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},iV:function(){if(this.bg.d()&&(_js.d.b(this.Y.bh.ContentType)||_at.b.d===this.Y.bh.ContentType.toLowerCase())){var t=_a.bh.a(this.Y.bh.Name);var n;if(_js.d.b(t))n=_at.b.d;else{n=_at.b.f[t.toLowerCase()];_js.d.a(n)&&(n=_at.b.d)}_js.Trace.logInfo(_at.b.a,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.Y.bh.Name||"<NULL>",t||"<NULL>",this.Y.bh.ContentType||"<NULL>",n);this.Y.j(n)}}};_at.bb=function(){};_at.bb.prototype={a:function(){return!1},d:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},b:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},c:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},e:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.x=function(){};_at.x.prototype={a:function(n,t){return String.format(_nbs.a.HT,n)},b:function(n,t){throw Error.notImplemented();}};_at.bd=function(){};_at.bd.prototype={imageAttachmentNotLoaded:1,attachmentSize:2,attachmentDownloadingProgress:3,attachmentOverlay:4,attachmentWaitingDownloadText:5,attachmentNotDownloadedOverlay:6};_at.bd.registerEnum("_at.bd",!1);_at.bc=function(){};_at.bc.prototype={a:function(n,t){var r=n;var i=_js.l.c(_a.dh,t.toString());return r!==i},b:function(n,t){throw Error.notImplemented();}};_at.I=function(){};_at.I.prototype={a:function(n,t){var i=n;return!i||!i.Y?"":i.bb()!==1&&i.bb()!==2?"":_js.d.a(i.Y.bh.Thumbnail)?i.bO():"data:"+i.Y.bh.ThumbnailMimeType+";base64,"+i.Y.bh.Thumbnail},b:function(n,t){throw Error.notImplemented();}};_at.z=function(){};_at.z.prototype={a:function(n,t){var i=n;var r=!0;try{var u=_js.l.c(_at.bd,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},b:function(n,t){throw Error.notImplemented();}};_at._TI=function(){};_at._TI.$$cctor=function(){var n="AttachmentOptionsIntroductionPeekView";new _A(n,function(){_at._TI.a[n]===undefined&&(_at._TI.a[n]=[[[-1,4,null,null,null,"ImageId",null,_at._TI.k,0,null,null,null,_n.a.cA()],[-1,4,null,null,null,"HoveredImageId",null,_at._TI.j,0,null,null,null,_n.a.cB()],[-1,4,null,null,null,"AriaLabel",null,_at._TI.h,0,null,null,null,_u.R.CC],[-1,0,["ShowTitle"],[_at._TI.f],null,"IsHidden",null,_at._TI.e,1,_at._TI.d(),null,!0],[-1,0,["CloseCommand"],[_at._TI.l],null,"ClickCommand",null,_at._TI.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at._TI.c,0,null,null,null,_nbs.a.iR],[-1,0,["ShowTitle"],[_at._TI.f],null,"IsHidden",null,_at._TI.e,1,_at._TI.d(),null,!0]],[[-1,4,null,null,null,"Text",null,_at._TI.c,0,null,null,null,_nbs.a.Ic]],[[-1,4,null,null,null,"Text",null,_at._TI.c,0,null,null,null,_nbs.a.fB]]]);var t=_at._TI._hf.childNodes[0].cloneNode(!0);var u=new _fc.a(_B.a(t,[1,2]));var f=new _fc.a(_B.a(t,[1,1]));var i=new _fc.a(_B.a(t,[1,0]));var r=new _fc.b(t.children[0]);return new _B(t,[r,i,f,u])},_at.y,_js.b,function(n){return new _js.b(n)},!1,!1,!1,0,_at._TI.a)};_at._TI.g=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='_at_5'></button> <div class='_at_2 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondary'> <span class='_at_3 ms-font-l ms-font-weight-semilight'></span> <span class='_at_3'></span> <span class='_at_3 _at_4'></span> </div> </div>";_js.c.a().appendChild(n);return n};_at._TI.f=function(n){return n.e};_at._TI.l=function(n){return n.d};_at._TI.e=function(n,t){n.M(t)};_at._TI.i=function(n,t){n.ba(t)};_at._TI.k=function(n,t){n.i(t)};_at._TI.j=function(n,t){n.k(t)};_at._TI.h=function(n,t){n.W(t)};_at._TI.c=function(n,t){n.a(t)};_at._TI.d=function(){_at._TI.b||(_at._TI.b=new _fc.k);return _at._TI.b};_at.be.registerClass("_at.be",_h.dX.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.ih);_at.q.registerClass("_at.q",_b.Y);_at.B.registerClass("_at.B",_b.Y);_at.c.registerClass("_at.c",_b.L);_at.U.registerClass("_at.U",_h.dX.$$(String),_a.fA);_at.r.registerClass("_at.r",null,IAttachmentDownloadUrlFactory);_at.s.registerClass("_at.s",null,IFileReader);_at.J.registerClass("_at.J",_h.dX.$$(Boolean),_a.fA);_at.K.registerClass("_at.K",_h.dX.$$(Boolean),_a.fA);_at.L.registerClass("_at.L",_h.dX.$$(Boolean),_a.fA);_at.M.registerClass("_at.M",_h.dX.$$(Boolean),_a.fA);_at.N.registerClass("_at.N",_h.dX.$$(String));_at.O.registerClass("_at.O",_h.dX.$$(String));_at.i.registerClass("_at.i",_h.dj.$$(_gg.gX,_gg.gI));_at.P.registerClass("_at.P",_at.i);_at.Q.registerClass("_at.Q",_h.dj.$$(_gg.hh,_gg.hj));_at.R.registerClass("_at.R",_h.dX.$$(String));_at.v.registerClass("_at.v",_h.dj.$$(_gg.tn,_gg.gI));_at.S.registerClass("_at.S",_h.dX.$$(String));_at.m.registerClass("_at.m",_h.dX.$$(String));_at.g.registerClass("_at.g",_h.dX.$$(_gg.tp));_at.bf.registerClass("_at.bf",_h.dX.$$(_g.fX));_at.T.registerClass("_at.T",_at.bf);_at.C.registerClass("_at.C",_at.bf);_at.D.registerClass("_at.D",_h.dX.$$(String));_at.n.registerClass("_at.n");_at.j.registerClass("_at.j");_at.p.registerClass("_at.p");_at.V.registerClass("_at.V",_a.bm);_at.y.registerClass("_at.y",_a.bx,_y.fA,_a.iT,_js.z,Sys.IDisposable);_at.a.registerClass("_at.a",_a.bx,_y.dn,_js.z);_at.t.registerClass("_at.t");_at.bh.registerClass("_at.bh",null,_y.gr);_at.X.registerClass("_at.X",_at.bh);_at.Y.registerClass("_at.Y",_at.bh);_at.Z.registerClass("_at.Z",_at.bh);_at.o.registerClass("_at.o",_at.a);_at.G.registerClass("_at.G",_at.o);_at.H.registerClass("_at.H",null,IUriFileAttachmentViewModelFactory);_at.w.registerClass("_at.w");_at.b.registerClass("_at.b",_at.a,_at.bi);_at.bc.registerClass("_at.bc",null,_js.T);_at.I.registerClass("_at.I",null,_js.T);_at.z.registerClass("_at.z",null,_js.T);_at._TI.registerClass("_at._TI");AttachmentsComponent.$$cctor();_at.q.a=_a.UserAgent.getInstance().E&&!_a.UserAgent.getInstance().K;_at.c.c=new _H("Attachment",_g.Attachment,_at.c);_at.c.e=new _H("ParentItemId",_g.g,_at.c);_at.c.g=new _H("IsEnabled",Boolean,_at.c);_at.c.d=new _H("FileSelectedCommand",_js.v,_at.c);_at.c.b=new _H("UploadAttachmentCommand",_js.v,_at.c);_at.c.f=new _H("UploadCompletedCommand",_js.v,_at.c);_at.c.a=_a.a.c;_at.r.a=_a.a.c;_at.f.b=null;_at.l.b=null;_at.i.a=_a.a.c;_at.v.a=_a.a.c;_at.m.a=null;_at.g.a=null;_at.j.a=null;_at.a.a=_a.a.c;_at.a.c=new _ff.d([".mp3"]);_at.a.d=new _ff.d([".ics",".ical",".icalendar",".vcs"]);_at.a.b=null;_at.h.b=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.e.j=[137,80,78,71,13,10,26,10];_at.e.h=[71,73,70,56,55,97];_at.e.i=[71,73,70,56,57,97];_at.e.g=[66,77];_at.k.a=_a.a.c;_at.k.b=!1;_at.d.a=_a.a.c;_at.b.a=_a.a.c;_at.b.d="application/octet-stream";_at.b.b="application/vnd.ms-excel";_at.b.e="application/msword";_at.b.c="application/vnd.ms-powerpoint";_at.b.f={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.b.b,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.b.e,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.b.e,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.b.c,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.b.c,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.b.c,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.b.c,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.b.c,".pwz":_at.b.c,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.b.b,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.b.b,".xlc":_at.b.b,".xld":_at.b.b,".xlk":_at.b.b,".xll":_at.b.b,".xlm":_at.b.b,".xls":_at.b.b,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.b.b,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.b.b,".xlw":_at.b.b,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};_at._TI._hf=_at._TI.g();_at._TI.b=null;_at._TI.a={};_at._TI.$$cctor();
window.scriptsLoaded['microsoft.owa.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
